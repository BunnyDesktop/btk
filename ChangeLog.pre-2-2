Fri Dec 20 15:23:26 2002  Owen Taylor  <otaylor@redhat.com>

	* === Released 2.2.0 ===

	* configure.in: Version 2.2.0, interface age 0, binary age 200.

	* README.in: Update the release notes.

	* INSTALL.in: Mention that Bango-1.0 can be used with BTK+-2.2.

	* NEWS: Update.

2002-12-20  Sven Neumann  <sven@gimp.org>

	* examples/btkdial/btkdial.c: use G_PI instead of M_PI.

Thu Dec 19 11:42:00 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkevents-x11.c (bdk_event_translate): Call
	the filters on the window where the event is received,
	not on the window the event is "about". (#101512,
	Bolian Yin.)

Thu Dec 19 03:58:36 2002  Kristian Rietveld  <kris@btk.org>

	* tests/testtreeflow.c: the rand variable should be static to
	avoid conflicts with rand(). (#100844, reported by Soeren Sandmann,
	fix pointed out by Matthias Clasen).

Thu Dec 19 03:56:23 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreeview.c (btk_tree_view_real_select_cursor_row): if we
	started editing, we handled this key signal, so return TRUE.
	(#100532, reported by Soeren Sandmann).

2002-12-18  Matthias Clasen  <maclas@gmx.de>

	* btk/btkwidget.c: Add docs.

Wed Dec 18 12:05:33 2002  Owen Taylor  <otaylor@redhat.com>

	* NEWS: Various name fixes.

Mon Dec 16 22:38:11 2002  Owen Taylor  <otaylor@redhat.com>

	* === Released 2.1.5 ===

	* configure.in: BTK+-2.1.5, interface age 2, binary age 105.

	* NEWS: Updated.

	* btk/Makefile.am (btk_c_sources): Remove reference to fnmatch.h

Mon Dec 16 22:12:01 2002  Owen Taylor  <otaylor@redhat.com>

	* configure.in: Don't use AC_CHECK_LIB() when
	checking for FreeType, Bango, Batk since that get
	the ordering wrong. Instead, set LIBS ourself
	and call AC_TRY_LINK_FUNC(). (#98406)

Mon Dec 16 21:39:28 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkentry.c (btk_entry_enter_text): Call
	btk_entry_set_position_internal() that takes a
	new "reset_IM" parameter, so that we avoid the
	problem where committing text would reset the
	input method. (#74381, Kang Jeong-Hee)

2002-12-17  Matthias Clasen  <maclas@gmx.de>

	* btk/btkcontainer.c: Fix a few doc comments.

2002-12-17  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkglobals-win32.c: Minor cosmetics.

	Implement two missing functions (#101369)

	* bdk/win32/bdkevents-win32.c
	(bdk_display_add_client_message_filter): Implement by calling
	bdk_add_client_message_filter(), no separate displays on Windows,
	at least not yet.

	* bdk/win32/bdkgc-win32.c (bdk_gc_get_screen): Implement by
	returning the only screen so far, _bdk_screen.

	* bdk/bdk.def: Add here, too.

Mon Dec 16 16:18:15 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btktexttag.c (btk_text_tag_get_property): Get rid
	of incorrect calls to g_value_init(). (#100669, Johan
	Dahlin, James Henstridge)

Mon Dec 16 17:20:02 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* btk/btkaccellabel.c: Implement Owen's susggestion from
	#80764. Fixes #101314.

Sun Dec 15 18:47:30 2002  Owen Taylor  <otaylor@redhat.com>

	Some fixes for modal hint setting based on a patch
	from Arvind Samptur (#100416)

	* btk/btkdialog.c (btk_dialog_run): Call btk_window_set_modal
	before showing the window for efficiency.

	* btk/btkwindow.c (btk_window_realize): Ignore the EWMH
	constraint that the transient-for hint must always be
	set on windows with the modal hint and just always set
	the modal hint.

	* btk/btkwindow.c (btk_window_set_modal): Update the
	modal hint on the BdkWindow when the window is realized.

Sun Dec 15 18:39:09 2002  Owen Taylor  <otaylor@redhat.com>

	* configure.in: Hard-code BTK_BINARY_VERSION=2.2.0 for
	now; should stay the same until we branch for 2.3. (#100598)

Sun Dec 15 18:14:16 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmenuitem.c (btk_real_menu_item_activate_item): 
	Pass TRUE for search_sensitive - prevents a problem
	where after hitting Alt-F to bring up the File menu,
	the mnemonics for the items in the menu might not
	be usable. (#89336)

Sat Dec 14 22:18:45 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkwindow-x11.c (bdk_window_get_frame_extents):
	Fix a bug with checking the private flag on the wrong
	window; improve the answer on failure a bit; push
	an error trap around the X operations. (#100933)

Sat Dec 14 22:03:21 2002  Owen Taylor  <otaylor@redhat.com>

	* modules/input/btkimcontextxim.c (status_window_hide): Don't
	call status_window_set_text() if the status window doesn't
	already exist. (#100933, reported by Anand Subra)

	* modules/input/btkimcontextxim.c (status_window_show): 
	Don't bother creating the status window here, wait for
	the set_text(). (Fixes a warning)

2002-12-15  Matthias Clasen  <maclas@gmx.de>

	* btk/btkcalendar.c:
	* btk/btkfilesel.c:
	* btk/btkfontsel.c:
	* btk/btkhruler.c:
	* btk/btkinputdialog.c:
	* btk/btkprogress.c:
	* btk/btktreemodel.c:
	* btk/btkvruler.c:
	* btk/queryimmodules.c:
	* btk/theme-bits/decompose-bits.c:
	* bdk-pixbuf/bdk-pixbuf-csource.c:
	* bdk-pixbuf/make-inline-pixbuf.c:
	* bdk-pixbuf/queryloaders.c:
	* bdk/bdkkeynames.c:
	* bdk/bdkrgb.c:
	* bdk/linux-fb/bdkfbmanager.c:
	* bdk/win32/bdkevents-win32.c:
	* bdk/win32/bdkmain-win32.c:
	* bdk/win32/bdkproperty-win32.c:
	* bdk/x11/bdkmain-x11.c: Use g_printf instead of system 
	printf.  (#99327)  

	* btk/btkcontainer.c (btk_container_class_install_child_property): 
	(btk_container_child_get_valist): 
	(btk_container_child_get_property): 
	(btk_container_child_set_valist): 
	(btk_container_child_set_property): 
	(btk_container_add_with_properties): 
	(btk_container_child_set): 
	(btk_container_child_get): Add docs.

	* btk/btkwindow.c (btk_window_activate_default): 
	(btk_window_activate_focus): Add docs.

2002-12-14  Matthias Clasen  <maclas@gmx.de>

	* btk/btkmenuitem.c (btk_menu_item_position_menu): Made
	Xinerama-aware.  (#85711)

Sat Dec 14 14:19:16 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmenu.c: Add a new binding signal, "move_scroll",
	and use it to hook up Home/End/Page_Up/Page_Down keybindings.
	(#80484, Narayana Pattipati, Marius Andreiana)

	* btk/btkmenu.c (btk_menu_scroll_item_visible): Fix some
	bugs in the computation of when an item is visible. (#99545)
	
	* btk/btkbindings.[ch] (_btk_binding_signal_new) btk/btkmenushell.c:
	Move here, export privately.

	* btk/btkmenushell.c (_btk_menu_shell_select_last): Export
	privately.

	* btk/btkmenushell.c (btk_menu_shell_select_item): Don't
	select the item if it is already selected.

Sat Dec 14 01:51:05 2002  Chema Celorio  <chema@celorio.com>

	* btk/btkdialog.c (btk_dialog_add_buttons_valist): minor coding
	style fix.

Sat Dec 14 01:22:05 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* btk/btkaccellabel.[ch] (btk_accel_label_refetch): Don't
	recalculate the acceleration label in an idle handler.

Sat Dec 14 01:00:12 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmenu.c (btk_menu_position): Handle the case
	where the pointer isn't on the same screen as the widget
	by centering the menu on the widget's screen. (#94563)

Fri Dec 13 23:58:06 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkscreen.c (bdk_screen_get_monitor_at_point)
	* bdk/bdkscreen.c (bdk_screen_get_monitor_at_window): 
	Provide a useful fallback on failure - return a monitor
	close to the point or window. (#79991)

	* btk/btkmenu.c (btk_menu_position): Remove a now
	unneeded check for failure of 
	bdk_screen_get_monitor_at_point()

Fri Dec 13 23:10:21 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkclist.c: Fix a problem with the focus row
	ending up off the list when rows were deleted
	(#94812, Christian Reis, Jon Nelson).

Fri Dec 13 22:55:27 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmenu.c (menu_change_screen): If the screen
	for the menu changes while the menu is torn off, move
	the tearoff along with it. (#85669)

	* btk/btkmenu.c (btk_menu_set_tearoff_state): When 
	reattaching, get rid of the get rid of the tearoff window.

Fri Dec 13 21:35:12 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkhandlebox.c (btk_handle_box_motion): Handle
	the case where the pointer is moved between screens
	during a handle box drag by resetting the original
	location. (#94562)

	* btk/btkinputdialog.c (btk_input_dialog_get_private): 
	Fix a leftover variable name from cut-and-paste.

Fri Dec 13 18:57:20 2002  Owen Taylor  <otaylor@redhat.com>

 	* btk/btkdialog.c: Change the Escape key binding to only close
 	if the dialog contains a cancel button.  (Patch from
	James Willcox, #74221)
 
Fri Dec 13 18:22:21 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkfilesel.c (compare_cmpl_dir): Use 
	g_utf8_collate_key() to sort in human-friendly order.
	(#94473, Gregory Merchan)

Fri Dec 13 17:45:40 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/fnmatch.c btk/btkprivate.h btk/btkfilesel.c: 
	System fnmatch wasn't going to be UTF-8 clean, neither 
	was our	version. Redo our fnmatch.c to be UTF-8, add 
	test cases, fix all sorts of bugs inherited
	from the antique GNU fnmatch code. Change interface
	to get rid of fnmatch.h constants. Fixes basic
	non-workingness of filesel with non-ASCII filenames.
	(#78758, Kang Jeong-Hee)

	* btk/fnmatch.h: No longer needed.

Fri Dec 13 12:15:09 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkfilesel.c (find_parent_dir_fullname): If
	getting the parent of the directory name, make
	an attempt to change back to the original directory.

Thu Dec 12 20:07:25 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkfilesel.c (cmpl_completion_fullname): Const
	warning fix.

Thu Dec 12 19:51:45 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkfilesel.c (open_new_dir): Include "."
	and ".." in the list of entries; they are needed for 
	correct	handling of .<TAB>, ..<TAB>; were lost
	with the GDir conversion. (Francisco Bustamante,
	#89972)

	* btk/btkfilesel.c (open_new_dir): If we hit
	EOF unexpectedly, that's OK... a file was just
	deleted while we were reading the directory.

Thu Dec 12 18:02:34 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmain.c (btk_main_do_event): Intercept events
	of type BDK_SETTING before we check to see if there
	was an event widget or not. (#97451, Simon Wong,
	Bastien Nocera)

Thu Dec 12 17:58:41 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkrc.key.emacs: Add C-u/C-h/C-w. (#72245)

Thu Dec 12 17:01:38 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkdnd.c (btk_drag_find_widget): Skip insensitive
	widgets. (#84061)

Thu Dec 12 15:08:01 2002  Owen Taylor  <otaylor@redhat.com>

	* acinclude.m4: Remove unneeded bits of AM_BTK_GNU_TEXT
	macros.

Thu Dec 12 18:25:17 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* btk/btktextview.c (btk_text_view_button_press_event): 
	return TRUE when button 3 is pressed, fixes #78324.

Thu Dec 12 10:12:39 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btktextview.c: Turn off DEBUG_VALIDATION_AND_SCROLLING
	that got turned on in an accidental commit.

Wed Dec 11 18:30:05 2002  Owen Taylor  <otaylor@redhat.com>

	* === Released BTK+-2.1.4 ===

	* NEWS: Updated.

	* modules/input/Makefile.am (INCLUDES): Remove BTK_LOCALEDIR
	from here as well. (Manish Singh)

2002-12-11  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkpixmap-win32.c (bdk_pixmap_new,
	bdk_bitmap_create_from_data, bdk_pixmap_create_from_data)
	* bdk/win32/bdkprivate-win32.h
	* bdk/win32/bdkimage-win32.c (_bdk_win32_setup_pixmap_image):
	Functions now take a BdkDrawable instead of BdkWindow parameter,
	like in X11 and linux-fb backends (#100780)

	* bdk/win32/bdkwindow-win32.c (get_default_title): Do use
	g_get_application_name() (I now have a fresh enough GLib).

Wed Dec 11 14:04:23 2002  Owen Taylor  <otaylor@redhat.com>

	* configure.in: version 2.1.4, interface age 1.
	
	* configure.in: Require GLib-2.1.4, so we will catch
	the need for the new AM_BUNNYLIB_DEFINE_LOCALEDIR() in
	an obvious way.

	* configure.in btk/Makefile.am: Use AM_BUNNYLIB_DEFINE_LOCALEDIR()

Tue Dec 10 15:46:01 PST 2002  Manish Singh  <yosh@gimp.org>

	* bdk/x11/bdkwindow-x11.c (set_initial_hints): 
	bdk_x11_get_xatom_by_name_for_display takes a BdkDisplay *,
	not an XDisplay * (obvious typo fix for the previous commit)

2002-12-11  Matthias Clasen  <maclas@gmx.de>

	* bdk/x11/bdkwindow-x11.c (set_initial_hints): Delete EWMH
	properties if no private->state flags are set.  (#66754)

2002-12-10  Matthias Clasen  <maclas@gmx.de>

	* btk/btkwidget.c (btk_widget_class_find_style_property): 
	* btk/btkcontainer.c (btk_container_class_find_child_property):
	Doc typo fixes.

	* btk/tree_plus.xpm: 
	* btk/tree_plus.xbm: 
	* btk/tree_minus.xpm: 
	* btk/tree_minus.xbm: 
	* btk/line-wrap.xbm: 
	* btk/line-arrow.xbm: 
	* btk/btktextview.c: 
	* btk/btktextutil.c: 
	* btk/btkstyle.c: 
	* btk/btkstock.c: 
	* btk/btksizegroup.c: 
	* btk/btkselection.c: 
	* btk/btkoptionmenu.c: 
	* btk/btklist.c: 
	* btk/btkfilesel.c: 
	* btk/btkentry.c: 
	* btk/btkcolorsel.c: 
	* btk/btkclist.c: 
	* btk/btkclipboard.c: 
	* btk/btkbutton.c: Data constness fixes.  (#75754)

Tue Dec 10 14:37:41 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkevents-x11.c (bdk_event_translate)
	  bdk/x11/bdkwindow-x11.h: Separate out tracking of the X server
	  focus window from tracking our idea of what the focus window is,
	  because the PointerRoot code needs to know the real pointer
	  window. (Mostly accidentally committed a bit earlier.)

Tue Dec 10 12:57:00 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkclist.c (adjust_adjustments): Fix typo with
	hadjustment/vadjustment introduce prior to 2.0.0.
	(#84621, Charles Kerr)

Tue Dec 10 12:40:30 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* btk/btkmenuitem.c, btk/btkstyle.c, btk/btkrc.c: new default
	color scheme based on the GNOME stock icon palette. (#80691,
	Tuomas Kuosmanen, Garrett LeSage, Owen Taylor)

	* btk/btknotebook.c (btk_notebook_real_remove): take a new
	parameter, "destroying", and don't emit the switch-page signals
	when it is true (fix #64832, reported by Jarred Keuch)

	* btk/btklabel.c (btk_label_set_property): remove unused
	variable. 

Tue Dec 10 02:14:12 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreeview.c (btk_tree_view_get_path_at_pos): x can be in
	the range [0, upper], which can be bigger than [0, page_size].
	(Fixed #99778, reported and testcase provided by Carlos Garnacho
	Parro).

Mon Dec  9 19:49:03 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwindow.c (btk_window_move_resize): Remove
	a couple of places if (widget->window), this function
	will only ever be called on a realized window.
	(#80225)

Tue Dec 10 01:58:43 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreeview.c (validate_visible_area): implement a working
	use_align = FALSE implementation (also mentioned in #91335, reported
	by Juri Pakaste).

	* btk/btktreeview.c (validate_visible_area): only free the
	scroll_to_path if we are done with validating (fixes #93584, reported
	and testcase provided by Erik Simonsen).

	* btk/btktreeviewcolumn.c (btk_tree_view_column_cell_process_action):
	set the BTK_CELL_RENDERER_FOCUSED flag where appropriate. (fixes
	#75745, reported by Richard Hult).

	* btk/btktreeviewcolumn.c (btk_tree_view_column_cell_get_position):
	initialize cellinfo to NULL to silence the compiler.

Mon Dec  9 19:31:59 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkstyle.c (draw_spinbutton_shadow): Remove
	unused draw_spin_entry_shadow(). (#80229)

Mon Dec  9 18:50:31 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkinput-x11.c (_bdk_input_common_find_events):
	Remove selection for DeviceButtonRelease, we no longer need
	it now that gxi is gone. (#32617, reported by Garry
	Osgood)

Tue Dec 10 00:49:35 2002  Kristian Rietveld  <kris@btk.org>

	* bdk/bdkpixmap.h (bdk_pixmap_new), (bdk_bitmap_create_from_data),
	(bdk_pixmap_create_from_xpm), (bdk_pixmap_colormap_create_from_xpm),
	(bdk_pixmap_create_from_xpm_d),
	(bdk_pixmap_colormap_create_from_xpm_d): update to allow a
	BdkDrawable instead of a BdkWindow.

	* bdk/bdkpixmap.c (bdk_pixmap_colormap_create_from_xpm),
	(bdk_pixmap_create_from_xpm), (bdk_pixmap_colormap_create_from_xpm_d),
	(bdk_pixmap_create_from_xpm_d): update to allow a BdkDrawable
	instead of a BdkWindow.

	* bdk/linux-fb/bdkpixmap-fb.c (bdk_pixmap_new),
	(bdk_bitmap_create_from_data), (bdk_pixmap_create_from_data): update
	to allow a BdkDrawable instead of a BdkWindow.

	* bdk/x11/bdkpixmap-x11.c (bdk_pixmap_new),
	(bdk_bitmap_create_from_data), (bdk_pixmap_create_from_data): likewise

Mon Dec  9 17:31:06 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkiconfactory.c (icon_size_lookup_intern): Remove
	unnecessary leftover check that was causing a UMR.
	(#100768, Kjartan Maraas)

Mon Dec  9 19:11:22 2002  Artis Trops  <hornet@navigator.lv>

	* configure.in: Added Latvian (lv) to ALL_LINGUAS.

Mon Dec  9 10:44:59 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkcolor-x11.c (bdk_colormap_alloc_colors_private):
	Fix a bug in one of my earlier changes. (From Naofumi Yasufuku,
	#100023)

Sun Dec  8 21:43:31 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkcolor-x11.c: Fix spacing in a bunch of 
	for (i=0; i<ncolors; i++).

	* bdk/x11/bdkcolor-x11.c: Various g_return_if_fail()
	cleanup.

Sun Dec  8 21:29:10 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkcolor-x11.c (bdk_colormap_alloc1): Fix
	a lost refcount in the case where we get a duplicate
	back from the X server.

	* bdk/x11/bdkcolor-x11.c (bdk_colormap_alloc_colors_writeable):
	Set success[] for all colors when allocation of colors
	cells via XAllocColorCells succeeds.

	* bdk/x11/bdkcolor-x11.c (bdk_colormap_alloc_colors_private):
	Don't match against colors cells allocated writeable.

Sun Dec  8 21:22:46 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkcolor-x11.c (bdk_colormap_alloc_colors_private): 
	When allocating non-writeable colors, fill in the flags
	field of the XColor, and insert the returned color into
	our color hash. (#100023, Naofumi Yasufuku)

	* bdk/x11/bdkcolor-x11.c (bdk_colormap_free_colors): 
	Fix a typo (my fault) that slipped in in the last patch.

Sun Dec  8 20:32:23 2002  Owen Taylor  <otaylor@redhat.com>

	More fixes for BdkColormapX11 (#100023, Naofumi Yasufuku)

	* bdk/x11/bdkcolor-x11.c (bdk_colors_free) 
	(bdk_colormap_free_colors): Don't call XFreeColors() for  
	private colorsmaps.

	* bdk/x11/bdkcolor-x11.c (bdk_colormap_alloc_colors_writeable,
	bdk_colormap_colors_private, bdk_colormap_alloc_colors_shared):
	Fix return values to return number remaining not number
	allocated.
	
	* bdk/x11/bdkcolor-x11.c (bdk_colormap_alloc_colors_shared,
	bdk_colormap_alloc_colors_private): Clean up some a stray 
	initializations.

Sun Dec  8 20:19:22 2002  Owen Taylor  <otaylor@redhat.com>

	Fixes for BdkColormapX11 (#100023, Naofumi Yasufuku)

	* bdk/x11/bdkcolor-x11.c (bdk_x11_colormap_foreign_new): 
	Fix typo that caused us to always return the system
	colormap.

	* bdk/x11/bdkcolor-x11.c (bdk_colormap_new): When allocating
	a private colormap and copying the system palette
	to prevent flashing, handle colormap->size greater than
	system_colormap->size.

	* bdk/x11/bdkcolor-x11.c (bdk_x11_colormap_get_xdisplay):
	Get rid of the last remains of private->xdisplay
	in favor of using private->screen. 

2002-12-09  Tor Lillqvist  <tml@iki.fi>

	Merge from stable:
	
	* bdk/win32/bdkdrawable-win32.c (generic_draw): Don't leak
	stipple_gc. More checks for errors. Use correct ternary ROP when
	blitting the foreground into the tile pixmap onto those pixels
	where the stipple is set. (I didn't notice that I had used the
	wrong one, as it didn't matter on Win2k, where DIB sections
	apparently are zeroed upon creation. But on Win98 they have random
	initial contents. Thanks to Hans Breuer for reporting this.)
	(bdk_win32_draw_rectangle, bdk_win32_draw_arc,
	bdk_win32_draw_polygon): Don't pass the LINE_ATTRIBUTES bits to
	generic_draw() if drawing a filled figure.

	* bdk/win32/bdkmain-win32.c (_bdk_win32_print_dc): Minor cosmetics.
	(_bdk_win32_gcvalues_mask_to_string): Initialize buffer as empty.
	(_bdk_win32_window_state_to_string): New debugging output helper
	function.
	
	* bdk/win32/bdkevents-win32.c: Minor debugging output changes.
	(bdk_event_translate): Ignore the WM_SHOWWINDOW/SW_OTHERUNZOOM or
	SW_OTHERZOOM messages. Do not generate a BDK_UNMAP event for
	WM_SIZE/SIZE_MINIMIZED messages, they do not really corrspond to
	unmapping on X11. Set window state correctly for all three of
	SIZE_{MINIMIZED,MAXIMIZED,RESTORED}. A maximized and then iconified
	("minimized" in Windows terminology) window still has the
	"maximized" property, i.e. when deiconified, it will reappear as
	maximized. (#10557)

	* bdk/win32/bdkprivate-win32.h: Declare new function.
	(WIN32_API_FAILED, WIN32_GDI_FAILED, OTHER_API_FAILED): Don't use
	__PRETTY_FUNCTION__ if __GNUC__ >= 3, to avoid warning message.

	* bdk/win32/bdkwindow-win32.c (show_window_internal): Handle more
	situations. Add parameter to tell whether deiconifying. Code
	reorg: Return early when appropriate instead of using nested if
	statements. If just deiconifying without raising, restore active
	window. (#10557)

	(bdk_window_hide, bdk_window_withdraw, bdk_window_iconify,
	bdk_window_deiconify, bdk_window_maximize, bdk_window_unmaximize,
	bdk_window_focus): Use _bdk_win32_window_state_to_string() in
	debugging output.

	(bdk_window_iconify): Restore active window after calling
	ShowWindow(). Otherwise the "next" window gets activated.

	(bdk_window_stick, bdk_window_unstick): Don't output any warnings.

	(bdk_window_set_transient_for): Rewrite. Just call SetWindowLong()
	with GWL_HWNDPARENT, which despite its name sets the *owner*
	window, which should be exactly what we want. The PSDK
	documentation is said to be misleading. testbtk's modal window
	test now works much better. (#50586)

Sun Dec  8 18:28:51 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.c (btk_widget_modify_fg/bg/base/text/font): 
	Remove left-over NULL checks that were preventing the
	NULL to "unmodify" feature from actually working.
	(#100702, Jon-Kare Hellan)

2002-12-08  Matthias Clasen  <maclas@gmx.de>

	* btk/btkcolorsel.c (btk_color_selection_set_previous_color): 
	(btk_color_selection_set_previous_alpha): Reset priv->changing 
	before returning.  (#100443)

Sat Dec  7 14:45:50 GMT 2002  Tony Gale <gale@btk.org>

	* docs/tutorial/btk-tut.sgml: minor fixes

	* examples/pixmap: don't use deprecated function

Fri Dec  6 19:00:59 2002  Owen Taylor  <otaylor@redhat.com>

	* demos/btk-demo/testview.c tests/testbtk.c
	tests/testtext.c tests/testtextbuffer.c: Use
	octal escapes rather than literal UTF-8.

Fri Dec  6 17:50:57 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkpixmap.c (PACKED_COLOR): Fix incorrect
	masks in PACKED_COLOR definition. (#99795, 
	John Finlay)

Fri Dec  6 17:46:42 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmenu.c (btk_menu_window_size_request): Use
	the correct screen for getting the height.
	(Fix from Stephen Browne, #96777)

Thu Dec  5 16:01:14 2002  Eric Warmenhoven <eric@warmenhoven.org>

	* bdk/{linux-fb,win32}/Makefile.am: Fix bdkenumtypes.h hack

2002-12-06  Matthias Clasen  <maclas@gmx.de>

	* bdk/bdkcolor.c: 
	* bdk/bdkfont.c: Add some Deprecation info. 

Wed Dec  4 19:41:14 2002  Eric Warmenhoven <eric@warmenhoven.org>

	* bdk/linux-fb/bdkglobals-fb.c bdk/linux-fb/bdkkeyboard-fb.c
	bdk/linux-fb/bdkmain-fb.c bdk/linux-fb/bdkprivate-fb.h
	bdk/linux-fb/bdkrender-fb.c: More proper vt switch handling

Wed Dec  4 14:31:46 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkdnd-x11.c: Always look up and create the
	Motif drag window as a child of the root window of screen 0
	rather than the default screen.	(#100362, Erwann Chenede)

	* bdk/x11/bdkdnd-x11.c (motif_read_initiator_info):
	Return FALSE, not BDK_FILTER_REMOVE on failure; this
	isn't a filter function.
	
	* bdk/x11/bdkselection-x11.c btk/btkselection.c: Add
	some g_return_if_fail() to catch selection == None more 
	gracefully than an X error.

2002-12-04  Christian Neumair  <chris@gnome-de.org>

	* btk/btkcellrendertoggle.c: Fixed typo in property
	description.

Wed Dec  4 12:44:50 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkcombo.c (btk_combo_selection_changed): Add
	back the monitoring of the selection when the combo
	isn't popped down; apparently people depended upon
	the side-effect where btk_combo_set_popdown_strings()
	would wipe out the contents of the list when browse-mode
	autoselected the first item in the list. (#100347)

Tue Dec  3 17:47:24 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkgeometry-x11.c (bdk_window_guffaw_scroll): Fix wrong 
	sign for queued translation. (Found by Chris Blizzard,
	#100274)

2002-12-03  Matthias Clasen  <maclas@gmx.de>

	Moveresize emulation for all edges.  (#52833)
	
	* bdk/x11/bdkwindow-x11.c (update_pos): Support all edges. 
	(calculate_unmoving_origin): New function which calculates the
	ICCCM reference point for the window depending on the gravity.
	(emulate_resize_drag): use calculate_unmoving_origin().
	(emulate_move_drag): use calculate_unmoving_origin().

	RTL flipping for statusbars.  (#96832)
	
	* btk/btkstatusbar.c (get_grip_edge): New function returning the
	appropriate grip edge for a statusbar.
	(get_grip_rect): Do the right thing in RTL mode.
	(btk_statusbar_button_press): Initiate a resize drag on the
	appropriate edge. 
	(btk_statusbar_expose_event): Paint the resize grip for the
	appropriate edge.

2002-12-03  Anders Carlsson  <andersca@gnu.org>

	* btk/btkstyle.c: Fix doc comment.

Mon Dec  2 20:36:28 2002  Owen Taylor  <otaylor@redhat.com>

	* === Released BTK+-2.1.3 ===

	* configure.in: Version 2.1.3, interface ago 0.

	* NEWS: Update

2002-12-02  Murray Cumming  <murrayc@usa.net>

	* btk/btktreemodel.h: Declare btk_tree_row_reference_get_type(). It is
	already used by a macro in the same header.

2002-11-28  Matthias Clasen  <maclas@gmx.de>

	* bdk/bdkdisplay.c: 
	* bdk/bdkdisplaymanager.c: 
	* bdk/bdk.c: 
	* bdk/bdkdraw.c:
	* bdk/bdkevents.c:
	* bdk/bdkrgb.c:
	* bdk/bdkscreen.c:
	* bdk/bdkwindow.c:
	* bdk/x11/bdkcolor-x11.c:
	* bdk/x11/bdkcursor-x11.c:
	* bdk/x11/bdkdisplay-x11.c:
	* bdk/x11/bdkdnd-x11.c:
	* bdk/x11/bdkevents-x11.c:
	* bdk/x11/bdkfont-x11.c:
	* bdk/x11/bdkgc-x11.c:
	* bdk/x11/bdkinput.c:
	* bdk/x11/bdkkeys-x11.c:
	* bdk/x11/bdkbango-x11.c:
	* bdk/x11/bdkpixmap-x11.c:
	* bdk/x11/bdkproperty-x11.c:
	* bdk/x11/bdkscreen-x11.c:
	* bdk/x11/bdkselection-x11.c:
	* bdk/x11/bdkvisual-x11.c:
	* bdk/x11/bdkwindow-x11.c:
	* bdk/x11/bdkxid.c:
	* btk/btkclipboard.c:
	* btk/btkcolorsel.c:
	* btk/btkiconfactory.c:
	* btk/btkinvisible.c:
	* btk/btkliststore.c:
	* btk/btkmenu.c:
	* btk/btkmenushell.c:
	* btk/btknotebook.c:
	* btk/btkplug.c:
	* btk/btkselection.c:
	* btk/btksettings.c:
	* btk/btktreemodel.c:
	* btk/btktreemodelsort.c:
	* btk/btktreeselection.c:
	* btk/btktreestore.c:
	* btk/btktreeview.c:
	* btk/btktreeviewcolumn.c:
	* btk/btkwidget.c:
	* btk/btkwindow.c: Document 2.2 API additions. I'm not
	going to list all individual functions here; if you want to see
	the list, grep for "Since: 2.2".	

Tue Nov 26 13:07:56 2002  HideToshi Tajima  <hidetoshi.tajima@sun.com>

	* modules/input/btkimcontextxim.c
	(btk_im_context_xim_filter_keypress):
	Fix #99593: Fix a memory leak when XmbLookupString returns
	XBufferOverflow

2002-11-26  Daniel Elstner  <daniel.elstner@gmx.net>

	* btk/btktoolbar.c (elide_underscores): Fix nasty typo (#99653):
	strlen (original + 1) -> strlen (original) + 1

Tue Nov 26 22:26:04 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btk{tree,list}store.c (btk_{tree,list}_store_real_set_value):
	add a btk_list_store_sort_iter_changed line for some special
	case ... (#96647 (issue 1), testcases from Soeren Sandmann and
	Daniel Elstner).

Tue Nov 26 22:18:06 2002  Kristian Rietveld  <kris@btk.org>

	Inconsistent state for toggle renderers, requested by Paolo Bacchilega
	in #88130.

	* btk/btktreeprivate.h: move BtkCellRendererInfo here.

	* btk/btkcellrenderer.c: moved BtkCellRendererInfo away,
	fix some indentation issues.

	* btk/btkcellrenderertoggle.c (btk_cell_renderer_toggle_class_init),
	(btk_cell_renderer_toggle_set_property),
	(btk_cell_renderer_toggle_get_property),
	(btk_cell_renderer_toggle_render): add an inconsistent property.

	* btk/btkstyle.c (btk_default_draw_check),
	(btk_default_draw_option): support drawing inconsistent
	options/checks for cells.

Tue Nov 26 22:14:14 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btkcellrenderertext.c (btk_cell_renderer_text_editing_done),
	(btk_cell_renderer_text_start_editing): add a focus_out_id to avoid
	calling _editing_done twice (which has nasty side-effects). (#96647,
	(issue 2) testcase from Soeren Sandmann).

Tue Nov 26 22:12:21 2002  Kristian Rietveld  <kris@btk.org>

	#82739, patch from Padraig O'Briain.

	* btk/btktreeviewcolumn.[ch]: add
	btk_tree_view_column_cell_get_position()

Tue Nov 26 22:06:29 2002  Kristian Rietveld  <kris@btk.org>

	Yes, this chunk breaks ABI compatibility. Owen knows about it and
	agreed with it. It doesn't break ABI that bad though, things will
	still work. Please keep it silent :P.

	This patch fixes some keynav issues reported by Narayana Pattipati
	in #81633. (Also mentioned in #92037 (Sun tracking bug)).

	* btk/btkmarshalers.list: add two silly marshalers

	* btk/btktreeview.[ch] (btk_tree_view_real_select_all),
	(btk_tree_view_real_unselect_all),
	(btk_tree_view_real_select_cursor_row),
	(btk_tree_view_real_toggle_cursor_row),
	(btk_tree_view_real_expand_collapse_cursor_row),
	(btk_tree_view_real_start_interactive_search): change the return
	type from void to gboolean, update prototypes, functions, signals and
	entries in BtkTreeViewClass,
	(btk_tree_view_class_init): add select_cursor_row binding for
	enter key,
	(btk_tree_view_key_press): only navigate the header button if the
	header is also visible ...

Tue Nov 26 22:05:48 2002  Kristian Rietveld  <kris@btk.org>

	API bit of #75745, reported by Richard Hult.

	* btk/btkcellrenderer.h (BtkCellRendererState): add
	BTK_CELL_RENDERER_FOCUSED, rest of this bug fix will follow later.

Tue Nov 26 18:28:58 GMT 2002  Tony Gale <gale@btk.org>

	* docs/tutorial/package-db-tutorial.sh:
	(see #71679) create split package files

Tue Nov 26 01:55:47 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* btk/btkprogressbar.c (btk_progress_bar_paint_text): don't offset
	one pixel when calculating the x position of the text.

Tue Nov 26 00:40:53 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* btk/btkprogressbar.c (btk_progress_bar_paint_text): draw text
	twice, once with the prelight state and clipped to the progress
	bar, and once with the normal state and clipped to the visible
	part of the trough. Also fix a spelling error pointed out by
	Matthias Clasen.

Mon Nov 25 17:44:09 2002  Owen Taylor  <otaylor@redhat.com>

	Fixes from #98358, Havoc Pennington.

	* bdk/{x11,win32,linux-fb}/bdkcolor-*.c (bdk_colormap_finalize): 
	Free the private structure.

	* bdk/x11,win32,linxu-fb}/bdkscreen-*.c (bdk_screen_set_default_colormap):
	  bdk/x11/bdkwindow-x11.c (_bdk_windowing_window_init): 
	Keep a ref to the default colormap.

	* bdk/x11/bdkscreen-x11.c (bdk_screen_x11_dispose): Unref
	the default colormap.

	* bdk/x11/bdkwindow-x11.c (bdk_window_impl_x11_set_colormap):
	Handle the CMAP == NULL case even when the window is
	destroyed.

	* bdk/x11/bdkwindow-x11.c (_bdk_windowing_window_init):
	Add a missing ref for the system colormap. 

Mon Nov 25 17:10:54 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btksettings.c (btk_settings_set_property_value): 
	Fix missing adjustments for new type of
	btk_settings_set_property_value_internal(). (#99436,
	Iain Holmes.)

	* btk/btksettings.c (apply_queued_setting): Set the
	source _after_ we call g_object_set_property, or otherwise
	we get the APPLICATION source from our setter 
	implemenatation.

2002-11-25  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkevents-win32.c (print_event_state,
	print_window_state, print_event): Enclose in #ifdef
	G_ENABLE_DEBUG, as they use functions only available with
	G_ENABLE_DEBUG, and are called only when G_ENABLE_DEBUG. (#99494,
	Arnaud Charlet)

Mon Nov 25 16:58:27 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkwindow-x11.c: Use _NET_WM_WINDOW_TYPE_SPLASH,
	not TYPE_SPLASHSCREEN. (#99482, Gregory Merchan)

2002-11-25  Matthias Clasen  <maclas@gmx.de>

 	* docs/tutorial/btk-tut.sgml: Fix the ftp download url.
	
Mon Nov 25 19:10:54 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* btk/btkprogressbar.c: Style improvements that I forgot about
	in last commit.	

Mon Nov 25 18:56:55 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* btk/btkprogressbar.c (btk_progress_bar_paint): Break this
	function into simpler functions:
	btk_progress_bar_paint_text(), btk_progress_bar_paint_discrete(),
	btk_progress_bar_paint_continous(),
	btk_progress_bar_paint_activity().

Mon Nov 25 12:34:44 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkdialog.c (btk_dialog_set_default_response): 
	Remove code to grab the focus here, it is no longer
	needed since we focus a widget on map, and can cause
	harm. (#99048, Daniel Elstner)

2002-11-24  Tor Lillqvist  <tml@iki.fi>

	Merge from stable:
	
	Implement tiles and stipples for all drawing methids (except the
	deprecated draw_text() and draw_text_wc()).

	* bdk/win32/bdkdrawable-win32.c: Remove the already ifdeffed-out
	code that didn't use generic_draw().

	(generic_draw): When drawing into the mask (for tiled/stippled
	fill styles), copy the line attributes from the actual GC. Also
	ask for text drawing setup if needed. Use differently set up HDCs
	in the normal and tiled/stippled cases.

	(draw_lines, bdk_win32_draw_lines, draw_polygon,
	bdk_win32_draw_polygon, draw_segments, bdk_win32_draw_segments,
	draw_arc, bdk_win32_draw_arc): Use generic_draw(), thus
	implementing tiled and stippled fill styles for lines, polygons,
	segments, and args.

	(bdk_win32_draw_points): Use Rectangle() instead of
	SetPixel(). Rectangle() uses the function (raster op) set for the
	HDC, SetPixel() doesn't.

	(widen_bounds): New function, refactoring.
	
	* bdk/win32/bdkgc-win32.c: Remove ifdeffed-out code.

	(predraw_set_foreground, bdk_win32_hdc_get): Some code moved
	around. Call SetROP2() only if necessary. Call SetTextColor() only
	if BDK_GC_FOREGROUND flag present. Don't handle
	BDK_OPAQUE_STIPPLED here, has been superseded by the code in
	generic_draw(). Always create a solid brush.

	Remove background color handling from here. The background color
	of a BdkGC is supposed to affect only BDK_OPAQUE_STIPPLED fill
	style, which it is already handled in generic_draw(), and
	BDK_LINE_DOUBLE_DASH lines, which aren't implemented properly
	anyway. Calling SetBkColor() is unnecessary as we always use
	TRANSPARENT text output.

	(bdk_win32_hdc_get, bdk_win32_hdc_release): Add doc comments, as
	these are public functions.

	* bdk/win32/bdkevents-win32.c (synthesize_expose_events): Don't
	synthesize expose events for BDK_INPUT_ONLY windows.
	(bdk_event_translate): On WM_SIZE, call
	bdk_synthesize_window_state() if window was iconified, restored or
	maximized. (#98983, Arnaud Charlet)

	* btk+/bdk/win32/bdkwindow-win32.c
	(bdk_window_get_frame_extents): Fix typo in setting y.  (#98983,
	Arnaud Charlet)

2002-11-23  Matthias Clasen  <maclas@gmx.de>

	* bdk/x11/bdkcursor-x11.c (bdk_cursor_new_from_pixmap): 
	Remove period from title of example in docs.

2002-11-21 15:43:54 2002 Dan Mills  <thunder@ximian.com>

	* configure.in: replace btk-doc version check with an all-sh
	version that works better,
	also up the required btk-doc version to 0.10 (#99216).

2002-11-21  Matthias Clasen  <maclas@gmx.de>

	* configure.in: Generate docs/reference/*/version.xml.

	* btk/btkwidget.c (btk_widget_get_ancestor): Add a note about
	reflexive ancestry.  (#99085, Frederic Lespez)

	* docs/tutorial/btk-tut.sgml: 
	* examples/calendar/calendar.c: Numerous fixes to the calendar 
	example.  (#97956, Owen Taylor)

	* btk/btktreeview.c (btk_tree_view_set_cursor): Fix doc 
	comment typos.  (#97432, Vitaly Tishkov)

	* btk/btktreemodel.c (btk_tree_model_iter_nth_child): Fix doc 
	comment typos.  (#98158, Vitaly Tishkov)

	* btk/btkmenu.c (btk_menu_set_screen): Fix doc comment
	typos.  (#98480, Vitaly Tishkov)

Wed Nov 20 23:13:19 2002  Kristian Rietveld  <kris@btk.org>

	* docs/RELEASE-HOWTO: small tweaks.

Wed Nov 20 19:29:50 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btkrbtree.c (btk_rbtree_reorder_sort_func): return a value
	in the range of [-1, 1] instead [0, 1],
	(btk_rbtree_reorder_invert_func): ditto,
	This makes treeview reordering working on platforms as FreeBSD and
	solaris, thanks go to Heiner Eichmann for finding this out and
	sending in a patch (#98251).

Wed Nov 20 19:27:07 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreestore.c (node_free): only free the data list if
	node->data is not NULL,
	(btk_tree_store_remove): free the data list from the node if
	needed. (#94728, pointed out by Peter Bloomfield).

Wed Nov 20 19:23:13 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreeview.c (btk_tree_view_remove_column): stop editing
	and set the edited_column to NULL if edited_column is set.
	(#91288, modified patch from Josh Parsons).

Wed Nov 20 19:20:34 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreeview.c (btk_tree_view_size_allocate): do a full
	redraw if vadjustment->value is bigger than tree_view->priv->height,
	(btk_tree_view_row_deleted): free the row ref if it isn't valid
	anymore. (#83726, reported by Robert Kinsella).

Tue Nov 19 17:05:51 2002 Manish Singh  <yosh@gimp.org>

	* btk/Makefile.am: add -DBTK_DISABLE_DEPRECATED. #undef it at the
	top of btktypebuiltins.c.

	* btk/btkclist.c
	* btk/btkcombo.c
	* btk/btkctree.c
	* btk/btklist.c
	* btk/btklistitem.c
	* btk/btkoldeditable.c
	* btk/btkpixmap.c
	* btk/btkpreview.c
	* btk/btksignal.c
	* btk/btktext.c
	* btk/btktipsquery.c
	* btk/btktree.c
	* btk/btktreeitem.c
	* btk/btktypeutils.c: #undef BTK_DISABLE_DEPRECATED, deprecated widgets
	and compat code.

	* btk/btkcolorsel.c: move btk_color_selection_set_color implementation
	to set_color_internal, and use that. The deprecated function now
	merely wraps it.

	* btk/btkfontsel.c: same as above, except with
	btk_font_selection_get_font.

	* btk/btknotebook.c: same as above, except with
	btk_notebook_set_homogeneous, and btk_notebook_set_tab_{border,
	hborder,vborder}.

	* btk/btkprogressbar.c: same as above, except with
	btk_progress_bar_set_{bar_stype,discrete_blocks,activity_step,
	activity_blocks}.

	* btk/btkstyle.c: same as above, except with btk_style_get_font.

	* btk/btkwidget.c: same as above, except with btk_widget_set_usize.

	* btk/btkitemfactory.h: declare compatibility functions for deprecated
	BtkMenuFactory stuff if BTK_COMPILATION, since they are used
	internally by the compat code.

	* btk/btkitemfactory.c (btk_item_factory_create_item): remove
	use of deprecated btk_check_menu_item_set_show_toggle (it is a noop
	now).

	* btk/btkmain.c: replaced deprecated BTK_TYPE_* with G_TYPE_*.

	* btk/btkobject.c: replaced various deprecated functions. In set and
	get_property, use g_object_{set,get}_data with "user_data" instead
	of btk_object_{set,get}_user_data.

	* btk/btkprogress.h: API declared if BTK_COMPILATION

	* btk/btkprogress.c: port get_type to GObject API.

	* btk/btktypeutils.h: declare BtkArg stuff and btk_type_init,
	if BTK_COMPILATION.

	* btk/btkwidget.c: define btk_widget_queue_clear in terms of
	btk_widget_queue_draw instead of the other way around.

	* tests/Makefile.am: define -DBTK_DISABLE_DEPRECATED

	* tests/testbtk.c
	* tests/testselection.c
	* tests/testsocket.c: #undef BTK_DISABLE_DEPRECATED, makes use of
	deprecated stuff.

Tue Nov 19 17:01:40 2002  Manish Singh  <yosh@gimp.org>

	* btk/btktreeselection.c (btk_tree_selection_real_modify_range):
	initialize anchor_path to NULL.

	* examples/buttonbox/buttonbox.c: remove useless static qualifier.

2002-11-19  Matthias Clasen  <maclas@gmx.de>

	* tests/testbtk.c (do_bench): 
	(do_real_bench): 
	(bench_iteration): Add a dummy widget and pass it as first
	argument to the various create functions when in --bench mode, 
	since these call btk_widget_get_screen () on their first argument.

Mon Nov 18 17:15:07 2002  Manish Singh  <yosh@gimp.org>

	* btk/btkwindow-decorate.c (btk_decorated_window_paint): use
	bdk_drawable_get_size instead of bdk_window_get_size. Fixes
	#98957.

Tue Nov 19 00:45:34 2002  Kristian Rietveld  <kris@btk.org>

	* docs/RELEASE-HOWTO: new file describing the release process.

	* docs/Makefile.am: added RELEASE-HOWTO to EXTRA_DIST.
	
Mon Nov 18 18:15:56 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btksettings.c (btk_settings_get_property): Clean up
	a bit of duplicated code.

Mon Nov 18 20:42:27 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreeview.c (btk_tree_view_expand_to_path): modify and
	free tmp instead of path ... (patch from #97927).

Mon Nov 18 20:31:20 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btkcellrenderertext.c (btk_cell_renderer_text_start_editing):
	only _set_text if celltext->text is not NULL. (#97815, reported
	and testcase provided by Vitaly Tishkov).

Mon Nov 18 20:28:28 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreeselection.c (btk_tree_selection_real_modify_range):
	also update the anchor_path, makes behaviour consistent with the
	other selection modification functions. (#96801, reported and
	testcase provided by Vitaly Tishkov).

Mon Nov 18 20:17:56 2002  Kristian Rietveld  <kris@btk.org>

	Hrm, this fixes up lots of mistakes in my swap/move code ... Some
	of these mistakes where pointed out by Vitaly Tishkov in bugs
	#97403, #97404, #97412, #97618.

	* btktreestore.[ch]: btk_tree_store_move is now private, use
	btk_tree_store_move_{before,after} instead now. Lots of fixes
	(more like a rewrite :) in the _move and _swap functions.

	* btkliststore.[ch]: likewise.
	
2002-11-18  Abibail Brady  <morwen@evilmagic.org>

	* btk/btkimmodule.c: (_btk_im_module_list): Sort the list of Input 
	Modules	by name, keeping Default at top.

Sun Nov 17 13:45:08 2002  Manish Singh  <yosh@gimp.org>

	* bdk/Makefile.am: add -DBDK_DISABLE_DEPRECATED

	* bdk/bdk.c (bdk_exit): remove obsolete comment

	* bdk/bdk.h: declare bdk_input_add_full if BTK_COMPILATION for
	btk_input_add_full

	* bdk/bdkcolor.c (bdk_color_white, bdk_color_black): use
	bdk_colormap_alloc_color instead of bdk_color_alloc

	* bdk/bdkcolor.h: declare bdk_colormap_change if BDK_COMPILATION for
	bdk_colors_store. Also, bdk_colors_{alloc,free} for
	bdk_rgb_try_colormap

	* bdk/bdkdrawable.h: declare bdk_draw_string if BTK_COMPILATION for
	btk_default_draw_string. Also, bdk_draw_text and bdk_draw_text_wc
	if BDK_COMPILATION for the respective bdk_window_ and bdk_pixmap_
	functions.

	* bdk/bdkfont.c: #undef BDK_DISABLE_DEPRECATED, completely compat
	code here

	* bdk/bdkfont.h: allow the BdkFont structure and a few bdk_font_
	functions for compat code in BDK_COMPILATION and BTK_COMPILATION.

	* bdk/bdkrgb.c (bdk_rgb_cmap_fail, bdk_rgb_try_colormap): use
	bdk_colormap_free_colors instead of bdk_colors_free.

	* bdk/bdkrgb.c (bdk_draw_rgb_image_core): no need to set fg/bg
	for own_gc, unused.

	* bdk/bdkwindow.h: declare bdk_window_get_deskrelative_origin if
	BTK_COMPILATION for btk_handle_box_button_changed.

	* bdk/x11/Makefile.am: add -DBDK_DISABLE_DEPRECATED, renmae
	-DINSIDE_BDK_X11 to -DBDK_COMPILATION

	* bdk/x11/bdkcolor-x11.c: remove duplicate doc string for
	bdk_colormap_alloc_colors.

	* bdk/x11/bdkfont-x11.c:  #undef BDK_DISABLE_DEPRECATED, completely
	compat code here

	* bdk/x11/bdkx.h: use BDK_COMPILATION instead of INSIDE_BDK_X11,
	allow a few bdk_x11_font_ functions if BDK_COMPILATION for compat
	code

	* btk/Makefile.am: add -DBDK_DISABLE_DEPRECATED

	* btk/btkclist.c
	* btk/btkctree.c
	* btk/btkpixmap.c
	* btk/btkpreview.c
	* btk/btktext.c: #undef BDK_DISABLE_DEPRECATED, deprecated widget

	* btk/btkhandlebox.c (btk_handle_box_motion): use
	bdk_window_set_geometry_hints instead of bdk_window_set_hints.

	* btk/btkmain.c (btk_exit): call exit directly

	* btktipsquery.c (btk_tips_query_real_start_query)
	* btk/btktreeitem.c (btk_tree_item_add_pixmaps): remove some
	deprecated BDK usage.

Sun Nov 17 10:49:28 2002  Jonathan Blandford  <jrb@gnome.org>

	* btk/btksettings.c (btk_settings_get_property): remove bogus
	gvalue initialization/freeing.

2002-11-16  Tor Lillqvist  <tml@iki.fi>

	* bdk/bdk.def: Add missing entries, needed by btk.

	* bdk/win32/bdkcolor-win32.c (bdk_screen_get_system_colormap):
	Remove g_return_val_if_fail call. This function is called from
	bdk_display_open() with the _bdk_screen it just created, but when
	bdk_screen_get_default() still returns NULL.

	* bdk/win32/bdkdisplay-win32.c
	* bdk/win32/bdkscreen-win32.c: Make more like the linux-fb
	versions. For instance, don't call
	bdk_display_manager_set_default_display() from bdk_display_open().

	* bdk/win32/bdkglobals-win32.c: Move _bdk_display, _bdk_screen and
	_bdk_parent_root here.

	* bdk/win32/bdkinput.c (bdk_display_list_devices): New function.

	* bdk/win32/bdkmain-win32.c (bdk_get_display): New function.

	* bdk/win32/bdkvisual-win32.c (bdk_screen_get_system_visual):
	Don't require that the screen parameter is non-NULL. It can be,
	and the linux-fb version doesn't check either.
	
	* bdk/win32/bdkwindow-win32.c (bdk_window_set_skip_taskbar_hint,
	bdk_window_set_skip_pager_hint, bdk_window_fullscreen,
	bdk_window_unfullscreen): Implement as no-ops.

	* btk/btk.def: Remove obsolete entries.

Fri Nov 15 19:12:56 2002  Jonathan Blandford  <jrb@gnome.org>

	* btk/btksettings.c: Allow g_object_set to work with BtkSettings.

2002-11-15  Tor Lillqvist  <tml@iki.fi>

	* bdk/bdk.def: Reflect recent renamings and removals of functions. 
	
	Merge from stable:
	
	Start implementing all fill styles (i.e. tiled, stippled, and
	opaque stippled in addition to the plain solid style) in the Win32
	backend in an elegant and generic way. For now only did the
	draw_rectangle() and draw_glyphs() methods. The rest will
	follow. Previously some of the drawing methods implemented opaque
	stippling, but not tiles or non-opaque stippling.

	Seems to work fine, now the check marks show up in check buttons,
	the stippled background and stippled text in btk-demo's Text
	Widget look as they should, and BtkText's line wrap arrow shows
	correctly instead of an ugly rectangle.

	The implementation does do a lot of pixmap handling and blitting
	back and forth, especially on Win9x. But performance is hopefully
	not an issue. I don't think many applications do a lot of tiled or
	stippled drawing.

	* bdk/win32/bdkprivate-win32.h: Define a new macro, GDI_CALL, that
	calls a GDI function and prints a warning if it failed. Also
	API_CALL for non-GDI calls. Cleans all the the if (!BlaBla())
	WIN32_GDI_FAILED ("BlaBla") snippets, these can now be written
	GDI_CALL (BlaBla, ()). Declare new functions.

	* bdk/win32/bdkdrawable-win32.c: Use GDI_CALL macro in lots of places.

	(generic_draw): New function that handles all the blitting
	necessary to implement tiles and stipples. A function that
	actually draws stuff is passed as a parameter to
	generic_draw(). If the fill style is solid, it is called
	directly, to draw on the destination drawable. Otherwise it is
	called to draw on a temporary mask bitmap, which then is used in
	blitting operations. The tiles and/or stipples are rendered into
	another temporary pixmap. If MaskBlt() is available (on NT/2k/XP),
	it is used, otherwise a sequence of BitBlt() is used to do the
	final composition onto the destination drawable.

	(draw_tiles_lowlevel, draw_tiles): Some renaming and code
	reorg. Use BitBlt() to blit each tile, not bdk_draw_drawable().

	(rop2_to_rop3): New function, does binary->ternary rop mapping.

	(blit_from_pixmap, blit_inside_window, blit_from_window): Use
	rop2_to_rop3(). Previously used SRCCOPY always...

	(draw_rectangle, bdk_win32_draw_rectangle, draw_glyphs,
	bdk_win32_draw_glyphs): Split functionality into two functions,
	with generic_draw() doing its magic inbetween.

	* bdk/win32/bdkevents-win32.c: Remove the TrackMouseEvent code, it
	was ifdeffed out and wouldn't have done anything even if
	enabled. Remove the BDK_EVENT_FUNC_FROM_WINDOW_PROC code, didn't
	have any effect any more anyway after all the changes BTK+ has
	gone through in the last years. Remove some #if 0 code.

	* bdk/win32/bdkgc-win32.c (bdk_gc_copy): Set the copy's hdc field
	to NULL in case a GC is copied while it has a Windows DC active.

	* bdk/win32/bdkprivate-win32.h
	* bdk/win32/bdkglobals-win32.c: Remove bdk_event_func_from_window_proc.
	
	* bdk/win32/bdkmain-win32.c: Remove -event-func-from-window-proc
	option. If there is a PRETEND_WIN9X envvar, set windows_version as
	if on Win9x.

	* bdk/win32/bdkpixmap-win32.c (_bdk_win32_pixmap_new,
	bdk_pixmap_new): Combine these two, _bdk_win32_pixmap_new() wasn't
	used or exported. Make a bit more like the X11 version. Hopefully
	I didn't break the fragile palettized display ("pseudocolor")
	code.

	* bdk/win32/bdkgc-win32.c: Various debugging output improvements.
	
	(predraw_set_foreground): Check whether
	tile/stipple origins are valid when calling SetBrushOrgEx().

	(bdk_win32_hdc_get): Ifdef out code that tries to handle the
	stipple by converting it into a rebunnyion, and combining the clip
	rebunnyion with that. A stipple shouldn't work like that, it should
	replicate in x and y directions. Stipples are now handled by
	generic_draw() in bdkdrawable-win32.c.

	* bdk/win32/bdkmain-win32.c: (bdk_win32_gcvalues_mask_to_string,
	bdk_win32_rop2_to_string): New debugging functions.

	(bdk_win32_print_dc): Print also DC's rop2 and text color.

Thu Nov 14 14:58:21 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkwindow-x11.c (bdk_window_set_icon_name): 
	Fix display/window typo. (#98511, Soeren Sandmann)

Fri Nov  8 18:04:16 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/{linux-fb,win32,11}/Makefile.am: Try a different
	hack to force bdkenumtypes.h to be updated before
	building the subdir, last hack caused contents
	to be rebuilt on every make.

Wed Nov 13 21:45:36 2002  Manish Singh  <yosh@gimp.org>

	* btk/btkhsv.c: get rid of deprecated bdk_rgb_gc_set_foreground
	usage in favor of bdk_gc_set_rgb_fg_color.

Thu Nov 14 00:33:26 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmenu.c (attach_widget_screen_changed): Monitor
	the screen of the attach widget continually, rather than only 
	setting the screen only on popup (#85710)

	* btk/btkmenu.c (btk_menu_set_screen): Allow %NULL to
	go back to getting the screen from the attach widget.

Wed Nov 13 17:03:19 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkcombo.c: Change so that updates of selection
	don't take effect immediately, but only when popdown
	is closed with a button release within the combo
	or Return/Enter.

	* btk/btkcombo.c: Support Alt-Down to pop down the 
	combo, Alt-Up to pop it back up, Space to immediately 
	select current item.
	
	* btk/btkcombo.c (btk_combo_entry_key_press): Don't
	move the focus when we get to the ends of the list
	entries.

	* btk/btkcombo.c: Fix handling of state in ad-hoc 
	keybinding handling to be a bit more reasonable.

	* btk/btkcombo.c (btk_combo_popup_list): Clear 
	last_focus_child when no item is selected so we 
	don't start focusing from some random place.

	* btk/btkcombo.c (btk_combo_init): Make
	btk_combo_set_use_arrows_always, enable_arrows_always 
	properties have no effect, they were an awful idea.
	Always behave as if enable_arrows_always is true.

	* btk/btknotebook.c: Fix a warning.

Wed Nov 13 13:50:25 2002  Eric Warmenhoven <warmenhoven@yahoo.com>

	* bdk/linux-fb/bdkinput.c: add bdk_display_get_devices to fix
	compilation

Wed Nov 13 15:52:53 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkcombo.c (btk_combo_activate): Fix warning.
	
	* btk/btkcombo.c: Fix code that was meant to delay
	grabbing events on the list until we had an enter-notify.
	(#54353, reported by Mike Fulbright, others)

2002-11-13  Matthias Clasen  <maclas@gmx.de>

	* btk/theme-bits/decompose-bits.c (do_part): Add a const here.

	* btk/btkcolorsel.c: 
	* btk/btkimcontextsimple.c: 
	* btk/btkstyle.c: Mark constant data as const to give the compiler
	a chance to put it in a readonly section.  (#75754)

Wed Nov 13 10:53:37 2002  HideToshi Tajima  <hidetoshi.tajima@sun.com>

	* modules/input/btkimcontextxim.c:
	Fix #90661: add im_info->im switch at the top of setup_im() and
	get_ic_real().
	Fix #97674: make sure only one status window for the focused
	input context should be shown.

Wed Nov 13 11:55:25 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btknotebook.c (btk_notebook_button_press): 
	When clicking on a non-active tab, focus the first
	widget in the tab, not the tab itself. (#98322)

	* btk/btknotebook.c (btk_notebook_focus_changed):
	Eliminate synchronous drawing, just call redraw_tabs.
	
	* btk/btknotebook.c (btk_notebook_init): Don't set
	the RECEIVES_DEFAULT flag, we no longer do anything
	with Return/Enter key.

Tue Nov 12 17:10:10 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkcombo.c: Fix up grabs to be robust; grab
	the keyboard as well as the pointer so we won't
	leave the window behind if the user switches desktops
	with a keyboard combination. (Based on a patch
	from Matthias Clasen, #82525)

Wed Nov 13 14:01:44 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* btk/btkstyle.c: 

          - comment out check_inconsistent_aa_bits[].

          - use fg/bg with a generated aa color to draw check and option
	    marks in menu items.

	  - use text/base to draw check and option buttons, except when
	    state is ACTIVE, in which case we use fg/bg with a generated
	    aa color.

	* tests/testbtk.c (menu_items): Add three check items.
	
2002-11-12  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkprivate-win32.h
	* bdk/win32/*.c: Rename all global variables and functions to
	start with underscore.

	Merge from stable:
	
	More work on the Win32 backend. The cause of some scrolling
	problems was that SetWindowPos() and ScrollWindowEx() don't blit
	those parts of the window they think are invalid. As we didn't
	keep Windows's update rebunnyion in synch with BDK's, Windows thought
	those areas that in fact had been updated were invalid. Calling
	ValidateRgn() in _bdk_windowing_window_queue_antiexpose() seems to
	be an elegant and efficient solution, removing from Windows's
	update rebunnyion those areas we are about to repaint proactively.

	In some cases garbage leftover values were used for the clip
	origin in BdkGCWin32. This showed up as odd blank areas around the
	pixmaps included in the Text Widget in btk-demo.

	Having the clip rebunnyion either as a BdkRebunnyion or a HRGN in
	BdkGCWin32 was unnecessary, it's better to just use a HRGN.

	The translation and antiexpose queue handling in
	bdkgeometry-win32.c seems unnecessary (and not implementable in
	the same way as on X11 anyway, no serial numbers) on Windows,
	ifdeffed out.
	
	Don't (try to) do guffaw scrolling as there is no static window
	gravity on Windows. Guffaw scrolling would be unnecessary anyway,
	as there is the ScrollWindow() API. This improves the behaviour of
	the Text Widget demo in btk-demo a lot. But I have no idea how the
	lack of static win gravity should be handled in other places where
	the X11 code uses it. Especially _bdk_window_move_resize_child().

	There is still some problem in expose handling. By moving an
	obscuring window back and forth over testbtk's main window, for
	instance, every now and then you typically get narrow vertical or
	horizontal strips of pixels that haven't been properly redrawn
	after being exposed. A fencepost error somewhere?

	Otherwise, all of testbtk and btk-demo except "big windows" now
	seem to work pretty well. (Well, that is in the stable branch, I
	haven't really tested HEAD. Only checked that bdk/win32 compiles.)

	Bug #79720 should be fixed now.
	
	* bdk/win32/bdkcolor-win32.c (bdk_win32_color_to_string,
	bdk_win32_print_paletteentries, bdk_win32_print_system_palette,
	bdk_win32_print_hpalette)
	* bdk/win32/bdkdrawable-win32.c (bdk_win32_drawable_description)
	* bdk/win32/bdkevents-win32.c (bdk_win32_message_name):
	Move all debugging helper functions to bdkmain-win32.c.

	* bdk/win32/bdkdrawable-win32.c (_bdk_win32_draw_tiles):
	Rewrite. Make static. Must take tile origin parameters, too.

	(bdk_win32_draw_rectangle): Pass the tile/stipple origin to
	_bdk_win32_draw_tiles(). Remove #if 0 code.

	(blit_inside_window): Don't call ScrollDC(), that didn't work at
	all like I thought. A simple call to BitBlt() is enough.
	
	* bdk/win32/bdkevents-win32.c (bdk_event_translate) Remove unused
	latin_locale_loaded variable.

	(_bdk_win32_get_next_tick): New function. Used to make sure
	timestamps of events are always increasing, both in events
	generated from the window procedure and in events gotten via
	PeekMessage(). Not sure whether this is actually useful, but it
	seemed as a good idea.

	(real_window_procedure): Don't use a local BdkEventPrivate
	variable. Don't attempt any compression of configure or expose
	events here, handled elsewhere.

	(erase_background): Accumulate window offsets when traversing up
	the parent chain for BDK_PARENT_RELATIVE_BG, in order to get
	correct alignment of background pixmaps. Don't fill with
	BLACK_BRUSH if BDK_NO_BG.

	(bdk_event_get_graphics_expose): A bit more verbose debugging output.

	(bdk_event_translate): Use _bdk_win32_get_next_tick(). In the
	WM_PAINT handler, don't check for empty update rect. When we get a
	WM_PAINT, the update rebunnyion isn't empty. And if it for some
	strange reason is, that will be handled later anyway. Call
	GetUpdateRgn() before calling BeginPaint() and EndPaint() (which
	empty the update rebunnyion).

	* bdk/win32/bdkdnd-win32.c
	* bdk/win32/bdkinput-win32.c:
	Use _bdk_win32_get_next_tick().
	
	* bdk/win32/bdkfont-win32.c: Use %p to print HFONTs.

	(bdk_text_size): Remove, unused.

	* bdk/win32/bdkgc-win32.c:  Set clip origins to zero
	when appropriate.

	(bdk_gc_copy): Increase refcount on colormap if present.

	(bdk_win32_hdc_get): Handle just hcliprgn. If we have a stipple,
	combine it with clip rebunnyion after selecting into the DC.

	(_bdk_win32_bitmap_to_hrgn): Rename from _bdk_win32_bitmap_to_rebunnyion.

	(_bdk_win3_bdkrebunnyion_to_hrgn): New function, code snippet
	extracted from bdk_win32_hdc_get().

	* bdk/win32/bdkgeometry-win32.c: Ifdef out the translate_queue
	handling.

	(bdk_window_copy_area_scroll): Increase clipRect to avoid
	ScrollWindowEx() not scrolling pixels it thinks are invalid.
	Scroll also children with the ScrollWindowEx() call. No need to
	call bdk_window_move() on the children.

	(bdk_window_scroll): Don't do guffaw scrolling.

	(bdk_window_compute_position): Fix typo, used win32_y where x was
	intended.

	(bdk_window_premove, bdk_window_postmove,
	bdk_window_clip_changed): Add debugging output.

	(_bdk_windowing_window_queue_antiexpose): Just call ValidateRgn()
	on the rebunnyion.

	(_bdk_window_process_expose): No use for the serial number
	parameter now. Instead of a rectangle, take a rebunnyion parameter, as
	Windows gives us one in WM_PAINT.

	* bdk/win32/bdkmain-win32.c (_bdk_win32_lbstyle_to_string,
	_bdk_win32_pstype_to_string, _bdk_win32_psstyle_to_string,
	_bdk_win32_psendcap_to_string, _bdk_win32_psjoin_to_string,
	_bdk_win32_rect_to_string, _bdk_win32_bdkrectangle_to_string,
	_bdk_win32_bdkrebunnyion_to_string): New debugging functions.

	(static_printf): Helper function for the above. sprintfs into a
	static circular buffer, return value should be used "soon".

	* bdk/win32/bdkwindow-win32.c (bdk_propagate_shapes): Plug memory
	leak, free list after use.

	(bdk_window_gravity_works): Remove, we know that there is no such
	thing on Windows.

	(bdk_window_set_static_bit_gravity,
	bdk_window_set_static_win_gravity): Ditto, remove, they didn't do
	anything anyway.

	(_bdk_windowing_window_init, bdk_window_foreign_new): Call
	_bdk_window_init_position() like in the X11 backend.

	(bdk_window_reparent): Don't call the now nonexistent
	bdk_window_set_static_win_gravity(). No idea what should be done
	instead.

	(bdk_window_get_geometry): The returned x and y should be relative
	to parent. Used to be always zero..

	(bdk_window_set_static_gravities): Return FALSE if trying to set
	static gravity.
	
	* bdk/win32/bdkprivate-win32.h: Drop the clip_rebunnyion field from
	BdkGCWin32. Only use the HRGN hcliprgn. Declare new
	functions.

	* bdk/win32/*.c: Use new debugging functions.

	* bdk/win32/rc/bdk.rc.in: Update copyright year.

Tue Nov 12 16:51:04 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkinputdialog.c: Make multihead aware (#80283)

Tue Nov 12 15:13:58 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.c btk/btkwindow.[ch]: Add
	_btk_window_unset_focus_and_default(), use to clear
	the focus and default out of parts of the widget
	heirarchy that we are hiding.

	* btk/btkwidget.c (btk_widget_propagate_screen_changed_recurse): 
	Fix typo that was resulting in missed screen-change
	notifies.

	* btk/btkwindow.c (do_focus_change): Allow for
	widget->window == NULL.

	* btk/btklabel.c (btk_label_screen_changed): Clear the
	layout here not in hierarchy changed to handle the case
	where the toplevel was moved between screens.

Tue Nov 12 14:20:53 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* btk/btkmenu.c (btk_menu_enter_notify): Do not return when
	menu_shell->ignore_enter is TRUE.

2002-11-10  Matthias Clasen  <maclas@gmx.de>

	* btk/btkstatusbar.c (btk_statusbar_button_press): Don't start
	a drag on double click.  (#98189)

2002-11-10  Matthias Clasen  <maclas@gmx.de>

	* tests/testbtk.c (grippy_button_press): Also test moving.

Sun Nov 10 22:55:39 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* btk/btkmenu.c (btk_menu_enter_notify): Don't return after
	calling btk_menu_handle_scrolling() when
	!menu_shell->ignore_enter.

Sun Nov 10 21:29:03 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* btk/btkcheckbutton.c (btk_real_check_button_draw_indicator): 
	* btk/btkradiobutton.c (btk_radio_button_draw_indicator)

	Make sure check and option marks are drawn insensitive when the
	widgets are insensitive.

	(#92548, patch from Tim Evans)

Sun Nov 10 21:25:04 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* btk/btkwidget.h (struct _BtkWidgetClass): Remove _btk_reserved8
	to restore binary compatibility.

2002-11-10  Matthias Clasen  <maclas@gmx.de>

	* bdk/x11/bdkwindow-x11.c (_bdk_moveresize_handle_event): Fix a
	typo which broke moveresize emulation.

Sat Nov  9 14:42:53 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmenu.c (btk_menu_button_*): Block
	button presses/releases over the scroll arrows
	to avoid popping down the menu. (#73444, Ettore Perazzoli)

	* btk/btkmenu.c (btk_menu_enter_notify): Obey the
	ignore_enter flag for scrolling as well.

	* btk/btkmenu.c (btk_menu_stop_scrolling): Clear
	the upper_arrow_prelight, lower_arrow_prelight 
	flags.

	* btk/btkmenu.c: Tweak the scroll speeds,
	timeouts, and fast-scroll area to make things
	zippier. (#73445, Ettore Perazzoli)

2002-11-09  Anders Carlsson  <andersca@gnu.org>

	* btk/btkwidget.c (btk_widget_class_init): Use the correct
	struct offset for the screen_changed signal.

Fri Nov  8 19:07:39 2002  Owen Taylor  <otaylor@redhat.com>

	* demos/Makefile.am (test-inline-pixbufs.h): Depend
	on bdk-pixbuf.loaders as well as bdk-pixbuf.csource.
	(#97096, Jeff Waugh)

2002-11-09  Matthias Clasen  <maclas@gmx.de>

	* tests/testbtk.c (create_resize_grips): Draw grips in all edges.

	* bdk/x11/bdkfont-x11.c (bdk_text_extents_wc): 
	(bdk_text_extents): 
	* bdk/bdkfont.c (bdk_string_extents): Reformulate doc comments to
	work around btk-doc limitations.

Fri Nov  8 18:04:16 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/{linux-fb,win32,11}/Makefile.am: Add in a awful
	hack to force bdkenumtypes.h to be updated before
	building the subdir. (#86587)

Fri Nov  8 17:49:54 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwindow.c (btk_window_check_screen): Access
	window->screen through a function so we can provide
	an informative warning window window->screen is NULL.
	(#85703)
	
2002-11-08  Matthias Clasen  <maclas@gmx.de>

	* btk/btkcheckmenuitem.c
	(btk_real_check_menu_item_draw_indicator): RTL flipping for check
	menu items.

	* tests/testtext.c (blink_timeout): Put into #ifdef DO_BLINK to
	avoid an unused static function.  (#97965)

	* btk/btktextiter.c (backward_line_leaving_caches_unmodified): 
	* btk/btkstyle.c (radio_aa_bits):
	(draw_spin_entry_shadow): #if-0-out unused static functions and
	variables.  (#97965) 

	* btk/btktextview.c (text_window_get_allocation): 
	* btk/btkcolorsel.c (btk_color_selection_get_palette_size):
	(btk_color_selection_get_palette_color):
	(btk_color_selection_unset_palette_color): Remove unused static
	functions.  (#97965)

	* btk/btkcolorsel.c
	(btk_color_selection_set_change_palette_with_screen_hook): Fix doc
	comment. 
	
Fri Nov  8 17:08:54 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkwindow-x11.c (bdk_window_new): Use
	g_get_application_name() instead of g_get_prgname()
	as the default window title when set.
	
	* bdk/x11/bdkwindow-x11.c bdk/x11/bdkdisplay-x11.[ch]:x
	Set g_get_application_name() as the title for the
	leader window the first time we create a window
	pointing to it.

	* tests/testbtk.c (main): Call g_set_application_name();

	* configure.in (BDK_PIXBUF_VERSION): Require GLib-2.1.3

2002-11-08  Matthias Clasen  <maclas@gmx.de>

	* btk/btkstyle.c (btk_default_draw_arrow): Improve drawing of RTL
	submenu indicators.

	* btk/btkoptionmenu.c (btk_option_menu_paint): Fix drawing of RTL
	optionmenus by flipping the indicator_spacing.

Fri Nov  8 21:15:25 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* tests/Makefile.am: add testmenus.c, a program to test menus when
	items are dynamically added and removed.

Fri Nov  8 20:14:52 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* docs/reference/bdk/tmpl/dnd.sgml
	docs/reference/bdk/tmpl/drawing.sgml
	docs/reference/bdk/tmpl/bdk-unused.sgml
	docs/reference/bdk/tmpl/bdkdisplay.sgml
	docs/reference/bdk/tmpl/general.sgml
	docs/reference/bdk/tmpl/input_devices.sgml
	docs/reference/bdk/tmpl/selections.sgml
	docs/reference/btk/tmpl/btkcellrenderer.sgml
	docs/reference/btk/tmpl/btkcurve.sgml
	docs/reference/btk/tmpl/btkdnd.sgml
	docs/reference/btk/tmpl/btkitemfactory.sgml
	docs/reference/btk/tmpl/btkmenu.sgml
	docs/reference/btk/tmpl/btkoldeditable.sgml
	docs/reference/btk/tmpl/btkoptionmenu.sgml
	docs/reference/btk/tmpl/btkpreview.sgml
	docs/reference/btk/tmpl/btkselection.sgml
	docs/reference/btk/tmpl/btksocket.sgml
	docs/reference/btk/tmpl/btkstyle.sgml
	docs/reference/btk/tmpl/btktextbuffer.sgml
	docs/reference/btk/tmpl/btktreemodel.sgml
	docs/reference/btk/tmpl/btkwidget.sgml bdk/bdk.h bdk/bdkdisplay.c
	bdk/bdkdisplay.h bdk/bdkdnd.h bdk/bdkdraw.c bdk/bdkdrawable.h
	bdk/bdkinput.h bdk/bdkselection.h bdk/x11/bdkdisplay-x11.c
	bdk/x11/bdkdnd-x11.c bdk/x11/bdkselection-x11.c btk/btkcurve.h
	btk/btkdnd.h btk/btkitemfactory.c btk/btkitemfactory.h
	btk/btkmenu.h btk/btkoldeditable.c btk/btkoldeditable.h
	btk/btkoptionmenu.h btk/btkplug.c btk/btkplug.h btk/btkpreview.h
	btk/btkrange.h btk/btkselection.c btk/btkselection.h
	btk/btksocket.c btk/btksocket.h btk/btkstyle.c btk/btkstyle.h
	btk/btktextlayout.c btk/btktextlayout.h btk/btktreemodel.c
	btk/btktreemodel.h btk/btkwidget.h

	Trivial s/foo/foo_/ fixes to make btk.h includable with -Wshadow
	without warnings. (#91680)
	
Thu Nov  7 16:13:41 2002  Eric Warmenhoven <eric@warmenhoven.org>

	* bdk/linux-fb/bdkscreen-fb.c: fix compilation

	* bdk/linux-fb/bdkmain-fb.c: prevent segfaults on shutdown

Thu Nov  7 18:50:38 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.c (btk_widget_get_bango_context): Note
	that get_bango_context() is not "until death does us
	part", but "until the screen changes".

	* btk/btkwidget.c (btk_widget_create_bango_context): Add
	a MULTIHEAD warning.

	* btk/btkwidget.c (do_screen_change): Clear bango context
	for widget if set.

Thu Nov  7 18:09:42 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkfilesel.c (open_new_dir): Escape invalid
	filename before printing it out, since it isn't
	a valid UTF-8 string. (#94676)

Thu Nov  7 17:18:06 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkdrawable-x11.c (bdk_x11_draw_pixbuf): 
	Don't try to use render if we can't get a picture for 
	the drawable. (Fixes #97220, reported by
	Jamie Zawinski)

	* btk/btkimage.c: Force requisition calculation
	when we get a expose prior to size_request().
	(#91711, reported by Sven Neumann, debugging
	help from Matthias Clasen, Soeren Sandmann)

Thu Nov  7 16:45:54 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkx.h: Fix misplaced display_grab()/display_ungrab();
	they shouldn't have been deprecated.

2002-11-07  Matthias Clasen  <maclas@gmx.de>

	* bdk/bdk.c (bdk_display_open_default_libbtk_only): Use
	g_return_val_if_fail in this non-void function.
	(bdk_init_check): Remove unused variable.

Thu Nov  7 15:42:12 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkfontsel.c (btk_font_selection_get_font_description):
	If called when fontsel->face is NULL, just return
	"Sans 10". (#82745, Vitaly Tishkov)

Thu Nov  7 15:29:43 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkimcontextsimple.c (check_hex): Use '_'
	not '-' in signal name to be consistent with
	what we do elsewhere (#97151, TOKUNAGA Hiroyuki)

Thu Nov  7 14:51:31 2002  Owen Taylor  <otaylor@redhat.com>

	* tests/testcalendar.c (calendar_date_to_string): 
	Use g_date_strftime(), fixing #74745. (Alper Ersoy)

2002-11-07  Anders Carlsson  <andersca@gnu.org>

	* btk/btkhpaned.c: (btk_hpaned_size_allocate):
	* btk/btkvpaned.c: (btk_vpaned_size_allocate):
	Check for NULL children, #97913.
	
Thu Nov  7 14:24:45 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkhandlebox.c: Add a snap_edge_set property to
	deal with the fact that we have an unset state for
	the snap_edge property. (Reported by Matthias Clasen
	#97505)
	
Thu Nov  7 12:53:08 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.[ch] btk/btkwindow.c btk/btkinvisible.c: 
	Add ::screen-changed signal.

	* btk/btkfontsel.c btk/btktoolbar.c: Use ::screen-changed
	signal to simplify logic.

2002-11-07  Anders Carlsson  <andersca@gnu.org>

	* tests/testbtk.c (create_resize_grips): Add resize grips test.

Sun Nov  3 21:26:20 2002  Kristian Rietveld  <kris@btk.org>

	Bah, and of course I broke something ...

	* btk/btktreeselection.c (btk_tree_selection_selected_foreach): fix
	up the mess I caused with my commit of Oct 23 fixing #50263, things
	should be fine now.

Sun Nov  3 13:03:29 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkfilesel.c configure.in: Remove check for
	winsock.h since it might show up on Linux+Wine.
	Instead just conditionalize of G_OS_WIN32.
	(#97396, Gaute Lindkvist)

Sun Nov  3 01:39:20 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreemodel.c (release_row_references): took out the useless
	check for refs->list (#97353, reported by Morten Welinder).

	* btk/btkcellrendererpixbuf.c (btk_cell_renderer_pixbuf_get_size):
	check if width isn't zero instead of calc_width ...

Sat Nov  2 23:48:52 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreemodelsort.c (btk_tree_model_sort_set_model): remove
	the second ref command on the child_model, we only have to ref it
	once here. (#96851, reported by Jorn Baayen).

2002-11-02  Matthias Clasen  <maclas@gmx.de>

	* btk/btkhandlebox.c (effective_handle_position): 
	(btk_handle_box_size_request): 
	(btk_handle_box_size_allocate): 
	(btk_handle_box_draw_ghost): 
	(btk_handle_box_paint): 
	(btk_handle_box_button_changed): 
	(btk_handle_box_motion): 
	Flip handleboxes for RTL locales.  (#96629)

Sat Nov  2 13:47:09 2002  Owen Taylor  <otaylor@redhat.com>
	 
	* === Released 2.1.2 ===

	* NEWS: Update.

Sat Nov  2 00:22:33 2002  Owen Taylor  <otaylor@redhat.com>

	Add startup notification hooks - mostly based on patch
	by Havoc Pennington in #96772.
	
	* bdk/bdk.h bdk/x11/bdkdisplay-x11.c 
	bdk/{win32,linux-fb}/bdkmain-*.c: (bdk_notify_startup_complete):
	new function that indicates an application has finished starting
	up.
	
	* bdk/x11/bdkmain-x11.c bdk/x11/bdkdisplay-x11.c
	(_bdk_windowing_set_default_display): store value of 
	DESKTOP_STARTUP_ID on the default screen, and clear it from the 
	environment.
	
	* bdk/x11/bdkdisplay-x11.c: 
	Set _NET_STARTUP_ID hint on display's group leader window.
	
	* btk/btkwindow.c (btk_window_set_auto_startup_notification):
	function to toggle whether we automatically broadcast that we've
	started up, after mapping the first toplevel window.
	(btk_window_map): call bdk_screen_notify_startup_complete() by
	default, unless enabled by above.

	* btk/btkmain.c btk/btkcombo.c btk/btktoolbar.c: 
	Couple of warning fixes.

Fri Nov  1 21:03:59 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkfilesel.c: Add a mnemonic to the "selection"
	label. (More of #74267)

	* configure.in: Version 2.1.2

	* NEWS: Updates.

2002-11-02  Matthias Clasen  <maclas@gmx.de>

	* btk/stock-icons/stock_jump_to_rtl_16.png,
	* btk/stock-icons/stock_jump_to_rtl_24.png: Mirrored variants
	of stock_jump_to.
	
	* btk/stock-icons/Makefile.am: 
	* btk/btkiconfactory.c (get_default_icons): Flip BTK_STOCK_FIRST,
	BTK_STOCK_LAST and BTK_STOCK_JUMP_TO for RTL locales.  (#96633)

	* btk/btkaccellabel.c (btk_accel_label_expose_event): 
	Flip accel labels for RTL locales.  (#96637)
	
	* btk/btktearoffmenuitem.c (btk_tearoff_menu_item_paint): 
	* btk/btkradiomenuitem.c (btk_radio_menu_item_draw_indicator): 
	* btk/btkimagemenuitem.c (btk_image_menu_item_size_allocate): 
	* btk/btkmenuitem.c (btk_menu_item_init): 
	(btk_menu_item_size_request): 
	(btk_menu_item_size_allocate): 
	(btk_menu_item_paint): 
	(btk_menu_item_select_timeout): 
	(btk_menu_item_position_menu): Flip all kinds of menu items for 
	RTL locales.  (#96637)

	* btk/btkstyle.c (btk_default_draw_resize_grip): Support resize
	grips for all edges.  (#52833)

	* btk/btkstyle.c (btk_default_draw_box): 
	* btk/btkoptionmenu.c (btk_option_menu_size_allocate): 
	(btk_option_menu_paint): Flip option menus for RTL 
	locales.  (#96631)

	* btk/btkmenubar.c (btk_menu_bar_size_allocate): Flip menubars
	for RTL locales.  (#96627)

	* btk/btkprogressbar.c (btk_progress_bar_act_mode_enter): 
	(btk_progress_bar_paint): Flip progress bars for RTL 
	locales.  (#96634)

	* btk/btktoolbar.c (btk_toolbar_size_allocate): Flip toolbars
	for RTL locales.  (#96626) 

2002-11-01  Matthias Clasen  <maclas@gmx.de>

	* bdk/x11/bdkim-x11.c: 
	* bdk/bdkfont.c: 
	* bdk/x11/bdkfont-x11.c: 
	* bdk/bdkdraw.c: Some docs moved inline.

Thu Oct 31 17:41:12 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btktooltips.c (btk_tooltips_update_screen): Fix
	from Nam SungHyun for crashes when tooltips->active_tips_data
	is NULL.

Thu Oct 31 12:40:39 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdk.[ch] bdk/bdkglobals.c bdk/bdkinternals.h 
	bdk/{x11,win32,linux-fb}/bdkscreen-{x11,win32,linux-fb}.c:
	Add a --screen option for setting the default screen. 
	(Based on a patch from Balamurali Viswanathan, #81145)

	* bdk/bdk.c bdkdisplay.h btk/btkmain.c: Add 
	bdk_display_open_default_libbtk_only(), so btk_init_check()
	and bdk_init_check() can share the same behavior w.r.t.
	--screen.

	* bdk/bdk.[ch]: Make bdk_get_display_arg_name() G_CONST_RETURN.

	* bdk/x11/bdkselection-x11.c (bdk_selection_property_get): 
	Suppress a spurious warning.

	* tests/testbtkrc: Remove someleft-over commented out 
	includes that could be confusing.

2002-10-31  Padraig O'Briain  <padraig.obriain@sun.com>

	* btk/btktoolbar.c (btk_toolbar_insert_stock): Move g_free()
	call to before return.

2002-10-29  Matthias Clasen  <maclas@gmx.de>

	* tests/testbtkrc: Adjust for current btk-engines.

	* bdk/x11/bdkcolor-x11.c (bdk_colors_free): Use the same parameter
	names in header, docs and implementation.

	* bdk/bdkcolor.c (bdk_colors_store): Doc comment fix.

	* bdk/x11/bdkcursor-x11.c (bdk_cursor_new_from_pixmap): Fix
	example in doc comment.

	* btk/btkiconfactory.c (btk_icon_size_lookup_for_settings): 
	* btk/btkfilesel.c (btk_file_selection_get_selections): Doc
	comment fixes.  (#97136, #97125, Vitaly Tishkov)

	* btk/btktreeselection.c (btk_tree_selection_get_selected_rows): 
	* btk/btkwindow.c (btk_window_set_default_icon_from_file): Doc
	comment fixes.  (#95829, #96818, Vitaly Tishkov)

Tue Oct 29 20:39:16 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* btk/btkmenu.c: Change NAVIGATION_REBUNNYION_OVERSHOOT back to 50,
	and create stay-up rebunnyions by flipping a fourth quadrant triangle
	as appropriate.

2002-10-28  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkwindow-win32.c (bdk_window_set_decorations,
	bdk_window_set_functions): Don't call GetWindowLong for
	GWL_EXSTYLE, the extended window style wasn't used or
	changed. After setting the window style with SetWindowLong, call
	SetWindowPos with the SWP_FRAMECHANGED flag for the window to
	actually be updated, as Platform SDK docs say one should. (#95812,
	huzheng)

2002-10-28  Dmitry G. Mastrukov  <dmitry@taurussoft.org>

	* configure.in: Added Belorusian (be) to ALL_LINGUAS.

Sun Oct 27 15:58:30 2002  Kristian Rietveld  <kris@btk.org>

	This fixes a scrolling bug. Shouldn't cause problems, but you
	never know ... (#81627, testcase by Timo Sirainen).

	* btk/btktreeview.c (validate_visible_area): add a temporary
	implemention for non use_align, always update dy and ->top_row
	if we scroll here,
	(btk_tree_view_clamp_node_visible): reimplement using
	_scroll_to_cell (#73895).

Sun Oct 27 11:41:37 GMT 2002  Tony Gale <gale@btk.org>

	* docs/tutorial/btk-tut.sgml:
	minor cleanups, remove refs to btk_menu_append

	*docs/faq/btk-faq.sgml: remove ref to btk_menu_append

Fri Oct 25 23:36:30 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* btk/btkmenu.c: Change NAVIGATION_REBUNNYION_OVERSHOOT from 50 to 5.

Fri Oct 25 17:56:24 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btknotebook.c (btk_notebook_switch_focus_tab): 
	Always switch to the page with the focused tab
	label. (#82108, Matt Wilson.)

Fri Oct 25 17:46:18 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btknotebook.c (btk_notebook_button_press): 
	Don't handle button 2/3 on the tabs. (#82118,
	Matt Wilson.)

Fri Oct 25 17:32:44 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btktoolbar.c: Don't insert mnemonics for stock
	items (#72918, reported by Mikael Hallendal)

Fri Oct 25 14:51:34 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkfilesel.c: Fix sensitivity of file operation
	buttons and buttons inside fileop dialogs to update
	properly based on the contents of the entries.
	(#74267, based on part of a patch from Muktha 
	Narayan)

	* btk/btkitemfactory.c (btk_item_factory_create_item):
	Warn if loading <ImageItem> image fails.

	* tests/testbtk.c: Fix data for "apple" inline pixbuf
	to be valid.

Fri Oct 25 18:17:39 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* btk/btkpaned.[ch]: New BtkPaned keyboard navigation. (Shift-)F8
	now cycles the available handles instead of toggling focus on and
	off. Fixes #87160, reported by Calum Benson.

2002-10-25  Matthias Clasen  <maclas@gmx.de>

	* bdk/x11/bdkcursor-x11.c: Fix doc comment. 

	* bdk/bdkdnd.c: Add missing includes.

2002-10-24  Matthias Clasen  <maclas@gmx.de>

	* bdk/bdkdnd.c: 
	* bdk/x11/bdkdnd-x11.c: 
	* bdk/x11/bdkcursor-x11.c: 
	* bdk/bdkcolor.c:
	* bdk/x11/bdkcolor-x11.c: Some docs moved inline.
	
2002-10-23  Matthias Clasen  <maclas@gmx.de>

	* bdk/linux-fb/bdkselection-fb.c (bdk_utf8_to_string_target): 
	(bdk_utf8_to_compound_text_for_display): 
	(bdk_text_property_to_utf8_list_for_display): 
	* bdk/linux-fb/bdkkeyboard-fb.c (bdk_keymap_get_entries_for_keyval): 
	(bdk_keymap_get_entries_for_keycode): 
	(bdk_keymap_lookup_key): 
	(bdk_keymap_translate_keyboard_state): 
	* bdk/win32/bdkselection-win32.c (bdk_text_property_to_utf8_list_for_display): 
	(bdk_utf8_to_string_target): 
	(bdk_utf8_to_compound_text_for_display): 
	* bdk/win32/bdkkeys-win32.c (bdk_keymap_get_entries_for_keyval): 
	(bdk_keymap_get_entries_for_keycode): 
	(bdk_keymap_lookup_key): 
	(bdk_keymap_translate_keyboard_state): 
	* bdk/win32/bdkgeometry-win32.c (bdk_window_scroll): 
	* bdk/win32/bdkfont-win32.c (bdk_font_from_description_for_display): 
	* bdk/win32/bdkevents-win32.c (bdk_keyboard_grab_info_libbtk_only): 
	Remove doc comments for non-backend-specific functions from win32
	and linux-fb backends. These functions should be documented in the
	x11 backend.
	
Wed Oct 23 17:06:02 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreemodel.c: s/NULL/0/ on the g_signal_emit lines to
	fix up yesterdays commit (reported by Morten Welinder).

Tue Oct 22 20:02:22 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkcombo.c: When popping up the list without
	any selected items, hack the focus on the list to
	avoid triggering a bug in BtkList when clicking
	on focused-but-not-selected items (#86700,
	Zimler Attila, Matthias Clasen) and to keep
	BtkWindow from selecting the first item.

	* tests/testbtk.c (create_list): Make the initial
	setting of the selection mode correspond to the option
	menu.

Wed Oct 23 01:03:43 2002  Kristian Rietveld  <kris@btk.org>

	Another feature to create truly ugly TreeViews!: style properties
	for the even/odd colors used for row hinting. (#71595, reported
	by Owen Taylor).

	* btk/btktreeview.c (btk_tree_view_class_init): add even_row_color
	and odd_row_color style properties.

	* btk/btkstyle.c (get_darkened_gc): support darken_count == 0 case,
	(btk_default_draw_flat_box): rework cell coloring code to support
	user-provided even/odd row colors.

Wed Oct 23 01:01:52 2002  Kristian Rietveld  <kris@btk.org>

	Cache signal IDs to speed up signal emission. This is a good speedup
	because BtkTreeModel emits a big number of signals.

	* btk/btktreemodel.c (btk_tree_model_base_init): save IDs returned
	by g_signal_new,
	(btk_tree_model_row_changed): use g_signal_emit instead of
	g_signal_emit_by_name,
	(btk_tree_model_row_inserted): ditto,
	(btk_tree_model_row_has_child_toggled): ditto,
	(btk_tree_model_row_deleted): ditto,
	(btk_tree_model_rows_reordered): ditto.
	
Wed Oct 23 00:56:15 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreeselection.c (model_changed): new function,
	(btk_tree_selection_selected_foreach): monitor changes in the model,
	bail out if the model has been changed from the foreach func.
	(#50263, reported by Havoc Pennington).

	* btk/btktreeselection.c (_btk_tree_selection_internal_select_node):
	free anchor if applicable (#94868, reported and testcase provided by
	Daniel Elstner).

2002-10-23  Matthias Clasen  <maclas@gmx.de>

	* btk/btkinvisible.c (btk_invisible_get_screen): 
	* btk/btkcolorsel.c
	(btk_color_selection_set_change_palette_with_screen_hook): Fix doc comments.

	* bdk/linux-fb/bdkselection-fb.c (bdk_text_property_to_utf8_list_for_display): 
	(bdk_utf8_to_compound_text_for_display): Fix doc comments - why
	do these overwrite the ones from bdk/x11/*.c ?!

	* bdk/bdkdisplaymanager.c
	(bdk_display_manager_get_default_display): 
	Documentation fix.

	* bdk/bdkevents.c (bdk_event_new): 
	* bdk/x11/bdkdnd-x11.c (bdk_drag_find_window_for_screen): 
	* bdk/x11/bdkevents-x11.c (bdk_x11_screen_get_window_manager_name): 
	* bdk/x11/bdkdisplay-x11.c (bdk_x11_display_grab): 
	(bdk_x11_display_ungrab): Add documentation.

	* bdk/x11/bdkimage-x11.c (bdk_x11_image_get_xdisplay): 
	(bdk_x11_image_get_ximage): 
	* bdk/x11/bdkgc-x11.c (bdk_x11_gc_get_xdisplay): 
	(bdk_x11_gc_get_xgc): 
	* bdk/x11/bdkfont-x11.c (bdk_x11_font_get_xdisplay): 
	(bdk_x11_font_get_xfont): 
	* bdk/x11/bdkdrawable-x11.c (bdk_x11_drawable_get_xdisplay): 
	(bdk_x11_drawable_get_xid): 
	* bdk/x11/bdkcursor-x11.c (bdk_x11_cursor_get_xdisplay): 
	(bdk_x11_cursor_get_xcursor): 
	* bdk/x11/bdkcolor-x11.c (bdk_x11_colormap_get_xcolormap): 
	(bdk_x11_colormap_get_xdisplay): 
	* bdk/x11/bdkxid.c (bdk_xid_table_lookup): 
	* bdk/x11/bdkvisual-x11.c (bdkx_visual_get): 
	(bdk_x11_visual_get_xvisual):
	* bdk/x11/bdkmain-x11.c (bdk_x11_grab_server): 
	(bdk_x11_ungrab_server): 
	(bdk_x11_get_default_root_xwindow): 
	(bdk_x11_get_default_xdisplay): 
	Some docs moved inline.
	
Tue Oct 22 16:37:12 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btktooltips.c: Multihead safety fixes, handle
	displays being closed. (#81651, based on patch
	from Erwann Chenede)

	* btk/btktoolbar.c (btk_toolbar_init): Fix typo
	from the last commit.

Tue Oct 22 15:55:08 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btktoolbar.c: Fix handling of getting the 
	default style/icon size from the correct 
	BtkSettings. (#82184, reported by Vitaly Tishkov,
	help from Soeren Sandmann)

Tue Oct 22 15:32:31 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwindow.c: Actively monitor the screen of the
	parent. (#80281)

	* btk/btkentry.c: Fix missing prototype from the 
	last commit.

Tue Oct 22 15:46:09 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkentry.c (btk_entry_unrealize): Reset the 
	layout, since it holds a reference to the font on
	a particular screen.

Tue Oct 22 15:13:59 2002  Owen Taylor  <otaylor@redhat.com>
	
	* btk/btkimmulticontext.c: Include config.h
	(#96441, Morten Welinder)

Tue Oct 22 15:03:41 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/fnmatch.h: When compiling our on fnmatch.c, 
	#define fnmatch _btk_fnmatch (#92890, Jacob Berkman)

Fri Oct 18 16:47:02 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkevents-x11.c (translate_key_event): Produce
	C-m, not C-j for return. Handle Escape.

2002-10-22  Matthias Clasen  <maclas@gmx.de>

	* btk/btkstatusbar.c (btk_statusbar_get_type): 
	(btk_statusbar_class_init): It is called BtkStatusbar, not
	BtkStatusBar. This was changed accidentally during deprecation
	cleanup and caused links in the API docs to break.  (#96390)

Mon Oct 21 14:04:39 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkentry.c (btk_entry_get_public_chars): Return
	"" for entry->invisible_char == 0, otherwise N copies
	of entry->invisible_char. (#95486, Vitaly Tishkov)

	* btk/btkentry.c: Fix a bunch of places where entry->text
	instead of layout->text was being used for computation
	of offsets/indices in the layout. Using layout->text
	is necessary because when the entry is invisible, it
	doesn't correspond to entry->text.

Sun Oct 20 23:58:03 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* btkmenu.c, btkmenubar.c, btkmenuitem.c, btkmenushell.c,
	btkmenushell.h, btkmenushell.h

	- make the delay before submenus appear below menu bars a
	  BtkSetting
	- make the delay before submenus pops up a BtkSetting
	- make the stay up triangle slightly larger
	- don't pop up the first submenu immediately.
	- make the default delay for submenus 225 ms, and 0 for menubars.
	- make the default delay before popping down inside the stay-up 
	  triangle 1000 ms

	Fixes #74950
	
Sun Oct 20 14:58:02 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkscrolledwindow.c (btk_scrolled_window_class_init):
	Add a scrollbar_spacing style property (#81396, based
	on a patch from Anders Carlsson)

2002-10-19  Jeremy Katz  <katzj@redhat.com>

	* configure.in: make configure checks for Xrandr and Xinerama
	extensions less noisy (#95858)

Fri Oct 18 16:47:02 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkevents-x11.c (translate_key_event): Handle
	Return and KP_Enter.

Fri Oct 18 15:38:50 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkprogressbar.c (btk_progress_bar_set_text): 
	Reset use_text_format to %TRUE for a %NULL text string.
	(#94157, once again).

Thu Oct 17 17:17:05 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkcheckbutton.c (btk_check_button_size_request): 
	Fix use of uninitialized variable.

Thu Oct 17 14:38:37 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkaccellabel.c (btk_accel_label_expose_event): 
	Align the baseline of the accelerator label with the 
	first baseline of the main label of the menu item. (#76953)

Wed Oct 16 18:25:24 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkevents-x11.c (translate_key_event): 
	Use bdk_keymap_translate_keyboard_state() rather than
	XLookupString() to get the keysymbol, since XLookupString
	can confuse the input method handling. (#93575)

	* bdk/x11/bdkkeys-x11.c: Rewrite the handling of
	key translation for the non-XKB case to properly
	handle Shift_Lock, Caps_Lock, Num_Lock according
	to the Xlib spec. (#67066)

2002-10-17  Havoc Pennington  <hp@redhat.com>

	* btk/btkwindow.c (btk_window_compute_configure_request): fix
	compiler warnings

Thu Oct 17 22:37:57 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* btk/btkwindow.c (get_center_monitor_of_window): fix typo to make
	it compile
	
2002-10-16  Havoc Pennington  <hp@redhat.com>

	* bdk/x11/bdkscreen-x11.c (bdk_screen_get_monitor_geometry): add
	g_return_if_fail for monitor number <= 0

	* btk/btkmenu.c (btk_menu_position): handle case where pointer 
	is outside the screen.

	* btk/btkwindow.c (get_monitor_center): factor out 
	the code to position a window in center
	(btk_window_compute_configure_request): use here
	(btk_window_constrain_position): use here, the 
	code here wasn't multihead-aware

	* bdk/x11/bdkevents-x11.c (get_real_window): function to
	return the window the event describes, rather than the window
	that received the event.
	(bdk_event_translate): use result of that function for 
	filling in BdkEvent::window, which only matters for 
	MapNotify/UnmapNotify and ConfigureNotify, in practice.

	Unbreaks various things using SubstructureNotifyMask.

Thu Oct 17 16:13:28 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkcheckbutton.c btk/btkradiobutton.c: Make
	the widgets work reasonably when they don't have
	children -- draw the focus around the indicator, 
	and position the indicator symmetrically.
	(#74830, Dave Camp)

	* tests/testbtk.c: Add no-child portions to check and radio 
	button tests.

Thu Oct 17 22:09:05 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* btk/btkmenu.c (btk_menu_scroll_to): Take arrows into
	account when clamping the offset. Fixes #95758.

Wed Oct 16 15:19:44 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkkeys-x11.c: Fix from Phil Blundell for
	compiling without Xkb. (#95909)

Wed Oct 16 14:32:43 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkdrawable.h bdk/bdkdraw.c bdk/bdkpixmap.c 
	bdk/bdkwindow.c bdk/x11/bdkdrawable-x11.c
	bdk/win32/bdkdrawable-win32.c bdk/linux-fb/bdkdrawable-fb2.c
	bdk/linux-fb/bdkprivate-fb.h:
	Make 'filled' arguments for draw_arc/polygon/rectangle
	gboolean not gint. (#94976)
	
Wed Oct 16 17:11:46 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* btk/btktearoffmenuitem.c (btk_tearoff_menu_item_paint): Make
	tear-off menuitems obey the "selected_shadow_type" style property.

Tue Oct 15 17:25:47 2002  Owen Taylor  <otaylor@redhat.com>

	* modules/input/btkimcontextxim.c (get_im): Don't use 
	connect_swapped() when the function being connected
	has a non-swapped signature.

Tue Oct 15 09:54:54 2002  Owen Taylor  <otaylor@redhat.com>

	* modules/input/btkimcontextxim.c (get_im): Initialize
	info->ics to NULL. (Hidetoshi Tajima.)  

	* modules/input/btkimcontextxim.c (status_window_get): 
	Call set_resizable on the window, not on the structure.

Mon Oct 14 19:17:34 2002  Owen Taylor  <otaylor@redhat.com>

	* === Released 2.1.1 ===

Mon Oct 14 18:50:59 2002  Owen Taylor  <otaylor@redhat.com>

	* configure.in: Version 2.1.1, interface age 0, binary age 101.

	* NEWS: Updates

Tue Oct 15 00:53:14 2002  Kristian Rietveld  <kris@btk.org>

	Behaviour change, apply changes if the entry of the editable gets
	a focus out event (#82405).

	* btk/btkcellrenderertext.c (btk_cell_renderer_text_focus_out_event):
	new function,
	(btk_cell_renderer_text_start_editing): stop editing and apply
	changes on focus-out.

Tue Oct 15 00:47:35 2002  Kristian Rietveld  <kris@btk.org>

	Fixes an *evil* BtkTreeModelSort bug, #93629.

	* btk/btktreemodel.c (release_row_references): return if the
	refs->list is NULL.

	* btk/btktreemodelsort.c (btk_tree_model_sort_row_changed): if we
	are swapping two rows (re-insertion on row_changed), also *emit*
	a rows_reordered signal. oops.

Tue Oct 15 00:45:03 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btkliststore.c (btk_list_store_remove_silently): free
	the actual link after the node has been removed (#92014).

	* btk/btktreeviewcolumn.c (btk_tree_view_column_column_finalize):
	free the cell_list and the child if the exists (#92014).

Tue Oct 15 00:40:25 2002  Kristian Rietveld  <kris@btk.org>

	Don't accept drops if the model has been sorted, #93758)

	* btk/btkliststore.c (btk_list_store_row_drop_possible): return
	FALSE if the list has been sorted.

	* btk/btktreestore.c (btk_tree_store_row_drop_possible): check
	if drag_dest is a TreeStore, return FALSE if the tree has been
	sorted.

Tue Oct 15 00:33:59 2002  Kristian Rietveld  <kris@btk.org>

	Compiler warning fixage, (#85858, #85859, #85860, #85872)

	* btk/btkcellrendererpixbuf (btk_cell_renderer_pixbuf_render):
	s/guint/BtkCellRendererState/.
	
	* btk/btkcellrenderertext.c (btk_cell_renderer_text_render):
	ditto.

	* btk/btkcellrenderertoggle.c (btk_cell_renderer_toggle_render),
	(btk_cell_renderer_toggle_activate): ditto.

	* btk/btkliststore.c (btk_list_store_get_flags): a
	s/guint/BtkTreeModelFlags/ on the return type.

Mon Oct 14 15:10:34 2002  Owen Taylor  <otaylor@redhat.com>

	* modules/input/btkimcontextxim.c:
 	- Make BtkXIMInfo structures per-screen (they were
 	  a mix between per-display and per-context before)
 	- Make signal connections info->settings one-per-info
         - Handle a BdkDisplay being closed, by destroying
 	  all XIC, calling XCloseIM on the XIM. (#87482)
 
Sun Oct 13 16:55:49 2002  Manish Singh  <yosh@gimp.org>

	* btk/btkdnd.c btk/btkradiobutton.[ch]: Deprecation cleanup

	* btk/Makefile.am: Added disable deprecation flags

	* demos/pixbuf-init.c demos/btk-demo/changedisplay.c: minor clean up

Sun Oct 13 16:20:41 2002  Manish Singh  <yosh@gimp.org>

	* tests/pixbuf-randomly-modified.c tests/prop-editor.c
	tests/testcalendar.c tests/testdnd.c tests/testbtk.c tests/testinput.c
	tests/testmultidisplay.c tests/testmultiscreen.c tests/testrgb.c
	tests/testselection.c tests/testsocket.c tests/testsocket_common.c
	tests/testtext.c tests/testtextbuffer.c tests/testtreecolumns.c
	tests/testtreeedit.c tests/testtreeflow.c tests/testtreefocus.c
	tests/testtreesort.c tests/testtreeview.c tests/testxinerama.c
	tests/treestoretest.c: Deprecation cleanup

	* tests/Makefile.am: Added disable deprecation flags

Sun Oct 13 13:43:16 2002  Manish Singh  <yosh@gimp.org>

	* btk/btkcurve.[ch] btk/btkgamma.[ch] btk/btklayout.[ch]
	btk/btkwidget.[ch] modules/input/btkimcontextxim.c
	modules/input/imam-et.c modules/input/imcyrillic-translit.c
	modules/input/imhangul.c modules/input/iminuktitut.c
	modules/input/imipa.c modules/input/imthai-broken.c
	modules/input/imti-er.c modules/input/imti-et.c
	modules/input/imviqr.c: Deprecation cleanup

	* modules/input/Makefile.am: Added disable deprecation flags

Sun Oct 13 12:29:15 2002  Manish Singh  <yosh@gimp.org>

	* btk/btkcolorsel.[ch] btk/btkcombo.[ch] btk/btkplug.[ch]
	btk/btksocket.[ch] btk/btktreeview.[ch] btk/btktreeviewcolumn.[ch]:
	Deprecation cleanup

	* btk/btkcolorseldialog.c: make window not resizable (lost
	accidently in the previous cleanup)

Sun Oct 13 20:20:51 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* btk/btktooltips.c (btk_tooltips_force_window): Make tooltip
	window not resizable. Fixes #95675.

Sun Oct 13 18:50:14 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* btkmenu.c, btkmenu.sgml, btkitemfactory.c, bdkwindow.c,
	btkwindow.c, btkpaned.sgml, btkdialog.c, btkbox.h, btkbutton.sgml,
	btktreemodel.sgml,btktable.sgml, btktable.c:

	Documentation fixes.

	#85719, #90759, #95169, Owen Taylor;
	#89221, Yao Zhang, Matthias Clasen;
	#95592, Joost Faassen;
	#92637, Vitaly Tishkov;
	#94616, Ben Martin;
	#94772, sbaillie@bigpond.net.au;

Sun Oct 13 17:41:53 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* btk/btkwidget.c (btk_widget_queue_clear_area): Don't invalidate
	a widget if it or one of its ancestors isn't mapped.

Sun Oct 13 17:21:15 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* tests/testbtk.c (window_controls), tests/testbtk.c
	(create_tooltips): remove references to non-existing properties
	BtkWindow::allow_shrink and BtkWidget::width

Sat Oct 12 15:44:29 2002  Manish Singh  <yosh@gimp.org>

        * btk/btkitemfactory.c: use BTK_IS_RADIO_MENU_ITEM instead
        of comparing the type directly. This handles possible subclasses
        too. (Recommended by Tim Janik)

Fri Oct 11 15:56:20 2002  Manish Singh  <yosh@gimp.org>

	* btk/btkaccellabel.[ch] btk/btkaccessible.[ch] btk/btkbutton.[ch]
	btk/btkcheckbutton.[ch] btk/btkcolorseldialog.[ch] btk/btkdialog.[ch]
	btk/btkhandlebox.[ch] btk/btkinputdialog.[ch] btk/btkmessagedialog.[ch]
	btk/btktearoffmenuitem.[ch] btk/btktogglebutton.[ch]: Deprecation
	cleanup

2002-10-11  Matthias Clasen  <maclas@gmx.de>

	* examples/btkdial/btkdial.c (btk_dial_destroy): 
	* docs/tutorial/btk-tut.sgml: Prevent segfault from double destroy.

	* bdk/x11/bdkwindow-x11.c (bdk_window_new): Typo fix.

	* btk/btkimagemenuitem.c (btk_image_menu_item_new_from_stock):
	Clarify the docs.

	* btk/btkmenuitem.c (btk_menu_item_set_accel_path): Mention 
	btk_menu_set_accel_group in the docs.

	* bdk/x11/bdkwindow-x11.c (bdk_window_set_skip_pager_hint): 
	* bdk/bdkdisplay.c (bdk_display_set_pointer_hooks): Fix
	doc comments.

	* btk/btkiconfactory.c (btk_icon_size_lookup_for_settings): 
	* btk/btknotebook.c (btk_notebook_get_n_pages): 
	* btk/btkwindow.c (btk_window_set_icon_from_file): 
	* btk/btktreeviewcolumn.c (btk_tree_view_column_focus_cell): Fix
	doc comments.

	* btk/btktreestore.c: 
	* btk/btktreestore.h: Consistently name first parameter
	tree_store, and make header and implementation agree on parameter 
	names to silence btk-doc.

	* btk/btkenums.h (enum): Comment typo fix.

Thu Oct 10 15:13:48 2002  Manish Singh  <yosh@gimp.org>

	* btk/btkimcontext.[ch] btk/btkimcontextsimple.[ch] btk/btkimmodule.c
	btk/btkimmulticontext.[ch] btk/btktreestore.[ch]: Deprecation
	cleanup

Thu Oct 10 14:58:47 2002  Manish Singh  <yosh@gimp.org>

	* btk/btkaccelgroup.c btk/btkarrow.[ch] btk/btkeventbox.[ch]
	btk/btkiconfactory.c btk/btkinvisible.[ch] btk/btktextchild.c:
	Deprecation cleanup

Thu Oct 10 14:41:05 2002  Manish Singh  <yosh@gimp.org>

	* btk/btktextbtree.c btk/btktextbuffer.c btk/btktextdisplay.c
	btk/btktextlayout.c btk/btktextmark.c btk/btktexttag.[ch]
	btk/btktexttagtable.c btk/btktextutil.c btk/btktextview.[ch]:
	Deprecation cleanup

Thu Oct 10 14:35:31 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkscrolledwindow.[ch]: Privately export
	_btk_scrolled_window_get_scrollbar_spacing().

	* btk/btkcombo.c: Properly account from scrollbar
	spacing when computing the size of the popup window.
	(#84955, Marco Pesenti Gritti)

Wed Oct  9 17:40:13 2002  Manish Singh  <yosh@gimp.org>

	* btk/btkaccelmap.c btk/btkfixed.[ch] btk/btkkeyhash.c btk/btkmenu.c
	btk/btkobject.c btk/btkoldeditable.c btk/btkrc.c btk/btkspinbutton.[ch]
	btk/btktable.[ch] btk/btkthemes.c: Deprecation cleanup

Wed Oct  9 16:52:53 2002  Manish Singh  <yosh@gimp.org>

	* btk/btkclipboard.[ch] btk/btkeditable.[ch] btk/btkgc.c
	btk/btkoptionmenu.[ch] btk/btkselection.c btk/btksizegroup.[ch]:
	Deprecation cleanup

Wed Oct  9 15:23:48 2002  Manish Singh  <yosh@gimp.org>

	* btk/btkadjustment.[ch] btk/btkalignment.[ch] btk/btkentry.[ch]
	btk/btkhsv.[ch] btk/btktooltips.[ch]: Deprecation cleanup

Wed Oct  9 15:07:08 2002  Manish Singh  <yosh@gimp.org>

	* btk/btkbindings.[ch] btk/btkcalendar.[ch] btk/btkfilesel.[ch]
	btk/btkfontsel.[ch] btk/btkitem.[ch] btk/btkitemfactory.[ch]:
	Deprecation cleanup

Wed Oct  9 17:06:21 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkiconfactory.c (add_size_and_dir_with_fallback):
	Add GO_FORWARD and GO_BACK with both left and right
	arrows depending on the direction. (#92211,
	Kenneth Christiansen)

	* tests/testbtk.c (create_flipping): Add forward/back button
	pairs in default, RTL, LTR configurations.

2002-10-09  Stanislav Brabec  <sbrabec@suse.cz>

	* btk/btkimcontextsimple.c: Added support for hungarian characters
	(addition to bug #93421). Only via dead keys, because compose key
	combinations in X are erratic.

Tue Oct  8 17:34:26 2002  Manish Singh  <yosh@gimp.org>

	* btk/btkmain.c btk/btkscrolledwindow.[ch] btk/btksettings.c
	btk/btkstatusbar.[ch] btk/btkstyle.c btk/btktoolbar.[ch]
	btk/btkviewport.[ch] btk/btkwindow.[ch]: Deprecation cleanup

Tue Oct  8 15:25:53 2002  Manish Singh  <yosh@gimp.org>

	* btk/btkhpaned.[ch] btk/btkpaned.[ch] btk/btkprogress.[ch]
	btk/btkprogressbar.[ch] btk/btkvpaned.[ch]: Deprecation cleanup

Tue Oct  8 14:49:56 2002  Manish Singh  <yosh@gimp.org>

	* btk/btktreemodel.h: restore btkobject.h #include so we don't
	break backwards compat.

Tue Oct  8 09:41:43 2002  Owen Taylor  <otaylor@redhat.com>

	* Patch from Takuro Ashie to fix updating of open_ims
	list. (#95150)

Mon Oct  7 19:44:45 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkkeys-x11.c (_bdk_keymap_keys_changed): Move
	out of HAVE_XKB. (#95129, Phil Blundell)

Mon Oct  7 19:14:24 2002  Eric Warmenhoven <eric@warmenhoven.org>

	* bdk/linux-fb/bdkwindow-fb.c: fix compilation

	* bdk/linux-fb/bdkmain-fb.c: better display mode setting

Mon Oct  7 18:50:46 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkcolorsel.c (btk_color_selection_finalize):
	Free the private data. (#84903, Matthias Clasen)

Mon Oct  7 18:21:39 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btk[hv]paned.c btk/btkpaned.c: Allow the slider
	to be set all the way to the edge, and if that happens,
	use btk_widget_set_child_visible() to hide the 
	appropriate child. (#72784, request from Darin Adler)

Mon Oct  7 16:28:11 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkcolorsel.c (palette_drag_begin): Use
	a pixbuf to set the drag icon, combine code
	to create drag icons (Fixes #80092, #80093)

	* btk/btkcolorsel.c (get_screen_color): Don't warn
	on failure to grab keyboard/mouse. (#80085)

	* btk/btkcolorsel.c (palette_press): Return FALSE,
	so DND initiation is possible.

	* btk/btkcolorsel.c (palette_release): Set the color
	from the palette on release, not press.

	* btk/btkcolorsel.c (btk_color_selection_show_all):
	Override to simple call show(). (#74173)

	* tests/testbtk.c (create_color_selection): Use 
	btk_widget_show_all()

Mon Oct  7 15:48:44 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkdnd.[ch] bdk/x11/bdkdnd-x11.c: Add 
	bdk_drag_find_window_for_screen(), so that we can
	interpret x_root / y_root relative to the correct screen.
	
	* bdk/bdkdnd.c Makefile.am bdk/x11/bdkdnd-x11.c 
	bdk/fb/bdkdnd-fb.c bdk/win32/bdkdnd-win32.c: New file. 
	Move bdk_drag_find_window(), bdk_drag_get_protocol() here.

	* btk/btkdnd.c: Handle drags between screens; use 
	a fallback icon for icons set as windows/pixmaps, 
	move the drag icon between displays for icons set as 
	pixbufs.

	* bdk/x11/bdkkeys-x11.c (update_keymaps): Fix infinite
	loop from last change.

Mon Oct  7 15:10:00 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkdisplay.[ch] bdk/bdkinternals.h 
	bdk/bdkwindow.[ch] bdk/linux-fb/bdkwindow-fb.c 
	bdk/win32/bdkwindow-win32.c bdk/x11/bdkwindow-x11.c:

	- Replace BdkPointerHooks with a multihead-safe 
	  BdkDisplayPointerHooks, leave BdkPointerHooks
	  around for singlehead.
	- Add bdk_display_get_pointer() to get the pointer
	  location with the screen it is on.

	* bdk/bdk.def bdk/bdkdisplay.[ch] bdk/bdkscreen.[ch]:
	Change bdk_screen_get_window_at_pointer() to
	bdk_display_get_window_at_pointer().

	* btk/btktreeview.c demos/btk-demo/changedisplay.c
	tests/testbtk.c: Use bdk_display_get_window_at_pointer(), 
	not bdk_screen_get_window_at_pointer().

	* btk/btkcolorsel.c: Fix grabbing color to be multihead
	safe.

	* btk/btkwidget.c: Allow btk_widget_push_colormap (NULL).
	since it is useful for writing code that doesn't
	know the dcurrent state but needs a clean colormap.

	* btk/btkrc.c: When loading the settings for a particular
	screen, only reset toplevels on that screen.

	* btk/btkiconfactory.h: Fix #ifdef BTK_MULTIHEAD_SAFE
	that should have been #ifndef BTK_MULTIHEAD_SAFE.

Mon Oct  7 11:59:33 2002  Manish Singh  <yosh@gimp.org>

	* btk/btkliststore.[ch] btk/btktreedatalist.[ch] btk/btktreednd.c
	btk/btktreemodel.[ch] btk/btktreemodelsort.[ch]
	btk/btktreeselection.[ch] btk/btktreesortable.[ch]
	btk/btktreestore.[ch]: Deprecation cleanup

Mon Oct  7 14:51:21 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkx.h: Fix some prototypes that had
	() instead of (void).

Mon Oct  7 12:40:39 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwindow.c (btk_window_move_resize): Clean
	up the handling of clearing transient state 
	settings, fixing bug #95026, reported by Jami
	Pekannen.

Mon Oct  7 11:45:17 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkkeys-x11.c (update_keymaps): If Mode_switch
	is used for a known modifier like Mod1, assume it won't
	be used to switch group. (#94841, problem reported by
	Szekeres Istvan)

Mon Oct 7 16:07:52 2002  Bill Haneman <bill.haneman@sun.com>

	* bdk/x11/bdkimage-x11.c bdk/linux-fb/bdkimage-x11.c 
	bdk/win32/bdkimage-x11.c: (bdk_image_get_pixel): 
	(bdk_image_put_pixel): Fixed sense of bounds checks.

Sun Oct  6 21:23:29 2002  Manish Singh  <yosh@gimp.org>

	* btk/btkcontainer.[ch] btk/btkbox.[ch] btk/btkhbox.[ch]
	btk/btkvbox.[ch]: Deprecation cleanup

Sun Oct  6 18:32:11 2002  Manish Singh  <yosh@gimp.org>

	* btk/btkcelleditable.c btk/btkcellrenderer.[ch]
	btk/btkcellrendererpixbuf.[ch] btk/btkcellrenderertext.[ch]
	btk/btkcellrenderertoggle.[ch]: Deprecation cleanup

Sat Oct  5 16:11:22 2002  Manish Singh  <yosh@gimp.org>

	* btk/btkmisc.[ch] btk/btklabel.[ch] btk/btkimage.[ch]
	btk/btkdrawingarea.[ch] btk/btknotebook.[ch]: Deprecation cleanup

Sat Oct  5 18:30:50 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/stock-icons/Makefile.am (pixbuf_csource): Use
	$(top_builddir) instead of here-undefined $$topdir.
	(Problem reported by Jacob Berkman)

Sat Oct  5 18:25:11 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btknotebook.c (btk_notebook_draw_tab): Fix 
	&expose_event vs expose_event problem (#94898,
	reported by Jon-Kare Hellan)

Sat Oct  5 16:47:03 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* docs/reference/btk/tmpl/btkfontseldlg.sgml, bdk/bdkwindow.c,
	bdk/x11/bdkwindow-x11.c, btk/btkfontsel.h, btk/btkimcontext.c,
	btk/btktreeview.c, btk/btktreeviewcolumn.c

	Documentation fixes:

	#75170, Dan Winship; 
	#73220, Havoc Pennington;
	#70742, Boris Shingarov; 
	#72007, Alexey A. Malyshev

Fri Oct  4 18:40:50 2002  Manish Singh  <yosh@gimp.org>

	* btk/btkcheckmenuitem.[ch] btk/btkimagemenuitem.[ch] btk/btkmenu.[ch]
	btk/btkmenubar.[ch] btk/btkmenuitem.[ch] btk/btkmenushell.[ch]
	btk/btkradiomenuitem.[ch]: Deprecation cleanup

Fri Oct  4 16:48:27 2002  Manish Singh  <yosh@gimp.org>

	* btkaspectframe.[ch] btkbin.[ch] btkframe.[ch] btkhruler.[ch]
	btkruler.[ch] btkvruler.[ch]: Deprecation cleanup

Fri Oct  4 15:47:06 2002  Manish Singh  <yosh@gimp.org>

	* btkbbox.[ch] btkhbbox.[ch] btkhscale.[ch] btkscale.[ch]
	btkvscale.[ch] btkvbbox.[ch]: Deprecation cleanup

Fri Oct  4 15:05:19 2002  HideToshi Tajima  <hidetoshi.tajima@sun.com>

	* modules/input/btkimcontextxim.c (get_ic_real): Fix memory
	intilization error caused by my previous checkin.
	#94908 a patch from famao@momonga-linux.org (Motonobu Ichimura)
	
Fri Oct  4 17:13:03 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkdnd.c: Improve checks on public entry points,
	including, among other things checking whether drag
	contexts passed in are source or dest. (Fixes
	#76762, Alexey A. Malyshev)

	* tests/testtext.c tests/testbtk.c tests/testdnd.c:
	Fix uninstalled operation for new pixbuf changes.

	* btk/stock-icons/Makefile.am (pixbuf_csource): 
	Fix makefile for uninstalled operation.

Fri Oct  4 21:21:47 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* btk/btkhandlebox.c (btk_handle_box_paint): remove unused
	codepath.

	* btk/btkmenuitem.c (btk_real_menu_item_{de,}select): call 
	btk_widget_queue_draw() instead of btk_widget_draw().

Fri Oct  4 14:49:04 2002  Owen Taylor  <otaylor@redhat.com>

	Patch from Shivram U <shivaram.upadhyayula@wipro.com>
 
  	* bdk/x11/bdkkeys-x11.c (update_keymaps): Increased the keycount to
 	(max_keycode - min_keycode) + 1 from (max_keycode - min_keycode).
 	(update_keymaps), (bdk_keymap_get_entries_for_keyval) looping through
 	less than or equal to max_keycode. (#79184)

2002-10-04  jacob berkman  <jacob@ximian.com>

	* bdk/x11/bdkscreen-x11.c (init_xinerama_support): make legal C

Fri Oct  4 12:05:27 2002  Owen Taylor  <otaylor@redhat.com>

	* demos/Makefile.am (pixbuf_csource): Fix envars
	for uninstalled operation of bdk-pixbuf

	* demos/Makefile.am (test-inline-pixbufs.h): Remove
	output on failure.

Fri Oct  4 12:00:10 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkscreen.c (bdk_screen_class_init): Get the
	name right.

	* bdk/x11/bdkscreen-x11.c (bdk_screen_x11_class_init): 
	Fix function that should have been static.

Fri Oct  4 11:43:47 2002  Owen Taylor  <otaylor@redhat.com>

	* configure.in: Add a check for the Xrandr extension.

	* bdk/bdkscreen.[ch]: Add a size-changed signal.

	* bdk/x11/bdkscreen-x11.[ch]: Patch from Keith packard
	to hook up ConfigureNotify events on the root window
	to the ::size-changed signal. (#94560)

	* btk/btkimcontextsimple.c: Warning fixes
	
Fri Oct  4 00:57:53 2002  Manish Singh  <yosh@gimp.org>

	* btk/btkhscrollbar.[ch] btk/btkhseparator.[ch] btk/btkrange.[ch]
	btk/btkscrollbar.[ch] btk/btkseparator.[ch] btk/btkseparatormenuitem.h
	btk/btkvscrollbar.[ch] btk/btkvseparator.[ch]: Deprecation cleanup

Thu Oct  3 22:38:12 2002  Manish Singh  <yosh@gimp.org>

	* bdk-pixbuf/queryloaders.c: make it legal C

Thu Oct  3 16:40:18 2002 Eric Warmenhoven <eric@warmenhoven.org>

	* bdk/bdkevents.c, bdk/linux-fb/bdkwindow-fb.c,
	btk/btkwindow-decorate.c: implement maximize for linux-fb

	* bdk/linux-fb/bdkkeyboard-fb.c: implement raw keyboard mode

	* bdk/linux-fb/Makefile.am, bdk/linux-fb/bdkdnd-fb.c,
	bdk/linux-fb/bdkmain-fb.c, bdk/linux-fb/bdkselection-fb.c,
	bdk/linux-fb/miarc.c, bdk/linux-fb/mifpolycon.c,
	bdk/linux-fb/miwideline.c, bdk/linux-fb/mizerclip.c,
	bdk/linux-fb/mizerline.c: small cleanups

Thu Oct  3 19:00:55 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkselection-x11.c (bdk_selection_property_get): 
	Fix error in computing length and a memory leak.
	(Fixes #94072, reported by Hema Seetharamaiah)

	* btk/btkmenu.c (btk_menu_motion_notify): Fix &event
	used instead of event.

2002-10-04  Matthias Clasen  <maclas@gmx.de>

	* demos/btk-demo/main.c (main): 
	* demos/pixbuf-init.c (pixbuf_init): Adjust to bdk-pixbuf changes.

Thu Oct  3 23:53:43 2002  Kristian Rietveld  <kris@btk.org>

	* bdk/x11/bdkwindow-x11.c (_bdk_windowing_window_destroy): get
	XDisplay from window instead of display, as display has not been
	defined here (fixes the build).

Thu Oct  3 17:09:23 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/{bdkdrawable-x11.[ch],bdkpixmap-x11.c,
	bdkwindow-x11.c}: Restore the pre-Xft2 code to
	render text directly via RENDER, conditionalized
	with !HAVE_XFT2 so that we'll build again on Xft1 
	systems. (#90181)

Thu Oct  3 14:13:33 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkevents.c (bdk_event_new): Add a 'type'
	parameter, make public.

	* bdk/bdkevents.c (bdk_event_copy): Copy the screen.

	* bdk/bdkevents.c bdk/linux-fb/bdkmain-fb.c
	bdk/x11/bdkevents-x11.c	bdk/win32/bdkevents-win32.c:
	_bdk_event_new() => bdk_event_new().
	
	* bdk/win32/bdkevents-win32.c (real_window_procedure): 
	Fix event_private->screen breakage that results from evil 
	encapsulation breakage here.
	
	* btk/btkclist.c btk/btkcombo.c btk/btkcontainer.c
	btk/btkdialog.c btk/btkdnd.c btk/btkdrawingarea.c
	btk/btkimcontextsimple.c btk/btklist.c btk/btkmenu.c
	btk/btknotebook.c btk/btkplug.c btk/btkselection.c
	btk/btktext.c btk/btktreeitem.c btk/btktreeview.c
	btk/btkviewport.c btk/btkwindow-decorate.c btk/btkwindow.c
	tests/testbtk.c: Remove most usage of stack-allocated 
	BdkEvent structures.

	* btk/btktreeview.c: Use a cut-and-paste of the full 
	send_focus_event() from btkwindow.c that does the necessary 
	notification of the ::has-focus property and setting of 
	the HAS_FOCUS flag.x

	* btk/btkdnd.c: Clean up some mess/duplicated code; removing
	an extraneous use of a BdkEvent.

Wed Oct  2 17:46:53 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkdrawable.h bdk/bdkinternals.h bdk/bdkdraw.c
	bdk/bdkwindow.c bdk/bdkdrawable.c: Export _bdk_draw_pixbuf
	as bdk_draw_pixbuf(), rename the _draw_pixbuf virtual
	function to draw_pixbuf. (#60582)

	* bdk/bdkpixbuf-render.c (bdk_pixbuf_render_to_drawable[_alpha]):
	Note that these functions are obsolete in the docs.

	* bdk/bdkpixbuf-render.c (bdk_pixbuf_render_to_drawable): 
	Remove all the sanity checks now we make it clear
	that it is obsolete name for bdk_draw_pixbuf().

	* bdk/bdkpixmap.c btk/btkcellrendererpixbuf.c btk/btkimage.c
	  btk/btkpixmap.c demos/testpixbuf-scale.c demos/testpixbuf.c
	  tests/testrgb.c: Use bdk_draw_pixbuf() everywhere.

	* btk/btklabel.c (btk_label_set_mnemonic_widget): Fix
	some warnings.

	* bdk/bdkinternals.h (struct _BdkEventPrivate): Fix missed
	bit from last bdk_event_get_screen() change.

	* bdk/bdkevents.c: Couple of small fixes.

Wed Oct  2 17:36:42 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkevents.[ch] bdk/x11/bdkevents-x11.c: Add
	bdk_screen_set_screen()/_get_screen() which (by evil
	hacks) work for for heap allocated events and
	fall back gracefully for stack allocated events.

Wed Oct  2 08:47:31 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btksettings.[ch]: Privately export:
	_btk_settings_set_property_value_from_rc()
	_btk_settings_reset_rc_values() so that we can reset
	settings set from RC files when reloading RC files.
	(#94610)

	* btk/btkrc.c: Hook up RC file setting resetting.

Tue Oct  1 12:53:44 2002  Manish Singh  <yosh@gimp.org>

	* btk/btkwindow-decorate.c btk/btkwindow.[ch]: Deprecation cleanup

2002-10-01  jacob berkman  <jacob@ximian.com>

	* btk/btkinvisible.c: 
	* btk/btkclipboard.c: declare parent_class static

2002-10-01  Stanislav Brabec  <sbrabec@suse.cz>

	* btk/btkimcontextsimple.c: Fixed alphabetical order (bug #93421).

2002-10-01  Padraig O'Briain <padraig.obriain@sun.com>

	* btk/btkmenu.c: Add btk_menu_focus() so we do not waste time
	trying to focus a menu item. (bug #91258)

2002-09-30  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkpixmap-win32.c (bdk_pixmap_impl_win32_finalize):
	Set image->windowing_data to NULL, unref the image. (Late merge
	from stable.)

Mon Sep 30 15:45:49 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btklabel.c (btk_label_set_mnemonic_widget): 
	Make the reference to the mnemonic widget weak.
	(#93334, Murray Cumming)

Mon Sep 30 15:38:53 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkwindow.h: Remove a duplicate definition
	of bdk_set_sm_client_id().

Mon Sep 30 15:31:57 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkdisplay.c bdk/x11/bdkdisplay-x11.c 
	bdk/bdkinternals.h: Set the client ID on all
	displays. (#85713)

	* bdk/bdkdisplay.h gkd/bdkinternals.h
	 bdk/{linux-fb,win32,x11}/bdkmain-{fb,win32,x11}.c
	Privatize bdk_display_set_sm_client_id().

Mon Sep 30 14:46:49 2002  Owen Taylor  <otaylor@redhat.com>
 
 	* btk/btkbindings.c (btk_binding_set_new): Initialize
 	->parsed field. (#94536, patch from Sebastian Ritau. Maybe 
 	fixes #87411?)
 
Mon Sep 30 14:28:58 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwindow.[ch]: Add btk_window_set_icon_from_file(),
	btk_window_set_default_icon_from_file() convenience
	functions (#75178, suggestion from Havoc Pennington)

2002-09-30  Daniel Elstner  <daniel.elstner@gmx.net>

	* btk/btktextbuffer.c: Add construct-only property "tag_table"
	and make use of it in btk_text_buffer_new().  (#70227)

2002-09-30  Stanislav Brabec  <sbrabec@suse.cz>

	* btk/btkimcontextsimple.c: Completed ISO-8859-2 characters
	support (#93421), fixed cacute, umacron, completed dead_key+space
	convention.

Sun Sep 29 23:52:28 2002  Owen Taylor  <otaylor@redhat.com>

	* ===== Released 2.1.0 ======

	* NEWS: Updated

Sun Sep 29 20:20:26 2002  Owen Taylor  <otaylor@redhat.com>

        * btk/btktooltips.c (btk_tooltips_event_handler): Disable
        tooltips for menu items with submenus .. they still
        don't really work properly. (Missed merge from
	stable)

Sun Sep 29 20:15:59 2002  Owen Taylor  <otaylor@redhat.com>

       * btk/btkwindow.c (btk_window_move_resize): Clear
        initial_pos_set even if it only causes a move, not
        a resize as well. (Missed merge from stable,
	may fix #89562)

Sun Sep 29 14:22:47 2002 Manish Singh  <yosh@gimp.org>

	* contrib/bdk-pixbuf-xlib/Makefile.am demos/Makefile.am
	demos/btk-demo/Makefile.am: add deprecation compile flags

	* demos/testanimation.c demos/testpixbuf-save.c demos/testpixbuf.c
	demos/btk-demo/*.c bdk-pixbuf/bdk-pixbuf-animation.c
	bdk-pixbuf/bdk-pixbuf.c: minor cleanups, getting rid of
	unnecessary casts

Sun Sep 29 13:11:13 2002  Manish Singh  <yosh@gimp.org>

	* btk/btktypeutils.h: use #defines instead of enum for
	BtkFundamentalType compat, to prevent 64-bit vs. 32-bit
	confusion (#90400)

2002-09-29  Tor Lillqvist  <tml@iki.fi>

	* configure.in: Instead of forcing -fnative-struct into CFLAGS
	when using gcc for Win32, check for gcc version 3.x which uses
	-mms-bitfields instead. Also check if either of these switches is
	actually available at all, and warn if not. Thanks to Soren
	Andersen for the inspiration. (#93965)

2002-09-01  Soeren Sandmann  <sandmann@daimi.au.dk>

	* btk/btkimcontext.c, btk/btktreeviewcolumn.c:

	Minor documentation fixes. 
	(#80021, Yao Zhang; #75567, #75279, Vitaly Tishkov)

2002-09-28  Matthias Clasen  <maclas@gmx.de>

	* bdk/x11/bdkwindow-x11.c (_bdk_windowing_window_init): Make
	drawing to the root window work.  (#89492)

Fri Sep 27 18:14:00 2002  Owen Taylor  <otaylor@redhat.com>

	(#91249, Thomas Leonard)

	* btk/btkselection.c (btk_selection_convert): Initialize
	idle time to 0.

	* btk/btkselection.c: Up idle timeout to 5 minutes
	from 5 seconds.

Fri Sep 27 17:40:47 2002  Owen Taylor  <otaylor@redhat.com>

	* modules/input/Makefile.am: Patch from J. Ali Harlow
	to avoid generating btk.immodules when cross-compiling.
        (#87774)
	
Fri Sep 27 14:30:34 2002 Eric Warmenhoven <eric@warmenhoven.org>

	* bdk/Makefile.am bdk/bdkkeynames.c bdk/linux-fb/bdkmain-fb.c
	bdk/win32/bdkkeys-win32.c: Move bdk_keval_name and
	bdk_keyval_from_name to new bdkkeynames.c, share implementation for
	linux-fb and win32 (#94123)

	* bdk/linux-fb/Makefile.am bdk/linux-fb/bdkkeyboard-fb.c
	bdk/linux-fb/bdkmain-fb.c bdk/linux-fb/bdkmouse-fb.c: add
	-DG_DISABLE_DEPRECATED and -DBDK_PIXBUF_DISABLE_DEPRECATED to compile
	flags

	* bdk/linux-fb/bdkdisplay-fb.c: prevent segfault if display can't
	initialize

	* bdk/linux-fb/bdkkeyboard-fb.c: better parsing of keycodes

	* bdk/linux-fb/bdkwindow-fb.c: add stubs for new functions

Fri Sep 27 17:23:31 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkcolorsel.c: Fix some signed/unsigned warnings.
	(#85863, David L. Cooper II)

Fri Sep 27 16:23:49 2002  Owen Taylor  <otaylor@redhat.com>
	 
 	* btk/btklabel.c : Replaced instances where strlen (label->label) is
 	used to get a byte code with strlen (label->text) as label->text 
	contains the actual display text, while label->label contains
	markup / mnemonics. (#92683, Patch from Shivram U  
	<shivaram.upadhyayula@wipro.com>, with some additions.)

	* btk/btklabel.c (btk_label_set_uline_text_internal): 
	Fix a leftover, now incorrect comment.
	
Fri Sep 27 16:15:11 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btknotebook.c (btk_notebook_get_event_window_position):
	Handle the case where the first page isn't visible.
	(#81600, bug tracked down by Chema Celorio)

Fri Sep 27 15:57:15 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkstock.c (builtin_items): Change accelerator
	from C_ut to Cu_t. (#82747, Paolo Maggi)

Fri Sep 27 15:27:45 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkimage.c (btk_image_unrealize): Reset the
	animation iter on unrealize as well as unmap.
	(#94336)

	* btk/btkprogressbar.c (btk_progress_bar_set_text): Don't
	turn a value of "" into NULL. (#94157, Vitaly Tishkov)

Wed Sep 25 18:23:50 2002  HideToshi Tajima  <hidetoshi.tajima@sun.com>

	* modules/input/btkimcontextxim.c:
	- use btk_settings_get_for_screen () instead of
	  btk_settings_get_default () for multihead
	- connect property-notify signal handlers to respond runtime
	  changes of status_style and preedit_style in the settings
	- Some indentation and code cleanup (#59076 - 2nd check-in)
	
2002-09-24  Havoc Pennington  <hp@redhat.com>

	* btk/btkwindow.c: fix BtkWindowMnemonic to have a separate
	typedef

	* bdk/x11/bdkevents-x11.c (bdk_check_wm_state_changed): monitor
	FULLSCREEN state

	* tests/testbtk.c (get_state_controls): add
	fullscreen/unfullscreen test

	* bdk/bdkdisplay.c (bdk_display_finalize): fix unused variable

	* bdk/x11/bdkscreen-x11.c (init_xinerama_support): fix unused
	variable

	* bdk/x11/bdkevents-x11.c (bdk_xsettings_watch_cb): mop up unused
	variable

	* bdk/x11/bdkscreen-x11.c
	(_bdk_x11_screen_window_manager_changed): emit
	window_manager_changed signal

	* bdk/x11/bdkscreen-x11.h (struct _BdkScreenX11Class): add
	window_manager_changed signal

	* bdk/x11/bdkevents-x11.c
	(bdk_x11_screen_get_window_manager_name): new function

	* btk/btkwindow.c (btk_window_class_init): add type_hint,
	skip_taskbar_hint, skip_pager_hint properties
	(btk_window_set_skip_taskbar_hint):
	(btk_window_get_skip_taskbar_hint):
	(btk_window_set_skip_pager_hint):
	(btk_window_get_skip_pager_hint):
	(btk_window_fullscreen):
	(btk_window_unfullscreen): new functions

	* bdk/bdkevents.h (BdkWindowState): add FULLSCREEN state

	* bdk/bdkwindow.h (BdkWindowTypeHint): add missing type hint
	values

	* bdk/x11/bdkwindow-x11.c (bdk_window_set_skip_taskbar_hint):
	(bdk_window_set_skip_pager_hint):
	(bdk_window_fullscreen):
	(bdk_window_unfullscreen): new functions
	(set_initial_hints): set fullscreen here if appropriate
	
Wed Sep 25 10:51:24 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkscreen.h bdk/{x11,win32,linux-fb}/bdkscreen-*.c:
	Add bdk_screen_make_display_name(), which returns a
	display name that can be used to open a display with the
	screen as the default (Based on patch from Mark McLoughlin, 
	#86013)

Wed Sep 25 08:50:40 2002  Owen Taylor  <otaylor@redhat.com>

	Patch from Eric Warmenhoven, #94123

        * bdk/bdkmouse-fb.c: Add scrolling support for 
	imps2 mice.

	* bdk/linux-fb/bdkimage-fb.c: Fix compilation error
	in last bdkimage-fb.c commit.

Wed Sep 25 00:16:53 2002  Manish Singh  <yosh@gimp.org>

	* bdk/Makefile.am bdk/x11/Makefile.am: add -DG_DISABLE_DEPRECATED
	and -DBDK_PIXBUF_DISABLE_DEPRECATED to compile flags

	* bdk/bdkcolor.c bdk/bdkdisplay.c bdk/bdkdraw.c bdk/bdkevents.c
	bdk/bdkgc.c bdk/bdkimage.c bdk/bdkbango.c bdk/bdkpixbuf-render.c
	bdk/bdkpixmap.c bdk/bdkrgb.c bdk/bdkwindow.c bdk/linux-fb/bdkdnd-fb.c 
	bdk/linux-fb/bdkfont-fb.c bdk/win32/bdkdnd-win32.c
	bdk/win32/bdkfont-win32.c bdk/x11/bdkdisplay-x11.c bdk/x11/bdkdnd-x11.c
	bdk/x11/bdkdrawable-x11.c bdk/x11/bdkevents-x11.c bdk/x11/bdkfont-x11.c
	bdk/x11/bdkgc-x11.c bdk/x11/bdkgeometry-x11.c bdk/x11/bdkim-x11.c
	bdk/x11/bdkinput-x11.c bdk/x11/bdkkeys-x11.c bdk/x11/bdkscreen-x11.c
	bdk/x11/bdkwindow-x11.c: Deprecation cleanup, mostly changing
	bdk_foo_{ref,unref} to g_object equivalents.

Tue Sep 24 23:54:20 2002  Manish Singh  <yosh@gimp.org>

	* btk/btkfilesel.c: check if last_selected is valid before doing
	a strcmp on it, which may happen if selections happen programmatically
	instead of through the UI (#86566)

Tue Sep 24 23:33:48 2002  Manish Singh  <yosh@gimp.org>

        * btk/btkfilesel.c: preserve ordering from btk_tree_selection_foreach
	when returning filenames for btk_file_selection_get_selections
	(#86567)

	* btk/btkclipboard.c: BtkClipboard struct should have a GObject
	in it, not a GObjectClass

Tue Sep 24 18:18:36 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkclipboard.[ch]: Make a GObject (#75970, James
	Henstridge)

Tue Sep 24 19:45:55 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkwindow-x11.c (bdk_window_impl_x11_get_colormap): 
	Look up the visual as well as the colormap, since calling
	bdk_drawable_get_visual() causes infinite recursion.

	* bdk/x11/bdkwindow-x11.c (_bdk_windowing_window_init): 
	Set the colormap for the root window.

Tue Sep 24 15:35:42 2002  HideToshi Tajima  <hidetoshi.tajima@sun.com>

	disable/enable preedit/status in BtkIMContextXIM (#59076)
	
	* btk/btkenums.h (enum): added preedit/status styles for btk+
	input method
	* modules/input/btkimcontextxim.c
	* bdk/x11/bdkevents-x11.c: add btk-im-preedit-style and
	btk-im-status-style to BtkSettings.
	* po/POTFILES.in: added modules/input/btkimcontextxim.c

	With the other patch for gnome-control-center,
	the preedit and status styles of BTK+ input method are
	configurable with associated gconf schemas keys:
	"/desktop/gnome/interface/btk-im-preedit-style"
	"/desktop/gnome/interface/btk-im-status-style"

	Both are set to "callback" by default, and platform's 
	packging can have different default by changing
	libgnome's desktop_gnome_interface.schemas.

2002-09-25  Matthias Clasen  <maclas@gmx.de>

	* bdk/x11/bdkvisual-x11.c (bdkx_visual_get): Replace leftover 
	bdkx_visual_get_for_screen () by bdk_x11_screen_lookup_visual().

	* btk/btkaccelgroup.h: Add a missing ; to make things compile.

	* bdk/x11/bdkwindow-x11.c (bdk_window_impl_x11_get_colormap):
	Replace leftover bdk_colormap_lookup () by
	bdk_x11_colormap_foreign_new () to make the linker happy.

Tue Sep 24 17:49:52 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkaccelgroup.[ch] (btk_accel_group_find): 
	Add a BtkAccelGroupFindFunc to clean up the
	prototype. (#76670, Vitaly Tishkov)

	* bdk/x11/bdkvisual-x11.c bdk/x11/bdkx.h: Rename
	bdkx_visual_get_for_screen() to 
	bdk_x11_screen_lookup_visual(). (#85702)

2002-09-25  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkevents-win32.c (bdk_event_translate):
	WM_SYSKEYDOWN, WM_SYSKEYUP: Need to handle F10 specially here in
	order to be able to handle it normally in the application. Set
	ignore_wm_char also always when handling WM_SYSKEY{DOWN,UP}, this
	way we can generate BDK events also for Alt-Fn keys, for instance.

2002-09-24  Matthias Clasen  <maclas@gmx.de>

	* bdk/x11/bdkx.h: Add a missing ; to make things compile.

Tue Sep 24 16:40:14 2002  Owen Taylor  <otaylor@redhat.com>

	Make icon sizes configurable (#70648, slightly based
	on a patch from Bill Haneman, Brian Cameron)

	* btk/btkiconfactory.[ch]: Add 
	btk_icon_size_lookup_for_settings().

	* btk/btksettings.c: Add btk-icon-sizes XSETTING

	* btk/btkiconfactory.c: Make icon sizes per-BtkSettings.

	* btk/btkstyle.c: Use btk_icon_size_lookup_for_settings()

	* btk/btkrc.[ch]: Privately export _btk_rc_reset_styles()
	to force all the widgets to recompute their appearance.

	* bdk/x11/bdkevents-x11.c: Add btk-icon-sizes XSETTING

Tue Sep 24 16:24:22 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/win32/bdkimage-win32.c bdk/x11/bdkimage-x11.c 
	* bdk/linux-fb/bdkimage-fb.c (bdk_image_put/get_pixel): 
	Add bounds-checking g_return_if_fail(). (Olexiy Avramchenko)

Tue Sep 24 16:04:44 2002  Owen Taylor  <otaylor@redhat.com>

	* bdkprivate-x11.h bdkcolor-x11.c bdkvisual-x11.c
	bdkwindow-x11.c: Delete unused private bdk_visual_lookup(),
	make bdk_colormap_lookup() private bdkcolor-x11.c.
	make bdk_window_add_colormap_windows private to bdkwindow-x11.c
	(#85674)

	* bdk/x11/bdkx.h bdk/x11/bdkcolor-x11.c 
	bdkscreen-x11.h: Add bdk_x11_colormap_foreign_new(), 
	BDK_ENABLE_BROKEN bdkx_colormap_get(), make the
	colormap hash per-screen. (#85697)

	* bdk/x11/bdkxid.c (bdk_xid_table_lookup_for_display):
	Remove a bit of unecessary code.

Thu Aug  8 16:58:22 2002  Owen Taylor  <otaylor@redhat.com>
 
 	* btk/btkspinbutton.c (btk_spin_button_real_change_value): 
 	Remove the check for editable. (Reported by Brent Fox)
 
Tue Sep 24 06:17:37 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkeventbox.c (btk_event_box_paint): Honor
	BTK_WIDGET_APP_PAINTABLE() (#92305, Jonathan Blandford.)

Tue Sep 24 05:26:31 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdk.h bdk/bdkdisplay.c bdk/linux-fb/bdkevents-fb.c 
	bdk/x11/bdkevents-x11.c  bdk/win32/bdkevents-win32.c:
	Change the window parameter for 
	bdk_event_send_client_message[_for_display] from guint32
	to BdkNativeWindow. (#79979)

Tue Sep 24 05:16:25 2002  Owen Taylor  <otaylor@redhat.com>

	* btk+.spec.in: Fix up a bit to look for the loaders
	in the right place. (#93011, Dennis Dementiev)

Tue Sep 24 05:12:14 2002  Owen Taylor  <otaylor@redhat.com>

        * btk/btkimcontextsimple.c: Fixes to BtkIMContextSimple
        compose table for us-intl keyboards (Red Hat bugzilla
        #70995, Alexandre Oliva)

Tue Sep 24 04:50:28 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkspinbutton.c (btk_spin_button_activate):   
	Chain up so that entry->activates_default is honored.
	(#93865, Pieter Penninckx)

2002-09-23  Jacob Berkman  <jacob@ximian.com>

	* btk/btkprogress.c (DEFAULT_FORMAT): cpp macros aren't ``;''
	terminated

Mon Sep 23 19:49:11 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkselection.[ch] btk/btkwidget.c btk/btkmain.c:
	Privatize btk_selection_request, btk_selection_incr_event
	btk_selection_notify, btk_selection_property_notify.
	Add doc note about future deprecation of btk_selection_clear()
	which. (#85683)

	* btk/btkoldeditable.c (btk_old_editable_selection_clear):
	Chain up, rather than calling btk_selection_clear().

Mon Sep 23 18:53:35 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkprogressbar.c (btk_progress_bar_set_text): 
	Restore back to the default format instead of an
	empty format. (#82626, Tim Janik)

	* btk/btkprogress.c (btk_progress_set_format_string): 
	Make NULL restore back to the default format.

Mon Sep 23 18:45:46 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmenuitem.c (btk_menu_item_set_accel_path): 
	Allow accel_path == NULL. (#84241, James Henstridge.)

Mon Sep 23 18:01:52 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btknotebook.[ch]: Add btk_notebook_get_n_pages
	(#73229, Havoc Pennington)

	* btk/btknotebook.c (btk_notebook_get_nth_page): Handle
	-1 to mean the last page, as we do elsewhere. (#73229)

Mon Sep 23 17:50:23 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmenushell.[ch] btk/btkentry.c btk/btkmenubar.c
	btk/btkmenuitem.c btk/btktextview.c: Make
	btk_menu_shell_select_first() public. (#70373)

Mon Sep 23 16:48:46 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkkeys.[ch] bdk/x11/bdkkeys-x11.c bdk/x11/bdkevents-x11.c:
	Add a keys_changed signal emitted when the keymap changes.
	(#72148)
	
	* btk/btkkeyhash.c (_btk_key_hash_remove_entry): 
	Hook up code to handle keymap changes, change to keep
	a linked list of keymap entries so that we can reinsert
	them in the same order on a keymap change.

Mon Sep 23 14:58:04 2002  Owen Taylor  <otaylor@redhat.com>
 
 	* btk/btkhandlebox.h btk/btktextbtree.[ch]:
 	Use 'signed int' not 'gint' for signed bitfields.
 	(#93020, Vitaly Tishkov)
 
 	* btk/btktextlayout.h btk/btktextbtree.[ch]: 
 	Fix some 'gint' bitfields that should have been
 	unsigned.
	
Mon Sep 23 12:24:14 2002  Owen Taylor  <otaylor@redhat.com>

	* modules/input/btkimcontextxim.c (status_window_get): 
	Fix incorrect usage of bdk_get_default_root_window ()).
	(#92767)

Mon Sep 23 12:12:48 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkspinbutton.c: Patch from Joshua N Pritikin to
	fix problem where signal connection wasn't removed
	from adjustment on finalize. (#93962)

Sun Sep 22 18:22:37 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/linux-fb/{bdkinput.c,bdkkeyboard-fb.c,bdk/linux-fb/bdkmain-fb.c,
	bdk/linux-fb/bdkprivate-fb.h, bdk/linux-fb/bdkwindow-fb.c}:
	Patch from Eric Warmenhoven to with miscellaneous linux-fb
	fixes, including a fix for a crash in 
	bdk_keymap_get_entries_for_keycode (#87420)

2002-09-22  Matthias Clasen  <maclas@gmx.de>

	* bdk/bdkdraw.c (bdk_drawable_get_type): 
	* bdk/bdkgc.c (bdk_gc_get_type): 
	* btk/btkmenushell.c (btk_menu_shell_get_type): 
	* btk/btkimcontext.c (btk_im_context_get_type): 
	* btk/btkprogress.c (btk_progress_get_type): 
	* btk/btkoldeditable.c (btk_old_editable_get_type): 
	* btk/btkcellrenderer.c (btk_cell_renderer_get_type): 
	* btk/btkwidget.c (btk_widget_get_type): 
	* btk/btkseparator.c (btk_separator_get_type): 
	* btk/btkscrollbar.c (btk_scrollbar_get_type): 
	* btk/btkscale.c (btk_scale_get_type): 
	* btk/btkrange.c (btk_range_get_type): 
	* btk/btkpaned.c (btk_paned_get_type): 
	* btk/btkmisc.c (btk_misc_get_type): 
	* btk/btkitem.c (btk_item_get_type): 
	* btk/btkcontainer.c (btk_container_get_type): 
	* btk/btkbbox.c (btk_button_box_get_type): 
	* btk/btkbox.c (btk_box_get_type): 
	* btk/btkbin.c (btk_bin_get_type): 
	* btk/btkobject.c (btk_object_get_type): Mark abstract types as
	G_TYPE_FLAG_ABSTRACT.  (#72383)

2002-09-21  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkselection-win32.c (sanitize_utf8): Copy from X11
	backend. The old version mishandled consecutive newlines.

	* tests/testbtkrc: Remove obsolete mention of btk-engines and
	Pixmap theme engine on Win32.

Fri Sep 20 18:01:26 2002  Owen Taylor  <otaylor@redhat.com>
 
 	* btk/btkentry.c (btk_entry_unrealize): Set the IM
 	context client 	window to NULL, not to the window that 
 	is about to be destroyed. (#88231)
 
Fri Sep 20 16:56:54 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkrc.c (btk_rc_reparse_all_for_settings):
	Return TRUE if force_load was specified. (#93738,
	Vitaly Tishkov.)

2002-09-20  Tor Lillqvist  <tml@iki.fi>

	* btk/btkmain.c (btk_get_default_language): On Win32, look
	explicitly for LANG, LC_ALL and LC_CTYPE, and if not found, use
	g_win32_getlocale(). The setlocale() in msvcrt.dll would return a
	locale name in the form Swedish_Finland for sv_FI.

	* bdk/bdkfont.h: Delete leftover declarations of the obsolete
	Win32-only functions bdk_font_full_name_get() and
	bdk_font_full_name_free().

	* bdk/bdk.def: Delete from here, too.

	* bdk/win32/bdkfont-win32.c (logfont_to_xlfd,
	bdk_font_full_name_get, bdk_font_full_name_free): Delete
	implementation, and helper functions.

	(pattern_match, InnerEnumFontFamExProc, EnumFontFamExProc,
	bdk_font_list_new, bdk_font_list_free): Delete unused functions.

	(bdk_text_width, bdk_text_width_wc) Instead of code duplication,
	let bdk_text_extents() and bdk_text_extents_wc() do the job.
	
	* bdk/win32/bdkgc-win32.c (bdk_win32_gc_values_to_win32values):
	Don't use the above removed functions in debugging output.

	* bdk/win32/bdkdisplay-win32.c
	* bdk/win32/bdkmain-win32.c
	* bdk/win32/bdkprivate-win32.h
	* bdk/win32/bdkselection-win32.c
	* bdk/win32/bdkinput-win32.h
	* bdk/win32/bdkinput.c: Make it compile again, pass a BdkDisplay in
	a couple of places.

Thu Sep 19 16:39:29 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btksettings.h (BTK_SETTINGS_GET_CLASS): Fix 
	usage of compat BTK_TYPE_ macros without including
	btkobject.h.

	* bdk/x11/bdkevents-x11.[ch]: Set a flag when initializing
	to avoid having extra settings-notify events sent
	when not needed.

2002-09-17  Matthias Clasen  <maclas@gmx.de>

	* btk/stock-icons/stock_color_picker_25.png:
	* btk/stock-icons/Makefile.am (VARIABLES1): 
	* btk/btkstock.h (BTK_STOCK_COLOR_PICKER): 
	* btk/btkiconfactory.c (get_default_icons):  
	* btk/btkcolorsel.c (btk_color_selection_init): Stockify color
	picker icon.   (#89880)

2002-09-14  Sven Neumann  <sven@gimp.org>

	* bdk/bdkpixbuf-drawable.c: fixed my latest change.

2002-09-13  Sven Neumann  <sven@gimp.org>

	* bdk/bdkpixbuf-drawable.c: use the most significant bits of the
	BdkColor components (#89703).

2002-09-12  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkinput-win32.c (bdk_input_wintab_init): Use correct
	function name in warning messages.

	Merge from btk-2-0:

	* bdk/win32/bdkdrawable-win32.c
	* bdk/win32/bdkevents-win32.c: Some spacing and indentation cleanup.
	
	* bdk/win32/bdkdrawable-win32.c (render_line_horizontal,
	render_line_vertical): Return TRUE.
	
	* bdk/win32/bdkevents-win32.c (_bdk_events_init): Search if the
	system has some input locale identifier that uses a Latin
	keyboard. This is needed to be able to get the virtual-key code
	for the latin characters corresponding to ASCII control
	characters. If no such keyboard is present, try to load one
	then. Will this upset users with no wish to ever use a Latin-based
	keyboard layout?

	(vk_from_char): Convert all ASCII control chars to the
	corresponding uppercase char before calling VkKeyScanEx(). Idea by
	Florent Duguet. Makes Control-C work again. To make it hopefully
	work like I think it should on non-Latin keyboards, too, use
	latin_locale when looking for the corresponding keycode.

	* bdk/win32/bdkgeometry-win32.c: Add BDK_NOTE debugging output
	to some functions, related to moving and resizing and expose
	and antiexpose queue processing. Use %p to output HWNDs.

	* bdk/win32/bdkkeys-win32.c (print_keysym_tab): Factor out
	debugging output to new function.

	Fix for #81831 by Tim Evans:
	
	* bdk/win32/bdkevents-win32.c (bdk_event_translate): Don't call
	_bdk_event_button_generate() here, it would append the double- or
	triple-click events too early, before the single-click event.

	(real_window_procedure): If we got a single-click event, call
	_bdk_event_button_generate() to perhaps append the double- or
	triple-click event after that.

	Tentative fix for #79720 based on code by Florent Duguet:
		
	* bdk/win32/bdkgeometry-win32 (bdk_window_queue_append): New
	static function. Checks length of translate_queue, calls
	_bdk_window_process_expose() if length is >= 128. Then appends
	to translate_queue.
	(bdk_window_queue_translation,_bdk_windowing_window_queue_antiexpose):
	Call bdk_window_queue_append().

	Merge from btk-1-3-win32-production and btk-2-0:

	* bdk/win32/bdkevents-win32.c (propagate): Check for parent being
	NULL before trying to propagate to it, and return FALSE in that
	case. (If parent is NULL, we are handling bdk_parent_root, and
	probably should have noticed that and bailed out earlier. But
	better late than never.)

	* bdk/win32/bdkinput-win32.c (bdk_input_init): Use
	GetSystemMetrics (SM_C[XY]SCREEN) instead of
	bdk_screen_{width,height}().

	* bdk/win32/bdkselection-win32.c (bdk_selection_convert): Don't
	use return value from GlobalSize() as length of string when
	calling MultiByteToWideChar(). Pass -1 instead (zero-terminated
	string). Thanks to Iwasa Kazmi.

Wed Sep 11 15:48:38 2002  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreemodel.c (btk_tree_row_reference_get_type): Make
	BtkTreeRowReference a boxed type.

	* btk/btkliststore.c (btk_list_store_finalize): free the root
	list.

	* btk/btktreestore.c (btk_tree_store_finalize): free the root
	nodes.

Wed Sep 11 12:33:34 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* btk/btkstyle.c: Draw radio buttons more symmetric. Draw shadow
	out bevels slightly different. Fix drawing of top right corner of
	etched in shadows.

Tue Sep 10 09:47:52 2002  HideToshi Tajima  <hidetoshi.tajima@sun.com>

	* modules/input/btkimcontextxim.c
	(get_im): modify a warning when XSetLocaleModifiers() fails, and
	add a warning when XOpenIM() fails
	(btk_im_context_xim_filter_keypress): use XLookupString when xic
	is not available. (#90661)
	(btk_im_context_xim_get_ic, btk_im_with_preedit,
	btk_im_without_preeedit): filter key release events only when
	input methods ask for (#81759)

Tue Sep 10 11:11:09 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/linux-fb/*: Patch from Eric Warmenhoven to
	get linux-fb compiling with multihead changes.

Tue Sep 10 09:29:00 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkevents-x11.c (bdk_event_translate): Take
	focus mode into account when tracking FocusIn/Out events,
	so we don't get confused by focus changes while a 
	keyboard grab is in effect. (Probably fixes #90563)

Mon Sep  9 16:16:25 2002  Shivram U  <shivaram.upadhyayula@wipro.com>

	* btk/btktextview.c (btk_text_view_drag_motion): If the end iter
	is also a part of the selection, then we are in the selection.
	(#92768)

2002-09-08  Tor Lillqvist  <tml@iki.fi>

	* configure.in: Add AM_CONDITIONAL calls also in the non-x11
	branch. Otherwise we get "conditional \"$1\" was never defined.
	Usually this means the macro was only invoked conditionally."
	errors when running configure if using automake 1.6a. Yeah, I know
	that autogen.sh says to use automake 1.4, but on Win32 I more or
	less have to use the bleeding edge. I think.

Sat Sep  7 21:24:55 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* btk/btktoolbar.c (get_button_relief): call
	btk_widget_ensure_style() before reading "button_relief". Fixes
	(#92741).

2002-09-06  Matthias Clasen  <maclas@gmx.de>

	* configure.in: Add ani to all_loaders.

Fri Sep  6 15:59:54 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkdisplay.h: Remove unused prototype for 
	bdk_set_default_display 
	(=> bdk_display_manager_set_default_display)
	(#90616, Matthias Clasen)

Fri Sep  6 15:35:01 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkgc.c (bdk_gc_new_with_values): Only set
	gc->colormap if it isn't already set. (Alex Larsson,
	#90632)

Fri Sep  6 12:41:16 2002  Owen Taylor  <otaylor@redhat.com>

	* modules/input/btkimcontextxim.c: Pass the actual input
	keycode to XIM, rather than the result of backconverting
	the keysym. Fixes the <> input problem! (#74922)

	* btk/btkimmodule.c: Fix bug where BTK_IM_MODULE environment
	variable couldn't be used to force the input method to
	the default input method.

2002-09-05  jacob berkman  <jacob@ximian.com>

	* configure.in: fix non-solaris xinerama checks (bug #89732)

	* autogen.sh: get automake-1.4 changes from -2-0 branch

2002-09-05  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkproperty-win32.c (bdk_property_change): Fix braino,
	actually do check each char, not just the first one, when looping
	through the text looking to insert CR in front of each LF. Bug
	noticed and fix provided by Florent Duguet.

	* bdk/win32/bdkwindow-win32.c (bdk_window_set_transient_for): 
	Use HWND_NOTOPMOST instead of HWND_TOPMOST. Suggested by Florent
	Duguet.

2002-09-04  Matthias Clasen  <maclas@gmx.de>

	* demos/testanimation.c (do_image): 
	(do_nonprogressive): Quit on destroy.

	* demos/testpixbuf.c (main): test load-at-size.
	(expose_func): draw transparent pixbufs against a checkerboard 
	pattern. (#91829)

2002-09-01  Soeren Sandmann  <sandmann@daimi.au.dk>

	* docs/reference/btk/tmpl/btkdialog.sgml
	docs/reference/btk/tmpl/btkhbbox.sgml
	docs/reference/btk/tmpl/btkvbbox.sgml
	docs/reference/btk/tmpl/btktogglebutton.sgml
	docs/reference/btk/tmpl/btktreeselection.sgml
	btk/btktextbuffer.c
	btk/btktogglebutton.c
	btk/btktreesortable.c

	Minor documentation fixes:
	
	#79107, #82854, #76398, Vitaly Tishkov; 
	#88627, Brian Tarricone;
	#81046, Owen Taylor

2002-08-31  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkevents-win32.c (_bdk_events_init): On Cygwin, open
	/dev/windows instead of using the magic G_WIN32_MSG_HANDLE fd that
	is implemented (in GLib) only on native Win32. (#91683, Masahiro
	Sakai)

	* btk/btkfilesel.c: Include <sys/cygwin.h on Cygwin, for
	cygwin_conv_to_posix_path().
	(translate_win32_path, get_real_filename): Use
	cygwin_conv_to_posix_path().
	(btk_file_selection_dir_activate): Call get_real_filename() here,
	too. (#91843, Masahiro Sakai)

2002-08-26  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkwindow-win32.c (RegisterBdkClass): Use MAX_PATH
	(from windef.h) insted of _MAX_PATH (from stdlib.h in mingw and
	MSVC, but not there in Cygwin) (#91681, Masahiro Sakai).

Mon Aug 26 12:21:16 BST 2002  Tony Gale <gale@btk.org>

	* docs/tutorial/package-db-tutorial.sh: cleanups

	* docs/tutorial/btk-tut.sgml: new content for the
	ItemFactory section. Originally from Robert Cleaver Ancell.

2002-08-25  Tor Lillqvist  <tml@iki.fi>

	* btk/btkfilesel.c: Don't include <winsock.h> on Cygwin (#91654,
	Masahiro Sakai).

	* btk/btkmain.c: Compile btk_init_abi_check and
	btk_init_check_abi_check when on G_PLATFORM_WIN32, not just on
	G_OS_WIN32, to match btkmain.h (#91649, Masahiro Sakai).
	(check_sizeof_BtkWindow, check_sizeof_BtkBox): Mention the
	-mms-bitfields swicth in addition to -fnative-struct.

Sun Aug 25 11:58:27 BST 2002  Tony Gale <gale@btk.org>

	* docs/tutorial/package-db-tutorial.sh:
	update packaging script for current tutorial

	* docs/tutorial/images/*.eps: New Files
	EPS versions of the tutorial images

2002-08-25  Tor Lillqvist  <tml@iki.fi>

	* btk/btkmain.h: Include btkbox.h and btkwindow.h on Win32, as the
	defines for struct packing checks use sizeof() on stuff from
	these. (#84211, Andreas Holzmann)

	* btk/Makefile.am (libbtk_win32_2_0_la_DEPENDENCIES): Add
	btk_win32res_lo. (#87101, J. Ali Harlow)

	* bdk/bdkevents.c
	* bdk/bdkinternals.h
	* bdk/x11/bdkevents-x11.c
	* bdk/win32/bdkevents-win32.c: Move the BdkEventPrivate and
	BdkEventFlags definitions from bdkevents.c to
	bdkinternals.h. Remove the duplicated definitions in
	bdkevents-x11.c and bdkevents-win32.c. (#89771)

2002-08-24  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkevents-win32.c (bdk_event_translate): Let the
	system handle Alt-Space, too. Thanks to Tim Evans (#91477).

Sat Aug 24 12:46:37 BST 2002  Tony Gale <gale@btk.org>

	* docs/tutorial/btk-tut.sgml, examples/*:
	update g_connect_signal usage

	* docs/faq/btk-faq.html: spelling/grammar fixes

2002-08-21  Tor Lillqvist  <tml@iki.fi>

	* bdk/Makefile.am: Move BDK_DEP_LIBS from LDFLAGS to each of the
	libbdk_*_LIBADD, to fix problems when cross-compiling, as
	suggested by J. Ali Harlow in #87103.

2002-08-19  Padraig O'Briain <padraig.obriain@sun.com>

	* btk/btkentry.c (btk_entry_real_delete_text): Use 
	btk_entry_set_positions() to update current_pos and selection_bound
	so notifications are emitted (#90548)

2002-08-16  jacob berkman  <jacob@ximian.com>

	* btk/btkdialog.h (struct _BtkDialog): switch vbox and action_area
	back to the order that 2.0 has

Thu Aug 15 22:46:02 BST 2002  Tony Gale <gale@btk.org>

	* docs/tutorial/btk-tut.sgml, examples/menu/menu.c:
	  minor menu example comment fix
	  (feeling my way back in after a long absence)

Wed Aug 14 08:07:53 2002  HideToshi Tajima  <hidetoshi.tajima@sun.com>

	* btk/btkselection.c (btk_selection_init): initialize
	btk_selection_atoms only once at the 1st call.
	* bdk/x11/bdkselection-x11.c (bdk_selection_property_get): 
	set length of selection data from number of read bytes (#90595)

2002-08-14 Padraig O'Briain <padraig.obriain@sun.com>

	* btk/btktextview.c (btk_text_view_focus): Move focus to
	children, if they exist, after BtkTextView is focused. (#63844)

2002-08-12  Matthias Clasen  <maclas@gmx.de>

	* bdk/bdkdisplaymanager.c: 
	* bdk/bdkdisplay.c (bdk_pointer_ungrab): Fix doc comments.

	* bdk/x11/bdkcolor-x11.c (bdk_colormap_get_screen): 
	* bdk/x11/bdkimage-x11.c (bdk_image_new_bitmap): Make parameter 
	names match those in the header file, to silence btk-doc.

Sat Aug 10 22:18:05 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkpixbuf-render.c 
	(bdk_pixbuf_render_pixmap_and_mask[_for_colormap]): Mention
	in the docs that @pixmap_return and @mask_return can
	be %NULL.

2002-08-10  Soren Sandmann  <sandmann@daimi.au.dk>

	* docs/reference/btk/tree_widget.sgml,
	docs/reference/btk/tmpl/btkdialog.sgml,
	docs/reference/btk/tmpl/btkentry.sgml,
	docs/reference/btk/tmpl/btkfilesel.sgml,
	docs/reference/btk/tmpl/btkfontsel.sgml,
	docs/reference/btk/tmpl/btkfontseldlg.sgml,
	docs/reference/btk/tmpl/btktreemodel.sgml,
	docs/reference/btk/tmpl/btkwidget.sgml, bdk/x11/bdkdisplay-x11.c,
	btk/btkbbox.c, btk/btkbox.c, btk/btkbutton.c, btk/btkcellrenderer.c,
	btk/btkcellrendererpixbuf.c, btk/btkcellrenderertext.c,
	btk/btkcheckmenuitem.c, btk/btkcontainer.c, btk/btkcurve.c,
	btk/btkdialog.h, btk/btkentry.c, btk/btkfilesel.c, btk/btkfontsel.c,
	btk/btkframe.c, btk/btkhandlebox.c, btk/btkiconfactory.c,
	btk/btkimage.c, btk/btkinvisible.c, btk/btkitemfactory.c,
	btk/btklabel.c, btk/btklayout.c, btk/btkmenu.c, btk/btkprogress.c,
	btk/btkprogressbar.c, btk/btkscrolledwindow.c, btk/btksizegroup.c,
	btk/btktable.c, btk/btktextiter.c, btk/btktexttag.c, 
	btk/btktexttag.h, btk/btktextview.c, btk/btktogglebutton.c, 
	btk/btktoolbar.c, btk/btktreemodel.c, btk/btktreeselection.c, 
	btk/btktreestore.c, btk/btktreeview.c, btk/btktreeviewcolumn.c, 
	btk/btkviewport.c, btk/btkwidget.c, btk/btkwidget.h,
	btk/btkwindow.c: 

	Minor documentation fixes

	(#89254, patch from Brett Nash; 
	 #85809, patch from daten@dnetc.org;
	 #76391, patch from Ross Burton; 
	 #74559, Manuel Clos; 
	 #73569, #72005, Alexey A. Malyshev; 
	 #70061, patch from Dennis Bj"orklund;
	 #64566, #63388, #58328, #57499, #81007, #77349, Vitaly Tishkov; 
	 #78932, Vitaly Tishkov, patch from Ross Burton;
	 #73306)

2002-08-10  Matthias Clasen  <maclas@gmx.de>

	* bdk/bdkrgb.c (bdk_rgb_try_colormap): 
	(bdk_rgb_create_info): 
	(bdk_rgb_select_conv): 
	(bdk_draw_gray_image): 
	(bdk_rgb_cmap_get_info): Changes to support depth 8 StaticColor
	visuals.  (#81631)
	(bdk_rgb_cmap_free): Don't loop forever.

Fri Aug  9 08:04:47 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkdisplay.h (struct _BdkDisplayClass): Fix 
	weird usage of 'class' for BdkDisplay * argumnent name.
	(#9031, Laszlo Peter)

Thu Aug  8 23:26:05 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkmain-x11.c bdk/x11/bdkscreen-x11.c: Remove
	explicit calls to bango_x/xft_shutdown_display() since
	Bango now does it by itself on XCloseDisplay().

Thu Aug  8 21:53:16 2002  Owen Taylor  <otaylor@redhat.com>

	* configure.in: Consistently order bangoxft / bangox
	in pkg-config calls in hopes of reducing problems
	(Eric Mader.)

2002-08-07  Matthias Clasen  <maclas@gmx.de>

	* btk/btkmain.c (btk_init): Fix doc comment.

	* btk/btktreemodel.c (btk_tree_path_new_from_indices): Make the
	doc comment btk-doc-grokkable.

2002-08-06  jacob berkman  <jacob@ximian.com>

	* configure.in: link bdk-pixbuf-xlib against x libs (bug #83442)

Mon Aug  5 17:20:45 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btklabel.c: Patch from Soeren Sandmann
	to improve BtkLabel behavior when it gets
	a too small allocation. (Always display the
	initial portion.) (#71742)

Mon Aug  5 17:01:30 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/Makefile.am (LDFLAGS): When overriding LDFLAGS,
	include @LDFLAGS@, otherwise LDFLAGS the users passes
	to configure don't get used. (#89946, Noah Levitt, 
	Albert Chin)

	* bdk/linux-fb/Makefile.am: Remove LDFLAGS setting.

Mon Aug  5 15:25:40 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkpixbuf-render.c (bdk_pixbuf_render_pixmap_and_mask_for_colormap): 
	Fix problem with wrong depth being used. (#89941, Jacob
	Berkman.) Remove an unneeded 'screen' variable.

Mon Aug  5 15:04:59 2002  Owen Taylor  <otaylor@redhat.com>

	More fixes for warnings reported by David L. Cooper II

	* btk/btkaccelmap.c (accel_map_parse_accel_path): Use
	BdkModifierType for accel_mods. (#85856)

	* bdk/bdkdisplay.h (struct _BdkDisplay): Make button_number
	signed, since we use -1 as an 'unset' value. (#85854)

	* bdk/x11/xsettings-client.c (parse_settings): Suppress
	a warning (#85853)

	* bdk/x11/bdkfont-x11.c (bdk_font_charset_for_locale): Fix
	accidental trailing ';'. (#85846)

Mon Aug  5 14:50:13 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkitemfactory.h: Add a note that yes, we do know
	what () means and we can't change it.

	Fixes for warnings reported by David L. Cooper II

	* tests/testtext.c: Warning fixes. Fix order of arguments
	to btk_message_dialog_new(). (#85891)

	* btk/btktreeitem.c (btk_tree_item_paint): Fix incorrect
	use BTK_STATE_INSENSITIVE for a shadow type. (Not clear
	what the drawing intent was, but it's ENABLE_BROKEN
	anyways.) (#85880)

	* btk/btktexttypes.c: Use character literals
	instead of direct constants to avoid warning. (#85878)

	* btk/theme-bits/decompose-bits.c btk/btkstyle.c:
	Fix some signed/unsigned problems (#85876)

	* btk/btksignal.c (btk_signal_newv): Add an explicit
	cast from BtkSignalRunType to GSignalFlags. (#85875)

	* btk/btkitemfactory.c (btk_item_factory_add_item): Fix
	use of guint instead of BdkModifierType (#85871)

	* btk/btkimmulticontext.c (btk_im_multicontext_append_menuitems): 
	Fix signed/unsigned problem (#85870)

	* btk/btkimcontext.c (btk_im_context_class_init): Get
	rid of BtkType/Signal*. (Fixes #85869 as a side effect)

	* btk/btkdnd.c (btk_drag_get_cursor): Fix some 
	signed/unsigned warnings (#85865)

2002-08-04  Matthias Clasen  <maclas@gmx.de>

	* btk/btkmain.c (btk_check_version): Fix for binary compatibility
	across 2.x.y.

Fri Aug  2 18:00:46 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmenu.c: Fix menus resizing dynamically while
	they are popped up or torn off. (#78949)

Fri Aug  2 16:38:34 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkrebunnyion-generic.c: Comprehensively add
	g_return_[val]if_fail() statements. (#89491, Robin Lu)

Fri Aug  2 16:24:32 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkmain-x11.c: Remove references to 
	bdk_initialized (#81060, Jacob Berkman)
	
	* bdk/bdk.c (bdk_exit): Remove bdk_exit_func().

Fri Aug  2 15:56:47 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkscreen-x11.c (bdk_screen_x11_dispose): Fix
	args to bango_x_shutdown_display().

	* bdk/linux-fb/bdkinput.c bdk/linux-fb/bdkinputprivate.h
	bdk/win32/bdkinput-win32.[ch] bdk/win32/bdkinput.c
	bdk/win32/bdkwindow-win32.c bdk/x11/bdkinput-x11.c
	bdk/x11/bdkinput-xfree.c bdk/x11/bdkinput.c
	bdk/x11/bdkinputprivate.h bdk/x11/bdkwindow-x11.c: Move
	a bunch of functions bdk_input => _bdk_input. Clean
	up some header file cruft. (#79971)

Fri Aug  2 12:21:41 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkscreen-x11.c (bdk_screen_x11_dispose):
	Call bango_x[ft]_shutdown_display().

2002-08-02  jacob berkman  <jacob@ximian.com>

	* bdk/x11/bdkscreen-x11.c (check_xfree_xinerama): declare
	screen_x11 variable to fix build w/ xinerama

Fri Aug  2 00:43:15 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkdrawable-x11.[ch] bdk/x11/bdkgc-x11.c
	bdk/x11/bdkbango-x11.c bdk/x11/bdkpixmap-x11.c 
	bdk/x11/bdkprivate-x11.h bdk/x11/bdkwindow-x11.c:
	Switch back to using XftDraw so that we take 
	advantage of the draw-to-non-RENDER capabilities
	of Xft2.

	* demos/btk-demo/changedisplay.c (query_for_toplevel): 
	Fix the case where the user clicks on the "click on
	a window popup".

Thu Aug  1 19:09:39 2002  Owen Taylor  <otaylor@redhat.com>

	* demos/btk-demo/changedisplay.c: New demo for
	window migration between different displays and screens.

	* btk/btkrc.c btkstyle.[ch]: Add
	_btk_style_init_for_settings(), so that btkrc.c
	can initialize the styles it creates for the 
	right display.

	* bdk/bdkdisplaymanager.c (bdk_screen_get_default)
	* btk/btksettings.c (btk_settings_get_default)
	* btk/btkstyle.c (btk_style_init): Handle absence of
	a default screen.

	* bdk/x11/bdkmain-x11.c (_bdk_windowing_set_default_display):
	Handle display == NULL.x

	* bdk/bdkdisplay.c (bdk_display_dispose): Free the
	event queue.

	* bdk/x11/bdkevents-x11.c bdk/x11/bdkdisplay-x11.c:
	Remove the event source when closing a display.

	* bdk/bdkdisplay.[ch]: Add a ::closed signal, dispose()
	isn't convenient enough by itself.

	* bdk/x11/bdkevents-x11.c (bdk_xsettings_watch_cb):
	Create foreign windows for watch windows if there isn't
	an existing window, instead of installing a global filter.
	
	* bdk/x11/bdkscreen-x11.c bdk/x11/bdkprivate-x11.h
	bdk/x11/bdkevents-x11.c (_bdk_x11_events_uninit_screen):
	Clean up the xsettings_client when we are done with
	it.

	* bdk/x11/bdkevents-x11.c (_bdk_events_init): Remove
	excess call to _bdk_x11_events_init_screen()

2002-08-01  Sven Neumann  <sven@gimp.org>

	Merge from stable:

	* bdk/bdkrgb.c: trivial changes to some debug code so it compiles
	with VERBOSE being defined.

Thu Aug  1 11:26:03 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkdisplay.[ch] bdk/bdkscreen.[ch] bdkinternals.h:
	Start implementing display/screen closing scheme; keep a
	flag for whether displays and screens are closed,
	call g_object_run_dispose(). Remove public bdk_screen_close().

	* bdk/x11/bdkdisplay-x11.c bdk/x11/bdkscreen-x11.c: Add 
	dispose() methods; move appropriate parts of the finalize
	there.

	* bdk/x11/bdkcolor-x11.c bdk/x11/bdkimage-x11.c
	bdk/x11/bdkmain-x11.c bdk/x11/bdkbango-x11.c 
	bdk/x11/bdkpixmap-x11.c bdk/x11/bdkproperty-x11.c
	bdk/x11/bdkselection-x11.c bdk/x11/bdkwindow-x11.c:
	Start of making everything correctly ignore operations
	when a display has been closed.

	* bdk/x11/bdkwindow-x11.c (bdk_window_get_decorations):
	Handle decorations == NULL.

	* bdk/x11/bdkcolor-x11.c (bdk_colormap_remove): 
	Remove unnecessary hash table creation.

	* bdk/x11/bdkinput.c bdk/x11/bdkinput-x11.c bdk/win32/bdkinput.c
	Fix up bdk_device_get_history - handle events, n_events == NULL,
	etc.

	* bdk/x11/bdkproperty-x11.c (bdk_property_get):
	Handle failure better.
	
	* bdk/x11/bdkselection-x11.c (bdk_selection_property_get):
	Handle failure better, handle data == NULL, move docs
	here, remove an excess round trip by asking for
	all selection data at once.
	
	* bdk/bdkselection.c bdk/win32/{x11,win32}/bdkselection-{x11,win32}.c
	  bdk/{x11,win32}/bdkmain-{x11,win32}.c	bdk/bdkdisplay.c: Move
	bdk_text_property_to_text_list(), bdk_string_to_compound_text(),
	bdk_display_set_sm_client_id() to display-independent part of BDK.

	* bdk/Makefile.am (bdk_c_sources): Sort bdkdisplay/screen.[ch]
	into the right place.

2002-07-31  jacob berkman  <jacob@ximian.com>

	* btk/queryimmodules.c (print_escaped): escape_string() only takes
	one arg

Wed Jul 31 12:50:51 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/queryimmodules.c: Avoid using g_strescape(),
	since it mangles UTF-8, (#89479, Yao Zhang.)

Tue Jul 30 19:09:46 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkrange.c (btk_range_scroll_event): Handle 
	inverted ranges correctly (#85436, fix from 
	Norihiro UMEDA)

Tue Jul 30 16:36:53 2002  Owen Taylor  <otaylor@redhat.com>

	* tests/testbtk.c: Fix bug in the selection mode option
	menus which were setting the wrong values. 
	(#85763, Manuel Op de Coul)

Tue Jul 30 15:39:06 2002  Owen Taylor  <otaylor@redhat.com>

	* demos/Makefile.am: Honor BDK_PIXBUF_CSOURCE from
	configure.in when cross-compiling. (#87099,
	J. Ali Harlow)

Mon Jul 29 16:42:30 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkimcontext.c (btk_im_context_real_get_surrounding):
	Unset btk-im-surrounding-info object data again.
	(Fix from Yao Zhang, #86811)

Fri Jul 26 17:59:06 2002  Owen Taylor  <otaylor@redhat.com>
 
 	* configure.in: Replace uses of grep \(A\|B\) ... with
 	egrep (A|B). (#84872, Arnaud Charlet)
 
Fri Jul 26 22:53:37 2002  Kristian Rietveld  <kris@btk.org>

	API additions: _move, _reorder and _swap for stores, path
	constructor.

	* btk/btktreemodel.[ch] (btk_tree_path_new_from_indices): new function.

	* btk/btkliststore.[ch]: added btk_list_store_reorder_func (private),
	btk_list_store_reorder, btk_list_store_swap, btk_list_store_move.

	* btk/btktreestore.[ch]: added btk_tree_store_reorder_func (private),
	btk_tree_store_reorder, btk_tree_store_swap, btk_tree_store_move.

Fri Jul 26 22:32:57 2002  Kristian Rietveld  <kris@btk.org>

	Merge from stable:

	* btk/btktreestore.c (node_free): return FALSE,
        (btk_tree_store_finalize): use g_node_traverse instead of
        g_node_children_foreach, so the whole tree will be freed (#88854,
        patch from Emmanuel Briot).

Fri Jul 26 22:32:24 2002  Kristian Rietveld  <kris@btk.org>

	Merge from stable:

        * btk/btktreeview.c (btk_tree_view_button_press): fix some memleaks,
        (#84426, patch from Matthias Clasen).

Fri Jul 26 22:31:25 2002  Kristian Rietveld  <kris@btk.org>

	Merge from stable:

        * btk/btktreeview.c (btk_tree_view_unref_tree_helper): _iter_children
        check shouldn't be in g_return_return_val_if_fail (pointed out by
        Josh Green, #88997),
        (btk_tree_view_set_model): call _btk_tree_view_column_unset_model
        for each column when we unset the model (part of #82484),
        (btk_tree_view_get_cell_area): return if we ran out of tree or
        if we got an invalid path (#82376).

        * btk/btktreeprivate.h: add _btk_tree_view_column_unset_model.

        * btk/btktreeviewcolumn.c: implement _btk_tree_view_column_unset_model
        which disconnects the sort_column_changed_signal (part of #82484).

        * btk/btkliststore.c (btk_list_store_insert): append row if the
        given postion is off the end of the tree (#85813).

        * btk/btkentry.c (btk_cell_editable_key_press_event): let's use
        2-space indent, commit changes if up/down keys has been pressed,
        this overrides the focus key foo so the user won't be surprised
        (#84665).

Fri Jul 26 16:34:34 2002  Shivram U  <shivaram.upadhyayula@wipro.com>

	* bdk/bdkpixbuf-drawable.c (bdk_pixbuf_get_from_drawable),
	(bdk_pixbuf_get_from_image), (rgbconvert), (convert_real_slow):
	Check if depth of the source is not equal to the depth of the colormap
	passed. (#75597)

2002-07-25  Matthias Clasen  <maclas@gmx.de>

	* bdk/bdkrgb.c (bdk_rgb_select_conv): Use bdk_rgb_convert_4,
	not bdk_rgb_convert_8 for depth 4, bpp 8, PseudoColor visuals.
	(#88697)
	
Thu Jul 25 14:14:46 2002  Owen Taylor  <otaylor@redhat.com>

        * btk/btkmenushell.c: When a menubar is up, use F10 to cycle
	menubars, not Control-Tab (#87159, Calum Benson. Patch from
	Padraig O'Briain.)
	
	* btk/btkmenubar.c: When cycling menu bars, cancel
	after the last instead of wrapping around.

Thu Jul 25 11:57:57 2002  Owen Taylor  <otaylor@redhat.com>

	[ Patch from Padraig O'Briain, #87904 ]

	* btk/btkwidget.c (btk_widget_class_init): Cleanup -
	use G_SIGNAL_RUN_LAST not BTK_RUN_LAST when using
	g_signal new.

	* btk/btktogglebutton.c (btk_toggle_button_mnemonic_activate): 
	Always focus the widget, even when we are activating
	as well.

2002-07-24  Havoc Pennington  <hp@pobox.com>

	* btk/btktextview.c: Apply patch from Gustavo
	Giraldez for bug #78513

Wed Jul 24 16:43:49 2002  Owen Taylor  <otaylor@redhat.com>
 
 	* btk/btkrc.c docs/references/tmpl/btkrc.sgml: Don't use
 	BTK_RC_FILES, since it causes problems with what KDE (etc.)
 	does to customize BTK+ themes, use BTK2_RC_FILES instead. (#88987)
 
2002-07-16  Federico Mena Quintero  <federico@ximian.com>

	* bdk/bdkpixbuf-drawable.c (rgb565lsb): Fixed the LSB -> MSB case.
	Fixes #79463.

2002-07-16  Sven Neumann  <sven@gimp.org>

	* bdk/bdk.c
	* bdk/bdkinternals.h
	* bdk/win32/bdkmain-win32.c
	* bdk/x11/bdkmain-x11.c: pass argc and argv to the BDK backend in
	_bdk_windowing_init() so that the backend has a chance to process
	the command-line arguments (BTK+-DirectFB needs this).

2002-07-10  jacob berkman  <jacob@ximian.com>

	* btk/btkoptionmenu.c (btk_option_menu_scroll_event): activate the
	menu item so old apps work properly

Wed Jul 10 14:27:14 2002  Owen Taylor  <otaylor@redhat.com>

	* modules/input/btkimcontextxim.c btk/btkcolorsel.c 
	btk/btkdialog.c btk/btktextbtree.c: Fix some cases
	where signal connection IDs where being assigned to 
	guint rather than gulong. (part of #87281, Shivram U)

Fri Jul  5 20:18:23 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmenushell.[ch] btk/btkmenubar.c btk/btkmenuitem.c
	btk/btkentry.c btk/btktextview.c: Add an extra parameter
	to _btk_menu_item_select_first() to allow us to choose
	whether we want to select the first item predictably
	or to select the first sensitive item. Fixes problem
	with insensitive menu items and keynav. (#85796,
	reported by Bill Haneman and others.)

Fri Jul  5 02:50:24 2002  Jonathan Blandford  <jrb@gnome.org>

	* btk/btktreeview.c (btk_tree_view_collapse_all): fix warning.
	(btk_tree_view_search_iter): fix warning, #85884

	* btk/btktreestore.c (btk_tree_store_get_flags): change return
	value to BtkTreeModelFlags to fix compiler warning, #85883

	* btk/btktreemodelsort.c (btk_tree_model_sort_get_flags): change
	return value to BtkTreeModelFlags to fix compiler warning, #85882

	* btk/btktreemodel.c (btk_tree_path_prepend_index): fix compiler
	warning, #85881

Fri Jul  5 12:51:39 2002  Kristian Rietveld  <kris@btk.org>

	Merge from HEAD.

	* btk/btkliststore.c (btk_list_store_sort): also update ->tail after	
	sorting.

2002-07-02 Padraig O'Briain <padraig.obriain@sun.com>

	* btk/btksocket.c (btk_socket_hierarchy_changed):
	Use hyphen instead of underscore in signal names in calls to
	g_signal_connect_swapped (Fixes bug #86339)

Tue Jul  2 00:33:26 2002  Jonathan Blandford  <jrb@gnome.org>

    * btk/btktreeview.c (validate_visible_area): only validate the
      visible area if we've ever been requisitioned.

Mon Jul  1 17:04:09 2002  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkliststore.c (btk_list_store_real_set_value): sync up
	white space/variable names to match tree_store equiv.

	* btk/btktreestore.c (btk_tree_store_real_set_value): sort if we
	set the value.

Mon Jul 01 17:19:00 2002  Bill Haneman <bill.haneman@sun.com>

	* contrib/bdk-pixbuf-xlib/bdk-pixbuf-xlib-drawable.c
	(xlib_window_is_viewable):
	Fixed failure of assertion when drawable is root window.

Thu Jun 20 19:41:09 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkdisplay.h bdk/bdkscreen.h bdk/*.c btk/*.c
	tests/*.c: Renames:

	 bdk_get_default_display => bdk_display_get_default
	 bdk_get_default_screen  => bdk_screen_get_default
	 bdk_open_display        => bdk_display_open

Thu Jun 20 16:49:00 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkdisplaymanager.[ch] bdk/bdk.[ch] bdk/bdkdisplay.c 
	bdk/bdkinternals.h bdk/x11/bdkdisplay-x11.c 
	bdk/win32/bdkdisplay-win32.c: Add a singleton object that
	we can use to get notification when displays 
	appear / disappear or the default display changes.

	bdk_set_default_display() => bdk_display_manager_set_default_display()
	bdk_list_displays() => bdk_display_manager_list_displays().
	(#85696)

	* bdk/Makefile.am bdk/bdkmarshalers.list: Add marshaler
	generation.

	* bdk/bdkintl.h: Add this.

	* btk/btkmain.c: Add btk_parse_args() that initializes
	BTK+ without opening a display.

	* btk/btkmain.c: Set things up so if a module
	exports btk_module_init() and btk_module_display_init(), 
	then we treat it as multihead aware, otherwise, 
	we only initialize it after the default display is set.

Thu Jun 20 15:53:21 2002  Owen Taylor  <otaylor@redhat.com>

	Patch from Erwann Chenede.

	* bdk/x11/bdkdisplay-x11.[ch] bdk/x11/bdkprivate-x11.h:
	Introduce a yes/no/unknown BdkTristate, use it
	in a couple of places. (#79962)

	* bdk/x11/bdkwindow-x11.c bdk/x11/bdkdisplay-x11.h: Make 
	gravity_works per-display. (#79963)

Thu Jun 20 15:36:40 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkselection.c (btk_selection_owner_set): Get
	the owner from the display if !NULL. Otherwise, warn for
	multihead. (#85680)

Thu Jun 20 15:17:14 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkstyle.[ch]: Get rid of btk_style_get_font_for_display(),
	make btk_style_get_font() warn for multihead if called
	on an unattached style. (#80277)

	* btk/btktext.c: Remove use of btk_style_get_font_for_display();
	this makes btktext not multihead safe, but it doesn't matter;
	it's ENABLE_BROKEN anyways.

	* btk/btkmain.c btk/btkdebug.h: Add BTK_NOTE(MULTIHEAD,[])

Thu Jun 20 14:51:30 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btksettings.c (btk_settings_notify): Only
	change the double click time if the screen for
	the notification is screen 0 of the display.
	(#77978)

	* bdk/bdkevents.c (bdk_display_set_double_click_time): Fix 
	half-done rename.

Thu Jun 20 12:16:00 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkinvisible.c (btk_invisible_set_screen): Add
	notification for screen property. (#80280)

Wed Jun 19 19:30:45 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkrc.c: Keep a global list of strings and
	RC files to reparse, make btk_rc_parse_string(),
	btk_rc_parse() add to the list, and parse the
	string or file in _all_ contexts.

	* btk/btkrc.c (btk_rc_reparse_all): Reparse all
	contexts, not just the default context.

Tue Jun 18 19:38:08 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkinput.c (_bdk_init_input_core): Set the
	display.

	* bdk/x11/bdkwindow-x11.c (_bdk_moveresize_handle_event): Fix
	missing check for mv_resize == NULL.

Tue Jun 18 19:30:25 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btktreeview.c: Typo fix.

Tue Jun 18 19:11:51 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkdisplay.[ch] bdk/bdkevents.c bdk/bdkinput.h 
	bdk/bdkinternals.h bdk/win32/bdkevents-win32.c
	bdk/win32/bdkinput-win32.[ch] bdk/x11/bdkevents-x11.c
	bdk/x11/bdkinput{,-none,-x11}.c bdk/x11/bdkinputprivate.h:
	Make the core pointer object per-display. (#85698)

	* btk/btkdnd.c btk/btktreeview.c: Adapt to above change.

2002-06-18  Yanko Kaneti <yaneti@declera.com>

	* configure.in: (ALL_LINGUAS) Added Bulgarian (bg).

Tue Jun 18 14:41:48 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkcursor.[ch] bdk/x11/bdkcursor-x11.c
	bdk/x11/bdkprivate-x11.h bdk/win32/bdkcursor-win32.c: Replace
	bdk_cursor_new_for_screen() with bdk_cursor_new_for_display().
	(#85671)

	* btk/btkclist.c btk/btkcombo.c btk/btkcurve.c btk/btkdnd.c
	btk/btkentry.c btk/btkhandlebox.c btk/btkhsv.c btk/btklabel.c 
	btk/btkpaned.c btk/btktext.c btk/btktextview.c 
	btk/btktipsquery.c btk/btktreeviewcolumn.c: 
	Adapt to above change.

Tue Jun 18 12:04:10 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdk.c (bdk_init_check): Change handling 
	of bdk_intialized(), so that bdk_parse_args(),
	bdk_init_check() sequence works.

Tue Jun 18 11:46:33 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkwindow-x11.c (get_move_resize_data): Add
	a gboolean create argument, so we don't create the
	structure unless we actually emulate move-resize
	drags.

Sat Jun 15 23:53:03 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkfilesel.c (btk_file_selection_set_filename): 
	Actually use the UTF-8 filename, so we actually
	fix #77948.

	* tests/testbtk.c: Remember the directory as a
	test of btk_file_selection_set_filename().

Sat Jun 15 23:05:19 2002  Owen Taylor  <otaylor@redhat.com>
 
 	* btk/btkfilesel.c (btk_file_selection_set_filename):
 	Fix backwards asssertion. (#85434)
 
Sat Jun 15 16:10:00 2002  James M. Cape <jcape@ignore-your.tv>

	* btk/btktexttag.c (btk_text_tag_set_property):
	Notify about "background-full-height-set", not
	"bg_full_height_set". (#83336)
			
Fri Jun 14 15:41:50 2002  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c: Fix bug #84268, where validate_rows sometimes
	didn't remove itself correctly.  Thanks to Dave Camp for the fix.

Fri Jun 14 15:09:11 2002  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_set_adjustments):
	disconnect_by_func instead of disconnect_by_data.  Someone else
	could use the same data as us.

	* btk/btktreeview.c (do_validate_rows): update the adjustment
	immediately after we update the size.  Fixes some scroll_to bugs.
	(validate_visible_area): ditto

Fri Jun 14 10:31:59 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkevents-x11.c (bdk_check_wm_state_changed): 
	Ignore state change events for windows that aren't
	our toplevels. (#84482, Thomas Leonard)

Fri Jun 14 10:00:29 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkwindow.c (bdk_window_update_idle): Add
	missing BDK_THREADS_ENTER()/BDK_THREADS_LEAVE().
	(Report of non-thread-safety from Nicholas Allen)

	* btk/btkmain.c (rewrite_events_translate): Fix sign
	problem with coordinate translation. (Fix from
	Robin Lu, #85229)

Thu Jun 13 19:41:56 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkiconfactory.c btk/btkselection.c btk/btkstyle.c
	btk/btktextiter.c btk/btktexttag.c btk/btktreemodel.c
	btk/btkwidget.c: Fix type names for BtkIconSet,
	BtkIconSource, BtkSelectionData, BtkBorder, BtkTextIter,
	BtkTextAttributes, BtkTreePath, BtkTreeIter, 
	BtkRequisition, which were all registered as BtkType*.
	(#84634, James Henstridge; patch from Jonathan Blandford.)
	
Thu Jun 13 18:48:14 2002  Owen Taylor  <otaylor@redhat.com>

 	* bdk/x11/bdkcolor-x11.c: Make work
	bdk_colormap_sync() work for DirectColor visuals 
	as well. Fill in the ->colors array in
	bdk_screen_get_system_colormap () for DirectColor visuals.
	(#81954, Based on a patch from shivaram.upadhyayula@wipro.com)
 
Thu Jun 13 17:50:36 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btktextview.c btk/btkentry.c: Add the obsolete
	CUA cut/copy/paste bindings. (#79078)

	* btk/btktextview.c btk/btkentry.c: Make <Shift>BackSpace
	a synonym for for Backspace. (#80302, Jeff Waugh)

Thu Jun 13 15:02:49 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkdnd-x11.c: Ignore all client events that
	were sent to a window that we don't know about or
	to a foreign window. (#81543, Young-Ho, Cha)

Thu Jun 13 12:24:09 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkfilesel.c (btk_file_selection_set_filename):
	Fix so that the encoding of the filename is handled
	properly in the case of non-UTF-8 filesystems;
	document the encoding. (#77948, Sebastian Ritau)

	* btk/btkfilesel.c (filenames_drag_get): Remove
	debug printf. Fix UTF-8 / filename encoding 
	confusion.

2002-06-13  Christian Rose  <menthos@menthos.com>

	* Makefile.am (EXTRA_DIST): Remove po/README.tools, po/desk.pl
	and po/update.pl.

Thu Jun 13 12:01:36 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkentry.c (btk_entry_drag_motion): Don't return
	a positive status unless there is a text target in
	the drag. (#83386, Thomas Leonard.)

Thu Jun 13 11:36:37 2002  Owen Taylor  <otaylor@redhat.com>
 
 	* btk/btkdnd.c (_btk_drag_source_handle_event): Save
 	the initial grab time, use that when changing the
 	pointer. (#83052, help from Dave Camp tracking it down.)
 
Thu Jun 13 16:42:40 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreestore.c (btk_tree_store_finalize): traverse all nodes,
	not just the leafs (pointed out by Josh Parsons)

2002-06-12  Havoc Pennington  <hp@redhat.com>
 
 	* configure.in: check that bango has Xft2 support, instead of
 	checking whether Xft2 exists.

Wed Jun 12 17:46:53 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkentry.c (blink_cb): Add an informative 
	g_warning() when the entry has lost a focus-out-event.
	(#78305, Michel Selten)

Wed Jun 12 17:31:15 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmenushell.c (btk_menu_shell_real_select_item): 
	Check to see if the menu item is selectable before
	setting menu_shell->active_menu_item. This hopefully
	will keep bail from getting confused.
	(#84115, Remus Draica)

Wed Jun 12 17:13:13 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwindow.c (btk_window_move_resize): Fix bug
	where if CENTER_ON_PARENT was set, but there was
	no parent, BDK_HINT_POS would be set, resulting
	in a dialog at 0,0. (#83479, Havoc Pennington)

Wed Jun 12 16:34:13 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmenubar.c: When fetching the menubars for
	the window for F10 handling, only add viewable menu
	bars. (Apparently, people sometimes put menu bars
	in notebook pages!) (Tim Janik, #82627)

Wed Jun 12 16:21:38 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkcheckbutton.c (btk_check_button_size_allocate): 
	Clamp size of child to at least 1x1. (#82431, 
	Boris Shingarov.)

Wed Jun 12 15:43:38 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkspinbutton.c (btk_spin_button_snap): Handle
	0 increment, to fix division-by-zero problem.
	(#82816, George Lebl.)

Wed Jun 12 15:38:01 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkimmulticontext.c (btk_im_multicontext_append_menuitems):
	Fix memory leak. (Patch from Matthias Clasen, #84926)

	* btk/btkrange.c (btk_range_init): Initialize
	mouse_x, mouse_y to -1,-1. (#84871, Garrett Lesage)

Wed Jun 12 15:08:37 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkrc.c (btk_rc_get_style_by_paths): Allow 
	NULL for widget path or class path as documented.
	(#83150, Sergey Kuzminov)

Wed Jun 12 15:02:30 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btktextutil.c: Fix ZWJ => ZWN typo.
	(#83092, Tino Meinen)

Wed Jun 12 14:41:43 2002  Owen Taylor  <otaylor@redhat.com>

	* configure.in: Fix some problems with case statements
	for checking for omitted deps. (#84202, Jacob Berkman.)

	* configure.in: Remove USE_X11R6_XIM checks since we 
	no longer use them.

Wed Jun 12 14:18:45 2002  Owen Taylor  <otaylor@redhat.com>
 
 	* btk/btkimcontextsimple.c: Add compose sequences
 	of dead_acute + c/C => C WITH CEDDILLA.
 	(Nano Golveia, #83492)
 
2002-06-10  Hans Breuer  <hans@breuer.org>

	* bdk/makefile.msc : added bdkdisplay and bdkscreen

	* bdk/win32/bdkdisplay-win32.c (bdk_open_display) : 
	need to bdk_screen_set_default_colormap(). Also un-static
	some exported bdk_display_*() functions

	* bdk/win32/bdkdrawable-win32.c : added "bdkscreen.h"

	* bdk/win32/bdkscreen-win32.c : implement
	bdk_screen_get_number, fixed typo, added rewuired headers

	[merge from 2.0.x branch, should we really manifest 
	 BtkPlug as being an X11 only thing this way? See #58541]
	* btk/btkwindow.c (btk_window_show): Conditionalize
	BTK_IS_PLUG() check on BDK_WINDOWING_X11. (Problem
	reported by Sven Neumann)

2002-06-10  Tor Lillqvist  <tml@iki.fi>

	[ merge from stable ]

	* bdk/win32/bdkmain-win32.c (bdk_screen_get_width_mm,
	bdk_screen_get_height_mm): Use the "logical dpi" to calculate
	(pseudo) physical sizes. Similar to the use of "logical dpi" in
	Bango as suggested by Joaquin Cuenca Abela.

	Two fixes by Florent Duguet:

	* bdk/win32/bdkwindow-win32.c (bdk_window_set_cursor): Correct
	semantics for setting cursor to NULL (should use cursor of parent
	window).

	* bdk/win32/bdkgc-win32.c (bdk_win32_hdc_get): Plug memory
	leak.

2002-06-10  Naba Kumar <kh_naba@users.sourceforge.net>

	* configure.in: Added hi in ALL_LINGUAS

2002-06-09  Matthias Clasen  <maclas@gmx.de>

	* btk/btktextbtree.c (_btk_text_btree_unref): Don't leak
	child_anchor_table.  (#84425)

	* btk/btktextlayout.c (btk_text_layout_finalize): Don't leak
	one_display_cache.  (#84424)

Fri Jun  7 23:11:42 2002  Jonathan Blandford  <jrb@gnome.org>

	* btk/btktreeview.c (btk_tree_view_real_expand_row): Fix sizing
	bug.

	* docs/reference/btk/tmpl/btkbutton.sgml: Remove ^M's.

2002-06-07  Matthias Clasen  <maclas@gmx.de>

	* btk/btktreeviewcolumn.c
	(btk_tree_view_column_clear_attributes_by_info): New function,
	split off from btk_tree_view_column_clear_attributes.
	(btk_tree_view_column_clear_attributes):
	(btk_tree_view_column_finalize):  Call the new function, avoid
	recalculating the info from the renderer.  (#84413) 
	
	* btk/btktextview.c (text_view_child_new_anchored): Initialize
	vc->type in order to avoid a later UMR.  (#84415)

2002-06-07  Mark McLoughlin  <mark@skynet.ie>

	* btk/btkwindow.c: (btk_window_compute_configure_request): use
	the RootWindow of this screen for bdk_window_get_pointer.

2002-06-06  Matthias Clasen  <maclas@gmx.de>

	* bdk/x11/bdkevents-x11.c (bdk_event_translate): Set
	hardware_keycode for KeyRelease events.  (#84305)

Thu May 23 15:44:30 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btktextview.c (changed_handler): Don't redraw
	when the area is completely above the visible area.

Fri May 17 17:27:21 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwindow.c btk/btkwidget.c: Add a "is_focus"
	property indicating whether a widget is the focus
	widget within the toplevel.

	* btk/btkwindow.[ch]: Add "is_active" "has_toplevel_focus"
	properties to indicate (separately) the idea of
	being the part of the toplevel with the input focus
	and being the active widget. (Needed for full XEMBED
	compliance.)

	* btk/btkplug.c btk/btksocket.c: Update to work
	in terms of is_active/has_toplevel_focus, and thus
	handle the active/focused XEMBED distinction
	correctly.

	* btk/btkplug.c (btk_plug_realize): Remove
	FOCUS_CHANGE_MASK, since we don't need it.

Fri May 17 18:07:34 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btksocket.c (btk_socket_add_window): Send
	XEMBED_EMBEDDED_NOTIFY.

	* btk/btksocket.c: Assume windows without _XEMBED_INFO 
	property want to be mapped, for better 
	current-Qt compatibility.

Thu Jun  6 17:27:01 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btkrbtree.c (_btk_rbtree_reorder): don't leak the GArray
	(figured out by Matthias Clasen, fixes #82026).

Wed Jun  5 18:34:47 2002  Owen Taylor  <otaylor@redhat.com>

	Changes multihead reorganizing code for win32 support,
	mostly from a patch by Hans Breuer.

	* bdk/bdkcolor.c bdk/x11/bdkcolor-x11.c bdk/bdkcursor.c
	  bdk/x11/bdkcursor-x11.c bdk/bdkevents.c bdk/x11/bdkevents-x11.c
	  bdk/bdkfont.c bdk/x11/bdkfont-x11.c bdk/bdkkeys.c
	  bdk/x11/bdkkeys-x11.c bdk/bdkimage.c bdk/x11/bdkimage-x11.c
	  bdk/bdkscreen.c bdk/x11/bdkmain-x11.c
	  bdk/bdkdisplay.c bdk/bdkevents-x11.c bdk/bdkbango.c
	  bdk/x11/bdkbango-x11.c bdk/bdkselection.c
	  bdk/x11/bdkselection-x11.c bdk/bdkwindow.c
	  bdk/x11/bdkwindow-x11.c bdk/bdkvisual.c bdk/x11/bdkvisual-x11.c:
	  Move port-independent singlehead wrapper functions into
	  port-independent part of BDK. (#80009)

	* bdk/win32/bdkcolor-win32.c bdk/win32/bdkcursor-win32.c
	  bdk/win32/bdkevents-win32.c bdk/win32/bdkfont-win32.c
	  bdk/win32/bdkimage-win32.c bdk/win32/bdkkeys-win32.c
	  bdk/win32/bdkmain-win32.c bdk/win32/bdkproperty-win32.c
	  bdk/win32/bdkselection-win32.c bdk/win32/gkwindow-win32.c: 
	Turn singlehead functions into "multihead" functions that ignore 
	their BdkDisplay or BdkScreen arguments.

	* bdk/win32/bdkdrawable-win32.c bdk/win32/bdkevents-win32.c
	bdk/win32/bdkinput-win32.c bdk/win32/bdkprivate-win32.h: 
	Misc multihead-compatibility changes.

	* btk/btk.def bdk/bdk.def: Update for multihead functions.

	* bdk/bdkcolormap.h bdk/bdkvisual.h bdk/x11/bdkcolormap-x11.c 
	bdk/x11/bdkvisual-x11.c: Remove the screen fields
	from the public parts of the colormap/visual structures, add accessors
	instead.

	* bdk/bdkpixbuf-render.c bdk/bdkpixmap.c bdk/bdkrgb.c
	  bdk/x11/bdkcolormap-x11.c bdk/x11/bdkimage-x11.c
	  bdk/x11/bdkimage-x11.c bdk/x11/bdkprivate-x11.h btk/btkgc.c
	  btk/btkstyle.c btk/btkwidget.c: Use accessors to get the screen
	for colormaps, visuals; move the fields into the private
	structures for the x11 backend.

	* bdk/bdkdisplay.[ch] bdk/x11/bdkdisplay-x11.[ch]
	  bdk/bdkscreen.[ch] bdk/x11/bdkscreen-x11.c: 
	Remove virtualization of screen and display functions.
	(#79990, patch from Erwann Chenede)

	* bdk/win32/bdkdisplay-x11.c bdk/win32/bdkscreen-win32.c
	bdk/win32/{Makefile.am, makefile.msc, makefile.mingw}:
	New files containing stub implementations of Display,
	Screen functions.

	* bdk/x11/bdkscreen-x11.[ch] bdk/x11/bdkdisplay-x11.[ch]
	bdk/x11/bdkx.h: Clean up function exports and what 
	headers they are in. (#79954)

	* bdk/x11/bdkx.h: Fix macro that was referring to a non-existant
	screen->screen_num. (In the patch for #79972, Erwann Chenede)

	* bdk/bdkscreen.c bdk/bdkwindow.c bdk/x11/bdkinternals.h
	 bdk/x11/bdkscreen-x11.c: Fix bdk_screen_get_window_at_pointer()
	to use window hooks. (#79972, patch partly from Erwann Chenede)

	* bdk/x11/bdkdisplay-x11.c bdk/x11/bdkevents-x11.c: Fix
	some warnings.

Wed Jun  5 23:29:41 2002  Kristian Rietveld  <kris@btk.org>

	Related bugs: #76252, #76396, #80866.

	* btk/btktreeselection.[ch]: added
	btk_tree_selection_get_selected_rows(),
	added btk_tree_selection_count_selected_rows(),
	renamed btk_tree_selection_real_select_range() to
	btk_tree_selection_real_modify_range(), and added mode parameter,
	added btk_tree_selection_unselect_range().
	
Tue Jun  4 17:39:34 2002  Owen Taylor  <otaylor@redhat.com>

 	* configure.in: If we have xft .pc file, use that
 	when checking for Xft/Xrender. (Still need to separate
 	out HAVE_XFT, HAVE_RENDER)
 
 	* configure.in: Make sure Xft cflags come before X cflags.
 
Tue Jun  4 21:13:57 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreeview.[ch]: added btk_tree_view_expand_to_path.

Tue Jun  4 19:24:41 2002  Kristian Rietveld  <kris@btk.org>

	Discussed in #76249.

	* btk/btkliststore.[ch]: made btk_list_store_remove return a gboolean,
	added btk_list_store_iter_is_valid.

	* btk/btktreestore.[ch]: made btk_tree_store_remove return a gboolean,
	added btk_tree_store_iter_is_valid.

	* btk/btktreemodelsort.[ch]: added VALID_ITER macro as in liststore
	and treestore sources, added btk_tree_model_sort_iter_is_valid.
	
Tue Jun  4 19:18:20 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreemodel.[ch]: add btk_tree_model_get_string_from_iter
	(#74667).

2002-06-04  Daniel Elstner  <daniel.elstner@gmx.net>

	[ merge from stable ]

	* btk/btkcellrenderertoggle.c (btk_cell_renderer_toggle_render):
	Really fix #83796: Revert jrb's last patch, and move the second
	if-clause into the fist one's else-branch.  This is also what
	the other cell renderers do.

2002-06-03  Federico Mena Quintero  <federico@ximian.com>

	* bdk/bdkpixbuf-drawable.c (rgb565msb): Fix the MSB -> MSB case.
	Fixes #79190.

Sat Jun  1 10:43:28 2002  Jonathan Blandford  <jrb@gnome.org>

	* btk/btkcellrenderertoggle.c (btk_cell_renderer_toggle_render): 
	add missing flag, #83796

2002-05-30  Michael Meeks  <michael@ximian.com>

	* btk/btkmenu.c (btk_menu_popup): destroy the transfer
	window if the grab fails so we don't get events on this
	window after the menu is finalized with a duff BtkWidget
	pointer: #82366

Mon May 28 13:28:10  Shivram U  <shivaram.upadhyayula@wipro.com>

	* btk/btktextbuffer.c (selection_data_get_buffer): Check if the owner
	got is of type BDK_WINDOW_FOREIGN. If so the owner is not in-process,
	and so return NULL.

2002-05-24  Michael Meeks  <michael@ximian.com>

	* btk/btkmain.c (_btk_find_module): don't leak the paths.

Thu May 30 07:59:38 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* btk/btkmenu.c (btk_menu_style_set): add
	btk_menu_style_set(). fixes #79345

2002-05-29  Dave Camp  <dave@ximian.com>

	* btk/btkdnd.c (btk_drag_end): Disconnect from keypress events.

2002-05-28  Matthias Clasen  <maclas@gmx.de>

	* btk/btkwindow.c (btk_window_move): Markup fixes

	* btk/btkrc.c (btk_rc_get_module_dir): Markup fixes.
	
	* bdk/x11/bdkcursor-x11.c (bdk_cursor_new_for_screen): Update docs
	for Docbook XML.

2002-05-27  Daniel Elstner  <daniel.elstner@gmx.net>

	[ merge from stable ]

	Fixes for #83190

	* btk/btktreedatalist.h (_BtkTreeDataList::data): Add missing
	fields to anonymous union: glong, gulong, gint64 and guint64.
	This is an internal header file, so it should not affect ABI
	or API compatibility.

	* btk/btktreedatalist.c (_btk_tree_data_list_node_to_value):
	Implement missing support for glong, gulong, gint64 and guint64
	fundamental types.  Use data.v_uint instead of data.v_int for
	G_TYPE_FLAGS, as GValue does.
	(_btk_tree_data_list_value_to_node): ditto
	(_btk_tree_data_list_node_copy): Add case labels for missing
	fundamental types, and reorder them to match the other functions.
	(btk_tree_data_list_compare_func): Implement comparison for
	glong, gulong, gint64 and guint64.  Use g_value_get_enum()
	for G_TYPE_ENUM and g_value_get_flags() for G_TYPE_FLAGS, rather
	than accessing them as gint/guint.  The G_VALUE_HOLDS() check
	probably won't like this.

2002-05-24  Dave Camp  <dave@ximian.com>

	* btk/btktreemodelsort.c (btk_tree_model_sort_row_inserted): 
	Built an iter directly instead of using
	btk_tree_model_sort_elt_get_path(), since that returns a path for
	the child model.

2002-05-24  Dave Camp  <dave@ximian.com>

	* btk/btktreemodelsort.c: Use indices[i] >= level->array->len
	rather than level->array->len > indices[i] in the bounds check.

2002-05-23  Tor Lillqvist  <tml@iki.fi>

	* btk-zip.sh.in: Use correct path to the loaders and immodules
	directories (BTK_BINARY_VERSION, not BTK_VERSION).

Wed May 22 16:12:38 2002  Owen Taylor  <otaylor@redhat.com>

	* configure.in: Require autoconf-2.52 explicitely,
	since otherwise Debian will process it with 2.13 (ugh!).

Wed May 22 12:29:20 2002  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkscrolledwindow.c (btk_scrolled_window_init): remove
	BTK_RESIZE_QUEUE setting.

Tue May 21 16:46:15 2002  Owen Taylor  <otaylor@redhat.com>
 
 	* bdk/x11/bdkdisplay-x11.c (bdk_internal_connection_watch): 
 	Fix missing dereference. (HideToshi Tajima)
 
Mon May 20 15:02:21 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkdisplay-x11.c: Patch from HideToshi Tajima
	to handle Xlib internal connections. (#76681)

Mon May 20 12:59:14 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btktooltips.c: Set the private LEAVE_PENDING
	flag to fix problem where with menu items with
	submenus, tooltips were getting stuck. (Effectively
	disables tooltips for menu items with submenus.)
	(Bug #75961, Soeren Sandmann)

	* tests/testbtk.c: Set a tooltip on a menu item
	with a submenu.

Mon May 20 11:47:59 2002  Owen Taylor  <otaylor@redhat.com>
 
 	* btk/btkplug.c: Undo an accidental revert of
 	fixes of May 16. (Caught by Padraig O'Briain)
 
	* btk/btkctree.c (cell_size_request): Fix bug where
	size request for text cells was being overwritten.
	(#82264, Graham Swallow.)

2002-05-18  Matthias Clasen  <maclas@gmx.de>

	* configure.in: Check for endianness. Sorry about REBUILD_PNGS...

Fri May 17 16:05:34 2002  Owen Taylor  <otaylor@redhat.com>

	* configure.in (REBUILD_PNGS): Re-add REBUILD_PNGS
	definition that got accidentally removed.

Fri May 17 14:40:24 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkimmulticontext.c (btk_im_multicontext_set_slave): 
	Protect against reentrancy problems by emitting 
	::preedit_changed at the end, fixing input context
	leak. (Yao Zhang)

	* modules/input/btkimcontextxim.c (status_window_free): 
	Patch from Federico Mena Quintero to fix problem where
	references to IMContextXIM were kept around after
	module was unloaded. (#77008)

	* btk/btkdnd.c (btk_drag_dest_set): NULL initialize
	proxy window.

Fri May 17 13:56:23 2002  Owen Taylor  <otaylor@redhat.com>
 
 	* btk/btkplug.c (btk_plug_filter_func): Fix a missing
 	unref in the local/passive case. (#82067, Michael
 	Meeks)
 
 	* btk/btkplug.c (_btk_plug_remove_from_socket): Fix
 	reference leak on the plug window.
 
 	* tests/testsocket.c (add_child): Fix memory leak.
 
 	* btk/btkdnd.c (btk_drag_dest_site_destroy): Unref
 	the proxy window.
 
Thu May 16 19:49:24 2002  Owen Taylor  <otaylor@redhat.com>
 
 	* btk/btkwindow.c (btk_window_configure_event): Only 
 	optimize out the full configure handling if we got
 	a gratuitous configure event(configure_request_count == 0)
 	and the size didn't change.
 
 	* btk/btkwindow.c (btk_window_move_resize): Use 
 	g_message(), not g_print() for debug spew.b
 
 	* btk/btkwindow.c (btk_window_real_set_focus): Ref
 	the old and new focus widgets for the scope of
 	the function.
 
 	* btk/btksocket.c btkplug.c: Remove various #if 0'd
 	bits of old code.
 
 Thu May 16 18:47:29 2002  Owen Taylor  <otaylor@redhat.com>
 
 	* btk/btkwindow.c (btk_window_show): Disable the
 	focus-some-widget code for BtkPlug descendants.
 
 	* btk/btkplug.c (btk_plug_focus_event): Eat 
 	focus-in/out events since they can be generated
 	by keyboard grabs, but are spurious for an embeddded
 	widget. (#79196, Padraig O'Briain)
 
 	* btk/btksocket.c (btk_socket_size_request): Only
 	pay attention to the minimum size hints, and changes
 	to that ... ignore the default size.
 
 	* btk/btksocket.c (btk_socket_send_configure_event):
 	Pass in root-window relative coordinates as per
 	the ICCCM.
 
 	* btk/btksocket.c (btk_socket_size_allocate): Send
 	as many synthetic configures as necessary to make
	up for ConfigureRequest events we got. (#78799,
	Dave Camp.)

Thu May 16 23:59:56 2002  Kristian Rietveld  <kris@btk.org>

	Merged from btk-2-0.

	* btk/btktreestore.c (btk_tree_store_sort_iter_changed): set the prev
	of the next node correctly, so we don't corrupt the list and cause
	bad things. (fixes #71374)
 
Thu May 16 17:29:08 2002  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkrbtree.c (_btk_rbtree_remove): include missing #ifdef G_ENABLE_DEBUG

Thu May 16 15:44:15 2002  Owen Taylor  <otaylor@redhat.com>

        * demos/btk-demo/editable_cells.c (cell_edited): Fix
	typo in earlier patch.

Tue May  7 15:50:51 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkimcontextsimple.c (btk_im_context_simple_filter_keypress):
	Don't filter control-shift+[non-hex]. 
	(#80252, reported by Nalin Dahyabhai)

Thu May 16 14:51:14 2002  Owen Taylor  <otaylor@redhat.com>

	Fixes for #78258

	* btk/btkrbtree.c demos/btk-demo/editable-cells.c:
	Fix some 64-bit warning problems. (Patch from Matthias
	Clasen.)
	
	* btk/btkrbtree.c (_btk_rbtree_debug_spew_helper): Surround
	a bunch of debug code with G_ENABLE_DEBUG.

	* configure.in demos/btk-demo/main.c: Replace
	#ifndef G_OS_WIN32 with proper #ifdef HAVE_FLOCKFILE.

Thu May 16 12:56:38 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkrange.c (btk_range_calc_layout): Fix a missed
	check for division by zero. (#77820, Gareth Pearce)

Thu May 16 12:50:13 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkevents-x11.c (bdk_xsettings_notify_cb):
	bdk_event_put() copies the event and setting name,
	so we don't have to strdup() it here. (Fix from
	Michael Meeks, #81953)

2002-05-16  Ettore Perazzoli  <ettore@ximian.com>

	* btk/btkmenu.c (btk_menu_paint): If the menu is scrolled down or
	up, and some of the widget area is empty, don't fill it in with
	BTK_SHADOW_IN rectangles that make it looks strange.  Fixes
	#72695.

Wed May 15 18:15:45 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkdnd.c (_btk_drag_source_handle_event): Don't
	call bdk_pointer_grab() to change the cursor if we've
	already ungrabbed on button release / escape.
	(#80420, Dave Camp)

Wed May 15 17:12:50 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btktooltips.c: Special case menu items to
	pop down on motion. (#75961)

	* tests/testbtk.c (create_item_factory): Add tooltips
	to the File menu.

	* btk/btkentry.c (update_im_cursor_location): Fix 
	cursor locations passed to the IM context.
	(#80027, Yao Zhang)

Wed May 15 16:52:57 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkfontsel.c: Update from contents of size entry
	on focus out. (#76493, Lauris Kaplinski)

	* btk/btkclipboard.c (selection_get_cb): Fix backwads
	info/time arguments. (#80226)

Wed May 15 11:13:19 2002  Owen Taylor  <otaylor@redhat.com>

	* configure.in btk/stock-icons/Makefile.am: If not
	building libpng, don't rebuild btkstockpixbufs.h
	(#81819, Bill Janssen)

2002-05-15  jacob berkman  <jacob@ximian.com>

	* demos/btk-demo/Makefile.am (demos.h): just run perl on the
	geninclude script manually

Tue May 14 19:53:15 2002  Owen Taylor  <otaylor@redhat.com>

	* demos/btk-demo/geninclude.pl.in configure.in:
	Subsitute in @PERL@ instead of hardcoded 
	/usr/bin/perl. (#78355, Gareth Pearce. Fix based
	on patch from Matthias Clasen)

	* bdk/Makefile.am: Patch from Daniel Elstner to use bunnylib-mkenums
	instead of makeenums.pl.

	* bdk/{x11,linux-fb,win32}/Makefile.am: Hack to
	get bdkenumtypes.h built first.

Tue May 14 18:41:58 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/stock-icons/Makefile.am (btkstockpixbufs.h): 
	Remove the result file on error. (#79929, David
	Highley)

	* btk/btkoptionmenu.c (btk_option_menu_remove_menu):
	If the menu is currently active, cancel it before
	setting the new menu. (#79162, Jonathan Blandford.)

Tue May 14 18:13:10 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkdnd-x11.c (bdk_window_cache_filter): Fix
	prepending at the start of the list. (#56349,
	Thomas Leonard.)

	* btk/btksignal.h (btk_signal_disconnect_by_func): Add
	explicit casts to GSignalMatchType for C++ compatibility.
	(#77601)

Tue May 14 18:02:37 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwindow.c (btk_window_realize): Fix
	frame_right/frame_top screwup. (Detlef Reichl,
	#78111)

	* btk/Makefile.am (install-data-local): Use
	$(INSTALL_DATA) not $(INSTALL) when installing
	theme files. (#77094, Ben Liblit)

Tue May 14 17:30:57 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkctree.c btk/btkclist.c: Fix format of 
	selection data to be 8 rather than BTK_TYPE_POINTER.
	(#79751, James Henstridge)
	
	* btk/btkmenu.c (btk_menu_key_press): Call 
	btk_accelerator_valid() with cleaned up
	accel_key/accel_mods, not the raw values from
	the event. (#80513, Havoc Pennington.)

	* btk/btkmenu.c (btk_menu_set_tearoff_state): Remove
	some dead code that set the tearoff window not 
	resizable and removed decorations. (#80235)

Tue May 14 16:44:09 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btklabel.c (btk_label_ensure_layout): Set
	the width of the layout to the actual wrap width 
	(our requisition) not the width we set when calculating
	the width. This results in the lines being justified
	within the correct area. (#79157, Anders Carlsson)

	* btk/btkaccelgroup.c btk/btkmarshelers.list: Corrected 
	registered parameter types of "accel_activate" and 
	"accel_changed" signals. (Patch from Murray Cumming, #78798)
	
	* btk/btkrc.c (btk_rc_make_default_dir): Switch
	binary-version and type to correspond to the 
	current ordering in _btk_get_module_path.
	(#78746, Sergey Kuzminov) 

	* btk/btkrc.c (btk_rc_get_module_dir): Add docs
	pointing to the BTK_PATH documentation.

	* btk/Makefile.am (uninstall-local): Delete 
	key themes as well. (#81286, Kristian Rietveld.)

Tue May 14 15:40:49 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkwindow-{linux-fb,win32,x11.c} (bdk_window_set_back_pixmap):
	Add a sanity g_return_if_fail() check for the depths
	for the window and pixmap. (#79191, Shivaram Upadhyayula)

Tue May 14 15:09:33 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkkeys-x11.c: Try adding a #ifndef/#define
	for XkbKeySymEntry to make up for OSF broken 
	XKB extension. (#77819, Gareth Pearce)

	* btk/btklayout.c: Clamp the upper values in response
	to ::size-allocate if necessary. (#81290, Christophe Saout)
	
	* btk/btkcombo.c (btk_combo_entry_focus_out): Handle
	combo being destroyed before idle fires.
	(#81396, Timo Sirainen)

Tue May 14 11:21:19 2002  Owen Taylor  <otaylor@redhat.com>
 
 	* bdk/x11/bdkevents-x11.c (bdk_event_translate): 
 	Discard configure events from SubstructureNotify.
 	(#81760, Rich Burridge)
 
 	* btk/btkfontsel.c (cmp_families): Use g_utf8_strcoll(), not
 	strcmp().
 
 	* btk/btkmenuitem.c (btk_menu_item_size_allocate): Clamp 
 	width of child allocation to >= 1. (Fixes warnings from
 	#77639, Martin Schulze)
 	
2002-05-14  Matthias Clasen  <maclas@gmx.de>

	* btk/btkcontainer.c (btk_container_class_install_child_property): 
	(btk_container_class_find_child_property): 
	(btk_container_class_list_child_properties): 
	* btk/btkwidget.c (btk_widget_class_find_style_property): 
	(btk_widget_class_list_style_properties): Change parameter names
	to match the header file and the documentation.

2002-05-13 Vitaly Tishkov <tvv@sparc.spb.su>

        * btk/btkfilesel.c
        * btk/btkplug.c 
        * btk/btkwidget.c
        * btk/btkwindow.c
        a few typos in docs were fixed

2002-05-10  Daniel Elstner  <daniel.elstner@gmx.net>

	[ merge from stable ]

	* btk/btktreemodel.c: #define INITIALIZE_TREE_ITER(),
	which zeroes out all BtkTreeIter fields. (#81380)
	(btk_tree_model_get_iter): Use it.
	(btk_tree_model_iter_children): ditto
	(btk_tree_model_iter_nth_child): ditto
	(btk_tree_model_iter_parent): ditto

2002-05-08  Michael Natterer  <mitch@gimp.org>

	* configure.in: fixed yesterdays fix for cross compiling: simply
	check the variable "cross_compiling" which gets set by autoconf.

Wed May  8 16:14:49 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* btk/btktreeview.c 
	(btk_tree_view_init): set_redraw_on_allocate (FALSE);
	(btk_tree_view_size_allocate): invalidate last column if width
	changed.
	(btk_tree_view_bin_expose): skip over cells that aren't in
	event->rebunnyion

Tue May  7 18:36:03 2002  Owen Taylor  <otaylor@redhat.com>
 
 	* bdk/x11/xsettings-client.c (xsettings_client_process_event): 
 	Check for selection_atom, not property name atom.
 
2002-05-07  Michael Natterer  <mitch@gimp.org>

	* configure.in: added a new conditional CROSS_COMPILING which
	indicates ($build != $host). If it is set, look for
	bdk-pixbuf-csource in PATH. Error out if it was not found.

	* btk/stock-icons/Makefile.am: use the bdk-pixbuf-csource found at
	configure time if CROSS_COMPILING is set, use the one which was
	just built otherwise.

2002-05-07  Anders Carlsson  <andersca@gnu.org>

	* bdk/x11/xsettings-client.c (xsettings_client_process_event): 
	Only process manager events with the correct atom.

2002-05-07  Matthias Clasen  <maclas@gmx.de>

	Fix for #79248:
	
	* bdk/x11/bdkwindow-x11.c (bdk_window_new): 
	(bdk_window_set_events): Always select for property notify for
	maintaining window state.

	* bdk/x11/bdkevents-x11.c (bdk_event_translate): Only propagate
	property notifys if they were selected by bdk_window_set_events.

Mon May  6 23:48:14 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreeview.c (btk_tree_view_map_expanded_rows_helper): call
	func on current node before the child nodes.

Mon May  6 23:17:42 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreeview.c (btk_tree_view_motion_draw_column_motion_arrow):
	unset user_data before destroying the window. (fixes #80065).

Mon May  6 12:17:14 2002  Owen Taylor  <otaylor@redhat.com>

	* configure.in: Fix versioning to avoid changing the
	soname!

	[ merge from stable ]

	* Makefile.am (EXTRA_DIST): Add ChangeLog.pre-2-0 (#78641)

	* m4macros/btk-2.0.m4: save CFLAGS/LIBS properly when
	compiling "what went wrong" test case. (#79329)

	* m4macros/btk-2.0.m4: Remove reference to editing
	pkg-config script. (From Jim Gettys)

02-05-05  Matthias Clasen  <maclas@gmx.de>

	* configure.in: Bump version to 2.1.0, binary, interface age 0.

	* btk/btkcontainer.c (btk_container_class_list_child_properties): 
	(btk_container_class_find_child_property): Document.

	* btk/btkwidget.c: 
	* btk/btkwidget.h: New functions btk_widget_class_list_child_properties
	and btk_widget_class_find_child_property.  (#80652)
	
Sun May  5 15:56:50 2002  Owen Taylor  <otaylor@redhat.com>

	* configure.in: Fix problem with == in test argument.
	(#80732, Hidetoshi Tajima)

Sun May  5 16:42:32 2002  Kristian Rietveld  <kris@btk.org>

	The "big treeview focus patch". Fixes several issues and adds some
	goodies. Related bugs: #73676, #73734, #78660.

	* btk/btktreeview.h: add btk_tree_view_set_cursor_on_cell

	* btk/btktreeview.c (btk_tree_view_button_press): focus on a cell
	if applicable,
	(btk_tree_view_bin_expose): set_cell_data before iterating columns,
	add support for row-spanning focus rectangles,
	(btk_tree_view_has_special_cell): new function,
	(btk_tree_view_move_cursor_left_right): add support for multiple
	focusable cells in one column,
	(btk_tree_view_set_cursor): call _set_cursor_on_cell now,
	(btk_tree_view_set_cursor_on_cell): copy of _set_cursor, extended
	with focus_cell parameter,
	(btk_tree_view_search_iter): removed unused column variable,
	(btk_tree_view_start_editing): add neighbor size code to allow
	for multiple editable cells in one column.

	* btk/btktreeviewcolumn.c (_BtkTreeViewColumnCellInfo): add
	in_editing_mode field,
	(btk_tree_view_column_get_edited_cell): new function, removed
	_get_editable_cell,
	(_btk_tree_view_column_get_cell_at_pos): new function,
	(btk_tree_view_column_pack_end): s/g_new/g_new0/ ...,
	(btk_tree_view_column_cell_process_action): loads of changes to get
	it right and to allow for multiple special cells, etc,
	(btk_tree_view_column_cell_first): new function,
	(btk_tree_view_column_cell_last): ditto,
	(btk_tree_view_column_cell_next): ditto,
	(btk_tree_view_column_cell_prev): ditto,
	(btk_tree_view_column_cell_focus): add left and right parameters,	
	allow for multiple special cells,
	(btk_tree_view_column_cell_is_visible): add assertion,
	(btk_tree_view_column_focus_cell): new function,
	(btk_tree_view_column_stop_editing): unset in_editing_mode flag,
	(_btk_tree_view_column_get_neighbor_sizes): iterate through cells
	correctly

	* btk/btktreeviewcolumn.h: add btk_tree_view_column_focus_cell

	* btk/btktreeprivate.h: s/_get_editable_cell/_get_edited_cell/, add
	_btk_tree_view_column_get_cell_at_pos, add new parameters to
	_btk_tree_view_column_cell_focus.

	* tests/testtreeedit.c: add some cells in order to test new code.

Sun May  5 02:22:59 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* tests/test-images/*: image files for testing pixbuf loaders
	* tests/pixbuf-*.c: the old test-loaders.c split into four 
	different programs
	* tests/Makefile.am: add new pixbuf tests

2002-05-03 Erwann Chenede - <erwann.chenede@sun.com>

	* bdk/x11/bdkvisual-x11.c:
	* bdk/x11/bdkwindow-x11.c:
	* bdk/x11/bdkdisplay-x11.[hc] (bdk_open_display) :
	Rationalized the screen initialization process,
	changed the BdkDisplayX11 screen list to an array.
	
	* bdk/x11/bdkscreen-x11.[hc] (_bdk_x11_screen_new) :
	Moved the xinerama init functions to bdkdisplay-x11.c to
	this file, create a single function to fully initialize
	a BdkScreen. #79981
	
2002-05-03 Erwann Chenede - <erwann.chenede@sun.com>
  
        * btk/btkplug.[hc] (btk_plug_construct_for_display):
	changed the order of the arguments. #80278

2002-05-02  Matthias Clasen  <maclas@gmx.de>

	* bdk/bdkscreen.c (bdk_screen_get_monitor_at_window): Fix doc comment.

	* bdk/x11/bdkdisplay-x11.c (bdk_open_display): 
	* bdk/x11/bdkkeys-x11.c (bdk_keymap_get_default): 
	* bdk/x11/bdkfont-x11.c (bdk_fontset_load_for_display): 
	* bdk/x11/bdkfont-x11.c (bdk_font_from_description_for_display): 
	* bdk/x11/bdkfont-x11.c (bdk_font_load_for_display): 
	* bdk/x11/bdkscreen-x11.c (bdk_x11_screen_get_xscreen):
	* bdk/x11/bdkscreen-x11.c (bdk_x11_screen_get_screen_number): 
	* bdk/x11/bdkdisplay-x11.c (bdk_x11_display_get_xdisplay): 
	* bdk/x11/bdkdnd-x11.c (bdk_drag_get_protocol_for_display): Document.

	* btk/btknotebook.c (btk_notebook_set_show_border): Typo fix.

	* btk/btkwidget.c (btk_widget_class_init): Correct the
	composite_child blurb.   

	* btk/btknotebook.c (btk_notebook_set_show_border): Clarify docs.  (#73093)

2002-05-02 Erwann Chenede - <erwann.chenede@sun.com>
        
	* bdk/bdkscreen.c (bdk_screen_get_monitor_at_point):
	* bdk/bdkscreen.h :
	* bdk/x11/bdkscreen-x11.c :
	make bdk_screen_get_monitor_at_point cross platform instead
	of backend dependant. #80480
	* tests/testxinerama.c (main):
	changed the warning message.
	
2002-05-02 Erwann Chenede - <erwann.chenede@sun.com>

	* bdk/x11/bdkscreen-x11.c (bdk_screen_x11_get_root_window):
	removed unneeded ref. #79977
	* bdk/x11/bdkscreen-x11.[hc] (bdk_screen_use_virtual_screen):
	* bdk/x11/bdkdisplay-x11.c (check_*_xinerama):
	removed bdk_screen_use_virtual_screen function and 
	use_virtual_screen member variable from BdkScreenX11. #79957
	
2002-05-02  Matthias Clasen  <maclas@gmx.de>

	* btk/btktable.c (btk_table_class_init): 
	* btk/btknotebook.c (btk_notebook_class_init): 
	* btk/btkbox.c (btk_box_class_init): Add nicks and blurbs for
	child properties.  (#57143)

2002-05-01 Erwann Chenede - <erwann.chenede@sun.com>
  	
	* bdk/bdkpixmap.[hc] (bdk_pixmap_get_screen):
	* x11/bdkpixmap-x11.c:
	removed that function as bdk_drawable_get_screen
	does the job. #79964

2002-05-01 Erwann Chenede - <erwann.chenede@sun.com>

	* bdk/bdkscreen.[hc] (bdk_screen_x11_get_monitor_at_window):
	remove virtualization and made it cross platform. #79961
	* bdk/x11/bdkdisplay-x11.c (check_solaris_xinerama):
	fixed initialization bugs.
	* bdk/x11/bdkscreen-x11.[hc] (bdk_screen_get_monitor_geometry):
	* tests/testxinerama.c:
	* btk/btkwindow.c (btk_window_compute_configure_request):
	* btk/btkmenu.c (btk_menu_position):
	take a BdkRectangle argument instead of returning 
	a BdkRectangle * and propagated the changes. #79974
	
2002-05-01  Anders Carlsson  <andersca@gnu.org>

	* bdk/x11/bdkevents-x11.c 
	(bdk_x11_screen_supports_net_wm_hint): Use the same
	key when setting and getting NetWmSupportedAtoms.

Tue Apr 30 18:42:25 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwindow.c (btk_window_set_screen): Make it
	work, even if the window is already realized or
	mapped.

	* tests/testbtk.c: Erwann's multihead changes, slightly
	dumbed down. (Removed logic for pulling windows onto
	the current screen, people can click twice on the demo
	to destroy and create again.)

	* tests/prop-editor.c: Set the screen on the property
	editor if the edited object is a widget.

2002-05-01  Matthias Clasen  <maclas@gmx.de>

	* btk/btkcontainer.c (btk_container_class_install_child_property):
	Improve a warning.

	* bdk/linux-fb/bdkinput.c (bdk_device_get_axis): Remove a broken
	and redundant doc comment.

2002-04-30  Matthias Clasen  <maclas@gmx.de>

	* btk/btkprogress.c (btk_progress_class_init): 
	* btk/btkprogressbar.c (btk_progress_bar_class_init): 
	* btk/btktexttag.c (btk_text_tag_class_init): 
	* btk/btknotebook.c (btk_notebook_class_init): Better blurbs,
	incorporating stuff from the doc templates.

	* btk/btkplug.c (btk_plug_construct): Fix docs.

Tue Apr 30 15:59:53 2002  Owen Taylor  <otaylor@redhat.com>

	* tests/testmultiscreen.c: Multi-screen test case
	form multihead branch with a few cleanups. (Get rid
	of use of g_object_connect())

	* tests/testmultidisplay.c: Multi-display test case
	from multihead branch with a few improvements.
	(Allow the other display name to be passed on
	the command line, use a BtkDialog to get more attractive
	spacing.)

Tue Apr 30 14:23:43 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkdisplay-x11.c (bdk_open_display): fix
	problem with finalizing non-initialized fully display
	when failing to open display.

	* tests/testxinerama.c: Xinerama test case from
	multihead branch, with some cleanups. (Start even
	if there is only one monitor, for one.)

Tue Apr 30 14:15:14 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkfilesel.c btk/btkselection.c: Doc fixes.

2002-04-30  Erwann Chenede - <erwann.chenede@sun.com>

        * bdk/x11/bdkimage-x11.c : rationalized multihead code
        in _bdk_x11_copy_to_image. fixes #80256 and ungrab problems.

2002-04-30  Havoc Pennington  <hp@redhat.com>

	* btk/btktextlayout.c (btk_text_layout_real_free_line_data): use
	btk_text_layout_invalidate_cache instead of cut-and-paste
	(btk_text_layout_real_invalidate): always invalidate cache, even
	if the line has no stored line data. #78573

	* btk/btktextview.c (btk_text_view_get_iter_location): add call to
	btk_text_view_ensure_layout, #77388
	(btk_text_view_get_iter_at_location): ditto
	(btk_text_view_get_line_yrange): ditto
	(btk_text_view_get_line_at_y): ditto

2002-04-30  Havoc Pennington  <hp@redhat.com>

	* btk/btktextbtree.c (btk_text_btree_remove_tag_info): assign
	something to "prev" so that removing tag info succeeds.
	Part of #77301

	* btk/btktextbtree.c (_btk_text_btree_unref): reorder so that it
	unrefs the tag table first, so that the btree is in a consistent
	state when we're removing tags from it.	

Tue Apr 30 12:28:27 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkdisplay.c bdk/bdkbango.c bdk/bdkpixmap.c
	bdk/x11/bdkdisplay-x11.c bdk/x11/bdkevents-x11.c
	bdk/x11/bdkpixmap-x11.c bdk/x11/bdkx.h: Doc fixes.

Tue Apr 30 11:37:09 2002  Owen Taylor  <otaylor@redhat.com>

	* modules/input/btkimcontextxim.c: Make multihead-safe;
	use a different IM context per display.

	* configure.in acconfig.h: Add Xinerama checks from
	multihead branch, changing HAS_XINERAMA => HAVE_XINERAMA.

	* bdk/x11/bdkdisplay-x11.c: HAS_XINERAMA => HAVE_XINERAMA.

2002-04-29  Alex Larsson  <alexl@redhat.com>

	* bdk/bdkbango.c (bdk_draw_layout_line_with_colors):
	Use tmp also if foreground is set.

Mon Apr 29 18:28:00 2002  Owen Taylor  <otaylor@redhat.com>

	Integrate Erwann Chenede's multihead changes for the btk/ directory.

	* btk/btkclipboard.[ch]: Add btk_clipboard_get_for_display(),
	make internals multihead aware.

	* btk/btkcolorsel.[ch]: Add
	btk_color_selection_set_change_palette_with_screen_hook () [ugh!]
	make up for non-multihead safety of
	btk_color_selection_set_change_palette_hook()

	* btk/btkinvisible.[ch] btk/btkmenu.[ch] btkwindow.[ch]: Add
	btk_{invisible,menu,window}_set_screen(); add "screen" properties
	for BtkWindow and BtkMenu.

	* btk/btkplug.[ch]: Add btk_plug_construct_for_display(),
	btk_plug_new_for_display(). Multihead fixes.

	* btk/btkselection.[ch]: Add btk_selection_owner_set_for_display(),
	make internals multihead aware.

	* btk/btksettings.[ch]: Add btk_settings_get_for_screen(), get
	rid of now-useless btk_settings_constructor().

	* btk/btkstyle.[ch]: Add btk_style_get_font_for_display(), fix
	check/radio button indicators bitmap handling to be multihead
	safe.

	* btk/btkwidget.[ch]: Add btk_widget_get_screen(), btk_widget_has_screen(),
	btk_widget_get_display(), btk_widget_get_clipboard(),
	btk_widget_get_root_window().
	
	* btk/btkbindings.c btk/btkbutton.c btk/btkclist.c btk/btkcombo.c
	btk/btkctree.c btk/btkdnd.c btk/btkfilesel.c btk/btkgamma.c
	btk/btkhandlebox.c btk/btkhsv.c btk/btkimcontext.c btk/btklabel.c
	btk/btklist.c btk/btkmain.c btk/btkmenuitem.c btk/btkmenushell.c
	btk/btknotebook.c btk/btkoldeditable.c btk/btkoptionmenu.c
	btk/btkpaned.c btk/btkpreview.c btk/btksocket.c btk/btktext.c
	btk/btktextbuffer.c btk/btktextview.c btk/btktipsquery.c
	btk/btktooltips.c btk/btktreeview.c btk/btktreeviewcolumn.c:
	misc mechanical multihead-safety fixes.
	
	* btk/btkclipboard.c: Use a BtkImage rather than a pixmap for
	the dropper, look up the color palette only at realization time,
	other multihead fixes.

	* btk/btkcombo.c (btk_combo_unrealize): Popdown the list when 
	unrealizing.

	* btk/btkentry.c: Only claim ownership of the primary selection 
	when realized, misc multihead fixes.

	* btk/btkfontsel.c: Only fill in fonts when attached to a screen,
	fix btk_font_selection_get_font() for multihead.

	* btk/btkgc.c: make the depth => drawable hash per-screen.

	* btk/btkinvisible.c: Add a constructor that realizes the
	widget, so we get a realized widget with g_object_new() as
	well btk_invisible_new() as before.

	* btk/btkmain.c: Get rid of unused btk_visual/btk_colormap
	variables.

	* btk/btktextdisplay.c: Add warnings if stipple bitmaps
	are used on the wrong screen.

	* btk/btktoolbar.c: Make handling of BtkSettings-based layout
	read properties and connect to settings when the screen is changed,
	rather than on init/finalize.

	* btk/btkwindow.c: Fix icon handing to be multihead safe ...
	default icon pixmaps/mask are only shared between windows on the 
	same screen. Misc multihead fixes.

Sat Apr 27 13:49:53 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkclipboard.c (btk_clipboard_get_for_display):
	Update docs to reference BDK_SELECTION_CLIPBOARD rather BDK_NONE.

2002-04-29  Alex Larsson  <alexl@redhat.com>

	* bdk/linux-fb/bdkproperty-fb.c (bdk_property_get):
	Fix silly bug, noticed by Sven Neumann.

Sun Apr 28 22:43:55 2002  Jonathan Blandford  <jrb@gnome.org>

	* btk/btktreemodelsort.c (btk_tree_model_sort_set_sort_func): Fix
	so that you can set a new sort func.

2002-04-27  Anders Carlsson  <andersca@gnu.org>

	* bdk/x11/bdkpixmap-x11.c (bdk_pixmap_foreign_new_for_display): 
	Use BDK_DISPLAY_XDISPLAY instead of BDK_SCREEN_XDISPLAY since
	we pass in a BdkDisplay * in the macro.

2002-04-26  Anders Carlsson  <andersca@gnu.org>

	* bdk/bdkdisplay.c: (bdk_set_default_display):
	Call _bdk_windowing_set_default_display.
	
	* bdk/bdkinternals.h:
	* bdk/x11/bdkmain-x11.c: (_bdk_windowing_set_default_display):
	New function that sets bdk_display to the default display.
	Fixes #79965
	
Fri Apr 26 21:58:16 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreemodel.c (btk_tree_row_ref_deleted_callback): if the
	deleted node was "below" this path, then do not unref all nodes
	between the deleted parent and the node this rowref is pointing too
	(see added comment in btk_tree_row_ref_deleted_callback),
	(fixes #77977)

2002-04-26  Sven Neumann  <sven@gimp.org>
 
        * tests/testtreecolumns.c
        * tests/testtreeview.c: quit the main loop when the window is
        destroyed. Removed compiler warnings about wrong format in printf().
 
Fri Apr 26 21:46:42 2002  Kristian Rietveld  <kris@btk.org>

	This commit fixes binary compatibility, which I broke with my
	recent cell renderer commits :/.

	* btk/btkcellrenderer.h: move cell_background out of _BtkCellRenderer

	* btk/btkcellrenderer.c: create BtkCellRendererInfo, with the
	cell_background field and use this as object data. This way we keep
	the field private and dont break ABI.

	* btk/btkcellrendererpixbuf.h: remove stock_id, stock_size and
	stock_detail from _BtkCellRendererPixbuf

	* btk/btkcellrendererpixbuf.c: create a BtkCellRendererPixbufInfo
	with above mentioned fields. And update everything.

Fri Apr 26 21:42:02 2002  Kristian Rietveld  <kris@btk.org>

	* bdk/x11/bdkdrawable-x11.h: include X11/Xlib.h, fixes the build

Fri Apr 26 10:34:15 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/Makefile.am (libbdk_x11_la_SOURCES): Add
	missing bdkscreen/display-x11.h files.

Thu Apr 25 16:51:40 2002  Owen Taylor  <otaylor@redhat.com>

	Start of integration of Erwann Chenede's multihead work
	from the btk-multihead branch.

	* bdk/bdkdisplay.[ch] bdk/bdkscreen.[ch]
	bdk/x11/bdkdisplay-x11.[ch] bdk/x11/bdkscreen-x11.[ch]
	New classes representing a set of screens with attached
	input devices and a single contiguous area, respectively.

	* bdk/bdk.[ch] bdk/bdkinternals.h bdk/x11/bdkmain-x11.c:
	bdk/x11/bdkprivate-x11.h: Make the initialization interface
	simple _bdk_windowing_init() and do the rest in
	bdk_open_display() calls.

	* bdk/bdk.[ch]: Add bdk_parse_args() which can be used
	to do the display-independent part of initialization
	instead of bdk_init_[check].

	* bdk/bdkcursor.h bdk/bdkfont.h bdk/bdkkeys.h bdk/bdkpixmap.h
	bdk/bdkproperty.h bdk/bdkselection.h bdk/bdkwindow.h:
	Add multihead variants (_for_display(), for_screen()) of functions
	getting information specific to a particular screen screen or
	display.

	* bdk/bdkscreen.[ch]: Add bdk_screen__* variants of functions
	like bdk_rgb_get_colormap() that used to get/list global
	objects.

	* bdk/x11/bdkx.h: Add functions for converting BdkScreen
	and BdkDisplay into the X equivalents.

	* bdk/x11/bdkwindow-x11.c: Removed bdk_window_xid_at_coords() 
	not in the headers and unused.

	* configure.in bdk/x11/{gxid.c,gxid_lib.[ch],bdkinput-gxi.c}:
	Remove gxid support ... has not been tested for a long time...
	"xfree" support is more	portable to non XFree86.

	* bdk/**.h: Add a BDK_MULTIHEAD_SAFE define that can be
	used to turn off functions that are inherently non-multihead
	safe.

	* bdk/**.c: add BDK_NOTE(multihead, ...) calls when functions
	are used in non-multihead-safe ways.

	* bdk/*.c bdk/x11/*.c: Changes to make the internals of BDK
	multihead safe.

Thu Apr 25 23:49:01 2002  Kristian Rietveld  <kris@btk.org>

	Fixes #74206.

	* btk/btktreeprivate.h: add _btk_tree_view_column_count_special_cells

	* btk/btktreeviewcolumn.c (_btk_tree_view_column_has_editable_cell),
	(_btk_tree_view_column_get_editable_cell): remove a space which made
	the code look ugly
	(_btk_tree_view_column_count_special_cells): new function,
	(btk_tree_view_column_cell_process_action): if there's only one
	activatable cell, the whole column will activate that renderer.

Thu Apr 25 23:36:55 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreeview.c (btk_tree_view_search_iter): make the search
	dialog not scroll horizontally (prolly fixes #74806).

2002-04-25  Matthias Clasen  <maclas@gmx.de>

	* btk/btkrange.c (btk_range_calc_layout): Avoid a possible
	division by zero.  (#77820)

Thu Apr 25 20:24:37 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* btk/btkmenuitem.c (btk_menu_item_size_allocate): use the child's
	requisition.height, not allocation.height, as width of submenu
	indicator. (#75948)

Thu Apr 25 00:26:34 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreemodelsort.c (btk_tree_model_sort_reset_default_sort_func):
	resort if we're already in 'unsorted' state, and update the docs

2002-04-24  Matthias Clasen  <maclas@gmx.de>

	* btk/btktreeview.c (btk_tree_view_stop_editing): Remove doc
	comment markers on freeform comments.

Wed Apr 24 17:34:16 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreeview.c (btk_tree_view_stop_editing): temporarily set
	->priv->edited_column to NULL. Pleas read the comment in this
	function for an explanation (fixes #79632).

2002-04-23  Matthias Clasen  <maclas@gmx.de>

	* btk/btktextview.c (btk_text_view_buffer_to_window_coords): 
	(btk_text_view_window_to_buffer_coords): Improve docs.  (#62359)

Tue Apr 23 18:35:34 2002  Kristian Rietveld  <kris@btk.org>

	This commit adds a cell_background property for cell renderers. With
	this property you can make your TreeView look incredibly ugly.

	* btk/btkcellrenderer.c: add cell_background, cell_background_bdk and
	cell_background_set properties,
	(set_cell_bg_color): new function,
	(btk_cell_renderer_get_property), (btk_cell_renderer_set_property):
	support for new properties,
	(btk_cell_renderer_render): render a background when set.

	* btk/btkcellrenderer.h: add cell_background_set and cell_background
	fields.

	* btk/btktreeviewcolumn.c (btk_tree_view_column_cell_process_action):
	when rendering, pass in just the background_area of the cell and not
	the background_area of the entire column.

2002-04-22  Anders Carlsson  <andersca@gnu.org>

	* btk/btkentry.c (btk_entry_drag_data_get): Use 
	btk_entry_get_public_chars. 
	Fixes #79532 (Reported by Ovidiu Gheorghioiu).

Mon Apr 22 19:24:29 2002  Kristian Rietveld  <kris@btk.org>

	This commit adds stock icon functionality to BtkCellRendererPixbuf
	which is totally cool.

	* btk/btkcellrendererpixbuf.h: add some fields

	* btk/btkcellrendererpixbuf.c: add finalize method, add some
	properties, add some stock icon rendering code.

	* demos/btk-demo/stock_browser.c: modified to use the stock
	icon stuff in the cellrendererpixbuf instead of its own stock icon
	rendering code.

2002-04-21  Alexander Larsson  <alla@lysator.liu.se>

	* bdk/x11/bdkwindow-x11.c (bdk_window_reparent):
	Save x and y in window_private.

	* btk/btkplug.c (_btk_plug_add_to_socket):
	Move plug window outside the visible area to avoid flashing until
	the first size_allocate.

2002-04-21  Matthias Clasen  <maclas@gmx.de>

	* btk/btktextiter.c (btk_text_iter_forward_search): More verbose
	description of match_start and match_end return values.  (#57929)

	* btk/btktreeselection.c (_btk_tree_selection_internal_select_node):
	* btk/btktreeview.c (_btk_tree_view_column_autosize): Remove doc
	comment markers on freeform comments.

	* btk/btktreemodelsort.c
	(btk_tree_model_sort_convert_path_to_child_path): Doc fixes. (#68404)

Sat Apr 20 21:15:11 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* btk/btkmenuitem.c: add "selected_shadow_type" style property

Sat Apr 20 12:07:14 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.c (btk_widget_modify_color_component): Accept
	NULL for color to mean "unmodify"

	* btk/btkwidget.c (btk_widget_modify_font): Accept NULL for
	font_desc to mean "unmodify".

Sat Apr 20 16:49:26 2002  Kristian Rietveld  <kris@btk.org>

	* bdk/x11/bdkpixmap-x11.c (bdk_pixmap_new): replace BDK_IS_WINDOW
	with BDK_IS_DRAWABLE in the assert, only check BDK_WINDOW_DESTROYED
	if window is a BdkWindow,
	(bdk_bitmap_create_from_data): ditto,
	(bdk_pixmap_create_from_data): ditto

Fri Apr 19 23:38:16 2002  Kristian Rietveld  <kris@btk.org>

	Fixes #50310.

	* btk/btktreeprivate.h: add _btk_tree_view_column_autosize

	* btk/btktreeview.c: privately export _btk_tree_view_column_autosize,
	and add a small note about that function,
	(btk_tree_view_button_press): check for double click and
	"not having an autosize" column before autosizing the column,
	
	* btk/btktreeviewcolumn.c (btk_tree_view_column_set_min_width):
	call _btk_tree_view_column_autosize to update autosized column width
	(btk_tree_view_column_set_max_width): ditto

2002-04-20  Matthias Clasen  <maclas@gmx.de>

	* TODO, TODO.xml, README.nanox, docs/Changes-1.2.txt,
	docs/Changes-2.0.txt, docs/btk-config.txt, docs/debugging.txt,
	bdk/TODO: Remove some files whose content is either obsolete or
	has been moved elsewhere.

	* Makefile.am, btk+.spec.in, docs/Makefile.am: Remove references
	to these files.
	
Fri Apr 19 21:31:04 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreeview.c (btk_tree_view_row_changed): cancel editing
	if tree_view->priv->edited_column != NULL (fixes #76066)

Fri Apr 19 21:06:39 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreeview.c (btk_tree_view_size_allocate): subtract
	TREE_VIEW_HEADER_HEIGHT from allocation->height to get the real
	size for the tree (fixes #72729),
	(btk_tree_view_real_start_editing): correct cell_area->y for
	scrolling due to btk_tree_view_real_set_cursor (fixes #75687)

Fri Apr 19 16:30:09 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreeprivate.h, btk/btktreeview.c: rename
	last_single_clicked{,_2} to last_button_press{,_2}, as the latter
	is a more sane name.

	* btk/btktreeview.c (btk_tree_view_button_press): use ->priv->anchor
	instead of ->priv->cursor, check for the anchor at another place, as
	you can go in edit mode without	having an anchor.

2002-04-18  Matthias Clasen  <maclas@gmx.de>

	* btk/btkitemfactory.c:
	* btk/btkiconfactory.c:
	* btk/btkwidget.c:
	* btk/btkstyle.c:
	* btk/btkrc.c:
	* btk/btktreeviewcolumn.c:
	* btk/btkdialog.c:
	* btk/btktreemodel.c: s/<!>/<!-- -->/g throughout the
	documentation to bring the produced Docbook closer to XML.

2002-04-18  Tor Lillqvist  <tml@iki.fi>

	* bdk-pixbuf/Makefile.am (uninstall-libtool-import-lib)
	* bdk/Makefile.am (uninstall-libtool-import-lib): Fix typo,
	thanks to David Sterba for noticing.

	* btk/btkmain.h
	* btk/btkmain.c (btk_init_abi_check, btk_init_check_abi_check): In
	BTK+ 2.0 the BtkWindow struct actually is the same size in gcc on
	Win32 whether compiled with -fnative-struct or not. Unfortunately
	this wan't noticed until now. So, from now on, check some other
	struct, too, for which the use of -fnative-struct still
	matters. BtkBox is one such.

Thu Apr 18 00:23:31 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreemodelsort.c
	(btk_tree_model_sort_convert_path_to_child_path): so this function
	was completely broken. Fix it and improve readability.

2002-04-17  Anders Carlsson  <andersca@gnu.org>

	* tests/testtreeedit.c (button_press_event): Add a small
	test case.

Wed Apr 17 00:21:36 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreestore.c (btk_tree_store_insert_before): fix docs

Tue Apr 16 17:28:21 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreeview.c (btk_tree_view_real_collapse_row): check
	->priv->cursor and ->priv->anchor rowrefs before removing
	node->children from the rbtree. Also check the
	->priv->last_single_clicked and ->priv->last_single_clicked_2 rowrefs
	(I think I really need to rename those two someday).

Tue Apr 16 07:53:49 2002  Tim Janik  <timj@btk.org>

	* btk/btkmenu.c (btk_menu_key_press): don't install/change accelerators
	from locked accel groups.

	* btk/btkwidget.c (_btk_widget_get_accel_path): export whether the
	accel path is from a locked accel group.

Mon Apr 15 15:41:56 2002  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkcontainer.c (btk_container_focus): include internal
	children when doing focus.
	(btk_container_get_all_children): new static function to include
	internal children when making a list of them.

Sun Apr 14 16:56:59 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreeprivate.h: add _btk_tree_view_column_get_editable_cell and
	_btk_tree_view_column_get_neighbor_sizes

	* btk/btktreeviewcolumn.c (struct _BtkTreeViewColumnCellInfo): add
	real_width field,
	(_btk_tree_view_column_get_editable_cell): implement,
	(btk_tree_view_column_cell_process_action): fill info->real_width
	(_btk_tree_view_column_get_neighbor_sizes): implement

	* btk/btktreeview.c (btk_tree_view_button_press): make the "editable
	widget" show up with the same size as the actual cell, so it doesnt
	cover the complete column if there are any other cells in that column.

2002-04-14  Abibail Brady  <morwen@evilmagic.org>

	* btk/btkfilesel.c: Fix typo in message.

2002-04-13  Havoc Pennington  <hp@pobox.com>

	* bdk/bdkpixbuf-drawable.c (bdk_pixbuf_get_from_drawable): create
	the target pixbuf AFTER filling in width/height, so that 
	passing in -1 for width/height will work.
	
Sat Apr 13 22:49:45 2002  Kristian Rietveld  <kris@btk.org>

	Fixes #75510

	* btk/btktreeselection.c (btk_tree_selection_get_selected): make this
	function work correctly and more sane

	* btk/btktreeview.c (btk_tree_view_real_collapse_row): remove
	node->children from rbtree before emitting BtkTreeSelection::changed

Sat Apr 13 17:15:12 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btkcellrenderertext.c (btk_cell_renderer_text_init): dont set
	the mode to BTK_CELL_RENDERER_MODE_EDITABLE by default,
	(btk_cell_renderer_text_class_init): for some reason our default for
	editable was TRUE, of course this is FALSE.
	(btk_cell_renderer_text_set_property): update mode when editable
	has been changed.

2002-04-12  jacob berkman  <jacob@ximian.com>

	* bdk/x11/xsettings-client.c (fetch_card8): fix cut-n-paste bug
	which breaks big-endian machines (fixes #73585)

2002-04-12  Havoc Pennington  <hp@redhat.com>

	* btk/btknotebook.c (btk_notebook_real_remove): relocate the
	remove_weak_pointer to just before we free the page, to be sure 
	it doesn't get re-added. #75282

Fri Apr 12 18:32:46 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreeview.c (btk_tree_view_real_set_cursor): add
	clamp_node argument
	(toplevel): update usages of btk_tree_view_real_set_cursor,
	(btk_tree_view_focus_to_cursor): don't let
	btk_tree_view_real_set_cursor clamp the node, so you won't get
	unexpected scrolling

2002-04-11  Michael Meeks  <michael@ximian.com>

	* btk/btklabel.c
	(btk_label_parse_uline, btk_label_set_text),
	(btk_label_set_text_with_mnemonic): add freeze / thaws
	to stop deluge of 'notify' signals.

Sat Apr  6 06:57:00 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmenushell.[ch] btk/btkmenuitem.c: Export
	private _btk_menu_shell_activate() to encapsulate
	cut-and-paste code.

	* btk/btkmenubar.c: Select the first item on the menu bar
	for F10	rather than acting as if the user pressed <Alt>F
	to select the file manager.

Tue Apr  9 19:01:28 2002  Owen Taylor  <otaylor@redhat.com>

        Fix problems with HandleBox and focusing - #78232

	* btk/btkwidget.c (btk_widget_translate_coordinates): Handle
	BtkHandleBox / GnomeDock style window heirarchy / widget
	heirarchy disconnects. :-(. 

	* btk/btkcontainer.c: Handle failures from
	btk_widget_translate_coordinates (Focusing is not right, but at
	least it doesn't go into infinite loops.)

Tue Apr  9 18:34:58 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkcontainer.c (_btk_container_queue_resize): Always
	set the ALLOC_NEEDED and REQUEST_NEEDED flags up the hierarchy,
	even if we aren't currently in a resize container... we need
	this to properly handle size changes to widgets that are
	being moved from one heirarchy to another. (#78226)

Tue Apr  9 21:41:24 2002  Kristian Rietveld  <kris@btk.org>

	Fixes #78110

	* btk/btktreeselection.c (_btk_tree_selection_internal_select_node):
	add override_browse_mode argument and implement,
	(btk_tree_selection_unselect_path): always unselect the path,
	(toplevel): update uses of _btk_tree_selection_internal_select_node

	* btk/btktreeview.c: update uses of
	_btk_tree_selection_internal_select_node

	* btk/btktreeprivate.h (_btk_tree_selection_internal_select_node):
	update prototype

Tue Apr  9 21:39:44 2002  Kristian Rietveld  <kris@btk.org>

	Fixes #77862

	* btk/btktreeprivate.h: add _btk_tree_view_column_has_editable_cell

	* btk/btktreeviewcolumn.c (_btk_tree_view_column_has_editable_cell):
	new function

	* btk/btktreeview.c (btk_tree_view_button_press): send cell event
	on first click when cell isn't editable

Tue Apr  9 21:37:31 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreedatalist.c (_btk_tree_data_list_check_type): add some
	types which were missing and useful to use (fixes #77870)

2002-04-09  Anders Carlsson  <andersca@gnu.org>

	* btk/btkfilesel.c (open_new_dir): Initialize error to NULL.

2002-04-08  Manish Singh  <yosh@gimp.org>

	* tests/testbtk.c: really revert testbtk.c

Mon Apr  8 20:28:54 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreeselection.c (btk_tree_selection_select_path),
	(btk_tree_selection_unselect_path),
	(btk_tree_selection_path_is_selected): check the return value of
	_btk_tree_view_find_node and return if it's TRUE. This makes those
	functions work somewhat saner on non-expanded trees.

Fri Apr  5 18:28:56 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreeselection.c (btk_tree_selection_set_mode): free
	anchor row reference after unselecting the selection (fixes #76272)

Fri Apr  5 18:27:48 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreeview.c (btk_tree_view_real_expand_row): only return
	when we don't have to open all children (fixes #75736)

Fri Apr  5 18:24:24 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreeviewcolumn.c (btk_tree_view_column_clear): unref
	cellrenderer after clearing the attributes of the renderer (fixes
	#75592)

Fri Apr  5 05:55:14 2002  Jonathan Blandford  <jrb@gnome.org>

	* btk/btktreeview.c (btk_tree_view_grab_focus): implement.
	  (btk_tree_view_move_cursor_up_down): check for focus
	  (btk_tree_view_move_cursor_page_up_down): ditto
	  (btk_tree_view_move_cursor_left_right): ditto
	  (btk_tree_view_move_cursor_start_end): ditto
	  (btk_tree_view_real_select_all): ditto
	  (btk_tree_view_real_unselect_all): ditto
	  (btk_tree_view_real_select_cursor_row): ditto	
	  (btk_tree_view_real_toggle_cursor_row): ditto
	  (btk_tree_view_real_expand_collapse_cursor_row): ditto
	  (btk_tree_view_real_select_cursor_parent): ditto
	  (btk_tree_view_real_start_interactive_search): ditto

	* btk/btktreeviewcolumn.c: grab focus

2002-04-05  Alex Larsson  <alexl@redhat.com>

	* bdk/linux-fb/bdkkeyboard-fb.c (write_string):
	Fix undefined variable typo.
	Patch from Simon Floery <simon.floery@gmx.at>

Fri Apr  5 01:06:15 2002  Tim Janik  <timj@btk.org>

	* bdk/x11/bdkwindow-x11.c (set_text_property): fix segfault
	upon NULL return from bdk_utf8_to_string_target().

	* bdk/x11/bdkselection-x11.c (bdk_utf8_to_string_target): fix
	return value comment to mention NULL returns upon EMFILE.

Thu Apr  4 22:35:42 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* tests/testbtk.c (menu_items): revert accidentally commited
	change to testbtk.c

Thu Apr  4 22:28:08 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* btk/btkmenuitem.c (btk_menu_item_paint): Fix problem with menu
	titles being clipped (#75948)
	
2002-04-04  Tor Lillqvist  <tml@iki.fi>

	* bdk/bdkrgb.c: Fix some bugs, and introduce a minor feature.

	(bdk_rgb_convert_4_pack): New function, for 16-color (4 bits per
	pixel) static visuals (fixes #858).

	(bdk_rgb_convert_gray4_pack, bdk_rgb_convert_gray4_d_pack): Fix
	same bugs in both functions: Odd start coordinate (partial byte)
	was not handled correctly. Also a partial final byte was not
	handled correctly.

	(bdk_rgb_do_colormaps): Use G_N_ELEMENTS.
	(bdk_rgb_create_info): For pseudocolor visuals, use the 2x2x2
	colorcube only for depths 3 and 4. For static color, use it for
	depths 3..7 like before. (Depth 5..7 pseudocolor probably never
	occurs on X11. It doesn't normally occur on Win32 either, but
	there is experimental code in bdkvisual-win32.c to let the user
	restrict the size of palette used.)
	(bdk_rgb_init): Set bdk_rgb_verbose if the BDK_DEBUG_BDKRGB flag
	is set.
	(bdk_rgb_select_conv): Use bdk_rgb_convert_8 also for depths 5, 6
	and 7 (see above). Use bdk_rgb_convert_4_pack for 4 bits per pixel
	static color.

Tue Apr  2 11:10:13 2002  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkliststore.c (btk_list_store_set_sort_func): set the
	sort_func correctly, 77030

Tue Apr  2 13:44:27 2002  Tim Janik  <timj@btk.org>

	* configure.in: update version to 2.0.2, binary age 2, interface
	age 2.

	* NEWS: updates for 2.0.2.

Mon Apr  1 22:20:24 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreeview.c (btk_tree_view_move_cursor_page_up_down): add
	check for y > tree_view->priv->height (fixes #76974)

Mon Apr  1 22:19:39 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreemodelsort.c (btk_tree_model_sort_sort_level): get
	the stamp changes right this time

Mon Apr  1 22:13:24 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreemodel.c (btk_tree_row_reference_free): only
	disconnect the ref callbacks when model == proxy (Thanks go to
	Manuel Clos Crespo for the remote debugging)

Sat Mar 30 15:19:24 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreemodelsort.c: revert the latest stamp increment changes,
	as it broke stuff for trees

Fri Mar 29 18:15:12 2002  Owen Taylor  <otaylor@redhat.com>

	* ===== Released 2.0.1 ======

Fri Mar 29 18:09:18 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkaccelgroup.c (btk_accel_group_query): Call 
	bdk_keyval_to_lower() on the key passed in, since we
	lowercase all other key vals passed in, so querying
	keyvals will otherwise fail if the caller used
	an uppercase accelerators (#76899, Vitaly Tishkov)

Fri Mar 29 17:41:21 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmain.c (load_modules): Fix screwup in handling
	of module path that was resulting in freed memory being
	accessed when both BTK_MODULES and a theme were set.
	(#76902, Johan Dahlin)

Fri Mar 29 17:57:36 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkiconfactory.c (get_default_icons): Fix wrong
	stock id's for ADD/REMOVE. (#76915, Vitaly Tishkov)

2002-03-29  Hans Breuer  <hans@breuer.org>

	* btk/btkmain.h : fix typo in btk_init_check macro, which
	caused crashes if argc != 0

	* btk/stock-icons/makefile.msc : added new icons

Fri Mar 29 20:17:35 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreemodelsort.c (btk_tree_model_sort_rows_reordered):
	remove call to btk_tree_model_sort_increment_stamp
	(btk_tree_model_sort_sort_level): always increment the stamp

Fri Mar 29 00:19:41 2002  Owen Taylor  <otaylor@redhat.com>

	* NEWS: Updates

	* configure.in: Version 2.0.1, binary, interface age 1.

	* configure.in (BDK_PIXBUF_VERSION): Up required versions
	of dependencies.

	* btk/btkiconfactory.c btk/stock-icons/Makefile.am:
	Add stock_add/remove_16.

Thu Mar 28 18:38:30 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btk[hv]paned.c (btk_[hv]paned_size_allocate): 
	Don't show the window unless the widget is mapped.
	(#76742, Dennis Björklund, Soeren Sandmann)

2002-03-29  Hans Breuer  <hans@breuer.org>

	Fixed dashed line issues (#74441) to an IMO reasonable extend. 
	That is: use PS_USERSTYLE on WinNT (the next GDI limit appears
	to be with lines width > 50); Render horizontal and vertical
	dashed lines on Win9x 'by hand'. Dotted selection rectangles 
	and Dia look nice ...

	* bdk/win32/bdkprivate-win32.h : add pen_dashes pointer and
	num_pen_dashes to _BdkGCWin32
	* bdk/win32/bdkgc-win32.c : initialize pen_dashes and remove
	the guesses from dashes to windoze line styles.
	(predraw_set_forground) : always ExtCreatePen (PS_SOLID) on
	Win9x, which does not support PS_USERSTYLE.
	* bdk/win32/bdkdrawable-win32.c : new functions render_line_
	<horizontal|vertical>. Use them if not running on NT in
	bdk_win32_draw_<rectangle|segments|lines> ()

	* bdk/win32/bdkkeys-win32.c (bdk_keyval_name) : return NULL
	for keyval == 0 to avoid to have zeros in all menu entries 
	without accelerator.

2002-03-29  Jakub Steiner <jimmac@ximian.com>

	* btk/stock-icons/stock_add_24.png:
	* btk/stock-icons/stock_add_16.png:
	* btk/stock-icons/stock_remove_24.png:
	* btk/stock-icons/stock_remove_16.png: use a simple '+' and '-',
	  works better. the old box was too clumsy

Thu Mar 28 21:11:04 2002  Tim Janik  <timj@btk.org>

	* btk/btkfilesel.c (open_new_dir): when encountering non-UTF-8 file
	names, alert the user with g_message() instead of g_warning() and
	put out the actual conversion error.

2002-03-28  Dave Camp  <dave@ximian.com>

	* btk/btktreeview.c (install_scroll_sync_handler): Don't install
	the handler if the widget isn't realized.

2002-03-28  Jakub Steiner <jimmac@ximian.com>

	* btk/stock-icons/stock_font*:
	* btk/stock-icons/stock_align*:
	* btk/stock-icons/stock_text*: better solution to the dark theme
	  problem. Also looks more pretty IMHO

2002-03-27  Matthias Clasen  <maclas@gmx.de>

	* configure.in: Try to find libpng via pkg-config first,
	since libpng-1.2.2 will come with a .pc file.

Wed Mar 27 11:10:39 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btknotebook.c (btk_notebook_real_remove): Set
	page->last_focus_child to NULL as well as removing the
	weak reference, to deal with reentrancy in set_focus_child().
	(#76634, Dennis Björklund)

2002-03-27  Murray Cumming  <murrayc@usa.net>
 
 	* btk/btktreeview.c: Corrected registered return type of
	"move-cursor" signal. Had to add a marshaller to 
 	btk/btkmarshalers.list.
	
Tue Mar 26 14:46:50 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmenu.c (btk_menu_popup): Shuffle the ordering around
	some more (position before realizing) fixing problems with 
	arrows popping up at the wrong time (#73386), hopefully not
	introducing other problems. (Reported by Ettore Perrazoli, others)

2002-03-26  Dave Camp  <dave@ximian.com>

	* btk/btktreeview.c (btk_tree_view_button_press): Free the path
	after calling btk_tree_view_row_activated() rather than before.

2002-03-25  Sven Neumann  <sven@gimp.org>

	* btk/btkrc.c (btk_rc_parse_font_name): free the style's
	font_description before assigning a new one.
	(btk_rc_parse_stock): always unref the created icon_set. #76289
	
2002-03-25  Mark McLoughlin  <mark@skynet.ie>

	* btk/btkbindings.c: (btk_binding_entry_add_signal),
	kill code duplicated in btk_binding_entry_add_signall.

Sun Mar 24 10:32:38 2002  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreemodel.c (btk_tree_path_copy): Make path arg const, #75653

	* btk/btkfontsel.c (btk_font_selection_show_available_styles): fix
	a warning

	* btk/btktreeview.c (btk_tree_view_button_press): remove the grab
	when we emit row_activated so that listeners of this signal can
	grab the mouse, #75629

2002-03-23  Havoc Pennington  <hp@pobox.com>

	* btk/btktextlayout.c (btk_text_layout_real_invalidate):
	invalidate the line containing start, even if the [start,end)
	range is empty (just invalidate [start,end], essentially).
	Partially fixes #72374

2002-03-23  Havoc Pennington  <hp@pobox.com>

	* btk/btktextview.c (btk_text_view_do_popup): end any selection in
	progress, patch from db@zigo.dhs.org, #74620

2002-03-23  Havoc Pennington  <hp@pobox.com>

	* btk/btktextview.c (btk_text_view_move_cursor_internal): extend
	selection for pageup/pagedown and ctrl+pageup/pagedown if 
	shift is held. more of #53934

2002-03-23  Havoc Pennington  <hp@pobox.com>

	* btk/btktextview.c (btk_text_view_destroy_layout): disconnect 
	layout handlers earlier in the function, to avoid possible
	reentrancy screwups
	(btk_text_view_invalidate): Don't install idle handlers if 
	layout == NULL, otherwise we get problems during finalization 
	since clearing the buffer invalidates and puts the idle handlers
	back after we destroy the layout. #74660
	(btk_text_view_ensure_layout): Install the validation handlers
	right after creating the layout.

	* btk/btktexttagtable.c (foreach_unref): call
	_btk_text_buffer_notify_will_remove_tag(), #75126

2002-03-22  Havoc Pennington  <hp@pobox.com>

	* bdk/x11/bdkfont-x11.c (bdk_fontset_load): add more explanatory
	text to the error message about missing charsets, and use
	g_printerr() not g_warning() since this is typically not a
	programming error (we do not export any API to ask whether 
	a font set will have missing charsets so apps realistically can't 
	do anything other than try the bdk_fontset_load())

	* btk/btktextview.c (btk_text_view_key_press_event): return FALSE
	if the text view isn't editable and the user presses Return, 
	so default buttons and such can be activated, #74937

	* btk/btktextbuffer.c (paste_from_buffer): don't insert 
	if the insertion point is not editable and the paste 
	is interactive, #74125

	* btk/btkwindow.c (btk_window_move_resize): enhance the #if 0
	debug spew

	* btk/btktextbuffer.c (cut_or_copy): only remove the previous 
	cut/copied data right before replacing it, when we know we are
	going to replace it. Fixes #74049

2002-03-22  Richard Hult  <rhult@codefactory.se>

	* bdk/bdkevents.c (bdk_event_get_root_coords): Fix typo, where x
	value was assigned to both x and y.

Fri Mar 22 11:29:11 2002  Owen Taylor  <otaylor@redhat.com>

	Partial fix for problem where keypad keys acted
	as shift-arrows in an entry rather than arrows (#74327)

	* btk/btkkeyhash.c (_btk_key_hash_lookup): Sort lookup
	results by number of modifiers in the entry. Fixes
	problem where if a key matched both modified and unmodified
	key bindings ... e.g., the distinguishing key binding
	was consumed, then it was random which was used. 

	* btk/btkbindings.c (btk_binding_entries_sort_patterns): 
	Catch the case where there are multiple entries from the
	same bindingset (with different modifiers), and use only
	the first entry, which, with the change in _btk_key_hash_lookup()
	will be the preferred value.

Fri Mar 22 10:56:19 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkaccelmap.c (btk_accel_map_save_fd): Fix memory
	leak. (#74400, Morten Welinder.)

	* btk/btkaccelmap.c: Properly handle short returns from
	write() calls. (Handling EINTR isn't enough... that only
	handles the case where you were interrupted before you
	wrote a single byte.)
	
	* bdk/linux-fb/bdkmouse-fb.c bdk/linux-fb/bdkkeyboard-fb.c:
	Robustify against short returns from write() calls.

Fri Mar 22 10:12:10 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btktextview.c (btk_text_view_paint): Change
	G_BREAKPOINT() to g_assert_not_reached ().
	(#75865, Ashok Venkiteswaran)
	
2002-03-22  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkgc-win32.c (bdk_win32_gc_set_dashes): Don't clear
	all of the pen_style, just the PS_STYLE_MASK. Seems to fix #74441,
	but that is just the special case of one-pixel wide one-pixel
	on-off dotted lines. To fully implement generic X11 style dashed
	lines a major rewrite would be needed.

2002-03-21  Matthias Clasen  <maclas@gmx.de>

	* btk/btkaccelgroup.c (btk_accelerator_valid): Trivial typo
	fix. (Vitaly Tishkov, #75726)

Thu Mar 21 10:04:05 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkwindow.c (bdk_window_real_get_depth): Remove
	some left over debugging code with a G_BREAKPOINT()
	in it.

Wed Mar 20 19:33:31 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkcalendar.c (btk_calendar_main_button): When
	changing months when the user clicks on a prev-month
	or next-month day, focus and select the new day.
	Ignore double clicks on prev-month, next-month days.
	(Based on suggestions from Andras Salamon, #74173)

	* btk/btkcalendar.c: Implement the focused/unfocused
	selected color change.

2002-03-20  Alex Larsson  <alexl@redhat.com>

	Patches from Carlo E. Prelz <fluido@fluido.as>
	Now btkfb at least compiles and mostly works. The keyboard
	stuff needs more loving.
	
	* bdk/linux-fb/bdkkeyboard-fb.c (xlate_get_for_keyval,
	xlate_get_for_keycode, raw_get_for_keyval, raw_get_for_keycode):
	At least set the out parameters for these calls.

	* bdk/linux-fb/bdkmain-fb.c:
	(bdk_pointer_grab_info_libbtk_only, bdk_keyboard_grab_info_libbtk_only):
	Implement new functions.
	
Wed Mar 20 19:00:03 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkentry.c (btk_entry_set_text): Short-circuit
	the text to the exact same thing, so we don't 
	unexpectedly change the selection or cursor position.
	(#74290, John Ellis.)

Thu Mar 21 00:05:14 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreeview.c (btk_tree_view_get_background_area),
	(btk_tree_view_get_cell_area): fix logic (fixes #74235, #73593)

Wed Mar 20 17:11:51 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkrc.c: Patch from Richard Hestilow to fix
	btk-font-name changes for widgets that get the actual
	default style. (#73709)

Wed Mar 20 22:59:23 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btkrbtree.[ch]: add _btk_rbtree_set_fixed_height()

	* btk/btktreeprivate.h: add fixed_height_check field

	* btk/btktreeview.c (btk_tree_view_init): initialize
	scroll_sync_timer and fixed_height_check
	(do_validate_rows): add fixed_height_check. If all validated rows
	in the first cycle have the same height, then we set that height for
	the entire tree. This is some sort of 'fake' optimization, but helps
	a lot for the common case. We keep validating the entire tree in
	the background though.
	(btk_tree_view_set_model): reset fixed_height_check

Wed Mar 20 16:36:08 2002  Owen Taylor  <otaylor@redhat.com>

        * btk/*.c: Patch from Erwann Chenede, #73900 fixing
	a lot of warnings with Forte CC, mostly implicit
	casts between void * and function pointers.
	
	* bdk/bdkevents.c (bdk_event_get_state): BdkEventVisibility's
	state field is not a BdkModifierType. (Also #73900)

Wed Mar 20 12:35:22 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.c (btk_widget_grab_default): Remove
	leftover notification of has-default. (#75508, Jacob
	Berkman.)

Wed Mar 20 12:27:07 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkaccelgroup.c (btk_accelerator_valid): Allow
	arrow keys as accelerators, as long as some modifier
	is pressed. (#75495)

	* btk/btkaccelgroup.c (btk_accelerator_valid): Fix
	incorrect example in the docs.

Wed Mar 20 12:06:30 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.c (btk_widget_set_child_visible):
	Fix segfault when widget->parent is NULL. 
	(#75615, Alexey A. Malyshev) 

Wed Mar 20 11:32:07 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkentry.c: Improve test to prevent infinite
	loop. (#74952, Thomas Leonard)

	* btk/btkmenushell.c (btk_real_menu_shell_cycle_focus):
	Fix warning when toplevel menu shell isn't a menu
	bar. (Thomas Leonard, #75602)

Wed Mar 20 11:00:59 2002  Owen Taylor  <otaylor@redhat.com>

        * configure.in: Use $PKG_CONFIG, not pkg-config.
        (LEE Sau Dan, #75572)

Wed Mar 20 10:55:56 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkevents-x11.c (bdk_event_translate): Fix assignment
	of time in scroll events. (Sven Neumann, #75574)

2002-03-20  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkdnd-win32.c (bdk_drag_find_window): Use
	bdk_window_get_toplevel(), as it is the top-level windows that are
	registered for DND.

	* bdk/win32/bdkwin32.h: Don't include bdkinternals.h.

2002-03-19  jacob berkman  <jacob@ximian.com>

	* btk/btkcombo.c (btk_combo_find): fix infinite loop when
	btk_combo_func() returns NULL (bug #75464)

2002-03-18  jacob berkman  <jacob@ximian.com>

	* btk/btkaspectframe.c (btk_aspect_frame_class_init): set the
	correct min/max values for the ratio property (fixes #75331)

Mon Mar 18 11:55:03 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkimmulticontext.c (btk_im_multicontext_get_slave):
	Patch from Yao Zhang fixing reference count leak.

	* btk/btkentry.c (btk_entry_key_release): if (entry->editable),
	not if (!entry->editable).

Mon Mar 18 11:09:17 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkwindow-x11.c (bdk_window_set_override_redirect): 
	Fix backwards conditional. (#75019, Dan Winship.)

Sun Mar 17 01:11:16 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreeview.c (btk_tree_view_size_request): use
	do_validate_rows instead of validate_rows_handler (fix by
	Mike Pieper, #74126)

Sat Mar 16 23:54:56 2002  Kristian Rietveld  <kris@btk.org>

	* bdk/x11/bdkwindow-x11.c (bdk_window_set_static_bit_gravity): just
	return when we have an input_only window (fix by Owen Taylor)

	* btk/btktreeprivate.h (struct _BtkTreeViewPrivate): add
	scroll_sync_timer

	* btk/btktreeview.c (install_scroll_sync_handler): new function,
	(scroll_sync_handler): ditto,
	(btk_tree_view_unrealize): take scroll_sync_timer into account
	(btk_tree_view_row_deleted): install scroll_sync_timer instead of
	calling top_row_to_dy/dy_to_top_row directly
	-- this greatly speeds up clearing the model (#73199)

	* btk/btktreemodelsort.c
	(btk_tree_model_sort_convert_path_to_child_path): fix up this function,
	for some reason I really screwed it up (fixes #74663)

2002-03-16  Sven Neumann  <sven@gimp.org>

	* configure.in (BDK_PIXBUF_DEP_CFLAGS) (BDK_PIXBUF_XLIB_DEP_CFLAGS) 
	(BDK_DEP_CFLAGS) (BTK_DEP_CFLAGS): include CFLAGS from bthread-2.0
	so that the libs work correctly in a threaded environment.

Fri Mar 15 12:51:42 2002  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeviewcolumn.c
	(btk_tree_view_column_new_with_attributes): add example to docs,
	as people are seeming to have trouble with this function.

2002-03-15  Tor Lillqvist  <tml@iki.fi>

	* configure.in: Set MATH_LIB to empty also on Win32.

Fri Mar 15 15:37:01 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkdrawable-x11.c (convert_to_format): 
	Fix byte shift arithmetic for big-endian. (Tracked
	down with help from Tuomas Kuosmanen)

Fri Mar 15 11:28:41 2002  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_insert_column_with_data_func):
	make args const, 74159
	(btk_tree_view_insert_column_with_attributes): ditto

	* btk/btktreeviewcolumn.c
	(btk_tree_view_column_cell_process_action): remov unused variables.

Fri Mar 15 13:31:51 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* btk/btkmenu.c (btk_menu_leave_notify): Fix test for "active
	submenu".

2002-03-15 Padraig O'Briain <padraig.obriain@sun.com>

	* bdk/x11/bdkkeys-x11.c (update_keymaps): Fudge keymap to have lower
	upper case variants if there is only a single keysym per keycode and
	the key symbol has upper and lower case variants (#74512)

Thu Mar 14 17:09:52 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkwindow.c (bdk_window_process_all_updates): Fix rather
	improbable reentrancy problem if a window is destroyed
	while updates are being processed on another window. (Noticed
	by Michael Meeks, #74708)

2002-03-14 Vitaly Tishkov <tvv@sparc.spb.su>

        * btk/btktreemodelsort.c
	typo in docs for btk_tree_model_sort_convert_iter_to_child_iter() fixed


Thu Mar 14 11:17:18 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkkeyhash.c (_btk_key_hash_remove_entry): When
	removing keys from the key hash, reinsert the right list
	back into the hash. (Dave Camp, #74571)

Wed Mar 13 17:17:40 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkobject.h: Remove left-over BTK_OBJECT_CONNECTED
	macro that was defined in terms of the now-gone BTK_CONNECTED
	flag. (Seth Burgess, #74028)

Wed Mar 13 17:11:10 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkaccelgroup.c (accel_group_weak_ref_detach): Unset 
	the acceleratable_groups qdata because qdata isn't removed
	on ->dispose but rather on ->finalize. (#74569, found
	by Matt Wilson.)

Tue Mar 12 23:14:23 2002  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeselection.c (btk_tree_selection_unselect_iter): Fix
	cut-n-paste bug.

Sat Mar  9 18:23:25 2002  Richard Hestilow  <hestilow@ximian.com>

	* btk/btkimage.c (btk_image_set_from_filename): Allow NULL
	filenames.
	
Tue Mar 12 10:50:09 2002  Owen Taylor  <otaylor@redhat.com>

	* modules/input/btkimcontextxim.c (btk_im_context_xim_filter_keypress):
	Fix incorrect return value, filter out returns of 0x7f for
	the delete key. (#74179, Kang Jeong-He)

Mon Mar 11 23:42:11 2002  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreemodel.c (btk_tree_model_foreach): fix totally broken
	foreach function.

2002-03-11  Matthias Clasen  <maclas@gmx.de>

	* btk/btkitemfactory.c (btk_item_factory_add_foreign): Document
	btk_{menu_item,widget}_set_accel_path() as the recommended API.  
	(#69244)

2002-03-11  James Henstridge  <james@daa.com.au>

	* configure.in: set CCAS and CCASFLAGS to get automake 1.6
	compatibility without breaking things for people using 1.4.

Sun Mar 10 21:04:30 2002  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_button_press): finally get the
	right behavior.

Mon Mar 11 01:25:14 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreeview.c (btk_tree_view_button_press): compare path with
	cursor path and not with the selected iter in the 'decide to edit'
	check


Fri Mar  8 14:45:00 2002  Owen Taylor  <otaylor@redhat.com>

	* ======== Released BTK+-2.0 ========

Fri Mar  8 20:41:51 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreestore.c (btk_tree_store_drag_data_received): handle
	btk-tree-model-drop-append like the ListStore, includes some
	tweaks to work right with trees

Fri Mar  8 14:22:43 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkfilesel.c (btk_file_selection_init): Some packing
	tweaks.

	* configure.in: Include BUNNYLIB_LIBS when checking
	for bind_textdomain_codeset, to catch the case where
	it is in -lintl.

Thu Mar  7 16:46:58 2002  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (validate_visible_area): get rid of really
	bad focus loop.
	(btk_tree_view_clamp_node_visible): only clamp the node when
	realized.  Need to replace this with scroll_to_cell sometime.
	(btk_tree_view_header_focus): clickable or reorderable columns are
	focusable, #73656

	* btk/btktreeviewcolumn.c (btk_tree_view_column_get_widget): fix
	docs to reflect behaviour change, #73682

Fri Mar  8 11:12:32 2002  Owen Taylor  <otaylor@redhat.com>

	* NEWS: Fix version numbers. (Johan Dahlin.)

	* INSTALL.in: Update, just refer to btk-building.html
	rather than duplicating information.

	* README.in: Add release specific notes.

	* Makefile.am (EXTRA_DIST): Remove TODO and TODO.xml
	from the distribution.

Thu Mar  7 23:29:35 2002  Owen Taylor  <otaylor@redhat.com>

	* NEWS: Final updates for 2.0.0

	* README.in: Updates.

2002-03-08  Tor Lillqvist  <tml@iki.fi>

	* bdk/Makefile.am (LDFLAGS): Add missing .la suffix for	libbdk_pixbuf.

Thu Mar  7 21:32:01 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreestore.c (btk_tree_store_sort_iter_changed): increase
	value of new_location by one if cmp_a > 0 and we hit the end of
	the list.

Thu Mar  7 10:31:57 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btknotebook.c (btk_notebook_timer): Fix problem where
	there were two copies of the "do an arrow step" code, 
	one correct for rotated notebooks, one not. (#73855,
	Thomas Leonard.)

Wed Mar  6 23:20:51 2002  Jonathan Blandford  <jrb@redhat.com>
and			  Kristian Rietveld  <kris@btk.org>

	Finishing touch for 2.0.0 release, fixes #70782, #72729, the
	'stealth' bug and other last-minute minor issues.

	* btk/btktreeview.c (btk_tree_view_bin_expose): set dnd dest line
	drawing right. We can't draw the line at the position of the next
	row, because that one still has to be drawn. So draw everthing at
	a -1 offset.
	(validate_visible_area): add check for invalid descendants and
	NULL scroll_to_path path, get scrolling right.  Also, fix the
	area_above value.  Pretty amazing I got it wrong.
	(get_logical_dest_row): add btk-tree-model-drop-append magic, so
	dragging a row to the end of the model works right.
	(btk_tree_view_get_dest_row_at_pos): minor floating point fix
	(btk_tree_view_start_editing): add call to validate_row
	(btk_tree_view_tree_to_widget_coords): Never subtract
	HEADER_HEIGHT from y values anymore!!!
	(btk_tree_view_widget_coords_to_tree): ditto.
	(btk_tree_view_scroll_to_point): allow -1 as values for the
	scroll_to coords
	(btk_tree_view_move_cursor_page_up_down): Don't need scroll_to_y
	as clamp_node_visible will make it work.

	* btk/btktreestore.c (btk_tree_store_drag_data_received): also check
	path depth, as we can't get iters from empty paths

	* btk/btkliststore.c (btk_list_store_drag_data_received): handle
	btk-tree-model-drop-append

	* btk/btktreednd.c (btk_tree_set_row_drag_data): free path_str

	* tests/testtreeflow.c (main): select path where we are scrolling to

2002-03-06  Darin Adler  <darin@bentspoon.com>

	* btk/btktreemodelsort.c: (btk_tree_model_sort_insert_value):
	Update offsets before finding where to insert the new value.

	* btk/btktreeview.c: (validate_visible_area): Make sure we redraw when
	we scroll, instead of just updating the scroll position variables.

2002-03-06  Manish Singh  <yosh@gimp.org>

	* bdk/Makefile.am
	* btk/Makefile.am: rework so that only things that really need to be
	done post install are in the hook

2002-03-06  Anders Carlsson  <andersca@gnu.org>

	* btk/btkiconfactory.c (get_default_icons): Register 16x16 version
	of properties stock icon.

	* btk/stock-icons/Makefile.am: Add stock_properties_16.png

Wed Mar  6 00:38:29 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkentry.c (btk_entry_real_insert_text): Fix various problems
	when truncating the inserted text to fit into the BtkEntry
	size limit of 65kb. (#73119)

Wed Mar  6 00:20:59 2002  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeviewcolumn.c
	(btk_tree_view_column_cell_process_action): move event handling to
	the process_action function so we can have the event go to
	individual cells.

Tue Mar  5 22:16:58 2002  Owen Taylor  <otaylor@redhat.com>

	* BTK+-2.0.0 rc1

	* docs/tutorial,faq/Makefile.am: Deal with the html directory
	already being there.

	* docs/faq/Makefile.am (EXTRA_DIST): Add btk-faq.sgml to EXTRA_DIST.

2002-03-05  Manish Singh  <yosh@gimp.org>

	* bdk/Makefile.am
	* btk/Makefile.am: use install-foo-hook instead of install-foo-local,
        since foo-local is run before the their respective builtin targets
	in automake 1.5

2002-03-05  jacob berkman  <jacob@ximian.com>

	* configure.in: change an == to =

2002-03-06  Tor Lillqvist  <tml@iki.fi>

	* bdk-pixbuf/bdk_pixbuf.rc.in
	* bdk/win32/rc/bdk.rc.in
	* btk/btk-win32.rc.in: Use BTK_API_VERSION.

2002-03-05  Manish Singh  <yosh@gimp.org>

	* configure.in: Fix up the freetype checking logic. Suppress
	suprious "no" with --disable-modules.

2002-03-06  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkevents-win32.c (bdk_pointer_grab,
	bdk_pointer_ungrab): Bypass calls to the grab/ungrab functions in
	bdkinput-win32.c, as they don't effectively do anything anyway.
	(build_key_event_state): Set MOD2 bit if key is in AltGr group.
	(bdk_event_translate): Call _bdk_windowing_window_get_offsets()
	each time the offsets are used, on the window they refer to,
	instead of once in the beginning. The window in question might
	change due to event propagation.
	(bdk_event_translate): Set key event group to 0 for non-AltGr
	keys. Do set the SHIFT bit in the key event state also for
	ISO_Left_Tab. Now backtabbing finally works again.

	* bdk/win32/bdkunput-win32.c: Minor debugging output change.

	* bdk/win32/bdkkeys-win32.c (update_keymap): Set VK_TAB mapping to
	Bdk_Tab and BDK_ISO_Left_Tab, like on X11.
	(bdk_keymap_translate_keyboard_state): Add similar code as in the
	non-XKB case on X11 to generate a more correct
	consumed_modifiers. Add debugging output.
	(bdk_keyval_name): Use the U+xxxx format for UCS characters
	encoded as keyvals. Never return NULL, but hex number
	representation if keyval not in table.

	* bdk/win32/bdkwindow-win32.c (bdk_window_focus): Call
	SetFocus(). Doesn't seem to have any harmful effect, and probably
	is close to what this function is supposed to do. But it didn't
	fix BtkCombo as I had hoped.
	(bdk_window_set_type_hint): Don't intern the _NET_WM_* atoms that
	weren't used and wouldn't have any meaning on Win32 anyway.

Tue Mar  5 19:19:19 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwindow.c (btk_window_set_focus): When setting
	the focus to NULL, clear the existing focus chain so
	that when we focus into the window again, we start
	at the beginning. (Pointed out by Tim Janik.)

2002-03-06  James Henstridge  <james@daa.com.au>

	* configure.in: libbango is now called libbango-1.0

Tue Mar  5 18:17:31 2002  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeviewcolumn.c (btk_tree_view_column_set_fixed_width):
	remove sizing == AUTOSIZE check.  Update docs.

Tue Mar  5 17:43:43 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkfontsel.c (btk_font_selection_init): Don't
	create ->font_entry, ->font_style_entry at all rather
	than just not showing them to avoid the problem of
	them popping up if btk_widget_show_all() is done
	on the dialog. (#72913, Charles Kerr.)

Tue Mar  5 18:06:49 2002  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeviewcolumn.c (btk_tree_view_column_set_resizable):
	doc fix proposed by tvv@sparc.spb.su (Vitaly Tishkov), #73567.

2002-03-05  Matthias Clasen  <maclas@gmx.de>

	* btk/btktreemodel.c (btk_tree_row_reference_deleted): Fix docs.

	* btk/btkwindow.c (btk_window_remove_mnemonic): 
	(btk_window_add_mnemonic): 
	(btk_window_mnemonic_activate): Add docs.

	* btk/btktreeview.c (btk_tree_view_get_search_equal_func): Fix
	typo in docs.

Tue Mar  5 17:02:59 2002  Owen Taylor  <otaylor@redhat.com>

	* docs/tutorial/btk-tut.sgml: s/menu_new/menu_item_new/.
	(#69199, Akira Tagoh.)

Tue Mar  5 16:53:05 2002  Owen Taylor  <otaylor@redhat.com>

	* docs/faq/Makefile.am: Build the docbook version, not
	the old linuxdoc version.

Tue Mar  5 15:47:54 2002  Owen Taylor  <otaylor@redhat.com>

	* configure.in test/makefile.msc **.pc.in **/*.am:
	Update version to 2.0.0

	* btk/Makefile.am (MAINTAINERCLEANFILES): Add stamp
	files.

	* configure.in (BDK_PIXBUF_VERSION): Require GLib 2.0.0,
	Bango, Batk, 1.0.0.

	* m4macros/btk-2.0.m4: Default to 2.0.0 as the minimum
	version.

2002-03-05  Havoc Pennington  <hp@redhat.com>

	* btk/btktextview.c (btk_text_view_size_allocate): don't assign
	yoffset here, just let it get updated in response to the
	value_changed. Fixes #72479

Tue Mar  5 10:29:09 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btktreeview.c (do_presize_handler)
	btk/btktreeview.c (do_validate_rows): Don't use this 
	same functions as idle callbacks and directly, to avoid
	threading deadlocks. (#72392, Scott Guilbeaux)

	* btk/btktable.c (btk_table_size_request_init): Fix 
	row/column confusion from recent patch. (#73505,
	Vitaly Tishkov.)

2002-03-04  Matthias Clasen  <maclas@gmx.de>

	* docs/tutorial/btk-tut.sgml: Make color selection and selection 
	examples work.

	* tests/testselection.c (selection_toggled, selection_clear):
	Use selection_widget as selection owner - otherwise clearing the
	selection doesn't work.

Mon Mar  4 12:43:48 2002  Owen Taylor  <otaylor@redhat.com>

        Fixes for non XKB operation. (#73103)

	* bdk/x11/bdkkeys-x11.c (bdk_keymap_translate_keyboard_state):
	Fix problem where BDK_Tab was converted to BDK_ISO_Left_Tab
	always, not just if Shift was pressed.
	
	* bdk/x11/bdkkeys-x11.c bdk/x11/bdkprivate-x11.c 
	bdk/x11/bdkevents-x11.c: Move determination of group
	to _bdk_x11_get_group_for_state(), fix to handle non-XKB.

	* bdk/x11/bdkkeys-x11.c (bdk_keymap_translate_keyboard_state): Only
	add in SHIFT_MASK | LOCK_MASK to consumed_modifiers if the shifted
	and unshifted keysyms are different. Only add in group_switch_mask
	if the group-switched and non-group-switched keysyms are diferent.

	* bdk/x11/bdkkeys-x11.c (bdk_keymap_translate_keyboard_state): 
	When calling XKeycodeToKeysym, use group * keysyms_per_keycode / 2
	not group * keysyms_per_keycode. (Tor Lillqvist)

	* bdk/x11/bdkkeys-x11.c (bdk_keymap_translate_keyboard_state):
	Remove the hack to fudge the return value for BDK_Tab + Shift
	since that didn't work -- it didn't affect the reverse mapping.
	Instead fudge the non-XKB keymap instead.

Mon Mar  4 11:02:18 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkfilesel.c (btk_file_selection_get_selections): Fix
	memory leak. (#73370, Paolo Maggi).

Mon Mar  4 10:35:28 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btknotebook.c (btk_notebook_set_current_page): Fix docs
	in terms of what out of range @page_num does. (#73371,
	Vitaly Tishkov.)

2002-03-02  Havoc Pennington  <hp@pobox.com>

	* demos/btk-demo/editable_cells.c (cell_edited): const fix

Sun Mar  3 18:47:13 2002  Owen Taylor  <otaylor@redhat.com>

        * btk/btkwindow.c (btk_window_parse_geometry): Fix
	to properly take the default window into account by
	setting a flag and in btk_window_compute_configure_request_size ()
	multiplying by the increments and adding in the base
	size. (#72393)

	* tests/testbtk.c (create_gridded_geometry): Add a
	test for gridded geometry and for btk_window_parse_geometry().

2002-03-04  Hans Breuer  <hans@breuer.org>

	* btk/makefile.msc.in : don't build btk.defs anymore

2002-03-04  Tor Lillqvist  <tml@iki.fi>

	* btk/btkrc.h: Remove obsolete Win32-only declaration of
	btk_win32_get_installation_directory().

Sun Mar  3 17:03:30 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmenushell.c btk/btkmenubar.[ch]: Back out
	changes to propagate keys to parent menu shells, since
	that broke stuff; rather implement ::cycle-focus as
	a key binding on BtkMenuShell rather than on BtkMenuBar.

	* btk/btkmenushell.c (btk_menu_shell_class_init): Add
	add bindings for ::cycle-focus. (In btkmenubar.c, were 
	mistakently bound to ::move-focus.)

2002-03-03  Tor Lillqvist  <tml@iki.fi>

	* README.win32: Minor edits.

	* config.h.win32.in: Update to match a recent configure-generated
	config.h

Sun Mar  3 15:16:07 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btktable.c: When increasing the row or column
	requisitions to make them sufficient for spanning widgets,
	favor rows or columns with expandable children in them.
	(#1261, Jonathan Blandford.)

Sun Mar  3 14:26:33 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkstyle.[ch] (_btk_get_insertion_cursor_gc):
	Centralize lookup and caching of cursor GC's here.

	* btk/btkentry.[ch] btk/btktextview.[ch] btk/btktextdisplay.c
	btk/btklabel.c: Move to using _btk_get_insertion_cursor_gc().

	* btk/btkentry.c (btk_entry_expose): Draw cursors
	under the text, not over the text.

	* btk/btkwidget.c (btk_widget_class_init): add
	a secondary-cursor-color property.

	* btk/btkwidget.c (btk_widget_class_init): Decrease
	the default aspect ratio to 1/25 (0.04).
	
	* tests/testbtkrc (bell_duration): Comment out
	cursor color setting.
	
Sun Mar  3 20:48:12 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* btk/btkmenu.c (btk_menu_set_submenu_navigation_rebunnyion): change
	offset of cursor corner of navigation rebunnyion from (-2, 2) to 
	(-2, 0).

2002-03-03  jacob berkman  <jacob@ximian.com>

	* Makefile.am (EXTRA_DIST): add sanitize-la.sh

2002-03-03  Anders Carlsson  <andersca@gnu.org>

	* bdk/x11/bdkwindow-x11.c (bdk_window_move_resize): Fix tyop
	in docs.

Sat Mar  2 03:49:31 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreeview.c (btk_tree_view_button_press): move edit
	ifs above _set_cursor code, don't collapse/expand row on double
	click, only activate (#63269)
	(validate_visible_area): add two missing lines (#73161, #73162)

Sun Mar  3 12:13:56 2002  Owen Taylor  <otaylor@redhat.com>

	* configure.in: Fix typo where bangoxft was being
	required instead of bangox. (Reported by Miles
	Lane)

Sun Mar  3 11:12:16 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btktextlayout.c (add_cursor): When in split cursor
	mode, always add the cursor as both strong and weak
	so that it is drawn with the correct non-split color.

Sun Mar  3 11:05:13 2002  Owen Taylor  <otaylor@redhat.com>

	* modules/input/Makefile.am (moduledir): Fix
	install location.

Sun Mar  3 10:28:32 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/Makefile.am: add missing dependency of objects on
	btkmarshalers.h.

	* btk/Makefile.am btk/btk-boxed.defs: Remove completely
	out of date and unused btk-boxed.defs and the accompanying
	Makefile rule to generate the complete btk.defs.

2002-03-03  Hans Breuer  <hans@breuer.org>

	* btk/btkmain.c : make rewrite_event_for_window() static
	* btk/btkrc.c : btk_rc_clear_realized_style() static

	* btk/makefile.msc.in : adapt to makeenums build changes

	* btk.def : sorted alphabetical again

2002-03-03  Sven Neumann  <sven@gimp.org>

	* m4macros/btk-2.0.m4: lowercase configure --help output.

Sun Mar  3 06:39:19 2002  Tim Janik  <timj@btk.org>

	* btk/btkfilesel.c: added compile time switch to put the tree views
	into a hpaned for owen to play with.

	* btk/btktreedatalist.c (_btk_tree_data_list_header_free): 
	* btk/btktreeviewcolumn.c (btk_tree_view_column_set_cell_data_func),
	(btk_tree_view_column_finalize): 
	* btk/btktreestore.c (btk_tree_store_set_default_sort_func),
	(btk_tree_store_set_sort_func), (btk_tree_store_finalize): 
	* btk/btktreeselection.c (btk_tree_selection_finalize): 
	* btk/btktreemodelsort.c (btk_tree_model_sort_reset_default_sort_func),
	(btk_tree_model_sort_set_default_sort_func),
	(btk_tree_model_sort_set_sort_func):
	* btk/btkliststore.c (btk_list_store_set_default_sort_func),
	(btk_list_store_set_default_sort_func),
	(btk_list_store_set_sort_func), (btk_list_store_finalize): 
	add reentrancy protection around destroy() function invocation.

	* btk/btktreeselection.c (btk_tree_selection_set_select_function): fix
	destroy function invocation (which was missing).

Sat Mar  2 23:08:23 2002  Owen Taylor  <otaylor@redhat.com>

	Fixes for uninstalled operation with module suffixes
	other than .so and in general for platforms like AIX where
	the module suffix isn't predictable. (#72185, problems
	reported by Miroslaw Dobrzanski-Neumann)

	* modules/input/Makefile.am (btk.immodules): Query .la
	files rather than shared objects in .libs when creating the
	uninstalled btk.immodules file.

	* btk/btkmain.c (_btk_find_module): Look for .la files
	after looking for the normal soname extension to handle
	cases where the soname extension isn't predictable,
	like AIX.

	* btk/btkthemes.c (btk_theme_engine_load): Don't
	call g_module_build_path... leave that to 
	btk_rc_find_module_in_path.

	* demos/btk-demo/main.c (main) demos/pixbuf-init.c (pixbuf_init):
	tests/testbtk.c (test_init): tests/testtext.c (test_init)
	tests/testdnd.c (test_init): Point bdk-pixbuf to .la
	files rather than poking in .libs for .so files.

	* btk/stock-icons/Makefile.am (btkstockpixbufs.h): Remove
	.libs from BDK_PIXBUF_MODULEDIR.

Sat Mar  2 20:58:30 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.c (btk_widget_reparent): Handle NO_WINDOW
	widgets with windows that are children of widget->window.
	(#50279)

	* tests/testbtk.c: Add eventboxes to the example so that
	we are reparenting between different BdkWindows.

Sat Mar  2 20:39:38 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkimagemenuitem.c (btk_image_menu_item_new_from_stock): 
	Add a note to the docs about how to use this in the 
	context of changeable accelerators. (#72382, Mark Patton)

Sat Mar  2 19:48:10 2002  Owen Taylor  <otaylor@redhat.com>

	* configure.in: Fix missing -lX11 into x_libs with bangoxft.

Fri Mar  1 00:46:49 2002  Owen Taylor  <otaylor@redhat.com>

	* configure.in: Add a --enable-explicit-deps option to control
	whether dependency libraries are written into .la files and .pc
	files.  Default is auto: if static libraries are off and shlib
	dependencies are found, don't write deps.

	* bdk/Makefile.am btk/Makefile.am sanitize-la.sh: Shell script
	used to strip dependencies out of .la files.

	* Makefile.am: Add a slightly modified distcheck rule that passes
	--enable-btk-doc to the configure inside.
	(So that 'make dist' succeeds inside.)

	* configure.in: If bango was compiled with
	--disable-explicit-deps, then repeat the checks for X and
	freetype ourselves so we don't depend on linking to libraries
	that bango doesn't reveal in the link line. Add some more paranoia
	for whether what we detect ourselves matches what Bango backends
	we found.
	
2002-03-03  Tor Lillqvist  <tml@iki.fi>

	* configure.in: Output bdk-pixbuf/bdk_pixbuf.rc.

	* bdk/bdk.def
	* bdk/win32/bdkevents-win32.c: Add and (trivially) implement
	bdk_pointer_grab_info_libbtk_only() and
	bdk_keyboard_grab_info_libbtk_only().

2002-03-02  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkevents-win32.c (build_keypress_event): Reorder
	code, keyval should get a value in all cases now.
	(build_keyrelease_event): Set BDK_CONTROL_MASK here, too, if it
	was a control character produced with Alt+keypad digits.
	(bdk_event_translate): Minor cleanups to keyboard input
	handling. Still need more major work.
	
Sat Mar  2 16:12:03 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkradiobutton.c (btk_radio_button_focus): Don't
	do special focus handling if draw_indicator is not set.
	(#64723, Damon Chaplin.)

Sat Mar  2 15:48:04 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkentry.c (btk_entry_new_with_max_length,
	btk_entry_set_max_length): Clamp @max parameter passed in to 
	[0, MAX_SIZE], improve docs. Fix default and range 
	for ::max-length property, range for ::ncursor_position,
	::selection_bound properties. (#55916, Vitaly Tishkov)

	* btk/btkmain.c (rewrite_event_for_grabs): Fix typo

Fri Mar  1 18:39:44 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/{bdkevents-x11.c,bdkmain-x11.c,bdkprivate-x11.h,
	bdkwindow-x11.c}: Robustify tracking of pointer grab window.

	* bdk/x11/bdkmain-x11.c: Keep track of current keyboard
	grab window.

	* bdk/x11/bdkmain-x11.c (bdk_pointer_grab_info_libbtk_only,
	bdk_keyboard_grab_info_libbtk_only): Private libbtk => libbtk
	API for finding out current grab information.
	
	* btk/btkmain.c (rewrite_event_for_grabs): Rewrite events
	so that the effective behavior of owner_events = TRUE is changed
	to "deliver events to same window group normally" instead
	of "deliver events to same application normally. #69934

	* btk/btkrange.c: Use an explicit btk_grab_add() so that
	it works within the BtkList combo, where there is a 
	owner_events = FALSE bdk_pointer_grab() already in effect.
	(#65006, reported by Damon Chaplin)

Sat Mar  2 14:32:50 2002  Owen Taylor  <otaylor@redhat.com>

        * configure.in: Default to --disable-btk-doc (avoid Jade
	breakage) and --disable-static (static linking causes
	problems with Xft changes.)

	* autogen.sh: Add --enable-btk-doc by default.

	* Makefile.am: Add a 'mydistcheck' rule that passes
	--enable-btk-doc to the configure since that is needed
	for 'make dist'.

	* docs/tutorial/Makefile.am (dist-hook): Don't distribute
	the PDF file. (Rule doesn't work on my system, plus it's
	big.)

	* btk/Makefile.am: 'make dist' fixes.

Sat Mar  2 13:26:58 2002  Owen Taylor  <otaylor@redhat.com>

        * btk/Makefile.am: Switch style of stamp file usage.

	* btk/Makefile.am btk/typeutils.[ch]: Switch all the exported
	enumeration/fags TYPE variables over to macros for get_type() functions,
	for lazy definition and to get rid of expensive relocations.

	* btk/btkiconfactory.[ch] btk/btkselection.[ch] btk/btkstyle.[ch]
	btk/btktextiter.[ch] btk/btktexttag.[ch] btk/btktreemodel.[ch]
	btk/btktypeutils.[ch] btk/btkwidget.[ch]: Switch boxed type
	definitions over manually coded get_type() functions.

	* btk/btk.def: Updates for above

	* btk/{genmarshal.pl,makeenums.awk,makeenums.h,maketypes.awk}:
	Remove from CVS, no longer used.

	* configure.in: Remove checks for awk.
	
Sat Mar  2 04:44:10 2002  Tim Janik  <timj@btk.org>

	* btk/btkaccelgroup.c (btk_accel_group_connect_by_path): fix typo.

Fri Mar  1 23:59:35 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreeviewcolumn.c (btk_tree_view_column_cell_get_size): set
	first_cell to FALSE after first iteration

	* btk/btktreeview.c (validate_visible_area): reduce usage of
	BTK_RBNODE_GET_HEIGHT, check for node != NULL,
	(btk_tree_view_top_row_to_dy): remove call to btk_adjustment_changed
	(btk_tree_view_search_iter): select iter after scrolling

2002-03-02  Tor Lillqvist  <tml@iki.fi>

	* btk/btkitemfactory.c: Remove unneeded Win32 stuff inside #ifdef
	G_OS_WIN32. (Leftover from when btkitemfactory.c handled files.)

2002-03-01  Tor Lillqvist  <tml@iki.fi>

	* bdk/bdkkeys.c (bdk_keyval_convert_case)
	* bdk/x11/bdkkeys-x11.c (bdk_keyval_convert_case): If the keyval
	to be converted is one of those that consist of a Unicode
	character plus our special flag bit, use the
	g_unichar_to{lower,upper} functions (Bug#73112).

	* bdk/bdkkeys.c (bdk_keyval_convert_case): Drop the #ifdefs for
	the BDK keysym symbols. As we include bdkkeysyms.h, we know they
	are there. And if BDK keysyms some day are added/removed, this
	function needs changes, too, anyway.

Fri Mar  1 17:00:28 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkpolyreg-generic.c: Fix some reported (but not significant)
	UMR's from purify. (#73160, Morten Welinder)

Fri Mar  1 16:48:19 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkscrolledwindow.c: Initialize the scrollbar spacing
	variable in the class to -1, and then take that to mean
	"default" (3) rather than putting 3 in the class directly.
	This gives us some wiggle room to make it a per-instance
	rather than a per-class property later.

2002-03-01  jacob berkman  <jacob@ximian.com>

	* Makefile.am (install-data-hook): 
	(dist-hook): replace uses of test -e with more portable test -f

Fri Mar  1 14:49:35 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btktextview.c (btk_text_view_commit_text): Don't delete
	forward across line boundaries when in overwrite mode.
	(#73145, reported by Ettore Perazzoli)

Fri Mar  1 14:47:39 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btktextview.c (btk_text_view_commit_text): Don't
	join up lines.

Fri Mar  1 10:31:14 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btknotebook.c (btk_notebook_reorder_child):
	Fix signed-unsigned error that was accidentally causing
	negative values to append, do it intentionally. Fix docs 
	to say that negative values append. (Alexey A. Malyshev,
	#73108) 

2002-03-01 Alexey Malyshev <maa@sparc.spb.su>
	
        * btk+/btk/btkitemfactory.c
	fixed a little type in docs for btk_notebook_set_show_border()
	
Fri Mar  1 09:05:19 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkitemfactory.c (btk_item_factory_delete_entries):
	Really make it work for paths with underline accelerators. (#69247)

2002-02-28  Havoc Pennington  <hp@pobox.com>

	* btk/btktextview.c (btk_text_view_finalize): free the tab array
	for custom tabs, reported by Paolo Maggi #72980
	
Thu Feb 28 19:55:01 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkkeys.c: include bdkkeysysms.h if
	compiling bdk_keyval_convert_case.

	* btk/btkmenubar.c (btk_menu_bar_cycle_focus): Implement
	<Control>Tab <Control><Shift>Tab to cycle between
	all menu bars in a toplevel once one is up.

	* tests/testbtk.c: Add a second menubar, this
	example is already full of crack anyways.

	* btk/btkmenushell.c (btk_menu_shell_key_press): Padd
	unhandled events up to the parent menu shell.

	* btk/btkmenuitem.c (btk_menu_item_select_timeout): Only
	pop up the menu if the parent menu shell is still active.

	* btk/btkcontainer.[ch] (_btk_container_focus_sort): Add a
	old_focus argument, export privately.

2002-02-28  Darin Adler  <darin@bentspoon.com>

	* btk/btkfilesel.c: (open_new_dir): Add missing NULL check.

2002-03-01  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkwindow-win32.h (struct _BdkWindowImplWin32): Remove
	the event_mask, it is now in BdkWindowObject.

	* bdk/win32/bdkwindow-win32.c: Change accordingly. Set the
	BDK_STRUCTURE_MASK in bdk_window_set_events(), as it is always set
	in bdk_window_new(), too. (Bug#72921)

	* bdk/win32/bdkevents-win32.c: Change accordingly here, too.
	(vk_from_char): New function, calculates the virtual keycode
	corresponding to the char in a WM_CHAR message.
	(build_keypress_event, build_keyrelease_event): Use it.
	(build_keypress_event): Call ImmReleaseContext() after using the
	input context. This might plug a memory or resource leak.
	(build_key_event_state): Remove #if 0 code.
	(bdk_event_translate): Actually, it would be preferrable to always
	handle just the WM_KEYDOWN and WM_KEYUP messages, not WM_CHAR at
	all, and thus drop the contorted logic with ignore_wm_char etc.

	* bdk/win32/bdkkeys-win32.c: (bdk_keymap_get_entries_for_keyval):
	Debugging output.
	(bdk_keymap_translate_keyboard_state): Return correct value. (But
	_btk_key_hash_lookup() doesn't check the return value...)

Thu Feb 28 14:49:08 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkwindow-x11.c (bdk_window_foreign_new): Initialize
	private->event_mask from attributes we retrieved for
	the window.

2002-02-22  Havoc Pennington  <hp@redhat.com>

	* btk/btktextbuffer.c (save_range): change gravity of start/end
	marks so that text added at either end of the range doesn't end up
	inside the range.
	(btk_text_buffer_real_insert_range): fix to handle pasting a range
	into itself.

2002-02-28  Sven Neumann  <sven@gimp.org>

	* configure.in: beautified configure --help output.

2002-02-28  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/Makefile.am: Move bdfcursor.c from
	libbdk_win32_la_SOURCES to EXTRA_DIST.

	* bdk/win32/bdkgc-win32.c (bdk_win32_colormap_color_pack): In the
	bitmap case, use just the LSB of the pixel value. Does this match
	X11 semantics? Or should it be pixel!=0?

Wed Feb 27 19:16:50 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkwindow-x11.c (bdk_window_new): 
	* bdk/x11/bdkwindow-x11.c (bdk_window_get_events): 
	* bdk/x11/bdkwindow-x11.c (bdk_window_set_events): 
	* bdk/win32/bdkwindow-win32.c (bdk_window_set_events): 
	* bdk/win32/bdkwindow-win32.c (bdk_window_new): 
	* bdk/bdkwindow.h (struct _BdkWindowObject): 
	* bdk/linux-fb/bdkwindow-fb.c (bdk_window_set_events):
	Save the window's event mask in window->event_mask.

	* bdk/bdkwindow.c (bdk_window_process_updates_internal): Only
	generate expose events if BDK_EXPOSE_MASK is included
	window->event_mask. (#54506)

Wed Feb 27 18:50:29 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.c (btk_widget_event): Allow focus-change
	events to be sent to unrealized widgets; they aren't
	really normal events in that they have anything to
	do with widget->window. (#72914, Andreas J. Guelzow)

Wed Feb 27 18:39:25 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/stock-icons/Makefile.am: Split big VARIABLES variable
	that was causing overlong lines into 6 variables with 20
	in each one.

Wed Feb 27 18:01:03 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkaccellabel.c (btk_accelerator_name) po/POTFILES.in: 
	Mark Ctrl, Shift, Alt for translation.
	(#60590)

	* btk/btkfontsel.c: Mark PREVIEW_TEXT for translation.
	(Vlad Harchev, #53223)

Wed Feb 27 17:32:09 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkrange.c (btk_range_get_props): if CAN_FOCUS
	reserve focus_line_width + focus_line_pad extra
	space and draw the focus in that space. #72027.

Wed Feb 27 23:02:55 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* btk/btkhandlebox.c (btk_handle_box_realize): minor code cleanup

Wed Feb 27 14:58:12 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmenubar.c (btk_menu_bar_size_request/allocate): 
	Don't reserve space for border when the shadow type
	for the menubar is "none". (#61843)

	* btk/btkmenubar.c (btk_menu_bar_size_allocate): Fix
	offset for right-justified menu items.

Wed Feb 27 14:45:21 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btktoolbar.c (btk_toolbar_size_allocate): Go
	back to old style of drawing children over the bevel.
	(#58615)

Wed Feb 27 14:08:26 2002  Owen Taylor  <otaylor@redhat.com>

	* modules/input/imxim.c: Add ko and zh to the locales
	where this is the default.

Wed Feb 27 12:34:21 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkiconfactory.c: Register all stock icons
	"unscaled" so that we don't have icons only available
	at some sizes. (#68896)

Wed Feb 27 11:59:05 2002  Owen Taylor  <otaylor@redhat.com>

	Some ASCII vs. locale fixes from Darin Adler (#55837)

	* btk/btkcombo.c (btk_combo_find): Implement real
	case-insensitive comparison using g_utf8_casefold().

	* btk/btkaccellabel.c (btk_accel_label_refetch): Fix
	assignment of gunichar to char by replacing g_unichar_totitle
	with g_ascii_toupper ... the contents would only be ascii
	here anyways.

	* bdk/x11/bdkim-x11.c (_bdk_x11_initialize_locale) 
	* btk/btkfontsel.c (btk_font_selection_show_available_fonts): 
	Replace a calls to g_strcasecmp() with g_ascii_strcasecmp().

2002-02-27  Hans Breuer  <hans@breuer.org>

	* demos/btk-demo/makefile.msc.in : new file

	* bdk-pixbuf/btk-pixbuf.rc.in : new file to include
	  version resource
	* bdk-pixbuf/makefile.msc : create and use bdk-pixbuf.res

	* bdk/win32/bdkkeys-win32.c : handle undefined LANG_URDU,
	(bdk_keyval_name) : fix endless looping

	* btk/btkfilesel.c : translate_win32_path() static
	* btk/queryimmodules : print_escaped(), query_module() static

	* btk/makefile.msc.in : added btkkeyhash, build btk-win32.res

	* btk/stock-icons/makefile.msc : regenerated from directory
	listing (almost all filenames changed)

Wed Feb 27 10:34:46 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkrange.c (btk_range_set_range): After computing
	the clamped value, actually set it. (#62639, Sergey Kuzminov)

Tue Feb 26 22:22:37 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkbox.c (btk_box_reorder_child): Clean up
	the code so < 0 == end wasn't just a side effect,
	remove most of the manual linked list manipulation
	code in favor of g_list_* functions.

Tue Feb 26 21:44:01 2002  Owen Taylor  <otaylor@redhat.com>

	* config.status config.guess: Remove these files
	from CVS so we more-or-less current versions from
	automake --add-missing. (Reported by Finlay Dobbie,
	#60342)

	* bdk/bdkkeyuni.c: Shouldn't map KP_Enter to '\n',
	or KP_Tab to \t' since we don't map the corresponding
	main keyboard characters in that way. (#61561,
	Padraig O'Briain)

Tue Feb 26 19:45:29 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkcombo.c (btk_combo_set_popdown_strings):
	Call btk_combo_set_popdown_strings() in case
	the combo is up currently. (#63535, Skip Montaro)

Tue Feb 26 19:38:14 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkscrolledwindow.c (btk_scrolled_window_class_init):
	Switch control-home/end and home/end with
	the idea that scrolled windows more typically contain
	vertical sets of controls and to correspond to the bindings
	in BtkTreeView.

Tue Feb 26 19:32:42 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btk[hv]vscale.c (btk_[hv]scale_expose): Chain
	up before drawing the scale values so that the number
	is drawn in the right place instead of one step 
	back. (#61743, patch from Satyajit Kanungo)

Tue Feb 26 19:16:28 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/win32/bdkkeys-win32.c (bdk_keyval_name): 
	* bdk/x11/bdkkeys-x11.c (bdk_keyval_name): 
	Make sure Page_Up, Page_Down get those names, not Prior,
	Next.

Tue Feb 26 18:58:49 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkaccelgroup.c (btk_accelerator_set_default_mod_mask):
	OR in the three default modifiers to any value passed
	in by the caller, so that the caller won't break the
	the default bindings. (#70142, Jody Goldberg, though he
	wasn't in favor of this particular way of solving it.)

Tue Feb 26 18:47:44 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwindow.c (btk_window_add_mnemonic): Append
	mnemonics rather than prepending them so that the 
	order is typically forward rather than typically
	backward. (Partial fix for #52395)

Wed Feb 27 00:45:39 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* btk/btkarrow.c, btk/btkmenuitem.c, btk/btkrange.c
	btk/btkspinbutton.c btk/btkstyle.c: Draw arrows better (without
	extra baseline)

Tue Feb 26 18:38:17 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkaccellabel.c (btk_accel_label_refetch): 
	Display any "g_unicode_isgraph()" char literally,
	not just latin1. (#65679)

Tue Feb 26 18:01:10 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.c (btk_widget_grab_focus): Don't
	focus insensitive widgets. (#68203)
	
	* btk/btkentry.c (btk_entry_state_changed): Clear any
	current selection if we become insensitive. (#68203)

	* btk/btkentry.c (btk_entry_grab_focus): Don't
	select the text if the entry isn't editable. (#67203)

	* btk/btkentry.c: Activate keybindings when not editable,
	but supress keybindings that change the text. (#65848, #68203)

	* btk/btkentry.c (btk_entry_set_property): Reset the
	IM context for the entry when it is made not editable.

Tue Feb 26 17:04:44 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkcolorsel.c (update_color): Emit ::color_changed
	every time we notify current_color. (Brute force 
	fix for #72470, Matthias Clasen). Some fixes to improve
	reentrancy.

Tue Feb 26 15:04:33 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkentry.c (btk_entry_enter_text): use
	the cursor position _after_ deleting the text
	as the position to insert at. (#72717, Jan Mynarik)

2002-02-26 Vitaly Tishkov <tvv@sparc.spb.su>

        * btk/btktreemodel.c
	misprints in documentation for btk_tree_row_reference_inserted() 
        and btk_tree_path_new () are fixed

Tue Feb 26 19:47:16 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreeview.c (validate_visible_area): take into account
	that a path from a rowref can be NULL. (#72623 and #72650)

	* btk/btktreeviewcolumn.c (btk_tree_view_column_cell_render_or_focus):
	let focus_rectangle be the same as cell_area for empty cells (#69900)

Tue Feb 26 11:51:56 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkkeyhash.c (_btk_key_hash_remove_entry): Fix
	double free.

Tue Feb 26 10:38:14 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkkeyhash.c (_btk_key_hash_lookup_keyval): Handle
	a keyval of 0, by returning an empty list. (#72617,
	Kevin Breit)

2002-02-26  Richard Hult  <rhult@codefactory.se>

	* btk/btktreeview.c (btk_tree_view_expand_all): Fix
	#72586. Silently accept empty tree.
	(btk_tree_view_collapse_all): Likewise.

2002-02-26  Tor Lillqvist  <tml@iki.fi>

	* btk/btk.def: A couple of name changes.

Mon Feb 25 22:10:47 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkscrolledwindow.c (btk_scrolled_window_class_init): Fix
	double set of bindings for page-up/down. (#72605, Tor Lillqvist)

	* btk/btkmenu.c (btk_menu_key_press): Remove consumed modiifers
	when setting up accelerator to make accelerators look prettier.
	(#65416, Guillermo S. Romero)

2002-02-26  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkkeys-win32.c: Implement the functions that until
	now just were non-functional stubs. For "hardware keycodes", we
	use Windows virtual keycodes. Not scancodes, although that at
	first might seem more low-level and a better match to X11
	keycodes. 

	The Windows API is really mixed up and confused with respect to
	scancodes and virtual keycodes. (Surprised?) Some scancodes are
	generated by two keys on the keyboard (!), and although the
	keyboard messages do have a flag to indicate which key the user
	pressed, other API that take a scan code as input don't let you
	specify which actual key you mean.

	(update_keymap): Function to build a X11-like representation of
	the keyboard. Each key has four keysyms: two levels (nonshifted
	and shifted) and two groups (normal and with AltGr).

	(bdk_keymap_get_direction): Use the codepage corresponding to the
	thread's input locale, not the system codepage.

	* bdk/win32/bdkglobals.h
	* bdk/win32/bdkmain-win32.c
	* bdk/win32/bdkprivate-win32.h
	* bdk/win32/bdkwindow-win32.h
	* bdk/win32/bdkwindow-win32.c: Remove the input_locale and
	charset_info fields from BdkWindowImplWin32. Input locale is
	per-thread in Windows, and as BDK on Windows really only works
	when the GDI interaction all happens in just one thread anyway,
	this state can be global. Use globals _bdk_input_locale and
	_bdk_input_codepage instead. Set these based on the thread's input
	locale (keyboard layout, or which IME is active).

	* bdk/win32/bdkevents-win32.c: Set the group and hardware_keycode
	fields in BDK key events. On input locale change messages, set
	the global state variables, and inform update_keymap() that it
	has to rebuild the keymap.
	
2002-02-25  Matthias Clasen  <maclas@gmx.de>

	* docs/tutorial/btk-tut.sgml: Fix typos in pkg-config 
	invokations.  (#72476) 

Mon Feb 25 18:59:27 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btktooltips.c (start_keyboard_mode): Set the keyboard-mode
	flag before popping up the tooltip so that pop it up
	in the right place. (#71917, Narayani Pattipati)

Mon Feb 25 22:11:34 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreeviewcolumn.c (btk_tree_view_column_set_visible): call
	_btk_tree_view_column_cell_set_dirty when visible, so this column
	gets some space allocated. (#70996)

	* btk/btkliststore.c (btk_list_store_get_path): add simple
	optimization for the tail case
	(btk_list_store_real_set_value): remove unneeded _get_path calls

Mon Feb 25 12:47:25 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkkeys-x11.c (bdk_keymap_translate_keyboard_state): 
	Fix precendence problem. (Sven Neumann)

Sun Feb 24 23:23:28 2002  Owen Taylor  <otaylor@redhat.com>

	* tests/testselection.c (main): Convert over to using
	an BtkInvisible - selections don't work properly
	with now NO_WINDOW BtkToggleButton. (Example really
	should be using BtkClipboard.)

	* bdk/x11/bdkselection-x11.c (bdk_selection_property_get):
	Fix  problems if sizeof(BdkAtom) != sizeof(Atom). (Unlikely)

	* bdk/x11/bdkproperty-x11.c (bdk_property_get): Set 
	actual_length when converting atoms as well.
	(Gregory Merchan, #72074)

2002-02-24  Havoc Pennington  <hp@pobox.com>
	
	* btk/btktextview.c (btk_text_view_value_changed): add dx/dy to
	child allocation, don't subtract them. Also, copy code from CList
	to recursively adjust the child allocation, instead of just 
	adjusting immediate children. #69115

2002-02-24  Havoc Pennington  <hp@pobox.com>

	* btk/btkstyle.c (_btk_draw_insertion_cursor): change to pass in
	the cursor direction always, not just when we need an arrow, so we
	can flip the cursor around its axis for RTL. Resolves #72372

	* btk/btkentry.c (btk_entry_draw_cursor): update for
	draw_insertion_cursor change
	
	* btk/btklabel.c (btk_label_draw_cursor): ditto

	* btk/btktextdisplay.c (btk_text_layout_draw): ditto
	
2002-02-24  Alexander Larsson  <alla@lysator.liu.se>

	* bdk/x11/bdkwindow-x11.c (bdk_window_set_background):
	Always NULL out bg_pixmap, even when it used to be None
	or parent relative.

2002-02-24  Havoc Pennington  <hp@pobox.com>

	* btk/btktextbuffer.c (parent_class): parent_class variable was
	BtkObjectClass instead of GObjectClass

	* btk/btktextview.c (widget_to_buffer): fix this the way 
	buffer_to_widget was fixed, to avoid duplicating 
	the code that computes text_window->allocation.x/y

Sun Feb 24 21:18:20 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btksocket.c (btk_socket_end_embedding): Fix
	off-by-one error. (Pointed out by Anders Carlsson)

2002-02-25  Matthias Clasen  <maclas@gmx.de>

	* docs/tutorial/btk-tut.sgml, docs/tutorial/images/*, examples/*: More
	 BTK+ 2.0 updates.

	* docs/tutorial/Makefile.am: build and dist the new tutorial, not
	the old Linuxdoc one.

Mon Feb 25 01:14:26 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktextlayout.c (find_display_line_above): free iter before
	going to done

	* btk/btktreeview.c (validate_visible_area): free above_path,
	(set_destination_row): free path before returning,
	(btk_tree_view_set_drag_dest_row): free current_dest

Sun Feb 24 14:15:45 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btktextview.c (widget_to_buffer): Take border
	width into account.

	* btk/btklabel.c (get_label_wrap_width): Don't use BdkFont
	to compute wrap width ... BdkFont will pull in X11 core
	fonts.

Sun Feb 24 00:06:58 2002  Owen Taylor  <otaylor@redhat.com>

	* Released 1.3.15.

	* configure.in: Version 1.3.15, binary, interface age 0.

	* NEWS: Updates

	* configure.in: Update version requirements.

Sat Feb 23 22:37:23 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkstyle.c (btk_style_init): Sanity check default
	font family name and size.

	* btk/btkwindow.c (btk_window_set_default_size): Remove
	incorrect comment about the geometry widget.

	* btk/btkwindow.c (btk_window_move_resize): Unset the
	btk_window_resize)() information once we've set the size
	once, to avoid it coming back next time we queue a resize.
	(#72359)

	* btk/btkwindow.c (btk_window_move_resize): Remove
	sething of ->need_default_position from here, Havoc
	says that it should correspond more or less exactly
	to BTK_WIDGET_MAPPED (window).

Sat Feb 23 23:00:48 2002  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreemodel.h: add () to function macros as per owen's
	request.

	* btk/btkfontsel.c: (btk_font_selection_select_best_style),
	(btk_font_selection_show_available_sizes),
	(btk_font_selection_set_font_name):
	* btk/btktreemodel.c: (btk_tree_model_get_iter_first),
	(btk_tree_model_foreach):
	* btk/btktreemodelsort.c: (btk_tree_model_sort_sort_level),
	(btk_tree_model_sort_build_level):
	* btk/btktreeselection.c: (btk_tree_selection_selected_foreach):
	* btk/btktreeview.c: (validate_visible_area),
	(btk_tree_view_focus_to_cursor), (btk_tree_view_set_model),
	(btk_tree_view_map_expanded_rows), (btk_tree_view_search_move),
	(btk_tree_view_search_init):
	* tests/testtreeview.c: (run_automated_tests): change iter_root
	to iter_first

Sat Feb 23 22:10:52 2002  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreemodel.c (btk_tree_path_new_first): change new_root to
	new_first to avoid confusion.
	(btk_tree_model_get_iter_first): ditto.

Sat Feb 23 20:59:05 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkstyle.c btk/btkrc.[ch]: btk/btksettings.c btk/btkstyle.c:
	Patch from Richard Hestilow to add a btk-font-name BtkSetting.

	* bdk/x11/bdkevents-x11.c: Add Btk/FontName XSETTING.

2002-02-24  Tor Lillqvist  <tml@iki.fi>

	* btk/btkfilesel.c: Move inclusion of <windows.h> before inclusion
	of <winsock.h>, to actually get STRICT prototypes for Win32
	API. Include bunnylib.h early to get G_OS_WIN32 and G_WITH_CYGWIN.
	Don't declare static functions that aren't defined if !HAVE_PWD_H
	or if G_OS_WIN32.
	(win32_btk_add_drives_to_dir_list): Remove #if 0 code, reindent.
	(btk_file_selection_get_selections): Don't crash if nothing has
	been selected.

Sat Feb 23 20:33:29 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkplug.[ch] btk/btksocket.[ch] btk/xembed.h: Implement 
	accelerator propagation using a custom XEMBED_BTK_KEY_GRAB
	XEMBED_BTK_KEY_UNGRAB pair of messages.

	* btk/btkwindow.[ch]: private export _btk_window_keys_foreach().

	* btk/btkplug.c (btk_plug_set_is_child): Clear focus and default
	widgets.

2002-02-23  Havoc Pennington  <hp@redhat.com>

	* btk/btktextbuffer.c (save_range): change gravity of start/end
	marks so that text added at either end of the range doesn't end up
	inside the range.
	(btk_text_buffer_real_insert_range): fix to handle pasting a range
	into itself. #71412
	
Sat Feb 23 19:05:34 2002  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (validate_visible_area): Didn't refind node
	when it was NULL.  Bug found by Tor Lillqvist.

2002-02-24  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkevents-win32.c (build_keypress_event,
	build_keyrelease_event, bdk_event_translate): Set also group in
	the key press/release events, always to zero for now.

2002-02-24  Anders Carlsson  <andersca@gnu.org>

	* btk/stock-icons/stock_dialog_error_48.png: 
	* btk/stock-icons/stock_sort_ascending_16.png:
	* btk/stock-icons/stock_undelete_24.png: 
	* btk/stock-icons/stock_sort_descending_16.png: 
	Alpha-pad icons so they get the correct size.
	
Sat Feb 23 16:52:38 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkentry.c: Patch from Matthias Clasen to remove some
	excessive ::changed signals for BtkEntry. (#53130)

2002-02-23  Tor Lillqvist  <tml@iki.fi>

	* btk-zip.sh.in: Include the btkrc files for themes.

2002-02-23  Anders Carlsson  <andersca@gnu.org>

	* btk/btkiconfactory.c (get_default_icons): Register 16x16 
	versions of most icons.

	* btk/stock-icons: Add 16x16 versions
	of most icons.

Wed Feb 20 16:44:05 2002  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_scroll_to_cell): delay
	scrolling until we try to draw the window.

	* btk/btktreeview.c (validate_visible_area): Implement
	scroll_to_cell.

2002-02-23  Tor Lillqvist  <tml@iki.fi>

	* btk/btk.def: Add missing btk_file_selection_get_select_multiple.
	Remove btk_tree_view_column_cell_* entry points that were made
	private.

Sat Feb 23 15:43:46 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btktogglebutton.c: Make button draw depressed whenever
	the user clicks / activates it, whether it's off/on/inconsistent.

Sat Feb 23 11:54:12 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/*.h bdk/*.h: Massive padding addition to class structures.

	* btk/btktextmark.h: Fix a FIXME about G_CONST_RETURN.

Fri Feb 22 20:28:18 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkrange.c: Applied patch from Thomas Leonard to make
	stepper click to scroll take effect immediately, rather than after
	a delay (#67649).

	* btk/btkrange.c: Remove right-click == step in trough since it
	isn't a useful binding and it's a large area to hit accidentally.
	(Leave it on the steppers since its more useful there and less
	likely to do accidentally.)

2002-02-23  Pablo Saratxaga  <pablo@mandrakesoft.com>

	* configure.in (ALL_LINGUAS): Add "cy" to the language list.

2002-02-23  Jody Goldberg <jody@bunny.org>

	* btk/btkaccelgroup.c (btk_accel_group_connect) : lower case the
	  key_val.
	(btk_accel_group_connect_by_path) : ditto.
	(btk_accel_group_disconnect_key) : ditto.

	* btk/btkwidget.c (btk_widget_real_key_release_event) : simplify.
	(btk_widget_real_key_press_event) : ditto.

Sat Feb 23 00:28:47 2002  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeviecolumn.c: Documented undocumented functions.

	* btk/btktreemodel.c: Documented undocumented functions.

Sat Feb 23 03:10:20 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreeview.c (btk_tree_view_key_press): honor min_width and
	max_width while resizing columns (pointed out by Jorn Baayen)

Fri Feb 22 19:17:46 2002  Owen Taylor  <otaylor@redhat.com>

	Patch from Matthias Clasen (#54488)

	* btk/btkwindow.c: Set/unset HAS_FOCUS flags here,
	and do ::has-focus notifications.

	* btk/btkclist.c btk/btkentry.c btk/btksocket.c
	btk/btktext.c btk/btktextview.c btk/btkwidget.c:
	Remove unecessary focus_in/out handles and unecessary
	flag setting.

	* btk/btkwidget.c: Adda missing notification on ::parent.

Fri Feb 22 18:36:45 2002  Owen Taylor  <otaylor@redhat.com>

	Fixes for AIX compilation from Miroslaw Dobrzanski-Neumann,
	#72182.

	* demos/btk-demo/main.c btk/btktreeview.c btk/btktoolbar.c
	btk/btkpaned.c btk/btkobject.c btk/btkcontainer.c 
	btk/btkcolorsel.c btk/btkcellrender.c bdk/x11/xsettings-client.h:
	Squash trailing commas on enumerations.

	* bdk/bdktypes.h: Drop BDK_RELEASE_MASK to 1 << 30 instead
	of 1 << 31 to work around AIX compiler problem. (C standard
	seems to imply that compiler is required to use an unsigned
	type for the enum value in this case.)

	* bdk/bdkpixbuf-drawable.c: Fix lvalue casts.

	* btk/btkwindow.h: Fix use of enum types for bitfields ... 
	compilers may choose to use a signed type for bitfields.

Sat Feb 23 00:34:01 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreeview.c (validate_rows_handler): leave threads before
	returning (#72045)

2002-02-22  Anders Carlsson  <andersca@gnu.org>

	* btk/stock-icons/*: Rename icons.
	
	* btk/stock-icons/Makefile.am: Update for new icon names.

	* btk/btkiconfactory.c (init_icon_sizes): Set the 
	BTK_ICON_SIZE_BUTTON size to be 20x20.
	(get_default_icons): Change stock names.

Fri Feb 22 22:39:59 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreeprivate.h: add last_single_clicked and
	last_single_clicked_2 rowrefs and add disable_popdown to the
	bitfield

	* btk/btktreeview.c (btk_tree_view_destroy): add destroy stuff
	for two new rowrefs
	(btk_tree_view_button_press): add some 'advanced' button handling,	
	so double click is being handled right (double click madness was
	discovered by Anders Carlsson)

	* btk/btktreeview.c (btk_tree_view_set_property): add missing
	break
	(btk_tree_view_class_init): default value of headers_visible
	should be TRUE (both pointed out by Damon Chaplin, #71986)

	* btk/btktreeview.c (btk_tree_view_real_start_interactive_search):
	connect to populate_popup,
	(btk_tree_view_search_disable_popdown): new function,
	(btk_tree_view_real_search_enable_popdown): ditto,
	(btk_tree_view_search_enable_popdown): ditto,
	(btk_tree_view_search_dialog_destroy): check for
	btk-tree-view-popdown-disabled (#71868)

	* btk/btktreeview.c (btk_tree_view_set_reorderable): move
	->priv->reorderable assignment to bottom. (#72122)

2002-02-22  Havoc Pennington  <hp@redhat.com>

	* btk/btkstyle.c (_btk_draw_insertion_cursor): subtract 1 from
	line endpoint, to avoid cursor dirt in the text widget.
	zero-width lines appear to draw the endpoint always. #67999

2002-02-22  Havoc Pennington  <hp@redhat.com>

	* btk/btktextview.c (buffer_to_widget): implement more cleanly by
	using text_window->allocation.x/y instead of recomputing it. 
	Fixes a bug caused by leaving out the border width here.

2002-02-22  Havoc Pennington  <hp@redhat.com>

	* btk/btktextview.c (changed_handler): call
	btk_size_group_queue_resize to avoid invalidating the widget every
	time its requisition changes. Instead we use the btree invalid
	lines to know what to redraw. Fixes #71429

Fri Feb 22 14:08:38 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* btk/btkradiobutton.c, btk/btkcheckbutton.c, btkbutton.h,
	btktogglebutton.c: feedback when check and radio buttons are
	depressed.	

2002-02-22  Matthias Clasen  <maclas@gmx.de>

	* btk/btktreeview.c (btk_tree_view_set_reorderable):
	s/columns/rows/ in docs.  (#70199)

	* btk/btktreestore.c (btk_tree_store_insert): s/before/after/ in 
	docs. (#71852, #68405)

	* btk/btkcalendar.c (btk_calendar_select_day): Correct a comment.

Thu Feb 21 23:02:29 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreeview.[ch]: add keynav handling for unselect all,
	focus column header, change focus with arrow keys in column headers,
	column reordering, column resizing, small try to fix page up/down
	(this fixes #70889, and fixes a great deal of #53580)

Thu Feb 21 16:51:17 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkaccelgroup.c (btk_accelerator_valid): Add
	BDK_ISO_Next_Group/Prev_Group/Level3_Shift/
	First_Group/Last_Group to list of invalid accelerators.
	(A lot more that should be added, but probably would
	want a range mechanism. These are the ones found in
	the standard XFree86 config files.)

	* btk/btkbindings.c (btk_bindings_activate): Fix problem
	that broke bindings for menus.

	* btk/btkwindow.[ch]: Export _btk_window_activate_key()
	privately.

	* btk/btkmenushell.c (btk_menu_shell_key_press): Use
	_btk_window_activate_key(), btk_bindings_activate_event().

Thu Feb 21 12:24:22 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkctree.c (btk_ctree_class_init): Remove some workarounds
	for +/= and shift key handling.

Wed Feb 20 14:26:47 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkkeyhash.[ch]: Implement "fuzzy" key binding lookups;
	allow matches on key and level but not group. Also, implement 
	ignoring "consumed modifiers correctly."

	* btk/btkaccelgroup.c btk/btkbindings.c: Convert to using
	BtkKeyHash.
	
	* btk/btkdebug.h btk/btkmain.c: Support BTK_DEBUG=keybindings

	* bdk/x11/bdkevents-x11.c (bdk_event_translate): Fill in
	the group for key release events as well as key press events.

	* bdk/bdkkeys.h bdk/x11/bdkkeys-x11.c (bdk_keymap_translate_keyboard_state): 
	Rename unused_modifiers to consumed_modifiers, make the docs and
	non-Xkb implementation match the Xkb implementation.

	* bdk/linux-fb/bdkkeyboard-fb.c bdk/win32/bdkkeys-win32.c: Propagate
	doc and parameter name changes.

	* bdk/x11/bdkkeys-x11.c (bdk_keymap_translate_keyboard_state):
	XkbTranslateKeyCode doesn't handle LockMask, we need to handle
	it ourselves.

	* bdk/x11/bdkkeys-x11.c (bdk_keymap_translate_keyboard_state): Force
	<Shift>Tab to give BDK_ISO_Left_Tab, since we need consistency
	to allow dealing with ISO_Left_Tab.
	
	* btk/btkwindow.c btk/btktextview.c btk/btkscrolledwindow.c
	btk/btkpaned.c btk/btkcombo.c  btk/btknotebook.c:
	Remove inappropriate uses of BDK_ISO_Left_Tab. (BDK_ISO_Left_Tab
	or <Shift>Tab both are equivalent as a binding specifier.)

	* btk/btkbutton.c (btk_button_class_init): Make ::activate
	BTK_RUN_ACTION, so you can bind an accelerator to it.

	* btk/btklabel.c (btk_label_set_uline_text_internal): Call 
	bdk_unicode_to_keyval on the mnemonic character.

	* tests/testbtk.c: Add a test for the new fuzzy key binding matching.

2002-02-21  jacob berkman  <jacob@ximian.com>

	* btk/theme-bits/Makefile.am (EXTRA_DIST): inconsitent files are
	.pngs too

Wed Feb 20 21:52:13 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkselection.c (btk_selection_request): Set the property
	as type ATOM_PAIR, not ATOM. (#72074, Gregory Merchan.)

	* bdk/x11/bdk{property,selecton}-x11.c: Auto-convert properties
	of type ATOM_PAIR as well as properties of type ATOM.

2002-02-21  Matthias Clasen  <maclas@gmx.de>

	* docs/tutorial/images/*.png: screenshots of examples.
	
	* docs/tutorial/btk-tut.sgml: remove deprecated widgets, add
	screenshots, fix chapters 1-4 for BTK+ 2.0. 

	* demos/btk-demo/Makefile.am (INCLUDES): add -DBDK_PIXBUF_DISABLE_DEPRECATED.

Thu Feb 21 00:31:41 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* btk/btkspinbutton.c: Many cleanups and fixes. Draw exclusively
	in expose handler. Feedback when buttons are depressed.

	* btk/btkstyle.c: update for changes in btkspinbutton.c. Fix
	spinbuttons for RTL langauges.

Wed Feb 20 23:00:08 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* btk/btkstyle.c: new radio buttons. handle inconsistent state for
	check- and radiobuttons.

	* btk/theme-bits/check-13-inconsistent.png,
	btk/theme-bits/radio-13-inconsistent.png: new files

	* btk/theme-bits/radio-13.png: new radio buttons

	* btk/theme-bits/Makefile.am (EXTRA_DIST): add new
	-inconsistent.png files

Wed Feb 20 16:19:49 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkevents-x11.c: Add a XSETTING mapping for
	btk-can-change-accels. (#70218, Thomas Leonard.)

2002-02-20  Sven Neumann  <sven@gimp.org>

	* btk/btkcolorsel.c (btk_color_selection_finalize): check
	handler_id before disconnecting the signal handler since it might
	have never been connected if the BtkColorSelection is destroyed
	before it was realized.

2002-02-20  Matthias Clasen  <maclas@gmx.de>

	* docs/tutorial/btk-tut.sgml: Fold back Svens g_signal fixes from
	the examples.  

	* docs/tutorial/btk-tut.sgml, examples/progressbar/progressbar.c,
	examples/progressbar/Makefile: Make the progressbar example 
	deprecation-clean.

Tue Feb 19 22:10:59 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreeviewcolumn.c (btk_tree_view_column_mnemonic_activate): new
	function
	(btk_tree_view_column_create_button): use g_signal_* instead of
	btk_signal_*, hook up _mnemonic_activate callback
	(btk_tree_view_column_update_button): use
	btk_label_set_text_width_mnemonic instead of btk_label_set_text
	(#69095)

	* btk/btktreeview.c (btk_tree_view_class_init): remove key bindings
	for C-f and C-b, let treeview search use C-f (instead of C-s)
	(#61866)

	* btk/btkrc.key.emacs: add some BtkTreeView bindings

Tue Feb 19 20:56:32 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* btk/theme-bits/decompose-bits.c (do_part): fix bug (skipping all
	black pixels).

2002-02-19  Sven Neumann  <sven@gimp.org>

	* examples/*/*.c: finish conversion to g_signal_* functions by
	using G_OBJECT and G_CALLBACK and other assorted changes.

Tue Feb 19 17:36:31 2002  Kristian Rietveld  <kris@btk.org>

	* btktreeprivate.h, btktreeviewcolumn.[ch], btktreeview.c: change
	btk_tree_view_column_cell_render,
	btk_tree_view_column_cell_focus,
	btk_tree_view_column_cell_draw_focus and
	btk_tree_view_column_cell_set_dirty to be private functions.

	* btktreeviewcolumn.[ch]: add install_handler argument to
	_cell_set_dirty to control if _mark_rows_col_dirty (which calls
	install_presize_handler) gets called, set widths correctly so
	autosizing works (#71870)

	* btktreeview.c (btk_tree_view_column_autosize): new function,
	(btk_tree_view_button_press): make double click on column
	separator resize the row (#71870)
	(btk_tree_view_get_dest_row_at_pos): change DnD threshold to 33%
	(#71869, suggestion by Anders Carlsson)

Mon Feb 18 23:16:16 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmain.[ch]: Add routines _btk_find_module(),
	_btk_get_module_path() to look up a module of an arbitrary type in
	a standard fashion. (#68474)

	* btk/btkrc.c: Make module_path keyword warn and do
	nothing. Remove the im_module_path keyword.

	* btk/btkrc.c (btk_rc_get_im_module_path): Fix
	to return the standard path instead of one determined
	from im_module_path and BTK_IM_MODULE_PATH.
	
	* btk+-2.0.pc.in: Add btk_host to go along with btk_binary_version.

2002-02-19  Matthias Clasen  <maclas@gmx.de>

	* docs/tutorial/btk-tut.sgml, docs/examples/*: Trivial formatting
	fixes to all examples, simple functional fixes to rangewidgets example.

Mon Feb 18 18:27:45 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkfontsel.c (btk_font_selection_set_font_name): Select
	the right item in the family list. (Reported by Mark Patton,
	Patch from Satajyit Kanungo, #64240)

	* btk/btkfontsel.c (btk_font_selection_set_font_name): Update
	the size and face entry lists as well, fix memory leak.
	(Also #64240)

	* btk/btkfontsel.c (btk_font_selection_show_available_sizes): 
	Allow fractional sizes, unselect the selected row if none
	matches.

	* btk/btkscrolledwindow.c (btk_scrolled_window_focus): Fix
	a bug where the scrolled window would always get focus
	when focusing out of the child.

2002-02-18  Hans Breuer  <hans@breuer.org>

	* bdk/win32/bdkevents-win32.c : process WM_PAINT messages
	for bg_pixmap == BDK_NO_BG, fixes The GIMP's canvas
	rendering glitches on win32

	* bdk/win32/bdkinput-win32.c : use g_object_new to create
	BdkDevice instead of g_new
 
	* btk/btkpaned.c : make LAST_SIGNAL the last in enum. 
	This avoids to smash totally unrelated static data and
	resulting random crashes. (as reported on btk-devel-list, 
	2002-02-10 : testbtk crashes)

	* btk/btk.def : add new file selection entry points

Mon Feb 18 17:34:43 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkentry.c btk/btktextview.c: Remove support for
	the poorly defined text/plain type for now. (#55117)

Mon Feb 18 16:44:00 2002  Owen Taylor  <otaylor@redhat.com>

	* docs/widget_system.txt: Add some docs for BTK_NEED_REQUEST
	BTK_NEED_ALLOCATION.

	* btk/btkmenu.c (btk_menu_popup): Scroll the menu
	to the right place before showing the menu to
	avoid spurious enter events.

	* btk/btkmenu.c (btk_menu_realize): Only scroll
	if there is an active menu item.

	* btk/btkwidget.c (btk_widget_init): Set RESIZE_NEEDED
	ALLOC_NEEDED initially.

2002-02-18  Matthias Clasen  <maclas@gmx.de>

	* NEWS: fix version number.

2002-02-18  Manish Singh  <yosh@gimp.org>

	* Makefile.am: don't comment out the lines to dist the packer
	example, just simply remove it. (the continuation line confused
	make even though it was in the comment, barf)

Mon Feb 18 14:40:22 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkcombo.c (btk_combo_popdown_list): Fix problems
	with stuck grab (#60132, reported by Nicolas Setton) and
	stuck prelighting. Combine duplicated code in three
	places for popping down the list.

Mon Feb 18 14:17:59 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkclist.c (adjust_adjustments) 
	* btk/btklayout.c (btk_layout_size_allocate)
	* btk/btktextview.c (btk_text_view_size_allocate) 
	* btk/btktreeview.c (btk_tree_view_size_allocate) 
	* btk/btkviewport.c (btk_viewport_size_allocate):
	Standardize on a page increment of page minus 1 line
	rather than half a page (#51027, Eric Fischer)

	* btk/btkviewport.c (btk_viewport_size_allocate): 
	Change step increment to be 0.1 * page_size height rather than
	a fixed 10 pixels.

Mon Feb 18 12:31:52 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkimcontextsimple.c (btk_im_context_simple_filter_keypress): 
	Don't commit unless we got at least one hex digit. (#70619)

Sun Feb 17 21:30:49 2002  Owen Taylor  <otaylor@redhat.com>

	* Released 1.3.14

	* configure.in: Version 1.3.14, interface, binary age 0.

	* bdk/bdkrebunnyion-generic.c (miSubtractO): Fix out-of-bounds
	read. (#71619, reported by Morten Welinder)

	* btk/btkmenu.c (btk_menu_class_init): Fix setting default.

	* btk/btkfilesel.c (btk_file_selection_class_init): Add
	a select_multiple property to go along with thenew 
	get/set_select_multiple.

	* bdk/bdkwindow.c: Patch from Soeren Sandmann to improve
	update debugging code. (#71703)

2002-02-17  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkcolor-win32.c (free_colors): Don't set the
	PC_EXPLICIT flag for unused palette entries, that might have
	undesired side effects. Just set them to black. Black is always
	present in a palette, so having superfluous black entries won't
	cause any extra allocations from the system palette either when
	realized.

	* bdk/win32/bdkevents-win32.c
	(bdk_event_translate:WM_QUERYNEWPALETTE): Don't do anything if the
	system visual is static color, i.e. the user has told BDK to use
	just the 16 static colors. In that case no need to redraw
	anything, as the colors are static and by definition always
	correctly mapped in the system palette.
	(WM_PALETTECHANGED): Ditto, no need to call UpdateColors() either.
	
	* btk/btk.def: Add new btkfilesel entry points.

2002-02-17  Matthias Clasen  <maclas@gmx.de>

	* docs/tutorial/btk-tut.sgml, examples/paned/paned.c, 
	examples/paned/Makefile: Make the paned example deprecation-clean.

2002-02-17  jacob berkman  <jacob@ximian.com>

	* Makefile.am: remove the packer example files as they don't exist
	in CVS.

2002-02-16  Manish Singh  <yosh@gimp.org>

	* tests/testbtk.c: hm, check buttons look better for below.

2002-02-16  Manish Singh  <yosh@gimp.org>

	* tests/testbtk.c: redid the filesel test. Added a way to set select
	multiple as a toggle button, and made show/hide fileops toggle
	buttons as well. get_selections() is called on OK and all the
	filenames selected are printed.

2002-02-17  Tor Lillqvist  <tml@iki.fi>

	* README.win32: Remove comment about the btk-1-3-win32-production
	branch having more functionality.

	* bdk/win32/*.c: Massive changes. Too many to list here, but I'll
	try a summary:

	1) Unify BdkPixmap and BdkImage implementation: For each
	BdkPixmap, allocate a BdkImage, and vice versa.
	BdkPixmapImplWin32Data has a pointer to the BdkImage.
	BdkImage::windowing_data is a pointer to the BdkPixmap.

	This simplifies many pixmap and image related functions a lot, and
	reduces duplicated code. For instance, there is only one
	place in bdk/win32 where CreateDIBSection() is called, in the
	function _bdk_win32_new_pixmap(). Converting a bitmap (BdkPixmap)
	to a Windows rebunnyion is almost trivial, with the bitmap bits being
	readily accessible in the associated BdkImage.

	All blitting between BdkPixmaps, BdkWindows and BdkImages goes
	through handled the _bdk_win32_blit() function, which calls
	different functions to handle the cases of blitting from pixmaps,
	inside windows (scrolling), or from windows, which all require
	somewhat different handling.

	2) Support 256-color mode. This has long been very broken, now it
	works more or less OK. Keep the logical palette for each colormap
	as small as possible while allocating and freeing colors. Select
	and realize the logical palette associated with a BdkColormap into
	a DC before drawing or blitting.

	When the display is in 256-color mode, make it possible for the
	user to override the size of the palette(s) used with either the
	BDK_WIN32_MAX_COLORS environment variable, or a -max-colors
	command line option. It is possible to reduce the palette size all
	the way down to using just the 16 static colors (which causes the
	system visual to be of type BDK_VISUAL_STATIC_COLOR. This could
	possibly be useful if one desperately wants to avoid color
	flashing. (Note that in order for this to work properly, an as of
	yet not commited fix to bdkrgb.c is needed.)

	Handle the palette messages. On WM_PALETTECHANGED, call
	UpdateColors() for the given window hierarchy. Do this only if a
	window in some other top-level window hierarchy caused the palette
	change (realized a palette). Do this max five times in a row (an
	arbitrarily chosen limit), though, otherwise redraw by generating
	expose events. On WM_QUERYNEWPALETTE, cause a redraw of the whole
	window hierarchy by generating BDK_EXPOSE events.

	3) Code cleanup in general. For instance, remove the "emulated"
	X11 structs ColormapStruct, Visual and XStandardColormap. Use the
	new BDK_DEBUG_* flags for debugging output in the relevant source
	files. Remove the unused colormap hash table in bdkcolor-win32.c

	4) Plug some resource leaks.

2002-02-14  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkdnd-win32.c (bdk_dropfiles_filter): Use
	g_filename_to_uri() to actually create legal URIs in the
	text/uri-list data.

2002-02-16  Manish Singh  <yosh@gimp.org>

	* btk/btkfilesel.[ch]: Added multiple selection API

2002-02-16  Manish Singh  <yosh@gimp.org>

	* bdk/linux-fb/miarc.c: use fabs() on a double instead of abs()

2002-02-17  Matthias Clasen  <maclas@gmx.de>

	More work on #71430.

	* examples/*/Makefile (CFLAGS): add deprecation guards.
	
	* docs/tutorial/btk-tut.sgml, examples/*/*.c: make most examples
	deprecation-clean; the major offenders right now are the examples
	that make heavy use of completely deprecated or broken widgets:
	list, tree, text, pixmap, paned and progressbar. These will have
	to be redone from scratch.

Sun Feb 17 00:13:06 2002  Kristian Rietveld  <kris@btk.org>

	This commit lands the 'dy patch'.

	* btk/btktreeview.c (validate_rows_handler): update top_row or dy,
	(btk_tree_view_top_row_to_dy): new function,
	(btk_tree_view_row_changed): update top_row or dy,
	(btk_tree_view_rows_reordered): update top_row

2002-02-16  Matthias Clasen  <maclas@gmx.de>

	* demos/Makefile.am (INCLUDES): add -DBDK_PIXBUF_DISABLE_DEPRECATED.

2002-02-16  Matthias Clasen  <maclas@gmx.de>

	* examples/extract.awk: rearrange rules to not emit the example 
	start and end markers.

	* docs/tutorial/btk-tut.sgml: turn the start and end markers into
	SGML comments, so they don't clutter the formatted tutorial.

2002-02-16  Havoc Pennington  <hp@pobox.com>

	* btk/btkwindow.c (btk_window_parse_geometry): take
	BDK_HINT_RESIZE_INC into account, and handle negative coordinates
	correctly. (Can't email Owen - hope this is OK.)

Fri Feb 15 20:09:45 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkscrolledwindow.[ch] btk/btkmarshallers.list:
	Add key bindings on BtkScrolledWindow for arrow keys,
	PageUp/PageDown Home/End to scroll the window. 
	Bind Control-[Shift]-Tab to focus out of the scrolled
	window entirely. Allow the scrolled window to be
	focused if no child can be focused. (#63480)

	* btk/btkwidget.c (btk_widget_hide): Remove the REALIZED()
	check - if we have visible but not mapped widgets 
	(inside a unshown notebook tab, for instance), we need
	to track their size. (#65087, reported by Damon Chaplin.)

	* btk/btkcolorsel.c (palette_change_color): Shut up
	a warning.

2002-02-16  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/rc/Makefile.am (bdk-win32res.lo): Depend on btk.ico.

	* bdk/win32/rc/btk.ico: Use the real BTK logo. Thanks to Jernej
	Simoncic for providing the nice multi-resolution .ico file.

2002-02-15 Alexey Malyshev <maa@sparc.spb.su>
	
        * btk/tmpl/btkimage.sgml
	removed wrong sentence from btk_image_new() docs

Fri Feb 15 19:38:00 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreestore.c (btk_tree_store_clear_traverse): new function
	(btk_tree_store_clear): traverse the tree, so we emit row_deleted
	for every node. This way we don't have confused row refs crashing the
	application. (#70631)

2002-02-14  Richard Hult  <rhult@codefactory.se>

	* btk/btkpaned.c (btk_paned_enter): Only queue a draw on the
	handle, not the whole widget. #71530.
	(btk_paned_leave): Likewise.

2002-02-14  Jody Goldberg <jody@bunny.org>

	* btk/btkrange.c (btk_range_class_init) : add new signal
	  'adjust_bounds' to potentialy change the bounds before assigning the
	  new value and camping it to the existing bounds.
	(btk_range_internal_set_value) : used here. #68800.
	* btk/btkmarshalers.list : add VOID:DOUBLE

Thu Feb 14 21:08:49 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkglobals.c: Remove BDKVAR from C file, see
	if anyone complains. (#71317, Morten Welinder.)

2002-02-14  Matthias Clasen  <maclas@gmx.de>

	The following changes are the beginning of the work on #71430.
	
	* examples/extract.sh, examples/extract.awk: Make extraction work.
	
	* examples/Makefile (SUBDIRS): Remove packer.

	* examples/packer/pack.c, examples/packer/Makefile: Removed.

	* docs/tutorial/btk-tut.sgml: Fix the included examples far
	enough to make them compile and (mostly) work, remove the packer
	example.

Thu Feb 14 16:46:48 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkentry.c btk/btktextdisplay.c btk/btklabel.c
	btk/btkstyle.[ch] btk/btkwidget.c: Patch from Bill
	Haneman and Padraig O'Briain to add cursor_aspect_ratio
	style property to BtkWidget to allow theming the aspect
	ratio of the cursor.

	* btk/btkentry.c btk/btktextview.c btk/btklabel.c
	btk/btkwidget.c tests/testbtkrc: Move cursor-color style property
	to BtkWidget.

Thu Feb 14 11:13:22 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkimmulticontext.c (btk_im_multicontext_get_surrounding): 
	Fix bug where we called get_surrounding on the context,.
	not the slave.

Thu Feb 14 00:10:09 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btktooltips.c (btk_tooltips_event_handler): Only
	pop the tooltip down on a select set of events, not
	on any unknown event. (#71157, Jody Goldberg)

	* btk/btktooltips.c (btk_tooltips_event_handler):
	Fix some warnings.

Thu Feb 14 00:02:21 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkcalendar.c (btk_calendar_size_request): A bunch of
	small allocation/drawing fixes.

	* btk/btkcalendar.c: Replace DAY_XPAD, DAY_YPAD with
	BtkWidget::focus-padding

Wed Feb 13 23:01:20 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkcalendar.c: Patch from Bill Haneman to draw
	to focus using btk_paint_focus() with the focus width
	BtkWidget::focus-width. (#63075)

	* btk/btkcalendar.c (btk_calendar_size_request): Initialize
	label_char_ascent/descent to 0. (#56925, reported by
	(Jean-Noel Guiheneuf)

2002-02-13  Havoc Pennington  <hp@redhat.com>

	* btk/btktextview.c (btk_text_view_flush_scroll): validate a
	larger area, proportional to widget size, to fix
	#71427 reported by Dennis Bjorklund

2002-02-13  Havoc Pennington  <hp@redhat.com>

	* btk/btktextview.c (btk_text_view_paint): just go ahead and flush 
	all the first validate stuff if it hasn't been done, presumably
	someone called process_updates at a weird time.

	* tests/testtext.c (do_apply_colors): terminate on >= end, not >
	end, avoids infinite loop when end is at the end of the buffer.

	* btk/btktextbtree.c (_btk_text_btree_delete): when creating a
	line data, we were adding it to the wrong line ("line" instead of
	"start_line")

2002-02-13  Joe Shaw  <joe@ximian.com>

	* btk/btktreeitem.c (btk_tree_item_expose): Don't chain up to the
	container's expose event.  Instead call
	btk_tree_item_expose_child() on each child.  Avoids a failed
	g_assert() in btk_container_propagate_expose().
	(btk_tree_item_expose_child): Added.  Synthesize an expose event
	for our children.  Basically btk_container_propagate_expose()
	minus the g_assert().  (#71396)

2002-02-13  Tor Lillqvist  <tml@iki.fi>

	* bdk/bdkinternals.h: Add some more BdkDebugFlags, for more
	fine-grained debugging output (mainly used in the Win32 backend).

	* bdk/bdk.c: Corresponding additions to the bdk_debug_keys table.

Wed Feb 13 15:42:42 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btktooltips.[ch] btkwidget.c: Implement Control-F1
	as toggle-tooltips-mode.

	* btk/btktooltips.c: Remove parsing of tooltips style
	string from here ... now in btkrc.c.

Wed Feb 13 12:41:44 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmain.c (btk_init_check): g_warning() if setting
	the local fails, like bdk_set_locale() did.

	* bdk/x11/bdkselection-x11.c (bdk_text_property_to_utf8_list): 
	Don't free local_list if local_count == 0. (#71241, reported
	by Kevin Vandersloot.)

	* bdk/x11/bdkselection-x11.c (bdk_text_property_to_text_list): 
	Clean up list == NULL handling and failure.

Wed Feb 13 11:27:31 2002  Owen Taylor  <otaylor@redhat.com>

	* tests/testtreeview.c (typesystem_recurse): Cast GType
	to long and use %ld to fix warning. (#71318, Morten Welinder)

Wed Feb 13 13:26:39 2002  Tim Janik  <timj@btk.org>

	* btk/btkmenu.c: fix figuring accel path and changing behaviour.

Wed Feb 13 06:42:37 2002  Tim Janik  <timj@btk.org>

	* btk/btktable.c (btk_table_size_allocate_pass1): partly revert
	my recent expanding change to not expand the table if all children
	have not epxand behaviour. this fixes palette views which often
	use homogeneous non-expanding tables.

Tue Feb 12 14:27:41 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreemodelsort.c (btk_tree_model_sort_row_deleted): emit
	row_deleted before we start unreffing the nodes ourselves
	(btk_tree_model_sort_increment_stamp): always increment the stamp,
	and not only if the stamp equals 0 (pointed out by Darin Adler)

	* btk/btktreemodel.c (btk_tree_row_ref_deleted_callback): we want
	to continue the while loop and not the nested for loop.

Tue Feb 12 02:19:49 2002  Tim Janik  <timj@btk.org>

	* btk/btktable.c (btk_table_size_allocate_pass1): always spread out
	the extra space allocated for the homogeneous case, as we don't
	properly deal with readjusting table allocation within it. (for  this
	purpose, a BtkAlignment can be used as table parent).

2002-02-11  Darin Adler  <darin@bentspoon.com>

	* btk/btktreemodelsort.c: (btk_tree_model_sort_row_changed):
	Consider reordering the row even when there's no sort column, if
	there's a default sort function.
	(btk_tree_model_sort_rows_reordered): Use symbolic constants.
	(btk_tree_model_sort_level_find_insert): Add code to handle the
	case where there is no sort column, but a default sort function.
	(btk_tree_model_sort_insert_value): Add code to handle the case
	where there is no sort column an no default sort function.
	(btk_tree_model_sort_set_model): Use symbolic constant.
	(btk_tree_model_sort_reset_default_sort_func): Use symbolic constant.

2002-02-11  Sven Neumann  <sven@gimp.org>

	* btk/btkfilesel.c: converted the "Delete File" dialog to
	BtkMessageDialog. Marked missing strings for translation.

Mon Feb 11 22:03:15 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* btk/btkpaned.[ch]: Opaque resizing + prelighting for paned widget.
	* btk/btkvpaned.c, btk/btkhpaned.c: move reszing logic to btkpaned.c

Mon Feb 11 21:42:17 2002  Kristian Rietveld  <kris@btk.org>

	Implements DnD scrolling and fixes #71139

	* btk/btktreeview.c (btk_tree_view_vertical_autoscroll): new function,
	(scroll_row_timeout): new function,
	(btk_tree_view_drag_motion): create scroll_timeout, so
	scroll_row_timeout gets called

Mon Feb 11 17:54:46 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreeview.c (btk_tree_view_size_allocate): set upper
	member of hadjustment correct, so the hscrollbars of lists smaller
	than 1 page (in width) are somewhat saner

2002-02-11  jacob berkman  <jacob@ximian.com>

	* bdk/bdkwindow.h (bdk_get_default_root_window): fix signature to
	match implementation

Mon Feb 11 16:48:34 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btkliststore.c (btk_list_store_set_valist): set value of
	func to NULL during initialization (we don't use func in the
	!SORTED case, so we just silent the compiler here) (#71029)

Mon Feb 11 16:40:44 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreeview.c (btk_tree_view_set_model): install presize
	handler, so the validate_rows_handler will always be run (#70997)

Sun Feb 10 22:20:46 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btkliststore.c (btk_list_store_sort_iter_changed): increase
	value of new_location by one if cmp_a > 0 and we hit the end of
	the list and pass NULL instead of a 'NULL-iter' with
	_rows_reordered (#71060)

Sun Feb 10 12:32:44 2002  Owen Taylor  <otaylor@redhat.com>

	* modules/input/Makefile.am modules/input/{imam-et.c, imti-er.c,
	imti-et.c} po/POTFILES.in: Add three Ethiopic input methods from
	Daniel Yacob.

2002-02-10  Anders Carlsson  <andersca@gnu.org>

	* btk/btkcalendar.c (btk_calendar_class_init): Set finalize handler;
	(btk_calendar_finalize): Rename btk_calendar_destroy to 
	btk_calendar_finalize since ::destroy can be called multiple times, 
	resulting in double-freeing memory.

2002-02-10  Hans Breuer  <hans@breuer.org>

	* bdk/win32/bdkgeometry-win32.c : don't reduce the scroll
	rect size by the scroll amount

	* bdk/win32/bdkwindow-win32.c
	* bdk/win32/bdkselection-win32.c : added some casts to
	make it compile with msvc's strict type checking

	* btk/fnmatch.c : #include <ctype.h> again for tolower
	prototype. The fnmatch() code assumes to be in the crt 
	locale though it is feeded by utf8 strings from btkfilesel.c

	* btk/btkfilesel.c : let ->cmpl_text be a strdup managed by
	_CompletionDir instead of referencing already freed memory

	* btk/btktooltips.c (btk_tooltips_init) : fix typo to
	btk_rc_parse_string (theDefaultTooltipColor) once as it
	was intended

	* tests/makefile.msc : added more tests

	* tests/testbtk.c (create_list) : don't try to load btkenums.h
	from the current directory use ../btk/btkenums.h instead

2002-02-10  Kjartan Maraas  <kmaraas@bunny.org>

	* btk/btksizegroup.c: Fix a double "The" typo in a string.
	
2002-02-09  Matthias Clasen  <matthias@local>

	* btk/btknotebook.c (btk_notebook_set_focus_child): Avoid segfault
	for selectable tab labels (even without a segfault, they make the
	notebook almost unusable, though).  (#69985)

2002-02-08  Matthias Clasen  <matthias@local>

	* btk/btkmenuitem.c (btk_menu_item_set_accel_path): Silently do 
	nothing if the parent is not a menu.  (#66492)

2002-02-06  Matthias Clasen  <matthiasc@poet.de>

	* btk/btkitemfactory.c (btk_item_factory_from_widget,
	btk_item_factory_path_from_widget): Try fetching the return value 
	from menu_item->submenu as a fallback.  (#69020)
	
Sat Feb  9 22:57:43 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreemodelsort.c (btk_tree_model_sort_build_level): convert
	the iter to a child iter again, after doing _iter_children. It's
	possible that _iter_children added some rows and updated the stamp.

2002-02-09  Daniel Elstner  <daniel.elstner@gmx.net>

	* btk/btktextchild.c: Use == rather than = in sanity
	checks.  Ouch!

2002-02-09  Daniel Elstner  <daniel.elstner@gmx.net>

	* btk/btktextchild.c (CHECK_IN_BUFFER_RETURN): Add missing
	curled braces so that it doesn't always return.  Also indent
	both CHECK_IN_BUFFER* macros properly, and make use of
	B_STMT_START/B_STMT_END.

Sat Feb  9 13:27:14 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkbindings.h: Add prototype for
	_btk_binding_reset_parsed().

Sat Feb  9 13:19:20 2002  Owen Taylor  <otaylor@redhat.com>

	* configure.in btk/Makefile.am btk/theme-bits/*: Add
	tools and images used for creating the check/radio
	button images in the default theme.

Sat Feb  9 13:58:41 2002  Soeren Sandmann  <sandmann@daimi.au.dk>

	* btk/btkpaned.[ch]: Keyboard navigation for BtkPaned
	F6: cycle between panes.
	F8: focus handle (#53584)
	
	* tests/testbtk.c: Add test cases for BtkPaned keyboard 
	navigation.
	
Sat Feb  9 00:16:31 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkimage-x11.c (_bdk_x11_copy_to_image): 
	XCopyArea with subwindow_mode = IncludeInferiors.
	(#70999)

	* demos/testpixbuf-save.c (configure_cb): Fix a minor
	memory management problem.

Fri Feb  8 20:24:58 2002  Owen Taylor  <otaylor@redhat.com>
	
	* btk/btkbindings.c (binding_compose_params): Fix problem
	with string-valued parameters (#70012, Johan Dahlin.)

	* btk/btkentry.c (btk_entry_delete_whitespace): Fix 
	white space deletion.

Fri Feb  8 21:25:56 2002  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreemodelsort.c (btk_tree_model_sort_row_deleted): fix
	evil ref bug where the wrong row and a deleted row was unreffed.
	Found by Darin Adler <darin@bentspoon.com>

Fri Feb  8 18:46:13 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkbindings.[ch] (_btk_binding_reset_parsed): Add
	a function to delete all bindings add by
	btk_binding_parse_binding() when rereading RC files.

	* btk/btkrc.c (btk_rc_reparse_all_for_settings): Reset
	binding set content as well as RC content.

	* btk/btkbindings.c (binding_compose_params): Fix 
	various GValue handling problems.

	* btk/btkentry.c (btk_entry_class_init): Remove bindings 
	for C-b, C-f, M-b, M-f, C-a, C-e, C-w, C-y, M-space, C-u,
	C-k, M-\, M-d, C-d.

	* btk/btktextview.c (btk_text_view_class_init): Remove
	same bindings as BtkEntry, plus C-n, C-p, C-space

        * btk/btkrc.key.default btk/btkrc.key.emacs btk/Makefile.am:
	Add Emacs and Default key themes.
	
2002-02-08  Darin Adler  <darin@bentspoon.com>

	* btk/btktreeview.c: (btk_tree_view_map_expanded_rows_helper):
	Remove a tiny bit more dead code.

2002-02-08  Darin Adler  <darin@bentspoon.com>

	* btk/btktreeview.c: (btk_tree_view_map_expanded_rows_helper):
	Fix stale pointer bug.

Fri Feb  8 14:30:14 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkclist.c (title_focus_in): Return FALSE if
	not showing the titles. (#70959, Thomas Leonard)

2002-02-08  Darin Adler  <darin@bentspoon.com>

	* demos/btk-demo/main.c: (load_file): isspace -> g_ascii_isspace
	* bdk/x11/bdkim-x11.c: Remove bdki8n.h include.
	* bdk/x11/bdkkeys-x11.c: Remove <ctype.h> include.
	* bdk/x11/bdkmain-x11.c: Remove <ctype.h> include.
	* btk/fnmatch.c: Remove <ctype.h> include.
	* btk/btkaccelgroup.c: Remove <ctype.h> include.
	* btk/btkaccellabel.c: (btk_accel_label_refetch): toupper ->
	g_unichar_toupper, toupper -> g_unichar_totile
	* btk/btkbindings.c: Remove <ctype.h> include.
	* btk/btkfontsel.c: Remove <ctype.h> include.
	* btk/btkiconfactory.c: Remove <ctype.h> include.
	* btk/btkinputdialog.c: Remove <ctype.h> include.
	* btk/btklabel.c: Remove <ctype.h> include.
	* btk/btkmain.c: Remove <ctype.h> include.
	* btk/btkmenu.c: Remove <ctype.h> include.
	* btk/btkoldeditable.c: Remove <ctype.h> include.
	* btk/btkrc.c: Remove <ctype.h> include.
	* btk/btktextbtree.c: Remove <ctype.h> include.
	* btk/btktextiter.c: Remove <ctype.h> include.
	* btk/btktextsegment.c: Remove <ctype.h> include.

2002-02-08  Sven Neumann  <sven@gimp.org>

	* btk/btkfilesel.c
	* btk/btkgamma.c
	* btk/btkinputdialog.c: use stock labels for dialog action buttons.

2002-02-08  Darin Adler  <darin@bentspoon.com>

	* btk/btktreemodelsort.c: (btk_tree_model_sort_ref_node),
	(btk_tree_model_sort_unref_node): Pass the ref_node and
	unref_node calls through to the child model.

2002-02-08  Laszlo Peter  <laca@ireland.sun.com>

	* btk/btktextchild.c: s/__FUNCTION__/B_GNUC_FUNCTION/
	* btk/btktextview.c: ditto

2002-02-07  Havoc Pennington  <hp@pobox.com>

	* btk/btkspinbutton.h (struct _BtkSpinButtonClass): add
	change_value virtual function, to fix build

	* btk/btkpixmap.c (btk_pixmap_class_init): parent_class was 
	from BtkWidget not BtkMisc. Not that it ever mattered.

Thu Feb  7 19:52:00 2002  Owen Taylor  <otaylor@redhat.com>

        * btk/btknotebook.[ch]: Add ::move-focus-out signal
	to handle Control[-Shift]-Tab and Control-arrow
	bindings and implement bindings as per #53612.

	* btk/btktextview.c (btk_text_view_move_focus): Fix 
	fetching the toplevel for plug-socket.

	* btk/btknotebook.c (btk_notebook_class_init): Remove
	bindings for Return/Enter to select the page.

	* btk/btknotebook.c (btk_notebook_change_current_page):
	Beep at ends.

	* btk/btknotebook.c (focus_tabs_move): Don't wrap around
	and beep at ends.

	* btk/btknotebook.c (btk_notebook_focus): When focusing into
	the page with the arrow keys, focus the first widget,
	not the directionally closest widget.

Thu Feb  7 19:00:10 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkspinbutton.c (btk_spin_button_key_release): Convert
	to using  binding set for doing key bindings. (#62622,
	Requested by Skip Montaro)

	* btk/btkwindow.c (btk_window_class_init): Add control-arrow
	bindings as overrides along with control-tab bindings.

	* btk/btknotebook.c (btk_notebook_class_init): Fix return
	type for ::focus_tab signal.

Thu Feb  7 19:39:27 2002  Kristian Rietveld  <kris@btk.org>

	Fixes #70782 and some drag dest rectangle/line issues

	* btk/btktreeview.c (btk_tree_view_set_model): set
	BTK_TREE_VIEW_IS_LIST flag (we can switch from a TreeStore to a
	ListStore for example)
	(btk_tree_view_get_path_at_pos): revert previous change, we
	shouldn't correct for the header, because we are taking bin_window
	coordinates here
	(btk_tree_view_set_drag_dest_row): queue old drag_dest row and
	upper/lower neighbors for draw, so the drag dest rectangle/line will
	be cleared correctly
	(btk_tree_view_get_dest_row_at_pos): correct for treeview header
	here, as drag_y is relative to the widget and _get_path_at_pos wants
	coords relative to bin_window, draw black outline rectangle after
	drawing the cells

Thu Feb  7 10:53:12 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkentry.c (btk_entry_draw_text): Use layout text
	(which may be affected by invisible char) to compute
	selection bounds, not entry text. (#70733, Alex Larsson)

2002-02-07 Padraig O'Briain <padraig.obriain@sun.com>

	* btk/btkwidget.[ch]:
	Change show_help signal to return gboolean instead of void. This
	allows the keypress which invokes the signal to be propagated to the
	focus widgets ancestors if not handled by the focus widget.
	
	* btk/btktoolips.[ch]
	Change _btk_tooltips_show_tip () to return a gboolean indicating
	whether widget has tooltip to display.
	
2002-02-07 Padraig O'Briain <padraig.obriain@sun.com>

	* btk/btkwidget.[ch]:
	Change popup_menu signal to return gboolean instead of void. This
	allows the keypress which invokes the signal to be propagated to the
	focus widgets ancestors if not handled by the focus widget.

	* btk/btkcolorsel.c btk/btkentry.c btk/btktextview.c:
	Change signature of popup_menu signal handler to return gboolean
	instead of void and return TRUE in the signal handler

2002-02-07  Anders Carlsson  <andersca@gnu.org>

	* bdk/x11/xsettings-common.c (xsettings_setting_free): Free 
	the setting name.

Wed Feb  6 23:28:39 2002  Kristian Rietveld  <kris@btk.org>

	Fixes #70708

	* btk/btktreeview.c (btk_tree_view_get_path_at_pos): we're dealing
	with widget coordinates here, so take the header height into
	account while converting
	(btk_tree_view_widget_to_tree_coords): take header height into
	account
	(btk_tree_view_tree_to_widget_coords): ditto
	(btk_tree_view_get_dest_row_at_pos): we were passing coords
	relative to the tree with _get_path_at_pos, while that function
	wants coords relative to the widget

2002-02-06  Havoc Pennington  <hp@redhat.com>

	* btk/btktextview.c (btk_text_view_scroll_hpages): remove unused variable
	(btk_text_view_get_window): add warning about how you
	can't get the private window. #70683, and avoid default: in the
	switch so we get "enum value unhandled" warnings

2002-02-06  Havoc Pennington  <hp@redhat.com>

	* btk/btktextchild.c: Add warnings if you try to use a child
	anchor that isn't inside a buffer. Really kind of lame; 
	we should separate the anchor from the buffer. But not worth 
	fixing for now. #70601

Wed Feb  6 18:25:24 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreemodelsort.c: rip out all the debugging ifdefs, as
	modelsort seems to be stable (and nobody complained :)

Tue Feb  5 19:13:42 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkgeometry-x11.c (bdk_window_queue): Keep
	the length of the anti-expose queue finite, by if
	it gets too long, first doing a XSync() and checking
	the event queue, and if that doesn't work, simply
	discarding all anti-expose items in the queue.

	* bdk/x11/bdkdnd-x11.c (bdk_window_cache_filter): Fix ordering
	on ConfigureNotify (#56349, Thomas Leonard)

2002-02-05  Havoc Pennington  <hp@redhat.com>

	* btk/btkimage.c (btk_image_expose): offset area being gotten from
	pixmap by the align/padding offsets, so we don't get warnings
	in bdk_pixbuf_get_from_drawable (and so it works, of course)

2002-02-05  Matthias Clasen  <matthiasc@poet.de>

	* btk/btkrc.c (btk_rc_parse_file): Remove a (now) misleading comment.

2002-02-05  Federico Mena Quintero  <federico@ximian.com>

	* bdk/bdkwindow.h: Do not #include <bdk/bdkwindow.h>.

Tue Feb  5 22:54:16 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btkliststore.c (btk_list_store_insert_after): let's set the
	path, which we're going to pass with the emission of row_inserted, to
	the iter we inserted and not its sibling.

2002-02-04 Padraig O'Briain <padraig.obriain@sun.com>

	* btk/btkmenu.c (btk_menu_popup):
	Fix leak of BdkEvent (#70519)

Mon Feb  4 10:40:28 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkstyle.c (btk_default_draw_resize_grip):
	Fix from Matthias Clasen to clear background appropriately
	for theme by calling btk_style_apply_default_background().
	(#70449)

Mon Feb  4 10:06:49 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkevents-x11.c: btk-double-click-time,
	not btk-double-click-timeout. (#70501)

2002-02-04  Havoc Pennington  <hp@pobox.com>

	* btk/btksignal.c (btk_signal_connect_while_alive): 
	(btk_signal_connect_object_while_alive): rename 
	"signal" arg to "name" to avoid compiler warnings
	about shadowing signal(). #70453

2002-02-03  Anders Carlsson  <expander-master@btk.org>

	* btk/btkstyle.c (btk_default_draw_expander): Add 
	flipping support to the expanders.

Sat Feb  2 21:54:01 2002  Owen Taylor  <otaylor@redhat.com>

	RC file lookup improvements (#68234, suggestions
	from Matthias Clasen.)

	* btk/btkrc.c (btk_rc_parse_file): Look for the 
	locale suffix variants (btkrc.en_US, btkrc.en) for
	all RC files we parse, not just the default RC
	files.

	* btk/btkrc.c (btk_rc_parse_default_files): Remove
	support for charset specific RC files.

Sat Feb  2 20:16:04 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmenushell.c (_btk_menu_shell_select_first): 
	Non-exported _btk_menu_select_first() function that
	selects the first item of the menu in a standard
	way. (Skipping tearoffs.)

	* btk/btkmenushell.c btk/btkentry.c btk/btktextview.c
	btkmenuitem.c: Use _btk_menu_shell_select_first().

	* btk/btkmenuitem.c (btk_real_menu_item_select): Remember
	if we are starting the timeout from a keypress so
	we can set menushell->ignore_enter properly.

	* btk/btknotebook.c (focus_child_in): Return something
	meaningful if there are no children.

	* btk/btkmenu.c (btk_menu_key_press): Fix precendence
	problem.

Sat Feb  2 19:15:42 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmenu.c (btk_menu_popup): Fix some bugs in
	the determination of xgrab_shell.

Sat Feb  2 17:43:00 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkentry.c (btk_entry_grab_focus): Add a BtkSetting
	(btk-entry-select-on-focus) controlling whether the
	contents of an entry are selected on focus in.

	* btk/btkmenu.c (btk_menu_key_press): Add a BtkSetting
	(btk-can-change-accels) controlling whether accelerators can be
	changed on the fly or not. (#51902)

	* btk/btkmenu.c (btk_menu_key_press): Allow unmodified
	accelerators, now that accelerator changing can be turned
	off for those who won't expect it. (#61285)

	* btk/btkaccelgroup.c (btk_accelerator_valid): Allow 
	Backspace/Delete/KP_Delete as valid accelerators.

	* btk/btkmenu.c (btk_menu_key_press): Allow setting of
	Delete/Backspace as accelerators by making them toggle
	the menu item between empty and the pressed key.
	(#58605)

	* tests/testbtkrc: Remove the objectionably short cursor blink
	time setting.

Sat Feb  2 16:43:31 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmenu.c (btk_menu_popup): To get around the fact
	that we may have a owner_events = FALSE grab in effect
	when we pop up a window, make a temporary grab on a
	different window, then grab on the real window. Fixes
	a problem where if a context menu popped up under the 
	cursor, the first item would be stuck unselected.
	(#59812, reported by Arnaud Charlet.)

2002-02-02  Peter Williams  <peterw@ximian.com>

	* btk/Makefile.am (install-data-local): Install btkrc.default
	from $(srcdir) for when $(builddir) is different.

Sat Feb  2 19:00:39 2002  Kristian Rietveld  <kris@btk.org>

	* btk/Makefile.am: remove TESTBTK_RCFILE define

Sat Feb  2 11:37:21 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmenu.c (btk_menu_popup): Remove the 
	"select first item if popped up from keypress" hack --
	was causing more problems than it was worth 
	(#53191, #68483)

	* btk/btktextview.c (popup_targets_received): 
	 btk/btkentry.c (popup_targets_received): If activated
	from keyboard, select first item of popup menu.

Sat Feb  2 18:07:51 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreeview.c (btk_tree_view_size_allocate): set upper member
	of vadjustment correct, so the vscrollbars of lists smaller than
	1 page are somewhat saner (#66905)

	* btk/btkliststore.c (btk_list_store_remove_silently): do not
	increment the stamp, liststore is a model with persisting iters

Fri Feb  1 23:54:00 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkrc.[ch] (btk_rc_parse_engine):	Support 
	engine "" {} to mean override to the default 
	engine. (#70205)

Fri Feb  1 23:25:33 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btktooltips.c (btk_tooltips_init): Parse the
	RC string here when the first object is created
	rather than in the class_init to not break doc 
	building. (#70341, Havoc Pennington.)

	* btk/btkrc.c (parse_include_file): Use the directories
	for the currently parsed files as the starting point
	to look for include files. (#59975)

Fri Feb  1 20:21:56 2002  Manish Singh  <yosh@gimp.org>

	* btk/btkinputdialog.c: use btk_label_new_with_mnemonic for labels
	that actually have mnemonics

Fri Feb  1 19:57:59 2002  Owen Taylor  <otaylor@redhat.com>

	* configure.in: Fix use of ! in shell.

	* btk/btktooltips.c (btk_tooltips_class_init) btkrc.default: 
	Move the setting of default tooltips colors to btktooltips.c
	from btkrc.default. (Use default priority so themes will
	override.) (#58542)

Fri Feb  1 17:48:51 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkrc.c (btk_rc_get_style): Fix ordering of
	priorities so that priorities take precendence over
	the ordering by type. (#70205)

	* test/testbtkrc tests/testbtk.c (create_rc_file): Add 
	some labels to test priorities in testbtkrc.

Fri Feb  1 00:37:49 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreeview.c (btk_tree_view_move_cursor_page_up_down): use
	y coordinate relative to the tree and not the treeview window
	(fixes the PgDn/PgUp brokenness)

Fri Feb  1 23:40:31 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreeview.c (btk_tree_view_button_press): adjust
	cell_area and background_area for possible treeview scroll
	(fixes #70283, #70065)

Fri Feb  1 22:20:13 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreeview.c (btk_tree_view_size_allocate): use
	height - page_size not height - allocation->height (fixes #66269)

Fri Feb  1 15:22:23 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkimage.c (btk_image_class_init): Fix typo
	in property description. (Christian Rose.)

Fri Feb  1 14:50:36 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkrc.c (btk_rc_parse_string): Handle reparsing
	any strings if the theme changes. (#69465)

	* tests/testbtk.c: Add a test for btk_rc_parse_string().

Fri Feb  1 20:50:29 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreeview.c (btk_tree_view_dy_to_top_row): set tree to
	NULL if tree_view->priv->tree is NULL (#70152, patch by John Harper).

Fri Feb  1 12:51:20 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btknotebook.c (focus_child_in): Catch the
	cur_page == NULL (no children) case. (#70287,
	Paolo Maggi.)

Fri Feb  1 12:12:12 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkfilesel.c (attempt_file_completion): 
	s/directory/folder/ in all labels and messages.

Fri Feb  1 08:57:38 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmain.c (btk_exit_func): Remove this useless
	atexit handler. (existance pointed out by Stefan Kost)

	* btk/btkmain.c (btk_init_check): Warning fixes.

Thu Jan 31 18:46:10 2002  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreemodel.c (btk_tree_row_reference_free): unref the
	model after the last use, not before.

Thu Jan 31 14:50:16 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkrc.default btk/Makefile.am: Install a Default
	RC file that sets the tooltips color to yellow. (#58542)

	* btk/btksettings.c (btk_settings_class_init): make 
	the default theme "Default", not NULL.

Thu Jan 31 11:33:52 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkproperty-x11.c (insert_atom_pair): Fix 
	another missing static.

	* btk/btkimmodule.c (n_loaded_contexts): And another.

	* bdk/x11/Makefile.am bdk/x11/gxid_lib.c: Don't
	build gxid sources at all except in the vanishingly
	rare case of --with-xinput=xfree.

2002-01-31  Mark McLoughlin  <mark@skynet.ie>

	* bdk/bdkimage.c: (scratch_image_info_for_depth): make static.

	* bdk/x11/bdkimage-x11.c: (get_full_image): ditto.

	* bdk/x11/gxid_lib.[ch]: (_gxid_claim_device), (_gxid_release_device):
	renamed from gxid_(claim|release)_device.

	* bdk/x11/bdkinput-gxi.c: (_bdk_input_enable_window),
	(_bdk_input_disable_window): upd for gxid change.

	* btk/btkimage.c: (animation_timeout): make static.

	* btk/btkstyle.c: (draw_thin_shadow), (draw_spin_entry_shadow): make
	static.

	* btk/btktextutil.c: (bidi_menu_entries): make static.

Thu Jan 31 10:21:05 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkplug.c (btk_plug_focus): Handle the case where
	bin->child is NULL. (#70153, Padraig O'Briain)

	* btk/btktextutil.c (_btk_text_util_append_special_char_menuitems): 
	Actually call gettext() on the labels; previously they
	were marked with N_() but we never called gettext().

Wed Jan 30 20:15:49 2002  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreestore.c (btk_tree_store_set_valist): save last minute
	changes before committing.

	* btk/btkliststore.c (btk_list_store_set_valist): ditto

Wed Jan 30 18:46:14 2002  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkliststore.c (btk_list_store_set_valist): only emit the
	signal if an interesting column changes.

	* btk/btktreestore.c: ditto.

	* btk/btktreeview.c (btk_tree_view_set_cursor): change behavior so
	that it no longer grabs 

2002-01-30  Manish Singh  <yosh@gimp.org>

	* btk/btkhandlebox.c (btk_handle_box_destroy): remove unused
	variable.

	* btk/btkwindow.c (btk_window_get_icon): function returns a value,
	so return NULL with g_return_val_if_fail instead of g_return_if_fail.

2002-01-30  Matthias Clasen  <matthiasc@poet.de>

	* btk/*.c: Remove excess g_return_if_fail calls from static
	and virtual functions.  (#57615)
	
2002-01-30  Anders Carlsson  <andersca@gnu.org>

	* btk/btkstyle.c (btk_default_render_icon): Allow a -1 icon size.

Wed Jan 30 20:29:01 2002  Tim Janik  <timj@btk.org>

	* btk/btkscale.c (btk_scale_set_digits): fix revrted bug fix.
	(use a define for max digits).

Wed Jan 30 13:55:59 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwindow.c (btk_window_show): Try to make
	sure that we have some focused widget on map. (#50339)

	* btk/btkdialog.c (btk_dialog_map): Handling picking
	a focus widget here differently so that if a
	response button gets picked, it's the default one.

	* tests/testbtk.c (make_message_dialog): Set the 
	default response for the dialogs.

Tue Jan 29 22:52:36 2002  Owen Taylor  <otaylor@redhat.com>

	* Released 1.3.13

	* configure.in: Micro version 13, interface, binary
	age 0. Require BUNNYLIB-1.3.13, Bango 0.24.

	* docs/Makefile.am (EXTRA_DIST): Add widget_geometry.txt,
	sizing-test.txt, tree-column-sizing.txt

	* docs/Makefile.am (EXTRA_DIST): Don't distribute
	Changes-1.2.txt, Changes-2.0.txt, README.linux-fb,
	since they are no longer canonical.

	* btk/btk.def: Convert spaces to tabs in front of
	btk_widget_set_accel_path in case it matters.

	* NEWS: Updated for 1.3.13.

Tue Jan 29 22:31:07 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.[ch] btkmenuitem.c btkitemfactory.c: Export 
	btk_widget_set_accel_path().

	* btk/btk.def: Add btk_widget_set_accel_path.

Tue Jan 29 21:50:28 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkaccelmap.[ch] btk/btkbindings.[ch] btk/btkwidget.[ch]:
	Consistently use BdkModifierType. (#66950, Mark Patton)

	* btk/btkimagemenuitem.c (btk_image_menu_item_new_from_stock):
	For consistency with btk_button_new_from_stock(), fall back
	to btk_image_menu_item_new_with_mnemnonic(). (#65944,
	Havoc Pennington)
	
	* btk/btkitemfactory.[ch] (btk_item_factory_path_from_widget): 
	Make G_CONST_RETURN. (#68527, Matt Wilson)

Tue Jan 29 20:56:13 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btk[vh]scale.c (btk_[vh]scale_new_with_range): Document
	that the end points are included in the range. (#69783,
	Jeffrey Baker)

Tue Jan 29 20:38:04 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkscale.[ch]: Revert the last changes to make the
	number of digits only effect drawing, instead, don't
	round unless we are in the 'draw_value' mode -- this
	is the behavior of BTK+-1.2, and keeps the behavior that
	if the user sees a displayed value, it is the correct value.

Tue Jan 29 19:51:05 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkenums.h: Deprecate BtkPreviewType,
	BtkSignalRunType, BtkSideType, BtkSubmenuPlacement, BtkSubmenuDirection
	(#68183, Matthias Clasen)

	* btk/btkmenuitem.h: Remove _btk_menu_item_set_placement() from
	the public header to avoid having to use BtkSubmenuPlacement.

	* btk/{btkmenuitem.c,btkmenubar.c,btkmenushell.c}: #define
	BTK_MENU_INTERNALS to preserve access to BtkSubmenu*.

	* bdk/bdki18n.h: Deprecate contents. (Darin Adler.)

Tue Jan 29 19:32:47 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btktextview.c (btk_text_view_get/set_property): 
	Fix wrong usage of g_value_set/get_object for PROP_TABS
	and memory leak in getter for PROP_TABS. (Jeff Franks)

Tue Jan 29 19:04:41 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkstyle.c (btk_style_render_icon): Document that
	a size of (BtkIconSize)-1 means don't scale.

	* btk/btkstyle.c (btk_default_render_icon): Obey the
	-1 convention.

	* btk/btkimage.c (btk_image_expose): Pass in -1 to
	btk_style_render_icon() to make sure that we catch it
	obviously if the style's render function tries to
	scale.

Tue Jan 29 18:50:59 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkimage.c (btk_image_expose): Optimize exposes of
	partial insensitive images.

2002-01-24  Havoc Pennington  <hp@redhat.com>

	* btk/btkimage.c (btk_image_expose): create insensitive version of
	the image regardless of storage type, #63305

	* demos/btk-demo/images.c: add toggle button to demonstrate that
	BtkImage makes its contents insensitive

Tue Jan 29 17:40:02 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkpixbuf-render.c (bdk_pixbuf_render_to_drawable):
	Call _bdk_draw_pixbuf(), thus enabling using this function
	for pixbufs with alpha. (#68801)

	* bdk/bdkdraw.c (bdk_drawable_real_draw_pixbuf): Move
	implementation of bdk_pixbuf_render_to_drawable()
	to here.

Tue Jan 29 17:16:17 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btklayout.c: Patch from Jacob Berkman to fix problem
	when the height/width of a layout was set before the
	adjustments were added. (#66294)

	* btk/btktreeview.c: Warning cleanups.

Tue Jan 29 16:35:04 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkhandlebox.c (btk_handle_box_motion): Small
	fix to size of torn off window (#60271, Detlef Reichl)

	* btk/Makefile.am: Don't install btkhsv.h. (Pointed out
	by Ross Burton)

Tue Jan 29 18:50:46 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreeview.c (btk_tree_view_move_cursor_page_up_down): free
	cursor_path after usage
	(btk_tree_view_real_start_interactive_search): use new g_signal
	and g_object calls
	(btk_tree_view_search_dialog_destroy): use g_object calls and free
	selected_iter if set
	(btk_tree_view_search_position_func): rework so it will never ever
	appear offscreen (#68492)
	(btk_tree_view_search_move): use new g_object calls
	(btk_tree_view_search_init): free selected_iter if set, use new
	g_object calls
	(btk_tree_view_leave_notify): don't destroy interactive search
	dialog

Tue Jan 29 23:07:03 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreeview.c (btk_tree_view_real_start_interactive_search):
	send focus in event
	(btk_tree_view_search_dialog_destroy): send focus out event (#66466)

2002-01-29  Anders Carlsson  <andersca@gnu.org>

	* btk/btkfontsel.c (btk_font_selection_select_size): Show correct
	size in the size entry.

Tue Jan 29 16:11:55 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkfontsel.c (btk_font_selection_show_available_sizes): Use
	btk_tree_view_set_cursor() instead of btk_tree_selection_select_iter().

	* btk/btkfontsel.c (btk_font_selection_init): Add mnemonic to
	preview field. (#52433, patch from Anders Carlsson)
	
	* btk/btkfontsel.c (btk_font_selection_dialog_init): Remove the 
	dialog separator. (#69558, Alex Larsson, patch from Anders Carlsson)

Tue Jan 29 15:24:59 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkfontsel.[ch]: Switch over to BtkTreeView from
	BtkCList. Remove the entries above the font/face lists 
	since they were a little confusing. (Not sure about this 
	change, so the code is still there the entries are
	just hidden.) (#68890)

	* btk/btkfilesel.c: Switch over to BtkTreeView from
	BtkCList. Add mnemonics for fileops. Allow Control/Shift
	Tab to focus out.

	* btk/btkfilesel.c: Make fileop dialogs transient-for
	the fileselector. (#69336, patch from Melvin Hadasht)

	* btk/btkgamma.c (button_clicked_callback): Fix handling
	of gamma dialog a bit. (#69336, Matthias Clasen.)

Tue Jan 29 14:56:28 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btksocket.c (toplevel_focus_out_handler): Return boolean
	(and FALSE from focus_in / focus_out handlers. (#69528,
	Padraig O'Briain)

Tue Jan 29 14:47:54 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmain.c (btk_init_check): Remove the scary startup
	warning. (#69480)

Tue Jan 29 14:24:49 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwindow.c (btk_window_class_init): Add <Control>Tab
	bindings for "move-focus" so that Control-Tab to escape from
	something that eats Tab just works if not otherwise overriden.

	* btk/btkspinbutton.c (btk_spin_button_new_with_range) 
	* btk/btkvscale.c (btk_vscale_new_with_range)
	* btk/btkhscale.c (btk_hscale_new_with_range): Use a page_size
	of zero for the adjustment, since at times we think that the range
	is lower to upper - page_size. A page size equally to the 
	step_increment is, in any case, not meaningful.

2002-01-29  Tor Lillqvist  <tml@iki.fi>

	* README.win32: Add comment about btk-1-3-win32-production branch
 	currently being ahead in functionality and code cleanliness (in
 	bdk/win32). Just in case somebody looks at the code in bdk/win32
 	here and starts fixing it, when it is going to change soonish
 	anyway.

2002-01-29  Sven Neumann  <sven@gimp.org>

	* btk/btkrc.c: don't install an empty icon_set if none of the image
	files could be found in the pixmap_path (bug #69398).
	
2002-01-29  Sven Neumann  <sven@gimp.org>

	* bdk/x11/bdkimage-x11.c (_bdk_x11_copy_to_image): fixed a segfault
	that showed up when using the color picker.

Tue Jan 29 11:51:14 2002  Tim Janik  <timj@btk.org>

	* btk/btkscale.[hc]: fix default value for ::digits property,
	leave as 1 as per havoc's request.
	don't apply the draw_digits value to range->round_digits,
	so we don't perform gross quantization by default.

2002-01-25  Havoc Pennington  <hp@redhat.com>

	* btk/btktextbtree.c (_btk_text_btree_delete): fix assertion
	failure by creating the line data, but not validating it at this
	stage. Also, remove old code related to the "bogus newline" mess
	that removed all tags from the last char in the buffer if you
	tried to delete it.
	(_btk_text_line_data_new): put this here and prepend underscore,
	remove from btktextlayout.c

Mon Jan 28 19:57:39 2002  Owen Taylor  <otaylor@redhat.com>

	* modules/input/imhangul.c modules/input/imhangul-defs.h
	po/POTFILES.in. Add port of Emacs korean-hangul input
	method from Yusuke Tabata (#67665)

Mon Jan 28 18:25:10 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkentry.c (btk_entry_draw_frame): Paint shadow
	before focus to give theme engines a bit morea
	flexibility. (#69857)

Mon Jan 28 16:23:20 2002  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_dy_to_top_row): no longer
	g_assert.

2002-01-28  Jon Trowbridge  <trow@gnu.org>

	* btk/btktreeview.c (btk_tree_view_set_model): When setting the
	BtkTreeView's model, set prelight_node, prelight_tree,
	button_pressed_node and button_pressed_tree to NULL. (#69603)

2002-01-28 Bill Haneman <bill.haneman@sun.com>

	* btk/btkstyle.c:
	Make sure that the default expanders are drawn with
	an outline thickness appropriate to the size of the
	expanders (RINT expander_size/7).
	Added static btk_style_draw_polygon_with_gc(), to
	reduce code duplication.

	* btk/btktreeview.c: (btk_tree_view_bin_expose):
	Use focus_line_thickness when drawing focus lines.

	* btk/btktreeviewcolumn.c:(btk_tree_view_column_cell_get_size):
	Adjust requested width to include focus line thickness.
	(btk_tree_view_column_cell_render_or_focus):
	Calculate a focus line rectangle which gets larger as the focus
	line thickness increases, to avoid overwriting cell content.
	Render left-aligned content at x+focus_line_width.
	(btk_tree_view_column_cell_draw_focus):
	Don't draw a focus line around an editable text cell, since the
	text caret already indicates keyboard focus.
	Pass a BtkStateType appropriate to the focussed cell's state
	to btk_paint_focus.

Mon Jan 28 14:44:40 2002  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_real_select_cursor_row): Only
	activate/edit the row if shift is not pressed, #69248

2002-01-28  Anders Carlsson  <andersca@gnu.org>

	* btk/btkcurve.c (btk_curve_set_vector): Fix build.

2002-01-28  Matthias Clasen  <matthiasc@poet.de>

	* btk/{btkalignment.c,btkaspectframe.c,btkbutton.c,
        btkcellrenderer.c,btkcellrendererpixbuf.c,btkcombo.c,
        btkcontainer.c,btkcurve.c,btkframe.c,btklabel.c,
        btkmessagedialog.c,btknotebook.c,btkspinbutton.c,btktable.c,
        btktext.c,btktextview.c,btktreeview.c,btktreeviewcolumn.c,
        btkviewport.c,btkwidget.c}: General property notification 
	cleanup. (#69066)

2002-01-28  Anders Carlsson  <andersca@gnu.org>

	* btk/btkaccelgroup.c (btk_accel_groups_activate): & with the
	default mod mask so accels work when numlock is on.

Sun Jan 27 23:23:23 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btkrbtree.[ch]: add _btk_rbtree_mark_invalid (my previous
	commit already needed this ...)

Sun Jan 27 22:13:02 2002  Kristian Rietveld  <kris@btk.org>

	Fix for bug #69586

	* btk/btktreeprivate.h: get rid of tab_offset, introduce
	expander_size

	* btk/btktreeview.c: get rid of ->priv->tab_offset, introduce
	expander_size caching (from style), fix CELL_HEIGHT macro,
	use MAX ("RBNODE_HEIGHT", expander_size) (differs per case) for
	row height calculation, added style_set callback

2002-01-27  Anders Carlsson  <andersca@gnu.org>

	* btk/btklabel.c (btk_label_create_window): Set the cursor to
	BDK_XTERM.

	* btk/btktextview.h (struct _BtkTextView): add mouse_cursor_obscured.

	* btk/btkentry.h (struct _BtkEntry): Add mouse_cursor_obscured.

	* btk/btktextview.c (set_invisible_cursor): New function.
	(btk_text_view_obscure_mouse_cursor): Likewise.
	(btk_text_view_key_press_event): Call obscure_cursor if text 
	has been inserted.
	(btk_text_view_motion_event): Restore the mouse cursor.

	* btk/btkentry.c (btk_entry_realize): Add BDK_POINTER_MOTION_MASK.
	(set_invisible_cursor): New function.
	(btk_entry_obscure_mouse_cursor): Likewise.
	(btk_entry_key_press): call obscure_cursor if text has been inserted.
	(btk_entry_motion_notify): Restore the mouse cursor.

2002-01-27  Sven Neumann  <sven@gimp.org>

	* btk/btkstyle.c (sanitize_size): removed unused return value.

Sat Jan 26 19:27:23 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btksocket.c (btk_socket_grab_notify): Don't
	send MODALITY_ON/OFF if socket->same_app (More fixes for #69735)

Sat Jan 26 19:04:37 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmain.c (check_is_grabbed): Return FALSE not true
	in the grab_widget == NULL case. (Bug reported by 
	Padraig O'Briain, #69735)

	* btk/btkplug.c (handle_modality_on): Realize the modality
	window so btk_widget_event() doesn't complain :-((((.

2002-01-25  Federico Mena Quintero  <federico@ximian.com>

	Merge from bdk-pixbuf stable.

	* bdk/bdkpixbuf-drawable.c (rgb565msb): Fixed the endianness
	conversion --- swap the individual 16 bit values instead of taking
	everying as a 32 bit value.
	(rgb565lsb): Likewise.
	(rgb555lsb): Likewise.
	(rgb555msb): Likewise.

2002-01-25  Alex Larsson  <alexl@redhat.com>

	* bdk/linux-fb/bdkdrawable-fb2.c (bdk_drawable_impl_fb_class_init):
	Implement copy_to_image instead of get_image
	
	* bdk/linux-fb/bdkimage-fb.c:
	Implement _bdk_image_new_for_depth, _bdk_windowing_get_bits_for_depth and
	_bdk_fb_copy_to_image.
	Based in part on patch from Mathieu Lacage <mathieu_lacage@realmagic.fr>

	* bdk/linux-fb/bdkmain-fb.c:
	Make ENABLE_FB_MANAGER rebunnyion larger.

	* bdk/linux-fb/bdkprivate-fb.h:
	Change _bdk_fb_get_image to _bdk_fb_copy_to_image.

2002-01-25  Sven Neumann  <sven@gimp.org>

	* btk/btkwindow.c (btk_window_get_size): changed the comment so
	that btk-doc doesn't get confused.

Fri Jan 25 14:03:36 2002  Tim Janik  <timj@btk.org>

	* btk/btkspinbutton.c (btk_spin_button_draw_arrow): assert
	that the passed in arrow is always _UP or _DOWN, this catches
	false invocations which lead to drawing artefacts.
	(start_spinning): likewise, i.e. sanity check the passed in arrow.
	(btk_spin_button_button_release): fix arrow redrawing.
	(btk_spin_button_button_press): must set click_child for
	button3 even if we don't take spinning action right away.

	* btk/btkspinbutton.h (struct _BtkSpinButton): document
	valid values for click_child.

Thu Jan 24 23:03:24 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreeview.c (btk_tree_view_get_path_at_pos): update docs,
	return current FALSE if x is smaller than the current visible area,
	not than the requested area, don't correct y coordinate,
	TREE_WINDOW_Y_TO_RBTREE_Y will do that. Fixes #67477.

Thu Jan 24 15:41:08 2002  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c
	 (btk_tree_view_motion_draw_column_motion_arrow): fix column
	 reordering fully.
	 (btk_tree_view_size_allocate): fix evil bug.

Thu Jan 24 11:53:19 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btktreeview.c (btk_tree_view_destroy): Don't clear
	the model until we clean up all the other objects
	that might refer to the object.

2002-01-24  Mark McLoughlin  <mark@skynet.ie>

	* btk/btkaccessible.h: include btk/btkwidget.h

Wed Jan 23 20:28:59 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btknotebook.c (btk_notebook_draw_arrow): 
	Use insensitive state for insensitive arrows, not
	just an "etched state". (#67172, Adrian Custer)

2002-01-23  Manish Singh  <yosh@gimp.org>

	* btk/btkentry.c (btk_entry_set_text): use a variable that's actually
	been declared.

2002-01-23  Damon Chaplin  <damon@ximian.com>

	* configure.in (btk_doc_min_version): set minimum btk-doc version to
	0.9, since we need to use the new --type-init-func argument for
	btkdoc-scangobj.

2002-01-23  Matthias Clasen  <matthiasc@poet.de>

	* btk/btkentry.c, btk/btkwidget.c: Remove excessive
	g_return_if_fail() calls. (#57615)

	* btk/btkitemfactory.c (btk_item_factory_delete_entries): Make
	it work for paths with underline accelerators. (#69247)

Wed Jan 23 15:12:16 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkspinbutton.c (btk_spin_button_state_changed): 
	Stop spinning if widget becomes insensitive. (#56248)

Wed Jan 23 14:44:12 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkspinbutton.c (EPSILON): Decrease value since
	we now use doubles.

Tue Jan 22 16:58:37 2002  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_size_allocate): Fix sizing bug
	I introduced accidentally, #69358

2002-01-22 Padraig O'Briain <padraig.obriain@sun.com>

	* btk/btktreestore.c (btk_tree_store_iter_children):
	Update last change to prevent core dump

Mon Jan 21 01:21:54 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreestore.c: add some more stamp checks (pointed out
	by Anders Carlsson)

	* btk/btktreemodelsort.c (btk_tree_model_sort_insert_value): don't
	assume _row_changed will insert sort (because _row_changed doesn't
	need to follow this signal), so apply insert sort here
	(btk_tree_model_sort_level_find_insert): header doesn't need to be
	set here, so use a return instead of g_return_val_if_fail.

Mon Jan 21 18:28:17 2002  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_adjustment_changed): Update
	top_row.  Remove extraneous print statements.

2002-01-21  Matthias Clasen  <matthiasc@poet.de>

	* btk/btkitemfactory.c (btk_item_factory_popup, 
	btk_item_factory_popup_with_data): Document allowed values
	for ifactory.

	* btk/btkitemfactory.c (btk_item_factory_delete_entry): Make 
	it work for paths with underline accelerators.

Fri Jan 18 16:31:21 2002  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_size_allocate): only resize the
	window.

Mon Jan 21 11:56:31 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkentry.c (btk_entry_real_activate): Trap the 
	case where there is no default widget and the entry
	is the focus widget, since this also causes infinite
	recursion. (#69158)

Mon Jan 21 11:46:39 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdk.c (bdk_init_check): Set the fallback program class here,
	rather than lazilybdk_get_program_class(), since we don't want
	-name to override it. (#69123, Ryan Lovett)

Mon Jan 21 10:29:45 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdk.c: Fix wrong types for command line arguments 
	(#69124, Ryan Lovett)

	* bdk/bdk.c (bdk_arg_context_parse): Fix bug in parsing
	parsing '--arg VALUE'.

	* bdk/bdk.c: Remove unused variable bdk_error_trap_free_list.

2002-01-21  Havoc Pennington  <hp@pobox.com>

	* bdk/bdkwindow.c (bdk_window_add_filter): mention that window 
	arg can be NULL

Sat Jan 19 20:49:41 2002  Kristian Rietveld  <kris@btk.org>

	* demos/btk-demo/editable_cells.c: fix a load of open line ends
	(cell_edited): modified patch from German Poo Caaman~o
	to fix up old_text declaration and free the memory
	(do_editable_cells): unref the model after creating the treeview

	* demos/btk-demo/list_store.c: fix a load of open line ends,
	(add_columns): set the sort column id, so we can sort

	* demos/btk-demo/tree_store.c: fix a load of open line ends,
	(do_tree_store): unref the model after creating the treeview

2002-01-19  Havoc Pennington  <hp@pobox.com>

	* btk/btkwindow.c: link to new X11 section in a lot of places when
	mentioning the window manager.

	* btk/btkwidget.c (btk_widget_hide_on_delete): don't mention
	window manager since we're portable.

Sat Jan 19 08:47:41 2002  Jeff Garzik  <jgarzik@mandrakesoft.com>

	* bdk/linux-fb/bdkproperty-fb.c (bdk_atom_name):
	Wrap case values in GPOINTER_TO_UINT().  Fixes build with gcc 3.x.

	* btk/btkmain.c:  Include sys/types.h if G_OS_UNIX.
	Fixes build with gcc 3.x and -ansi.

Fri Jan 18 23:01:37 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkrc.c (btk_rc_parse_style): Fix problems when
	an engine declaration occurs in a reopened style, and
	g_free() of objects when errors occur.

2002-01-18  Matthias Clasen  <matthiasc@poet.de>

	* btk/btkitemfactory.c (btk_item_factory_get_widget_by_action):
	Clarify documentation. (#69026)

	* btk/btkprogressbar.c (btk_progress_bar_size_request): Fix 
	missing initialization of adjustment. (#69025)

2002-01-17  Raja R Harinath  <harinath@cs.umn.edu>

	Simplify Makefiles. 
	<URL: http://bugzilla.bunny.org/show_bug.cgi?id=68969>
	* bdk/Makefile.am: Remove use of automake conditionals to pick
	library to build.
	* btk/Makefile.am: Likewise.
	
	* bdk/Makefile.am (LDFLAGS): Use $(libdir), not @prefix@/lib.
	* btk/Makefile.am (LDFLAGS): Likewise.

Thu Jan 17 20:13:14 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btknotebook.c (btk_notebook_redraw_tabs): Fix
	missing allocation.x/y offsets. (#68962, Jacob
	Berkman)

	* btk/btknotebook.c (btk_notebook_size_allocate):
	Queue a redraw on the entire widget if we hide
	the last page or show the first. (Also #68962)
	
2002-01-17  Havoc Pennington  <hp@redhat.com>

	* btk/btktextview.c (btk_text_view_move_cursor_internal): change
	BTK_MOVEMENT_PARAGRAPHS to go to start/end of paragraph before it
	starts to go up/down paragraphs. This makes Ctrl+Up/Ctrl+Down work
	as in the keynav spec, though it makes the interpretation of
	BTK_MOVEMENT_PARAGRAPHS different from the interpretation of some
	of the other BTK_MOVEMENT_ thingies, maybe, as if that enum makes
	any sense anyhow.

Thu Jan 17 16:34:55 2002  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_real_select_cursor_row): For
	some reason, I was activating a row while just selecting it.
	Reported by andersca.
	(btk_tree_view_size_request): add a
	validate_rows_handler to give us a rough width of the widget.

	* btk/btktreeviewcolumn.c (btk_tree_view_column_update_button):
	Queue a resize here just in case.  It's needed in over half the
	cases, and I don't want to do a diff to figure out exactly when
	it's needed.

2002-01-17  Matthias Clasen  <matthiasc@poet.de>

	* btk/btkinputdialog.c,
	btk/btkcolorsel.c, btk/btkfilesel.c, btk/btkfontsel.c:
	Mark children as composite. (#66360)

	* btk/btkwidget.c (btk_widget_push_composite_child): Explain
	composite children some more. (#66360)

2002-01-17  Havoc Pennington  <hp@redhat.com>

	* btk/btktextlayout.c (_btk_text_layout_get_line_xrange): new
	function (which I then decided not to use but I think it's needed
	to fix #68963

	* btk/btktextview.c: add page_horizontally action signal and
	implement Ctrl+PgUp, Ctrl+PgDown based on patch from Padraig, 
	hackily modified to avoid adding BTK_MOVEMENT_ API. Part of 
	#53934

	* btk/btkmarshalers.list: add NONE:INT,BOOL

Thu Jan 17 17:02:38 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.c (btk_widget_real_unrealize): Call
	btk_selection_remove_all() here, not in destroy/
	finalize. (#66636, Sergey Vlasov)

	* btk/btkselection.c (btk_selection_request): Fix
	reentrancy problem with multiple conversions.

	* btk/btkselection.c (btk_selection_remove_all): 
	Don't remove incrs, we don't need the widget for
	maintain the incr.

	* btk/btkselection.c (struct _BtkIncrInfo): Remove
	the widget field from here, we don't need it.

Thu Jan 17 13:08:34 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkmain-x11.c (bdk_error_trap_push): Move
	here, and save/restore the X error handler to allow
	people using BTK+ to set the X error handler to something
	custom without disturbing the operation of BDK.

	* bdk/linux-fb/bdkmain-fb.c (bdk_error_trap_push) 
	* bdk/win32/bdkmain-win32.c (bdk_error_trap_pop): Add
	dummy implementations.

	* bdk/x11/bdkmain-x11.c bdk/x11/bdkevents-x11.c 
	bdk/x11/bdkdnd-x11.c: Use bdk_error_trap_push()/pop()
	for all error trapping.

	* bdk/x11/bdkdnd-x11.c: Remove '#if 0' code.

	* bdk/x11/bdkdnd-x11.c (bdk_window_cache_new): Fix
	problem where we would add the results anyways,
	and then add it again if no error occurred, and problem
	where we could leave _bdk_error_warnings() unset.

Wed Jan 16 20:28:38 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkfilesel.c: Fix "deleting" filename by adding
	another boolean parameter to file_selection_populate() -
	whether to clear the entry. Also, never fill in the
	entry when the user clicks on something in the 
	directory list. (#6791, Reported by Jos Dehaes and many,
	many, many others.)

2002-01-16  Havoc Pennington  <hp@redhat.com>

	* btk/btktextview.c (btk_text_view_scroll_pages): update
	cursor_y_pos with clamped delta rather than theoretical delta
	(#68788). Also, if we can't page up/down further then jump 
	to top/bottom of the document.

Wed Jan 16 19:33:41 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkfilesel.c (btk_file_selection_map): Refresh
	the dialog on map. (#52877, inspired by request from
	Murray Cumming)

Wed Jan 16 19:23:04 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkbindings.c (btk_binding_entry_activate): 
	Support "optional" bindings. If a binding signal
	has a boolean return value, and returns FALSE it
	is as if it didn't exist all.

	* btk/btkbindings.c (binding_compose_params): Switch
	over to GValue.

	* btk/btknotebook.[ch]: Make the select_page() and
	change_current_page() signals only take effect when
	the focus is on the tab area so that key presses
	in children pass up to the toplevel correctly.

Wed Jan 16 12:16:37 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkoptionmenu.c (btk_option_menu_size_request): Fix 
	calculation error in the (shouldn't happen) case where
	option_menu->height < child_requisition.height. (Patch
	from Jacob Berkman, #66969)

2002-01-15  Matthias Clasen  <matthiasc@poet.de>

	* btk/btkenums.h (BtkMatchType): Deprecate. (#68183)

	* btk/btkscale.h (btk_scale_value_width): Remove useless 
 	compatibility macro. (#67730) 

Wed Jan 16 10:54:38 2002  Owen Taylor  <otaylor@redhat.com>

	* configure.in: Fix typo in --help output.
	(Arnaud Charlet).

Wed Jan 16 10:18:42 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/stock-icons/Makefile.am (EXTRA_DIST): Add 
	btkstockpixbufs.h.

	* configure.in: Make TIFF, JPEG, PNG loaders mandatory
	unless you configure with --without-libtiff, etc.
	(#54045, Brian Cameron)

2002-01-16  Padraig O'Briain <padraig.obriain@sun.com>

	* btk/btkmenushell.c (btk_real_menu_shell_move_current):
	Avoid unexpected warning message when navigating menu (#68517)

2002-01-15  Jody Goldberg <jody@bunny.org>

	* btk/btklayout.c (btk_layout_realize) : It is possible that a
	BtkLayout may have been scrolled _before_ it was realized.

Tue Jan 15 18:10:24 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkspinbutton.c (btk_spin_button_grab_notify): Stop
	the timer on destroy, or when we are notified that we are
	shadowed by a modal dialog.

	* btk/btkspinbutton.c: Remove explicit btk_grab_add()/remove() -
	not needed any more.

	* btk/btkmain.c (btk_grab_notify): Fix problem where notifications
	weren't sent out for the default grab group.

	* btk/btkmain.c (btk_grab_notify): Fix notification of widgets that
	were getting events because they were part of the previous grab.

Tue Jan 15 12:23:33 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btknotebook.c (btk_notebook_mnemonic_activate_switch_page): 
	focus the activated tab, not the page. (#53612)

	* btk/btknotebook.c (btk_notebook_set_focus_child): Track
	the last focus descendant of the page.

	* btk/btknotebook.c (btk_notebook_real_switch_page): If the focus
	was on the previous page, move it to the last focused widget /
	first element on the new page, if possible, or if not, to the 
	notebook itself. (#68224, reported by Jonathan Blandford)

	* btk/btknotebook.c (focus_tabs_in): Don't focus tabs
	tabs aren't visible. (#65462, Damon Chaplin, fixed based 
	on patch from Anders Carlsson)

2002-01-15            Vitaly Tishkov       <tvv@sparc.spb.su>

        * btk/btkstyle.c
	a misprint in documentation for btk_style_render_icon () is fixed

Mon Jan 14 23:21:47 2002  Tim Janik  <timj@btk.org>

	* btk/btkmenuitem.c (btk_menu_item_map): map event_window after
	mapping child, so we don't loose events.

2002-01-15  Sven Neumann  <sven@gimp.org>

	* btk/btkaccellabel.h
	* btk/btkitemfactory.c: fixed documentation by syncing the parameter
	names used in headers and code.

2002-01-14  jacob berkman  <jacob@ximian.com>

	* btk/btkrc.c (btk_rc_get_im_module_path): close a comment block

Tue Jan 15 01:13:51 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreemodelsort.c: fix a load of open line ends,
	(btk_tree_model_sort_set_model): only free root level if it's
	!NULL

2002-01-14  Matthias Clasen  <matthiasc@poet.de>

	* btk/btkoldeditable.c, btk/btkrc.c, 
	btk/btkstyle.c: Documentation additions.

	* btk/btkmenu.c (btk_menu_set_accel_path),
	btk/btkmenuitem.c (btk_menu_item_set_accel_path), 
	btk/btkwidget.c (btk_widget_add_accelerator): Typo and markup fixes.

	* btk/btkitemfactory.c (btk_item_factory_add_foreign): Document.

	* btk/btkaccelmap.c (btk_accel_map_add_filter): Explain intended use.

Mon Jan 14 17:14:13 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkselection-x11.c (sanitize_utf8): Don't
	mangle sequences of consecutive \n or \r.

Mon Jan 14 17:42:28 2002  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_stop_editing): allow cancel to
	happen.

	* btk/btktreeview.c (install_presize_handler): only install the
	handler if we're realized, #68056

Mon Jan 14 16:35:58 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwindow.c (btk_window_move_resize): Unset 
	initial_pos_set after the first configure request.

2002-01-13  Jody Goldberg <jody@bunny.org>

        * btk/btktexttag.c (get_color_arg) : set_boxed will copy the color
	  and will use a mem_chunk to do it.  Avoid an unnecessary copy, a
	  leak, and confusion.

Sun Jan 13 23:23:22 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwindow.c (btk_window_compute_hints): Fix problem where
	widget->requisition was being used instead of
	btk_widget_get_child_requisition (), causing geometry widgets
	with usizes to misbehave.

2002-01-14  Sven Neumann  <sven@gimp.org>

	* btk/btkrc.c: g_getenv() returns a const string.

2002-01-14  Hasbullah Bin Pit  <sebol@ikhlas.com>

        * configure.in: Added ms at ALL_LINGUAS.
	* po/ms.po: Added Malay Translation.

2002-01-14  Matthias Clasen  <matthiasc@poet.de>

	* btk/btkitemfactory.c: Documentation.

2002-01-13  Sven Neumann  <sven@gimp.org>

	* bdk/bdkwindow.c: documentation cleanups.

Sun Jan 13 01:15:45 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreemodelsort.c: various cleanups,
	(get_child_iter_from_elt): removed,
	(btk_tree_model_sort_elt_get_path): rewritten to be a lot cleaner
	and especially faster,
	(btk_tree_model_convert_iter_to_child_iter): use
	btk_tree_model_sort_elt_get_path

Sat Jan 12 16:57:31 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btktreeview.c (btk_tree_view_real_start_interactive_search):
	revert Owen's change (using a strdupped string as object data), so
	the interactive search works again

2002-01-11  Havoc Pennington  <hp@pobox.com>

	* btk/btklabel.c: put in more links to Bango markup format docs
	(btk_label_set_justify): mention btk_misc_set_alignment

2002-01-12  Tor Lillqvist  <tml@iki.fi>

	Fixes contributed by Archaeopteryx Software: This is a first small
	part of their changes. Will commit more later.
	
	* bdk/win32/*.c: Add some more checks for failed GDI calls. If a
	call fails, don't use bogus values.

	 bdk/win32/bdkcursor-win32.c (_bdk_win32_data_to_wcursor): Plug
	memory leak: g_free() the AND and XOR bitmaps after use.
	(_bdk_cursor_destroy): If we are destroying the current Windows
	cursor, set the Windows cursor to none first.

	* bdk/win32/bdkgc-win32.c (predraw_set_foreground): Delete the old
	brush that was in the DC, like the win32-production branch does.

	* bdk/win32/bdkwindow-win32.c (bdk_window_impl_win32_finalize): If
	the window has a cursor which is the current Windows cursor,
	before destroying it set the current Windows cursor to none.
	(bdk_window_set_cursor): Also here, if destroying the current
	Windows cursor, set the current Windows cursor to none first.
	(bdk_window_get_pointer): Revamp logic.
	
2002-01-10  jacob berkman  <jacob@ximian.com>

	* btk/btkwidget.c (btk_widget_add_events): actually iterate
	through the list rather than infinitely loop

2002-01-08  Matthias Clasen  <matthiasc@poet.de>

	* btk/btkwidget.c (btk_widget_set_style_recurse): Rename to
	reset_rc_styles_recurse(). (#68084)

2002-01-10            Vitaly Tishkov       <tvv@sparc.spb.su>
        * btk/btkimage.c
	* btk/btkimcontext.c
	* btk/btktreemodel.c
	* btk/btktreemodelsort.c
	* btk/btkwindow.c
	fix docs	

Wed Jan  9 20:56:42 2002  Jonathan Blandford  <jrb@redhat.com>

	* bdk/x11/bdkkeys-x11.c (get_xkb): get the types as well as the
	symbols because we need them in MyEnhancedXkbTranslateKeyCode.

2002-01-10  Tor Lillqvist  <tml@iki.fi>

	Apply the same fixes and improvements as to the
	btk-1-3-win32-production branch: Bug fixes and cleanup of
	selection and DND functionality. Still doesn't work as well as the
	win32-production branch, though, but getting closer.

	After this, need to add Archaeopteryx Software's OLE2 DND support.

	* bdk/win32/bdkselection-win32.c (bdk_selection_owner_set,
	bdk_selection_send_notify, generate_selection_notify): Don't use
	SendMessage() to generate events for the same app, instead use
	bdk_event_put().

	* bdk/win32/bdkprivate-win32.h
	* bdk/win32/bdkglobals-win32.c
	* bdk/win32/bdkmain-win32.c
	* bdk/win32/bdkevents-win32.c: Thus, remove declaration, definition,
	initialisation and handling of bdk_selection_notify_msg,
	bdk_selection_request_msg and bdk_selection_clear_msg. 

	* bdk/win32/bdkselection-win32.c (bdk_text_property_to_text_list,
	bdk_free_text_list, bdk_string_to_compound_text,
	bdk_free_compound_text): Implement trivially, witrh a text_list
	always having a single element, and a compound text always
	consisting of just a single (UTF-8!) string. Let's see how well
	this works.

	* bdk/win32/bdkselection-win32.c (bdk_selection_convert): Fix
	non-ASCII paste from the clipboard: Try getting the same formats
	from the Windows clipboard that bdk_property_change() puts there:
	CF_UNICODETEXT, UTF8_STRING or CF_TEXT+CF_LOCALE.

	* bdk/win32/bdkproperty-win32.c (bdk_property_change): When
	storing text on the clipboard, handle non-ASCII text
	correctly. The logic is as follows:

	If we have only ASCII characters, use CF_TEXT.

	Else, if we are on NT, use CF_UNICODETEXT.

	Else (we are on Win9x), if all the characters are present in the
	code page of some installed locale, use CF_TEXT and also set
	CF_LOCALE to that locale.

	Else (still on Win9x) store as RTF. We use a very simple RTF
	string, just the text, no fonts or other crap, with the non-ASCII
	characters as Unicode \uN keywords. Additionally, also store the
	UTF-8 string as such, under the format "UTF8_STRING", so that BDK
	can also paste from the Clipboard what it has copied there. (Thus
	no need to implement any RTF parser.)
	
	(find_common_locale): New function, implements the search for a
	locale for case 3 above.

	* bdk/win32/bdkglobals-win32.c: New global variables
	compound_text, text_uri_list, utf8_string, cf_rtf and
	cf_utf8_string.

	* bdk/win32/bdkim-win32.c (_bdk_ucs2_to_utf8): New function,
	converts from a wchar_t string to UTF-8.
	(_bdk_utf8_to_ucs2): Rename from _bdk_win32_nmbstowchar_ts.
	(_bdk_utf8_to_wcs): Rename from bdk_nmbstowchar_ts.

	* bdk/win32/bdkevents-win32.c (build_keypress_event): Use
	_bdk_ucs2_to_utf8().

	* bdk/win32/bdkselection-win32.c: Remove some unnecessary logging.

	* bdk/win32/bdkdnd-win32.c: Plug memory leaks, the
	bdk_drag_context_ref() was called unnecessarily in a couple of
	places, meaning drag contexts were never freed. The same memory
	leaks seem to be present in bdk/linux-fb/bdkselection-fb.c, BTW.

	(bdk_drop_reply): For WIN32_DROPFILES drops, free the temporarily
	stored file list.

	* bdk/win32/bdkselection-win32.c: Clarify the use of the
	sel_prop_table. Now it is used only for storing the BDK_SELECTION
	"properties".

	The file names dropped with WM_DROPFILES -style DND is stored
	temporarily (between the drop and the target picking them up) in a
	separate place.

	Have a separate hash table to map selection atoms to owner
	windows. This used to be quite mixed up.

	(_bdk_dropfiles_store): New function, to store the dropped file
	list for the drop target to possibly fetch, and clear it
	afterwards, from bdk_drop_reply().

	(bdk_selection_owner_get): Much simplified now.

2002-01-09  jacob berkman  <jacob@ximian.com>

	* btk/btklayout.c (btk_layout_style_set): set the background of
	our bin window also (fixes #58957)

Wed Jan  9 19:10:07 2002  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeselection.c
	(_btk_tree_selection_internal_select_node): Now we test we can
	unselect nodes before selecting new ones.
	(btk_tree_selection_real_select_node): be careful comparing booleans.

Wed Jan  9 21:31:44 2002  Kristian Rietveld  <kris@btk.org>

	* btk/btkliststore.c (btk_list_store_sort): pass NULL to
	btk_tree_model_rows_reordered and not an iter with user_data
	set to NULL (which is an invalid liststore iter, so
	iter_n_children failed, etc)

2002-01-09  Sven Neumann  <sven@gimp.org>

	* tests/prop-editor.c: declared internal functions static.
	
Wed Jan  9 11:13:12 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmenuitem.c (_btk_menu_item_refresh_accel_path): 
	Fix problem with menus without accel groups, such as the
	menus for option menus.

	* btk/btkpaned.c (btk_paned_expose): Only conditionalize
	drawing of handle on whether both children are visible,
	not the drawing of the other child!. (#68325, Diego Gonzalez)

Wed Jan  9 10:20:16 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkdrawable-x11.c bdk/x11/bdkgc-c11.c: Check for
	RENDER before trying to use it... XRenderFindFormat() prints
	warnings if called when extension isn't present.

Wed Jan  9 15:20:40 2002  Tim Janik  <timj@btk.org>

	* btk/btkmenuitem.c (btk_menu_item_parent_set): update the accel
	path upon parent changes.

Wed Jan  9 13:20:14 2002  Tim Janik  <timj@btk.org>

	* btk/btkviewport.c (btk_viewport_size_allocate): small but important
	fix to force vadjustments at size_alocate time from Xavier Ordoquy
	<mcarkan@users.sourceforge.net>.

Wed Jan  9 11:23:39 2002  Tim Janik  <timj@btk.org>

	* btk/btklayout.c (btk_layout_get_property): 
	* btk/btkspinbutton.c (btk_spin_button_get_property): 
	* btk/btktreeview.c (btk_tree_view_get_property): 
	* btk/btkwidget.c (btk_widget_get_property): 
	* btk/btkfontsel.c (btk_font_selection_get_property): 
	* btk/btkrange.c (btk_range_get_property):
	* btk/btkviewport.c (btk_viewport_get_property):
	* btk/btkprogressbar.c (btk_progress_bar_get_property): don't cast a
	possible NULL pointer.

2002-01-08  Mike Kestner  <mkestner@speakeasy.net>

	* btk/btkcelleditable.h : Use G_TYPE_INSTANCE_GET_INTERFACE.
	* btk/btktreednd.h : ditto.
	* btk/btktreemodel.h : ditto.
	* btk/btktreesortable.h : ditto.
	* btk/btkwidget.h : Don't reference incomplete _BdkRectangle type.

2002-01-08  Matthias Clasen  <matthiasc@poet.de>

	* btk/btkplug.c, btk/btksocket.c: Speak of window IDs rather 
	than XIDs in the docs.

	* btk/btkclipboard.c (btk_clipboard_clear): Fix docs.

Tue Jan  8 18:39:23 2002  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreedatalist.c (btk_tree_data_list_compare_func): wow!
	Am I a moron or what 0 < 1 is not equivalent to strcmp ("a", "b")

Tue Jan  8 18:04:01 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btktoolbar.c (btk_toolbar_set_icon_size):
	Handle TOGGLE/RADIOBUTTON as well. (#68201,
	Damon Chaplin.)

	* btk/btktoolbar.c (get_first_child): Fix stupid 
	bug, just introduced.

Tue Jan  8 15:53:28 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkdnd.c (btk_drag_find_widget): Fix coordinate
	translations, once and for all.

	* btk/btktextbuffer.c (paste_from_buffer): Free
	the ClipboardRequest structure. (#66198, HideToshi
	Tajima)

2002-01-08  jacob berkman  <jacob@ximian.com>

	* btk/btklayout.c (btk_layout_move_internal): queue a resize on
	the child rather than the layout. see bug #68263

Tue Jan  8 14:51:19 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkpaned.c (btk_paned_expose): Don't draw
	the handle if we aren't showing both children.
	(#68135, Diego Gonzalez)

Tue Jan  8 14:45:43 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.c (btk_widget_add_events): Fix
	leak of result of btk_container_get_children().

Tue Jan  8 14:42:19 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btktoolbar.c: Fix leaks of results of
	btk_container_get_children(). (#68199, Damon Chaplin)

Tue Jan  8 14:19:43 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkcheckbutton.c (btk_check_button_size_allocate): 
	Fix problem where child->requisition was accessed
	directly instead of calling get_child_requisition()
	(#68199, Damon Chaplin)

2001-01-08  James Henstridge  <james@daa.com.au>

	* btk/btkstyle.c: add trailing */ on doc comment.

Mon Jan  7 22:19:32 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkdrawable-x11.c (draw_with_pixmaps): Fix a
	problem where were the offset into the image was passed
	into convert_to_format() wrong.

	* bdk/x11/bdkdrawable-x11.c (bdk_x11_draw_pixbuf): Call
	bdk_x11_drawable_update_picture_clip () before using
	the picture; allow update_picture_clip() to take a NULL gc
	to mean no clipping.

2002-01-07  Matthias Clasen  <matthiasc@poet.de>

	* btk/btksocket.c (btk_socket_get_id): Doc typo fix. (#68172)

	* btk/btktreemodel.c (btk_tree_path_is_descendant): Fix docs.

	* btk/btktreemodel.c (btk_tree_model_rows_reordered): Document.

	* btk/btkwindow.c (btk_window_remove_accel_group): Fix docs.

	* btk/btkrc.c (btk_rc_get_style_by_paths),
	btk/btkwidget.c (btk_widget_get_toplevel, 
	btk_widget_push_composite_child), btk/btkdialog.c 
	(btk_dialog_new_with_buttons, btk_dialog_run): Keep btk-doc
	from messing up the indentation of inline examples.	

	* btk/btkmain.c, btk/btkrc.c: Consistently call g_getenv() 
	instead of getenv().

	* btk/btktreemodel.c, btk/btkaccelgroup.c, btk/btkclipboard.c,
	btk/btkdnd.c, btk/btkiconfactory.c, btk/btkrc.c,
	btk/btkstyle.c, btk/btkselection.c: Doc fixes.

	* btk/btkaccelmap.c (btk_accel_map_add_filter,
	btk_accel_map_foreach_unfiltered, btk_accel_map_load_scanner):
	Document.

2002-01-07  Anders Carlsson  <andersca@gnu.org>

	* btk/btkcellrendererpixbuf.c (btk_cell_renderer_pixbuf_render): Remove
	unused pixels and rowstride variables.
	(btk_cell_renderer_pixbuf_get_size): Check for non-NULL width.

Mon Jan  7 08:48:23 2002  Tim Janik  <timj@btk.org>

	* btk/btkdnd.c (btk_drag_find_widget): don't forget to offset
	the pointer by x/y_offset into the new window when we found
	the drag destination.

	* btk/btkaccelmap.c (internal_change_entry): fix return code
	for simulation when the entry already contains the required
	accel key and mod.

2002-01-06  Matthias Clasen  <matthiasc@poet.de>
 
	* docs/debugging.txt: Replace BTK_NO_CHECK_CASTS by 
	G_DISABLE_CAST_CHECKS.

	* btk/btkaccelgroup.c (btk_accel_group_from_accel_closure,
	btk_accel_group_query, btk_accel_group_find,
	btk_accel_groups_from_object): Document.

	* btk/btkaccellabel.c (btk_accel_label_set_accel_closure): Document.

2002-01-04  Hans Breuer  <hans@breuer.org>

	* bdk/bdkdraw.c bdk/bdkpixbuf-drawable.c : 
	need to cast image->mem away from void* to avoid 
	'error C2036: 'void *' : unknown size'. Doing pointer 
	arithmetics on void pointers is a GCCism afaik.

	* bdk/bdkpixbuf-render.c : #include "bdkinternals.h" for
	_bdk_draw_pixbuf ()

	* bdk/makefile.msc bdk/win32/makefile.msc 
        bdk/btk/makefile.msc.in : use -FI msvc_recommended_pragmas.h

	* bdk/win32/bdkdrawable-win32.c : use _gkd_win32_copy_to_image
	and take care of image->visual possibly NULL.

	* bdk/win32/bdkimage-win32.c : implement _bdk_image_new_for_depth(),
	_bdk_win32_copy_to_image() and _bdk_windowing_bits_for_depth().
	Again take care of image->visual possibly NULL.

	* bdk/win32/bdkprivate-win32.h : declare _bdk_win32_copy_to_image()

	* bdk/win32/bdkevents-win32.c : use bdk_drawable_get_colormap
	instead of private field access

	* bdk/win32/bdkpixmap-win32.c (bdk_pixmap_new) : adapt
	colormap setting to the bdk-X behaviour

2001-01-04  Matthias Clasen  <matthiasc@poet.de>

 	* btk/btkwidget.c: Documentation additions.

2001-01-04  Matthias Clasen  <matthiasc@poet.de>

	* btk/btkobject.c (btk_object_dispose): Fix a comment.

	* btk/btkwidget.c (btk_widget_set_sensitive): tiny docs change

2002-01-04  Havoc Pennington  <hp@pobox.com>

	* btk/btkwidget.c (btk_widget_set_sensitive): tiny docs change
	
Fri Jan  4 13:05:15 2002  Owen Taylor  <otaylor@redhat.com>

	* btk/btkdnd.c (btk_drag_find_widget): At least
	don't infinite loop if the widget and window heirarchies
	don't correspond.

	* btk/btkdnd.c (btk_drag_find_widget): Handle changes
	in heirarchy in ::drag_motion, ::drag_drop callbacks
	by referencing child widget lists. (Patch from Tim)

	* btk/btkdnd.c (btk_drag_find_widget): Fix a problem
	with widgets where window.x != widget->allocation.x

Fri Jan  4 01:36:48 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkdrawable-x11.c (convert_to_format): Optimize
	a little bit. (More for consistency than because it
	makes much of a difference.)

Thu Jan  3 22:18:15 2002  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkdrawable-x11.c bdk/x11/bdkprivate-x11.h
	(_bdk_x11_have_render): Private function to tell if we have RENDER
	extension.

	* bdk/x11/bdkgc-x11.c (_bdk_x11_gc_get_fg_picture): Return
	None if we don't have RENDER extension.

	* bdk/x11/bdkbango-x11.c (bdk_bango_context_get): Don't
	use Xft unless we have render extension.

	* bdk/x11/bdkdrawable-x11.c (bdk_x11_drawable_get_picture):
	Handle missing render extension.

	* bdk/bdkdraw.c bdk/bdkdrawable.h bdk/bdkpixmap.c bdk/bdkwindow.c
	bdk/bdkinternals.h: Add a private copy_to_image() virtual function
	to the BdkDrawable vtable that extends get_image() to allow
	copying onto existing images.  Make the default implementation of
	get_image() use this so that backends don't have to implement
	both. Add private wrapper _bdk_drawable_copy_to_image().

	* bdk/x11/bdkimage-x11.c bdk/x11/bdkprivate-x11.c
	bdk/x11/bdkdrawable-x11.c (_bdk_x11_copy_to_image): Implement
	copy_to_image() semantics, speed up by using ShmPixmaps and
	XCopyArea when possible, XFlush() after ungrabbing the server,
	generally redo the logic once again.

	* bdk/bdkinternals.h bdk/x11/bdkimage-x11.c
	_bdk_windowing_bits_per_depth(): Function to convert from depth to
	bits-per-pixel. (We assume only one bpp per depth - X requires
	this.)

	* bdk/bdkinternals.h bdk/bdkrgb.c bdk/bdkimage.c: Move the BdkRGB
	scratch image code into a generic _bdk_image_get_scratch() chunk
	of code that we can use other places we need scratch images.

	* bdk/bdkimage.c bdk/x11/bdkimage.c bdk/bdkinternals.h:
	Add _bdk_image_new_for_depth() as the backend 
	to _bdk_image_new() to allowing creating images with
	a depth and no visual.

	* bdk/bdkpixbuf-drawable.c: Fix so that getting 
	parts of images not at 0,0 actually works.

	* bdk/bdkdrawable.h bdk/bdkinternals.h bdk/bdkdraw.c
	bdk/bdkwindow.c bdk/bdkpixmap.c bdk/bdkpixbuf-render.c: 
	 - Add a new BdkDrawableClass vfunc _draw_pixbuf, and 
	  _bdk_draw_pixbuf() [ will be made public later ], to allow 
	  backends to accelerate drawing pixbufs. 
	 - Move the implementation of bdk_pixbuf_render_to_drawable_alpha()
	   to be the default implementation. 
	 - Update docs for bdk_pixbuf_render_to_drawable_alpha(). 
	 - Optimize the default implementation by using 
	   _bdk_image_copy_to_pixmap() and scratch shared images, and
	   special casing the compositing.

	* bdk/x11/bdkdrawable-x11.c: Accelerate _bdk_draw_pixbuf()
	with alpha using the RENDER extension.

        * bdk/bdkpixbuf-drawable.c (bdk_pixbuf_get_from_drawable):
	Optimize by _bdk_image_copy_to_pixmap() and scratch images.

	* tests/testrgb.c: Add test for speed of alpha composition,
	reduce the number of iterations since alpha composition
	can be a bit slow.

	* bdk/x11/bdkimage-x11.c bdk/bdkprivate-x11.h (_bdk_x11_image_get_shm_pixmap): 
	Private function to get a ShmPixmap for an image, if possible.

2002-01-04  Anders Carlsson  <andersca@gnu.org>

	* tests/testtreesort.c: Add my cool list of integers.

Thu Dec 27 18:12:55 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkproperty-x11.c (bdk_property_get): Fix
	problem where retrieved atoms weren't properly returned.

2002-01-03  Anders Carlsson  <andersca@gnu.org>

	* btk/btktextview.c (btk_text_view_key_press_event): When
	tab is pressed and the text view isn't editable, 
	move the focus instead.

	* btk/btkstyle.c (btk_default_draw_focus): Free dash list if
	necessary.

	* btk/btkhsv.c (btk_hsv_get_focus_gc): Free dash list.

	* btk/btkcolorsel.c (get_focus_gc): Free dash list.

	* btk/btkdnd.c (set_icon_stock_pixbuf): Don't unref the mask
	if it's NULL.

	* btk/btktreeview.c: Rename btk_tree_view_queue_draw_node to
	_btk_tree_view_queue_draw_node.
	(btk_tree_view_row_has_child_toggled): Only redraw one node.

	* btk/btktreesortable.c (btk_tree_sortable_set_sort_func): 
	sort_column_id can be 0.

	* btk/btktreeselection.c (btk_tree_selection_real_select_node):
	Only redraw one the node being selected.

	* btk/btktreeprivate.h: Add _btk_tree_view_queue_draw_node.
	
Wed Jan  2 23:09:06 2002  Tim Janik  <timj@btk.org>

	* btk/btkcontainer.c (_btk_container_queue_resize): don't ignore
	realized but visible && !mapped resize containers (which is
	possible with unset CHILD_VISIBLE now).

2002-01-02  jacob berkman  <jacob@ximian.com>

	* btk/Makefile.am (LDFLAGS): automake still doesn't support
	libsomething_la_LDFLAGS, so fix the build again

2002-01-01  Havoc Pennington  <hp@pobox.com>

	* btk/btktextview.c (btk_text_view_expose_event): propagate
	exposes to no window children not in the buffer window.
	(btk_text_view_class_init): add move_focus bindings for Ctrl-Tab
	- is this the right way to do it?
	(btk_text_view_focus): add focus method, just chains up for now, 
	I'm not sure why the BtkContainer implementation doesn't work

	* btk/btktextbtree.c (_btk_text_btree_insert_child_anchor): fill
	in the text line for the child anchor segment

	* tests/testtext.c (do_add_focus_children): add another test
	example (to put focusable buttons into the widget)

2002-01-01  Havoc Pennington  <hp@pobox.com>

	* docs/README.linux-fb: note that this file is obsolete

	* docs/Changes-2.0.txt, docs/Changes-1.2.txt: Add notes to these
	files that they should not be edited and look in the reference 
	manual instead. Probably these files should just be replaced by 
	the note, and their main contents deleted.

	* btk/btktextview.c: docs

	* btk/btktextmark.c: docs

	* btk/btktextchild.c: docs

	* btk/btktextbuffer.c: docs stuff

	* btk/btkclipboard.c (btk_clipboard_get): fool with docs to maybe
	give people more leads in sorting out PRIMARY vs. CLIPBOARD

2002-01-01  Tor Lillqvist  <tml@iki.fi>

	* demos/Makefile.am (test-inline-pixbufs.h): Append EXEEXT to
	../bdk-pixbuf/bdk-pixbuf-csource.

2001-12-31  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkgc-win32.c (predraw_set_foreground): Improved error
	handling.
	(bdk_win32_hdc_get,bdk_win32_hdc_release): Silence gcc -Wall.

	* bdk/win32/bdkimage-win32.c (_bdk_win32_get_image): Silence gcc
	-Wall.  Use BDK_IS_PIXMAP_IMPL_WIN32 instead of BDK_IS_PIXMAP in
	one more place.

	* bdk/win32/bdkinput-win32.c (_bdk_input_other_event): Silence gcc
	-Wall.

	* btk/Makefile.am (libbtk_win32_1_3_la_LDFLAGS): Add -lwsock32.

2002-01-01  Havoc Pennington  <hp@pobox.com>

	* btk/btktextview.c (btk_text_view_get_default_attributes): doc 
	fix
	
2002-01-01  Havoc Pennington  <hp@pobox.com>

	* btk/btktextview.c (changed_handler): Replace call to
	btk_widget_size_request() that expected to actually compute the
	request with a direct use of widget_class->size_request, so we get
	our size request right; fixes remaining part of #63065 reported by
	Matthias Clasen

2001-12-31  Havoc Pennington  <hp@pobox.com>

	* tests/testtext.c (do_insert_and_scroll): remove backward_char
	since we no longer have bogus newline
	(dialog_response_callback): remove another backward_char horkage, 
	reported by Matthias Clasen #63065

2001-12-31  Havoc Pennington  <hp@pobox.com>

	* btk/btktextbtree.c (btk_text_btree_node_view_check_consistency):
	fix an incorrect assertion that the "valid" flag is always correct
	in a node and add explanatory comment. This keeps me from 
	reproducing #59101, but I'm remembering that 59101 was actually 
	about incorrect pixel totals, so I'm not sure 59101 is actually 
	fixed. May just have stopped happening due to some change in 
	how C-k works.

2001-12-31  Havoc Pennington  <hp@pobox.com>

	* btk/btktextview.c (btk_text_view_start_selection_drag): extend
	selection if shift is down, bug #50939
	(btk_text_view_button_press_event): add double/triple click
	selection to the current selection if shift is down

2001-12-31  Havoc Pennington  <hp@pobox.com>

	* btk/btktextiter.c (btk_text_iter_get_visible_line_index): fix 
	to use ensure_byte_offsets not ensure_char_offsets, patch 
	from Padraig O'Briain bug #67356
	
2001-12-30  Havoc Pennington  <hp@pobox.com>

	* btk/btkdialog.h (BtkDialogFlags): fix BtkDialogFlags to have 
	the right values, reported by Jeff Franks

2001-12-30  Matthias Clasen  <matthiasc@poet.de>

	* btk/btkwindow.c, btk/btkimcontextsimple.c: Minor documentation tweaks.

2001-12-28  Matthias Clasen  <matthiasc@poet.de>

	* bdk/x11/bdkproperty-x11.c, bdk/x11/bdkselection-x11.c: 
	Minor documentation tweaks.

2001-12-28  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkfont-win32.c: Use G_N_ELEMENTS().
	(unicode_classify): Don't return -1 on encountering an
	unclassified character, but play it safe and return U_BASIC_LATIN.

Thu Dec 27 16:05:30 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkarrow.c btk/btkimage.c btkpixmap.c: Make interpretation
	of misc->xpad/ypad consistent with BtkLabel. Do 
	directional flipping when interpreting misc->xalign/yalign.
	Fix off-by-one error for negative x,y. (#67472, reported
	by Mathieu Lacage)

Thu Dec 27 15:45:41 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.c (btk_widget_set_style_internal):
	Remove optimization that was causing problems because
	we called btk_widget_size_request() before we called
	btk_widget_queue_resize() so RESIZE_NEEDED was not
	set. Optimization shouldn't mattter now that we
	are smart about needlessly size requesting or allocating
	widgets. (#67598, reported by Jacob Berkman)

Thu Dec 27 15:38:20 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmenu.c (btk_menu_stop_navigating_submenu_cb):
	Call bdk_window_get_pointer() on menu->bin_window not
	menu->window, so we get the correct window for the
	menu item. (#65213, Guillermo S. Romero)

Thu Dec 27 15:13:44 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmenu.c (btk_menu_set_title): Allow unsetting
	the title by setting to NULL. Move docs inline. 
	Update the title if the tearoff window already
	exists. Code cleanup. (Fixes #65190, reported by
	Vitaly Tishkov.)

Thu Dec 27 14:04:22 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btksocket.c (btk_socket_key_press_event): 
	btk/btkplug.c (btk_plug_key_press_event): Don't do
	special handling of key presses unless we are doing 
	iter-app embedding. (Fixes #67590, Anders Carlsson)

Thu Dec 27 16:37:04 2001  Kristian Rietveld  <kris@btk.org>

	* btk/btktreemodelsort.c (btk_tree_model_sort_row_deleted),
	(btk_tree_model_sort_sort_level),
	(btk_tree_model_sort_insert_value): fix a few places where
	I was confused between modelsort iters and other iters. This was
	really going to happen someday ;)

Wed Dec 26 23:41:41 2001  Kristian Rietveld  <kris@btk.org>

	* btk/btktreeview.c (btk_tree_view_rows_reordered): ensure
	we are unprelighted before reordering

	* btk/btktreemodel.c (btk_tree_row_ref_reordered_callback): we
	need to break out of the for loop, not return (this fixed
	the 'selection freeze' bug).

	* btk/btktreemodelsort.c: more fixage and cleanups. It seems to
	be pretty stable now, though it still needs some more code
	cleanups.

Wed Dec 26 12:32:31 2001  Owen Taylor  <otaylor@redhat.com>

	* docs/Changes-2.0.txt: Document the fact that
	btk_paned_set_handle_size() has been removed.

	* btk/btkpaned.h Remove btk_paned_handle_size() compat macro, 
	since it pointed to btk_paned_set_handle_size(), which
	was removed. (#66760, Matt Wilson)

Wed Dec 26 12:28:24 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkdnd.c (btk_drag_highlight): Connect 
	btk_drag_hightlight_expose _after_, so it works with
	widgets that paint there entire background. (#66735)

Wed Dec 26 12:17:06 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkplug.c (btk_plug_size_allocate): Assign the
	allocation to widget->allocation. (Fixes #67290,
	Chris Phelps.)

Wed Dec 26 11:49:01 2001  Owen Taylor  <otaylor@redhat.com>

	(#67542, reported by Anders Carlsson)
	
	* btk/btkstyle.c (btk_style_real_init_from_rc): Merge
	rc_style->font_desc with defaul style instead of replacing
	it.

	* btk/btkrc.c (btk_rc_style_real_merge): Allow partial
	font descriptions in RC styles by calling
	bango_font_description_merge(). 

2001-12-24  James Henstridge  <james@daa.com.au>

	* btk/btkdialog.h (doc comment): s/<!>/<!-- -->/ to make the doc
	valid with both SGML and XML.

Sat Dec 22 12:38:03 2001  Owen Taylor  <otaylor@redhat.com>

	* configure.in: 1.3.12, interface, binary age 0.

	* configure.in: Require new versions of Bunnylib, Bango, BATK.

	* NEWS: Updated.

	* configure.in: Make explicit what libtool we are executing.
	(Tomas Ogren)

	* bdk/bdkcolor.c bdk/bdkgc.c bdk/bdkwindow.c: Doc fixes.

	* btk/btkwidget.c (btk_widget_[class]path) btkrc.h : Fix 
	parameter names for docs.

Sat Dec 22 22:35:29 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwindow.c (btk_window_realize) 
	  btk/btkplug.c (btk_plug_realize): Include BDK_KEY_RELEASE_MASK.

	* btk/btkentry.c (btk_entry_key_release)
	  btk/btktextview.c (btk_text_view_key_release_event): Pass
	key release events to the input method.

	* btk/btkimcontextsimple.c (btk_im_context_simple_filter_keypress): 
	Handle release of Control/Shift to end hex sequence.

	* modules/input/btkimcontextxim.c (btk_im_context_xim_filter_keypress): 
	Handle key releases as well as presses.

2001-12-21  Matthias Clasen  <matthiasc@poet.de>

	* btk/btktoolbar.c (btk_toolbar_insert_element): Trivial doc adjustment.

	* btk/btklabel.c (btk_label_new_with_mnemonic),
	btk/btkbutton.c (btk_button_new_with_mnemonic): More precise
	documentation about underscores and mnemonics. (#66380)

	* btk/btktextiter.c (btk_text_iter_backward_word_starts): Fix
	cyclic reference in docs.

	* btk/btklabel.c (btk_label_set_justify): Correct documentation
	of default value. (#65402)

	* btk/btkmain.c (btk_set_locale, btk_disable_set_locale): 
	Markup fixes.

2001-12-20  Anders Carlsson  <andersca@gnu.org>

	* btk/btktreeview.c (btk_tree_view_realize): Don't call
	map here.

Tue Dec 18 16:15:55 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkgc.h: Explicitely deprecate bdk_gc_set_font()
	(reported by Jeff Franks.)

Tue Dec 18 16:07:28 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkkeys.h (struct _BdkKeymapClass): Fix 
	prototype for direction_changed. (Reported by
	Jeff Franks.)

2001-12-18  Padraig O'Briain <padraig.obriain@sun.com>

	* btk/btktreeview.c (btk_tree_view_get_expander_column):
	Fix typo (list->data becomes list->next)

2001-12-06  Havoc Pennington  <hp@redhat.com>

        Add Unicode control char menu, based on patch from Dov.
	Bug #63495
	
	* btk/btkentry.c (btk_entry_commit_cb): share code via
	btk_entry_enter_text
	(btk_entry_enter_text): function to do "typing in text"
	(popup_targets_received): add the Unicode menu items

	* btk/btktextview.c (popup_targets_received): add missing mnemonic
	on Input Methods item, and add the unicode menu items.

	* btk/btktextutil.h, btk/btktextutil.c: private utilities to be
	used in BtkEntry and BtkTextView - may become public later.	

2001-12-16  Kjartan Maraas  <kmaraas@bunny.org>

	* btk/btkprogressbar.c: Fix a typo.
	* btk/btkpaned.c: Fix a typo.
	
2001-12-15  Darin Adler  <darin@bentspoon.com>

	Fix some warnings.

	* bdk/x11/bdkproperty-x11.c: (bdk_property_get): Fix wrong type in
	g_new -- bug if sizeof (BtkAtom) != sizeof (BtkAtom *).
	* bdk/x11/bdkwindow-x11.c: (create_moveresize_window): FALSE -> NULL
	* btk/btkaccellabel.c: (btk_accel_label_refetch): Remove unused local.
	* btk/btklistitem.c: (btk_list_item_expose): Remove unused local.
	* btk/btktextiter.c: (_btk_text_iter_backward_indexable_segment):
	Restructure loop to get rid of uninitialized variable warning. Also
	gives a tiny efficiency gain.

2001-12-15  Murray Cumming  <murrayc@usa.net>

	* Fixed first arg type of BtkScale's "format_value" signal's
	function pointer.

2001-12-14            Vitaly Tishkov       tvv@sparc.spb.su
        docs/reference/btk/tmpl/btkcelleditable.sgml
                btkcelleditable -> BtkCellEditable
        docs/reference/btk/tmpl/btktreesortable.sgml
                btktreesortable -> BtkTreeSortable

2001-12-13  Sebastian Wilhelmi  <wilhelmi@ira.uka.de>

	* demos/testpixbuf-drawable.c, demos/testpixbuf-save.c,
	demos/testpixbuf-scale.c, demos/testpixbuf.c: Call g_object_ref
	and g_object_unref instead of bdk_pixbuf_ref and bdk_pixbuf_unref
	resp.

Thu Dec 13 22:02:41 2001  Kristian Rietveld   <kris@btk.org>

	* btk/btktreeview.c (validate_visible_area): free path
	at the end

2001-12-13  Matthias Clasen  <matthiasc@poet.de>

	* btk/btkdialog.c, btk/btkrc.c, btk/btkwidget.c: Markup fixes.

Thu Dec 13 20:37:27 2001  Kristian Rietveld  <kris@btk.org>

	* btk/btktreeview.c (btk_tree_view_button_press): do not try
	to find the clicked node in the tree when tree == NULL

2001-12-13  Anders Carlsson  <andersca@gnu.org>

	* btk/btktreeview.c (btk_tree_view_button_press): Compare 
	event->state with the default mod mask. 

2001-12-12  jacob berkman  <jacob@ximian.com>

	* btk/btk*.h (BTK_IS_*_CLASS): s/obj/klass/ where appropriate

Wed Dec 12 17:22:45 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkimmulticontext.c (btk_im_multicontext_set_slave):
	Reset the existing slave before removing it to give
	it a chance to commit and emit "preedit_changed" 
	in case there was still a preedit string.

2001-12-12  Matthias Clasen  <matthiasc@poet.de>
	
	* btk/btktextlayout.c: Typo fixes
	* btk/btkwindow.c (btk_window_set_position): Typo fix. (#66746)

	* btk/btkwidget.c (btk_widget_send_expose, btk_widget_get_toplevel, 
	btk_widget_get_default_direction): Doc fixes. (#66727, #66737, #66744)

	* btk/btkstyle.h (BTK_STYLE_NUM_STYLECOLORS): Remove. (#66467)

Wed Dec 12 16:43:10 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_unrealize): Remove
	validate_rows_timer in unrealize.  Reported by Matthew Wilson.

Wed Dec 12 16:18:26 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmenu.c (btk_menu_realize): Remove support for
	"prepainting" the menu before realizing other than
	via btk_style_set_background() - this was broken when
	we added menu scroll support.

	* btk/btkmenu.c (btk_menu_paint): Pay attention to the
	window in the expose event -- fixes problem with border
	flashing during scrolling.

Wed Dec 12 15:11:49 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btksettings.c (btk_settings_get_property): Support
	using names/nicks for the bdk_settings values for enum valued
	types. (#57678, reported by Anders Carlsson)

Wed Dec 12 15:01:33 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btknotebook.c (btk_notebook_set_tab_label): keep in sync
	with insert_page_menu.  Code duplication is bad.

	* btk/btklabel.c (btk_label_mnemonic_activate): Whoops -- got the
	wrong fix yesterday.

Wed Dec 12 14:27:30 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmenubar.c (window_key_press_handler): Fix check for
	modifiers.

2001-12-12  James Henstridge  <james@daa.com.au>

	* btk/btkmenu.c (btk_menu_key_press): check BTK_MENU_ITEM
	(menu_item)->accel_path first when looking up the accel path.

Tue Dec 11 19:18:21 2001  Owen Taylor  <otaylor@redhat.com>

	* tests/testbtk.c (layout_expose_handler): Only draw
	for events on the bin window.

Tue Dec 11 18:55:16 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btklabel.c (btk_label_mnemonic_activate): Small fix to let
	mnemonics work with notebooks.

Tue Dec 11 15:25:06 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_size_allocate): Change
	bin_window to be located at y=TREE_VIEW_HEADER_HEIGHT(tree_view).
	Makes some flicker while scrolling go away.

2001-12-11  Michael Natterer  <mitch@gimp.org>

	* demos/testpixbuf-save.c: added new keyboard shortcut 'a' which
	adds alpha to the pixbuf; re-load the saved pixbuf and
	pixel-by-pixel compare it with the original one.

Tue Dec 11 15:39:08 2001  Soeren Sandmann  <sandmann@daimi.au.dk>

	* ChangeLog: Fix wrong ChangeLog entry
	* btk/btkstyle.c (btk_default_draw_shadow_gap): Fix drawing of top
	right corner

2001-12-10  jacob berkman  <jacob@ximian.com>

	* bdk/x11/bdkinput-xfree.c (_bdk_input_grab_pointer): 
	* bdk/x11/bdkmain-x11.c (bdk_pointer_grab): 
	(bdk_keyboard_grab): do not grab things if the nograb debug flag
	is set

	* bdk/bdkinternals.h: 
	* bdk/bdk.c: add nograbs debug flag to disable grabs of the
	keyboard / mouse

Mon Dec 10 19:42:29 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (validate_rows_handler): stupid bug where I
	didn't reset the timer.

2001-12-10  Matthias Clasen  <matthiasc@poet.de>

	* btk/btkcontainer.c (btk_container_child_type): Close comment.

2001-12-09  Matthias Clasen  <matthiasc@poet.de>

	* btk/btkviewport.c: Add docs.

Mon Dec 10 16:21:38 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkrbtree.c (_fixup_parity): New function to fixup parity.
	RBTree corruption bug--

2001-12-10  Anders Carlsson  <andersca@gnu.org>

	* btk/btktreeview.c (btk_tree_view_remove_widget): Return
	if edited_column is NULL, also grab focus before removing
	the cell_editable.

Sun Dec 09 15:06:51 2001  George Lebl <jirka@5z.com>

	* btk/btkrange.c (btk_range_calc_layout): check for 0 value on the
	  denominator in the horizontal case just like we do in the vertical
	  case (why I didn't notice that there were two cases the first time
	  around is beyond me:).  Also fix indentation in the vertical case.

2001-12-09  Anders Carlsson  <andersca@gnu.org>

	* bdk/x11/bdkevents-x11.c: Update xsettings name.

	* btk/btkdnd.c (btk_drag_check_threshold): Use the
	btk-dnd-drag-threshold BtkSetting.

	* btk/btksettings.c (btk_settings_class_init): Add 
	setting for dnd drag threshold.

2001-12-09  Matthias Clasen  <matthiasc@poet.de>

	* btk/btkcontainer.c: Add docs.

2001-12-08  Matthias Clasen  <matthiasc@poet.de>

	* btk/btkwidget.c: Doc markup fix. 

	* btk/btktreeviewcolumn.c: Markup fixes. (#66447)

	* btk/btktreestore.c: Typo fixes. (#66445)

	* btk/btkaccelgroup.c: Misc doc markup. (#66425) 

	* btk/btkclipboard.c (btk_clipboard_get_owner): Fix reference
	to btk_clipboard_set_with_owner(). (#66424)
 
Sat Dec  8 16:12:10 2001  Christopher Blizzard  <blizzard@redhat.com>

	* bdk/bdk.c (bdk_init_check): Fallback to setting the prgname to
	"<unknown>" if someone doesn't pass in a valid argc.  (Patch from
	Fabrice Bellet <fabrice@gnu.org>, #54127).

Sat Dec  8 10:04:54 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkrbtree.c (_btk_rbtree_debug_spew): Add debug spew to lots
	of places, so that people with crashy trees can just run their
	program with BTK_DEBUG=TREE.

Sat Dec  8 20:57:24 2001  Kristian Rietveld  <kristian@planet.nl>

	* btk/btkliststore.c (btk_list_store_remove): nuke the stamp++,
	per jrb's request

2001-12-08  Anders Carlsson  <andersca@gnu.org>

	* tests/testbtk.c (layout_expose_handler): Don't return TRUE
	since then the default BtkLayout expose handler won't be called.

Fri Dec  7 23:42:50 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (validate_rows_handler): remove
	g_return_if_fail.

	* btk/btktreeview.c (validate_visible_area): Patch from Manish
	Singh <yosh@gimp.org> to fix bug when rendering Tree with an
	empty model.

Fri Dec  7 20:06:14 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (validate_visible_area): get logic right,
	#66249

	* btk/btkrbtree.c (_btk_rbtree_remove_node): fix bug where
	removing a node ended up with a corrupt tree.  Really really nasty
	bug.
	(_btk_rbtree_debug_spew): new debug helper function
	(_fixup_validation): new inline function to clean up code
	readability a lot. 

Fri Dec  7 19:34:51 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btktoolbar.c (btk_toolbar_insert_element):
	Close comment.

2001-12-07  Matthias Clasen  <matthiasc@poet.de>

	* btk/btkstyle.h: Typo fixes.

	* btk/btkstyle.c, btk/btktoolbar.c: Add docs.

	* btk/btkrc.c (btk_rc_find_pixmap_in_path): Fix docs.

Fri Dec  7 16:05:22 2001  Owen Taylor  <otaylor@redhat.com>

	* modules/input/btkimcontextxim.c: Display the XIM
	status callbacks with a popup window. (Patch from
	HideToshi Tajima, #50628, somewhat modified.)

Fri Dec  7 12:07:15 2001  Tim Janik  <timj@btk.org>

	* btk/Makefile.am: each source generation rule needs to use its own
	temporary file, to avoid clashes for parallel builds. fixed rules
	for btkmarshalers.h and btkmarshalers.c to use their own temp files.

2001-12-07  Havoc Pennington  <hp@pobox.com>

	* bdk/x11/bdkcursor-x11.c (bdk_cursor_new): fix up my list of
	"cursors that are actually useful" in bdk_cursor_new() docs

Thu Dec  6 23:09:21 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btk[hv]paned.c (btk_[hv]paned_size_allocate): Fix errors
	in computing the size of the second child.

Thu Dec  6 16:50:17 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkrange.c: Make button 1 clicks on the trough
	do pages, button 3 steps. (Patch from Hans Breuer
	#63735)

2001-12-06  Matthias Clasen  <matthiasc@poet.de>

	* btk/btklabel.c: Fix docs. (#66383)

	* btk/btkbbox.c (btk_button_box_set_child_secondary): Fix docs. 
     	(#66278, #66280)
	
	* bdk/bdkwindow.h (bdk_window_get_deskrelative_origin),
	bdk/bdkimage.h (bdk_image_get): Deprecate. (#66208)

	* btk/btkcolorsel.c (btk_color_selection_set_update_policy):
	Don't emit a g_warning() about being deprecated. (#66208)	

	* btk/btkaccellabel.c (btk_accel_label_set_accel_widget): Add docs.

	* btk/btkcontainer.c: Doc fixes.
	
	* btk/btkliststore.c (btk_list_store_clear): Add docs; misc doc fixes.

	* btk/btkstyle.c (btk_style_attach): Add docs.

2001-12-05  Sven Neumann  <sven@gimp.org>

	* btk/btkwidget.c (btk_widget_reset_shapes): close comment.

	* btk/queryimmodules.c: g_dir_read_name() returns const.

Tue Dec  4 21:46:13 2001  HideToshi Tajima  <hidetoshi.tajima@sun.com>

	* btk/btktreeprivate.h: restore the else case of #ifdef __GNUC__
	#66225
	
2001-12-04  Manish Singh  <yosh@gimp.org>

	* btk/btkmain.c
	* btk/queryimmodules.c: g_module_symbol takes a gpointer *, not just
        a gpointer.

	* btk/btkwidget.c (btk_widget_push_composite_child): minor cosmetic
	correction to docs.

	* demos/btk-demo/item_factory.c: add BTK_WINDOW() cast

2001-12-04  Havoc Pennington  <hp@redhat.com>

	* btk/btktextbtree.c (btk_text_btree_remove_tag_info): remove
	g_assert_not_reached() that was bogus, since we demand-create the
	tag info. reported by Chris Phelps

        Jump through assorted hoops to fix bug from Chris Phelps where 
	removing tags from the table resulted in btree trying to 
	access tag->table
	
	* btk/btktextbuffer.c: set up mechanics of adding/removing 
	ourselves to the tag table

	* btk/btktexttagtable.c (_btk_text_tag_table_add_buffer) 
	(_btk_text_tag_table_remove_buffer): private cruft to 
	let us notify buffer of disappearing tags

	* btk/btktexttag.h: remove BTreeNode typedef from this public
	header, put it in tagprivate	

	* btk/btktextbtree.c (_btk_text_btree_new): don't connect to
	tag_removed; it's emitted too late.
	(_btk_text_btree_notify_will_remove_tag): rename tag_remove_cb to
	this

	Padding for ABI-compat expansion
	
	* btk/btktexttag.h (struct _BtkTextAttributes): pad this
	(struct _BtkTextAppearance): one pad in here too

	* btk/btktextlayout.h (struct _BtkTextLayoutClass): padding here

	* btk/btktextview.h (struct _BtkTextViewClass): more padding,
	since action signals etc. seem pretty likely

	* btk/btktextbuffer.h (struct _BtkTextBufferClass): padding

	* btk/btktexttag.h (struct _BtkTextTagClass): padding

	* btk/btktexttagtable.h (struct _BtkTextTagTableClass): padding

2001-12-04  Matthias Clasen  <matthiasc@poet.de>

        * bdk/bdkcolor.h (bdk_colormap_change): Deprecate. (#65851)

        * bdk/bdktypes.h (BdkKeyInfo): Remove. (#66025)

	* btk/btkwindow.c, btk/btkwidget.c: Add docs, markup fixes.

Tue Dec  4 18:51:44 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeviewcolumn.h: remove btk_tree_view_column_cell_event,
	#62084.

Tue Dec  4 18:38:35 2001  Jonathan Blandford  <jrb@redhat.com>

	* demos/btk-demo/main.c: (create_tree): Minor fix.

	* docs/tree-column-sizing.txt: Update

	* btk/btkrbtree.[ch]: Massive work to support validation.

	* btk/btktreemodel.c: Doc fixes.

	* btk/btktreeview.c: Incremental reflow added.
	* btk/btktreeviewcolumn.c: ditto
	* btk/btktreeviewcolumn.h: ditto

2001-12-04  Havoc Pennington  <hp@redhat.com>
	
	* btk/btktexttag.c (btk_text_tag_set_property): add a warning for
	"invisible" property, #65999

2001-12-04  Matt Wilson  <msw@redhat.com>

	* btk/btktreestore.c (btk_tree_store_insert): fixed docs

Tue Dec  4 12:16:31 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btksettings.c (btk_settings_set_property_value):
	Simplify, make more efficient and fix memory leak
	when turning quark into a string. (#66103, HideToshi
	Tajima)

	* btk/btkcolorsel.c: Ref and sink priv->tooltips in
	init() and unref priv->tooltips in destroy rather
	than calling btk_object_destroy() which has no
	effect on memory management. (#66104, HideToshi
	Tajima)

	* btk/btkcolorsel.c (palette_set_color): Use g_object_set_data_full()
	so we free the when the object is freed. (Fixes memory
	leak, #66096, HideToshi Tajima)

	* bdk/bdkevents.c (bdk_synthesize_window_state): Use 
	a full BdkEvent structure to avoid reads of uninitialized/
	invalid memory in bdk_event_put() (#65877, patch
	from Hidetoshi Tajima)

Tue Dec  4 11:06:54 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmenuitem.c: Revert my last mistaken change - 
	toggle-size-request doesn't take a requisition.

	* btk/btkmenuitem.c (btk_menu_item_class_init): Fix
	reference to marshaler that no longer exists.

Mon Dec  3 16:39:17 2001  Owen Taylor  <otaylor@redhat.com>

	Patch from Bill Haneman (with many modifications) to make
	the focus color work on dark themes and to make the
	focus line width configurable. (#61079, #63074)

        * btk/btkwidget.c: Add style properties, 
	::focus-widget, ::focus-line-width, and ::focus-padding.

	* btk/btkstyle.[ch]: Make btk_paint_focus() take a 
	state argument as well so we can use fg[STATE] to
	draw instead of always drawing with black. 
	Cange paint_focus() to respect BtkWidget::focus-width
	and BtkWidget::focus-line-pattern. Fix continuity
	problem where the default 1-1 stipple had a blob
	in one corner and a gap in the other. Change the
	interpretation of x/y/width/height to be the bounding
	box of the focus rect instead of the rectangle
	passed to bdk_draw_rectangle.

	* btk/btkcheckbutton.c btk/btklistitem.c btk/btknotebook.c 
	btk/btkoptionmenu.c btk/btkradiobutton.c btk/btkspinbutton.c 
	btk/btktextview.c btk/btktreeview.c: Handle ::focus-width 
	and ::focus-line-padding.

	* btk/btkentry.c: Handle :;focus-width property; cleanup
	and remove duplicated code; fix drawing of focus rectangle
	when interior-focus = FALSE. (#63072, #63073)

	* btk/btkrange.c btk/btktext.c btk/btktreeitem.c
	btk/btktreeviewcolumn.c: Basic fixups to make compile;
	Range and TreeViewColumn will need more extensive fixing.

	* btk/btkcolorsel.c: Honor focus line attributes when
	drawing the focus on the color swatches. (#63071)

	* btk/btkhsv.c: Honor focus line attributes when
	drawing the focus for the ring and triangle.

	* docs/widget_geometry.txt: Start at documenting how 
	various widgets are drawn.

	* btk/btkbutton.c (_btk_button_paint): Export 
	_btk_button_paint() librarywide, so we don't have 
	duplicate a bunch of code in btktogglebutton.c.

	* btk/btktogglebutton.c: Use _btk_button_paint().

Mon Dec  3 21:04:13 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkmarshalers.list: remove VOID:BOXED,POINTER and
	NONE:POINTER.

2001-12-03  Alex Larsson  <alexl@redhat.com>

	* btk/btkaccellabel.c:
	* btk/btkarrow.c:
	* btk/btkcolorsel.c:
	* btk/btkcontainer.c:
	* btk/btklabel.c:
	* btk/btktextview.c:
	* btk/btktogglebutton.c:
	* btk/btktreeview.c:
	* btk/btkwindow.c:
	Return FALSE from expose handlers.

Mon Dec  3 21:15:59 2001  Kristian Rietveld  <kris@btk.org>

	* btk/btktreedatalist.c (_btk_tree_data_list_value_to_node): if
	we use pointers, we should free the previous pointer first (if
	it exists), before we set a new pointer. (#64726)

	* btk/btktreeprivate.h: get rid of cursor_drag

	* btk/btktreeview.c (btk_tree_view_unrealize): remove check	
	for cursor_drag
	(btk_tree_view_bin_expose): don't directly return in the while
	loop
	(btk_tree_view_class_init): indentend expanders by default
	(btk_tree_view_header_focus): only give the button focus
	if it's clickable, visible and the column is reorderable
	(#65539)

	* btk/btktreeviewcolumn.c (_btk_tree_view_column_realize_button):
	create and free cursor

Mon Dec  3 10:23:07 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkcalendar.c (btk_calendar_size_request): Fix
	some bugs with size requisition. (From Bill Haneman)

	* btk/btkcalendar.c: Draw headers and selection in 
	base/text[SELECTED] instead of fg/bg[SELECTED].

	* btk/btkcalendar.c: Miscellaneous cleanups to drawing
	code and formatting.

2001-12-03  Havoc Pennington  <hp@pobox.com>

	* btk/btktextview.c (set_window_height): 
	(set_window_width): Hmm, setter functions normally assign the new
	value to the object field. Reported by Chris Phelps.

2001-11-30  jacob berkman  <jacob@ximian.com>

	* btk/btknotebook.c (btk_notebook_remove_tab_label): set the
	signal id to 0 after we disconnect from it

2001-11-30  Matthias Clasen  <matthiasc@poet.de>

	* bdk/bdkdrawable.h (bdk_drawable_ref, bdk_drawable_unref),
	bdk/bdkcolor.h (bdk_colormap_ref, bdk_colormap_unref),
	bdk/bdkdnd.h (bdk_drag_context_ref, bdk_drag_context_unref),
	bdk/bdkgc.h (bdk_gc_ref, bdk_gc_unref):	 Deprecate.

	* bdk/bdkvisual.h: Use BDK_DISABLE_DEPRECATED, not 
	BTK_DISABLE_DEPRECATED.

	* bdk/bdkcolor.c (bdk_colormap_ref, bdk_colormap_unref),
	bdk/bdkgc.c (bdk_gc_ref, bdk_gc_unref): Document.

Fri Nov 30 16:37:01 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkcombo.c (btk_combo_popup_list): Sanitize
	move/resize code, removing various bad, non-functional
	hacks. (Fixes #65048, reported by Damon Chaplin.)

Fri Nov 30 16:12:21 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkbango.c: Patch from Hidetoshi Tajima to fix 
	bad match error when target drawable is not the 
	same depth as the root window. (#65841)

	* HACKING: Update.

2001-11-29  Matthias Clasen  <matthiasc@poet.de>

	* bdk/bdkwindow.c: Typo fix.

Thu Nov 29 21:35:56 2001  Kristian Rietveld  <kristian@planet.nl>

	* btk/btkmenu.c (btk_menu_motion_notify): add checks for
	empty menu items to behave like insensitive items (#59456)

	* btk/btkmenuitem.c (btk_real_menu_item_activate_item): select
	next item if the first item in the menu is a tear off item
	(#59456-2, suggestion by Matthias Clasen)

	* btk/btkmenushell.c (btk_menu_shell_button_press),
	(btk_menu_shell_button_release), (btk_menu_shell_entry_notify),
	(btk_menu_shell_leave_notify), (btk_real_menu_shell_move_current),
	(btk_real_menu_shell_activate_current): add check, so empty
	menu items behave like insensitive items (#59456)
        
	* btk/btkmenuitem.[ch]: add _btk_menu_item_is_selectable to make
	the checks more readable ...
	
	* btk/btkmenushell.c (btk_menu_shell_button_press),
	(btk_menu_shell_button_release): causes the menu to dropdown if the
	caption is clicked again (#64977)

2001-11-29  Havoc Pennington  <hp@redhat.com>

	* btk/btktextiter.c (_btk_text_iter_forward_indexable_segment):
	assertion here that we were at the end iterator was not correct;
	change code to move us to the end iterator. bug #65731

Wed Nov 28 20:05:44 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkaccellabel.c (btk_accel_label_refetch): Remove 
	improper use of g_locale_to_utf8() to convert from
	latin-1, and do it the easy way by building the string
	correctly in the first place.

Wed Nov 28 19:34:15 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkproperty-x11.c (bdk_property_change, bdk_property_get): 
	Convert atoms to and from atoms for properties of type XA_ATOM.
	(#65555, patch from Hidetoshi Tajima)

Wed Nov 28 18:37:04 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btksocket.[ch] (btk_socket_add_id): Rename 'id' parameter 
	to avoid problems with Objective C.

2001-11-28  Matthias Clasen  <matthiasc@poet.de>
	
	* btk/btkaccelmap.c: Typo fixes. (#65607)

	* btk/btkfixed.c (btk_fixed_set_has_window, btk_fixed_get_has_window):
	Fix docs. (#65505)

	* btk/btkwindow.c (btk_window_set_mnemnonic_modifier): Document.

Wed Nov 28 18:19:12 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmenu.c (btk_menu_set_tearoff_hints): Move
	accounting of menu->tearoff_scrollbar width to here
	and make sure we have the correct requisition.

	* btk/btkmenu.c (btk_menu_position): Fix fixme
	by using btk_window_move().

	* btk/btkmenu.c (btk_menu_set_tearoff_state): Force
	the requisition to be updated by calling
	btk_widget_size_request() (#65440)

	* btk/btktearoffmenuitem.c (btk_tearoff_menu_item_activate): 
	queue resize before calling btk_menu_set_tearoff_state().

Wed Nov 28 22:20:44 2001  Kristian Rietveld  <kristian@planet.nl>

	* demos/btk-demo/editable_cells.c: fix typo

	* demos/btk-demo/list_store.c (add_columns): remove call to
	btk_tree_view_column_set_clickable which didn't make sense

2001-11-28  Havoc Pennington  <hp@redhat.com>

	* btk/btktextview.c (btk_text_view_paint): put the warning
	explaining the validation error in front of the G_BREAKPOINT

	* btk/btkrange.c (btk_range_adjustment_value_changed): call
	process updates with include_children = FALSE instead of TRUE, so
	we redraw the range only, not the whole darn window.  Making
	BtkRange a NO_WINDOW widget had weirdly caused the text widget
	Trace/breakpoint trap bug to become much easier to trigger.

Wed Nov 28 14:12:03 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/Makefile.am (bdk_public_h_sources): Remove reference
	to bdkcursors.h.

2001-11-28  Matthias Clasen  <matthiasc@poet.de>

	* btk/btkwindow.c (btk_window_move): Add markup to docs.

	* bdk/bdkcursor.h: Directly include the contents
	of bdkcursors.h in the BdkCursorType enum.

	* bdk/bdkcursors.h: Deleted.

	* bdk/bdkkeysyms.h: Remove XFree86-specific keysyms, add 
	header boilerplate.

	* bdk/Makefile.am: Remove the X-derived-headers rule.

Tue Nov 27 20:17:55 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkcheckmenuitem.c (btk_check_menu_item_activate):
	Notify on the ::active property _here_, not in
	btk_check_menu_item_set_active.

Mon Nov 26 19:11:18 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkcellrendererpixbuf.c
	(btk_cell_renderer_pixbuf_class_init): add 2 properties
	(PIXBUF_EXPANDER_OPEN and PIXBUF_EXPANDER_CLOSED)

Sun Nov 25 21:19:02 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkgeometry-x11.c: Add long, but horribly sketchy
	comment about what is going on in this file.

	* bdk/x11/bdkgeometry-x11.c (bdk_window_compute_position): Fix 
	x/y problem.

Sun Nov 25 18:59:19 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkoptionmenu.c (btk_option_menu_calc_size): 
	Calculate size based on the _child_ of the menu item,
	not the menuitem. (#65005, Damon Chaplin)

	* btk/btklistitem.c (btk_list_item_new_with_label): Add
	some extra vertical padding to the label widget ... restores
	BTK+-1.2 spacing. (#65085, Damon Chaplin.)

2001-11-26  Tor Lillqvist  <tml@iki.fi>

	* demos/pixbuf-demo.c
	* demos/btk-demo/pixbufs.c: M_PI -> G_PI.

	* demos/btk-demo/main.c (read_line): No flockfile() or
	getc_unlocked() on Win32.

2001-11-25  Tor Lillqvist  <tml@iki.fi>

	* configure.in
	* acconfig.h: As we now use GDir, no need to check for dirent.h.

Sun Nov 25 23:18:39 2001  Kristian Rietveld  <kristian@planet.nl>

	* btk/btktexttag.c (btk_text_tag_set_property): free font_desc
	when finished (#65266)

Sun Nov 25 23:16:29 2001  Kristian Rietveld  <kristian@planet.nl>

	* bdk/x11/bdkwindow-x11.c (bdk_window_set_icon_list): free
	data after we set the property. (#65264)

Sun Nov 25 23:14:06 2001  Kristian Rietveld  <kristian@planet.nl>

	* btk/btkbutton.c: add destroy method so label_text gets freed
	if it has been allocated (#65268)

Sat Nov 24 13:39:51 2001  Manish Singh  <yosh@gimp.org>

	* bdk/linux-fb/bdkdrawable-fb2.c
	* bdk/linux-fb/bdkbango-fb.c: update to latest Bango API

	* bdk/linux-fb/bdkwindow-fb.c: implement bdk_window_show_unraised

	* bdk/linux-fb/bdkfont-fb.c (bdk_font_load): plug memleak on
	set_family
	
	* bdk/linux-fb/bdkfbswitch.c: minor cleanups

Sat Nov 24 22:05:27 2001  Kristian Rietveld  <kristian@planet.nl>

	* btk/btkmenushell.c (btk_menu_shell_button_release): don't
	deactivate menu when menu_item isn't sensitive (#61389)

Sat Nov 24 15:35:26 2001  Kristian Rietveld  <kristian@planet.nl>

	* btk/btktreemodel.c (btk_tree_model_foreach): free path before
	we return (in case of a failure here)

Fri Nov 23 19:22:50 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btknotebook.c: Handle events in windows other
	than widget->event_window properly. (#65079, reported
	by Damon Chaplin)

	* bdk/bdkevents.c (bdk_event_get_coords): Fix x/y bug.

Fri Nov 23 18:57:46 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmessagedialog.c (btk_message_dialog_init): Align
	the image at the top. (#65020, request from Seth Nickell)

Fri Nov 23 18:49:53 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/{btkclist,btkctree.c} (draw_row): Remove some strange
	arithmetic that was resulting in rows being drawn too low.
	(#65001, reported by Damon Chaplin)

Fri Nov 23 18:36:42 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkrange.c (btk_range_button_press): Offset 
	invalidated range correctly.

	* btk/btkclist.c (hadjustment_value_changed): Fix scrolling 
	of title window. (#65001, reported by Damon Chaplin)

	* btk/btkcombo.c (btk_combo_button_event_after): Replace
	horrible hack with use of ::event_after.

Thu Nov 22 15:01:03 2001  Owen Taylor  <otaylor@redhat.com>

	* Version 1.3.11

	* configure.in (BATK_REQUIRED_VERSION): Require
	GLib-1.3.11, Bango-0.22, BATK-0.7.

	* tests/prop-editor.c (property_widget): Restore
	to working as well as it did before.

	* btk/btklistitem.h: Mark deprecated since it is
	an integral part of BtkList.

 	* demos/btk-demo/demo-common.h: New header file,
	for a common functions not important to the meat
	of the demos.
	
	* demos/btk-demo/main.c (demo_ifind_file): Add a utility
	function to search for a file used by the demo.

	* demos/*.c: Use demo_find_file.

2001-11-23  Matthias Clasen  <matthiasc@poet.de>

	* btk/btktextbuffer.c (btk_text_buffer_create_tag),
	btk/btkruler.c (btk_ruler_get_metric): Actually commit typo 
	fixes already mentioned in ChangeLog entry on 2001-11-14.

	* docs/reference/btk/tmpl/drawing.sgml: Minor markup fixes.

2001-11-23  Hans Breuer  <hans@breuer.org>

	* bdk/win32/bdkfont-win32.c (bdk_font_from_description) : 
	reflect Bango API change

	* btk/btk.def : updated externals

	* btk/btkfixed.c (btk_fixed_get_has_window) : use 
	g_return_val_if_fail() to avoid 'function must return a value'

	* btk/btkrc.c : added spaces to fix small coding style issues
	* btk/btkwidget.c : ... and linebreaks. Also a static for
	'static correctness'

	* btk/makefile.msc.in : temporary(?) disable btk<plug|socket>
	because they only can be build on win32 after applying my patch

Wed Nov 21 22:55:37 2001  Tim Janik  <timj@btk.org>

	* btk/btkbutton.c (btk_button_map): raise event window afte
	children, in order for the input pnly window to stay *above*
	children.

Wed Nov 21 22:44:27 2001  Tim Janik  <timj@btk.org>

	* tests/testtreeview.c: make hackery worse ;) by checking fundamental
	type walks againts G_TYPE_FUNDAMENTAL_MAX.
	
	* tests/prop-editor.c: disable type hackery.

Wed Nov 21 17:41:39 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkimage.c (bdk_image_get): Fix problem with
	lost parameter.

Wed Nov 21 17:01:25 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkcellrenderer.h btk/btktreemodel.h 
	btk/btktreeprivate.h btk/btktreesortable.h: Remove
	trailing commas in enum declarations.

Wed Nov 21 15:21:26 2001  Owen Taylor  <otaylor@redhat.com>

	* configure.in (BTK_MICRO_VERSION): Version 1.3.11, 
	interface, binary age 0.

	* NEWS: Updates

	* btk/btktreemodel.c btk/btkrc.c btk/btkentry.c: SGML
	fixes in docs.

	* btk/btkmain.h: Remove unused and misnamespaced
	get_btk_win32_directory() prototype.

	* bdk/bdkimage.c (bdk_image_get): Fix parameter names
	to match header.

	* bdk/bdkwindow.h: Fix parameters to bdk_window_shape_combine_mask(),
	bdk_window_set_transient_for(), bdk_window_set_geometry_hints(),
	to match docs.

	* bdk/bdkevents.c (bdk_event_get_coords)
	  btk/btkcellrenderertoggle.c (btk_cell_renderer_toggle_get_active)
	  btk/btkdnd.c (btk_drag_set_icon_stock):
	Fix parameter names in docs.
	
	* docs/faq/Makefile.am (FAQ_FILES): Add missing files.
	(#64961, Akira Tagoh)

Wed Nov 21 11:41:29 2001  Owen Taylor  <otaylor@redhat.com>

	* tests/testbtk.c (create_tooltips): Ref-sink the tooltips object.

	* btk/btktoolbar.c (btk_toolbar_init): Ref-sink the tooltips object.

	* btk/btkfilesel.c (open_new_dir): Fix some constness warnings.

	* btk/btkaccelgroup.c: Rename btk_accel_groups_from_acceleratable()
	back to btk_accel_groups_from_object(), change @acceleratable
	parameter to btk_accel_groups_activate() accordingly.

	* btk/btkaccelmap.c (btk_accel_map_lookup_entry): Remove
	left-over comment about quark return.

	* btk/btkaccelmap.h: Fix spelling of btk_accel_map_foreach_unfiltered().

 	* btk/btk-boxed.defs (BtkIconSource): added as a boxed type.
        (Patch from Matt Wilson)

	* btk/btkobject.c (btk_object_finalize): Warn if a floating
	object is finalized.

Tue Nov 20 21:25:08 2001  Tim Janik  <timj@btk.org>

	* applied patch from owen to get rid of accel map notifiers.
	changed things to fix reentrancy and API as discussed on btk-devel.

	* btk/btkaccelgroup.[hc]:
	(btk_accel_group_finalize): unregister this accel group from all
	accel map paths.
	(accel_closure_invalidate): handle invalidation of closures by
	disconnecting their accelerators.
	(quick_accel_add): move closure connection and changed notification
	into this function to reduce code duplication. don't emit change
	notification on closurers without accelerators.
	(quick_accel_remove): rewrite, do the exact opposite of quick_accel_add
	for a BtkAccelGroupEntry.
	(btk_accel_group_connect): get rid of the accel_path_quark argument.
	(btk_accel_group_connect_by_path): new function to add accelerators
	with an accel path.
	(btk_accel_group_disconnect_closure): new function, disconnect a
	closure from of an accel group.
	(btk_accel_group_disconnect): loop over all closure for a accel_ley,
	accel_mods pair and remove them.
	(_btk_accel_group_reconnect): new function that basically does
	btk_accel_group_disconnect_closure() and
	btk_accel_group_connect_by_path() once an accel path changed.
	(btk_accel_groups_disconnect_closure): remove this, there's
	btk_accel_group_disconnect_closure().
	
	* btk/btkaccelmap.[hc]: keep list of accel groups per entry now,
	nuke notifiers.
	(_btk_accel_path_is_valid): make this non-static for
	btkwidget.c and btkaccelgroup.c assertions.
	(btk_accel_map_add_notifer): removed this function.
	(btk_accel_map_remove_notifer): same.
	(_btk_accel_map_add_group):
	(_btk_accel_map_remove_group): (un-)register accel groups, with
	accel paths for correct propagation.
	(btk_accel_map_add_entry): return void.
	(btk_accel_map_lookup): return gboolean instead of GQuark.
	
	* btk/btkitemfactory.c (btk_item_factory_add_foreign): always
	set accel_path on widgets.
	
	* btk/btkwidget.[hc]:
	(accel_path_changed): got rid of this, changes are handled by
	accel maps internally now.
	(_btk_widget_set_accel_path): get things to work without notifiers.
	(btk_widget_list_accel_closures): list accel closures of a widget.
	
	* btk/btkwindow.[hc]: rename ::accels_changed, to ::keys_changed.

2001-11-20  Matthias Clasen  <matthiasc@poet.de>

	* btk/btkcontainer.c (btk_container_propagate_expose): Typo fix.

Tue Nov 20 23:01:01 2001  Kristian Rietveld  <kristian@planet.nl>

	* btk/btktreemodel.c (btk_tree_row_reference_unref_path):
	replace gboolean free_last in the function parameters with
	gint depth. Changes to reflect new situation.

	* btk/btktreemodel.c (btk_tree_row_reference_unref_path_helper):
	replace gboolean free_last, with gint depth, add gint current_depth.
	Changes to reflect new situation.

	* btk/btktreemodel.c (btk_tree_row_ref_deleted_callback): changes
	to reflect new situation

	* btk/btktreemodel.c (btk_tree_row_reference_free): ditto

Tue Nov 20 12:37:10 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btknotebook.c (btk_notebook_paint): Fix problem
	where notebook gap was double shifted by allocation.x/y

	* btk/btknotebook.c (btk_notebook_unmap): Chain up
	to unmap children.

Tue Nov 20 14:49:59 2001  Tim Janik  <timj@btk.org>

	* btk/btkvpaned.c (btk_vpaned_size_allocate): fix
	allocation to be relative to paned->allocation, now
	that this is a NO_WINDOW widget.
	* btk/btkhpaned.c (btk_hpaned_size_allocate): same here.

	* btk/btkaccellabel.c (btk_accel_label_class_init): ::closure
	needs to be a boxed property.

Mon Nov 19 17:34:40 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkradiobutton.c (btk_radio_button_draw_indicator):
	Use the widget's state when drawing the indicator, as
	in BtkCheckButton. This gives us color changes for
	un-prelighted checkbuttons. (#63308, Matt Wilson)

Mon Nov 19 17:11:23 2001  Owen Taylor  <otaylor@redhat.com>

	(Fixes related to #64428, Michael Meeks)

	* btk/btkplug.c (btk_plug_set_is_child): Unmap the
	widget, so it gets mapped again properly when we
	add to a parent.

	* btk/btkplug.c (_btk_plug_add_to_socket): Set
	plug->socket_window. 

	* btk/btkplug.c (_btk_plug_remove_from_socket): Set
	socket_window to NULL, not FALSE.

	* btk/btkplug.c (_btk_plug_add_to_socket): Set
	socket->same_app to TRUE. (#64612)

Mon Nov 19 15:50:41 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkfixed.[ch] docs/Changes-2.0.txt: Add 
	btk_fixed_set/get_has_window() to remove criticism
	about BTK_WIDGET_SET_FLAGS() hacks.

2001-11-19  Michael Natterer  <mitch@gimp.org>

	* btk/btknotebook.c: show notebook->event_window with
	bdk_window_show_unraised(), so it doesn't catch the events which
	should go to the tab widgets first.

Mon Nov 19 15:30:51 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeviewcolumn.c (btk_tree_view_column_class_init): Add a
	"resizable" property, to get rid of the
	BTK_TREE_VIEW_COLUMN_RESIZABLE sizing flag.
	(btk_tree_view_column_set_resizable): New function to set resizable.
	(btk_tree_view_column_set_resizable): getter.

	* tests/testtreecolumns.c (add_clicked): modify for above change.

	* Makefile.am (install-data-hook): remove old .pc files before
	installing the new one.  We used to symlink this, and it will
	break old installs.

2001-11-19  Havoc Pennington  <hp@pobox.com>

	* tests/testtext.c (fill_example_buffer): put in a test for
	negative indentation values

Mon Nov 19 14:08:18 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btklabel.c (btk_label_init): Change default for
	justify to BTK_JUSTIFY_LEFT. Assuming that multiline
	labels are most often wrapped labels, this gives better
	compatibility with BTK+-1.2, where justification was
	ignored for wrapped labesl and is a more sensible
	default in any case. (#64489)

	* btk/btklabel.c (btk_label_class_init): Fix default
	for wrap property to FALSE.

2001-11-19  jacob berkman  <jacob@ximian.com>

	* btk/Makefile.am (btk_extra_sources): add btkmarshal.list

Mon Nov 19 13:56:45 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkwindow-x11.c (bdk_window_focus): Use 
	RevertToParent, not RevertToNone. (#64613, 
	Matthias Clasen)

Mon Nov 19 12:28:02 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkframe.c (btk_frame_class_init): label_xalign
	and label_yalign need to be float properties to
	correspond to BTK+-1.2, to btk_frame_set_label_align,
	and to the types of the xalign and yalign properties of BtkMisc.
	(#63484, Vitaly Tishkov)

Mon Nov 19 12:24:30 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btksocket.h (struct _BtkSocketClass): Fix return
	of plug_added vfunc. (#64408, Jeff Franks)

Mon Nov 19 12:07:20 2001  Owen Taylor  <otaylor@redhat.com>

	* configure.in (deps): Undef HAVE_STDLIB_H before
	checking for jpeg, because jconfig.h has this
	in it too (%#$@!). Fix from Matthias Clasen, #64500.

Mon Nov 19 11:30:03 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkproperty-x11.c (get_atom_name): Fix a 
	memory leak when retrieving atom names. (Michael Meeks,
	#64508)

2001-11-18  Alex Larsson  <alexl@redhat.com>

	* bdk/x11/bdkfont-x11.c (bdk_font_from_description):
	Update to new Bango API.
	
Sun Nov 18 19:47:29 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkobject.h docs/Changes-2.0.txt: Rename the
	BTK_DESTROYED flag to BTK_IN_DESTRUCTION, remove the
	BTK_OBJECT_DESTROYED() check macro.

	* btk/btkbindings.c (btk_bindings_activate): Remove
	instances of BTK_OBJECT_DESTROYED() that weren't
	needed any more.

	* btk/btkdialog.c: Exchange use of BTK_OBJECT_DESTROYED
	for a connection to ::destroy.

Sun Nov 18 18:18:11 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkfixed.c: Make a NO_WINDOW widget, as it should
	have been since the beginning, but as special hack,
	allow clearing the NO_WINDOW flag to get a window widget.

Sun Nov 18 22:01:36  Kristian Rietveld  <kristian@planet.nl>

	* btk/btktreestore.c: return TRUE when value changed, so
	row_changed is being emitted

2001-11-18  Hans Breuer  <hans@breuer.org>

	* btk/bdkaccelmap.c : make it compile with msvc: !HAVE_UNISTD_H;
	no label without op, even if it's a no-op.

	* btk/btk.def :
	* btk/makefile.msc.in : reflect marshaler split, some clean-up	

	* config.h.win32.in : remove definition of HAVE_DIRENT_H
	* btk/btkfilesel.c : due to GDir (new in bunnylib) DIR isn't
	required anymore, replace it.
	* btk/queryimmodules.c : DIR -> GDir replacement, also
	getcwd() -> g_get_current_dir()

	* bdk/win32/bdkgeometry-win32.c : adapt to refactored bdkgeometry-x11.c
	Even 'noisy laugh' scolling appears to work, though I still can't
	claim to have fully understood what it is supposed to do ...

Sat Nov 17 21:07:46 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkenums.h: Include bunnylib-object.h instead of
	bobject/gsignal.h

	* bdk/{bdkinternals.h,bdkwindow.c,bdkwindow.[ch],
	  x11,{fb,win32,x11/bdkwindow-*.c}: Add a dummy BdkScreen
	argument to the window_at_pointer() field of
	BdkPointerHooks. (Patch from Erwann Chenede)

	* bdk/bdkdrawable.h (struct _BdkDrawableClass ): Up
	to 6 pointers.

2001-11-17  Matt Wilson  <msw@redhat.com>

	* btk/btkenums.h: must include bunnylib-object.h only

Sat Nov 17 19:26:20 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwindow.c (btk_window_key_press_event): Reprioritize
	key bindings in order of visibility - mnemonics, then 
	accelerators, then send key to the focus widget, then
	bindings on the BtkWindow.

	* btk/btklayout.h docs/Changes-2.0.txt tests/testbtk.c: 
	Removed the xoffset, yoffset fields of BtkLayout which were
	identically zero for compat with 1.2, but were no longer 
	compatible with	all uses of these fields in 1.2.

	* btk/btkwindow.c (btk_window_set_default): Remove 
	unused variable.

Sat Nov 17 19:08:13 2001  Owen Taylor  <otaylor@redhat.com>

	* tests/testtreeview.c (btk_tree_model_types_get_type): 
	We no longer need to create the signals here ... they
	come from the interface.

	* btk/maketypes.awk: Use GType, not BtkType in output.

	* btk/btktypeutils.h: Mark virtually all of this
	file deprecated.

	* btk/btkcontainer.h: Deprecate btk_container_foreach_full;
	the only use of this function is the BtkArg using
	BtkCallbackMarshal, since destroy notification is
	silly here.

Sat Nov 17 18:26:45 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/Makefile.am btk/btkmarshal.list btk/btkmarshalers.list
	btk/*.c btk/btksignal.h: Make btkmarshal.list/btkmarshal.h
	only for compatibility with BTK+-1.2; and deprecate it; 
	put all marshalers we actually use into btkmarshalers.list 
	and use the _btk_marshal_ prefix for these marshalers.

2001-11-17  Murray Cumming  <murrayc@usa.net>

	* btk/btktexttagtable.c (btk_text_tag_table_class_init):
	The first parameters of the signals are now registered as
	BTK_TYPE_TEXT_TAG instead of G_TYPE_OBJECT.
	
2001-11-17  Tor Lillqvist  <tml@iki.fi>

	* btk-zip.sh.in: Build separate runtime and developer
	packages.

	* btk/btk.def: Reflect recent accelerator-related changes.

Fri Nov 16 19:44:35 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwindow.c (btk_window_set_default): Move 
	notification of "has_default" to here, so it
	is safe to call btk_window_set_default() instead
	of btk_widget_grab_default().

	* btk/btkwindow.c (btk_window_set_focus): Make it call
	btk_widget_grab_focus(), which then calls 
	_btk_widget_internal_set_focus(). This makes 
	btk_window_set_focus() a safe way of both setting
	and unsetting the focus widget.

	* btk/btkwidget.c (btk_widget_propagate_state): Use
	btk_widget_get_toplevel(), instead of btk_widget_ancestor
	to find the toplevel.

	* btk/btkwindow.h: Move btk_window_set_focus/default
	from the "internal functions" section.

2001-11-16  jacob berkman  <jacob@ximian.com>

	* tests/testbtk.c (create_radio_buttons): add some no-indicator
	radio buttons

	* btk/btkradiobutton.c (btk_radio_button_init): since we are
	initially active, also initially be depressed
	(btk_radio_button_clicked): also update our depressed state

Thu Nov 15 12:54:36 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwindow.c (btk_window_key_press_event): Propagate
	key press events not just to focus/window but also to
	intermediate widgets.

	* btk/btknotebook.c: Handle Ctrl-PageUp/Ctrl-PageDown
	to switch pages. (Needs some work on handling focus
	when switching pages.)

Fri Nov 16 14:06:31 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btknotebook.c: Fix child allocations to be relative to 
	widget position and some drawing bugs.

	* btk/btkmenuitem.c (btk_menu_item_paint): Fix problem
	with reading uninitialized variable.

Fri Nov 16 00:16:40 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/{btkmenuitem.[ch],btkcheckmenuitem.c,btkimagemenuitem.c,
	btkradiomenuitem.c,btktearoffmenuitem.c}: Make Menu items
	NO_WINDOW widgets.

	* btk/btk{h,v,}paned.[ch]: Make NO_WINDOW widgets, some
	cleanup.

	* btk/btkstyle.c (btk_default_draw_handle): Don't assume
	we are drawing in a window when drawing the paned handle.

2001-11-16  Sven Neumann  <sven@gimp.org>

	* demos/btk-demo/appwindow.c
	* demos/btk-demo/menus.c: reduce compiler warnings

Thu Nov 15 19:47:09 2001  Owen Taylor  <otaylor@redhat.com>

	* demos/btk-demo/main.c (button_press_event_cb): Remove 
	unused callback to make things compile with 
	btk_tree_view_path_at_pos_change().

Thu Nov 15 18:44:33 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreedatalist.c (_btk_tree_data_list_free): maybe fix #64160

2001-11-15  Matthias Clasen  <matthiasc@poet.de>

	* btk/btkwindow.c (btk_window_new): Move '.' out of quote. (#64407)
 
Thu Nov 15 16:24:55 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_get_bin_window): New function
	to get a BdkWindow to compare event->window to.

	* btk/btktreeview.c (btk_tree_view_move_cursor_left_right): emit
	the signal for lateral motion too, #64361

	* btk/btktreeview.c (btk_tree_view_get_path_at_pos): remove window
	arg as it is useless, #64137

Thu Nov 15 16:07:42 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btknotebook.c: Some small drawing fixes for scroll arrows.

Thu Nov 15 14:19:34 2001  Owen Taylor  <otaylor@redhat.com>
 
 	* bdk/bdkwindow.c (bdk_window_invalidate_maybe_recurse): Cal
 	bdk_window_invalidate_maybe_recurse() for recursion.
 	(Soeren Sandmann)

 	* btk/btkviewport.c: Make !redraw_on_allocate. (Soeren Sandmann)
 
	* btk/btkcontainer.c (btk_container_expose): Call
	btk_container_forall() not _foreach() to propagate,
	since we need to propagate exposes to internal children
	as well.

	* btk/btkwidget.c (btk_widget_set_events, btk_widget_add_events): 
	Remove the restriction of only being able to call these
	on window widgets, since we have lots of NO_WINDOW widgets
	with windows now; for add events, recurse over the children
	of widget->window to find one owned by the widget.

	* btk/btkbutton.[ch]: Make a NO_WINDOW widget, using an input-only
	window to catch events.

	* btk/btktogglebutton.[ch]: Remove the code for switching
	between NO_WINDOW and WINDOW widgets based on the mode.

	* btk/btkcheckbutton.c btk/btkoptionmenu.c btk/btkclist.c
	btk/btktreeview.c: Adopt to NO_WINDOW change for BtkButton.

	* btk/btkrange.[ch]: Make into a NO_WINDOW widget.

	* btk/btkhscale.c, btk/btkvscale.c: Adopt to NO_WINDOW
	change for range.

	* btk/btknotebook.[ch]: Make into a NO_WINDOW widget.
 
	* docs/Changes-2.0.txt: Add a note about the NO_WINDOW changes.

Thu Nov 15 11:59:35 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmessagedialog.c: Patch from Murray Cumming to add
	"message_type" and "buttons" CONSTRUCT properties. (#64069)

	* tests/testsocket.c: Expand tests to add a "local passive
	child" (Test case for #64428)

2001-11-14  jacob berkman  <jacob@ximian.com>

	* btk/btkgamma.c (button_clicked_callback): create the label with
	a mnemonic

2001-11-15  Sven Neumann  <sven@gimp.org>

	* tests/testbtk.c: make it compile without warnings.

2001-11-14  Alex Larsson  <alexl@redhat.com>

	* btk/btklabel.c:
	Don't recalculate the layout on each gkt_label_ensure_layout () for
	wrapped labels.

Wed Nov 14 17:40:23 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_get_expander_column): Return
	the currently selected column when we get the column, #64380

	* btk/btkentry.c (btk_cell_editable_key_press_event): Handle Esc
	to cancel CellRendererText editting, #63613

	* btk/btkcellrenderertext.c: ditto

	* btk/btkcellrenderertext.h: formatting changes

2001-11-14  Matthias Clasen  <matthiasc@poet.de>

	* btk/btkbutton.c (btk_button_get_label): Rearrange docs (#64566)

	* btk/btktextbuffer.c (btk_text_buffer_create_tag): Typo fix (#64474)

	* btk/btkruler.c (btk_ruler_get_metric): Typo fix (#64470)

	* btk/btknotebook.c (btk_notebook_prepend_page): Typo fix (#64467)

	* btk/btklabel.c: Documentation fixes (#64452)

2001-11-14  Daniel Egger  <degger@fhm.edu>

	* bdk-pixbuf/io-xpm.c: 
	(xpm_skip_whitespaces): Remove unused static function.
	(xpm_skip_string): Dito.	
	(xpm_extract_color): Declare const variable const to avoid warnings. 

	* btk/btkfixed.c: (btk_fixed_map): Remove unused static function.
	
	* btk/btkplug.c: #if 0'ed prototype for #if 0'ed code.
	
	* btk/btksocket.c: Change type of mask to g_message to %ld for 
	a long.

Wed Nov 14 15:14:48 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkcontainer.c (btk_container_idle_sizer): Back
	out accidental commit of debugging timing code.

2001-11-14  Havoc Pennington  <hp@redhat.com>

	* btk/btktextview.c (btk_text_view_move_cursor): fix Control-E so
	it doesn't move to a new line each time you press it

	* btk/btktextiter.c (btk_text_iter_forward_to_line_end): fix
	return value, #62987

2001-11-14  Havoc Pennington  <hp@redhat.com>

	* tests/testtextbuffer.c (main): bulk of the tests were commented
	out, oops.

	* btk/btktextiter.c (find_paragraph_delimiter_for_line): make this 
	function work, should resolve #63426
	(btk_text_iter_ends_line): return TRUE for the end iterator

	* btk/btktextiter.h: put padding back in BtkTextIter, I thought of
	a couple things that might get cached in here.

Tue Nov 13 21:00:59 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreemodelsort.c (btk_tree_model_sort_class_init): new
	"model" construct property for language bindings.

	* btk/btktreestore.c (btk_tree_store_set_column_types): New
	function to let you set the column types of a BtkTreeStore for
	language bindings.

	* btk/btkliststore.c (btk_list_store_set_column_types): ditto.

2001-11-13  Havoc Pennington  <hp@redhat.com>

	* btk/btktextview.c (btk_text_view_add_child_in_window): docs
	including reference to bugzilla bug about how we should have 
	a better way of positioning children

	* btk/btktextview.h (struct _BtkTextViewClass): add some padding

	* btk/btktextview.c (btk_text_view_size_allocate): assign zero
	size to side rects if they don't exist, #63438

2001-11-13  Havoc Pennington  <hp@redhat.com>

	* btk/btktextview.c (btk_text_view_key_press_event): fix to
	properly replace selection with Return or Tab

	* btk/btktextdisplay.c (btk_text_layout_draw): fix broken code
	that didn't locate the end of the line correctly, should fix #63800

2001-11-13  Havoc Pennington  <hp@redhat.com>

	* btk/btktextview.c (btk_text_view_size_request): add border width
	to requisition, request non-anchored children
	(btk_text_view_size_allocate): handle border width, allocate
	non-anchored children
	(text_view_child_new_window): set the child as object data
	(btk_text_view_move_child): allow children at negative
	coordinates, no reason why not
	(btk_text_view_forall): make it copy the list of children before
	walking it, to avoid reentrancy issues	
	(btk_text_view_move_child): short-circuit if position is unchanged
	(changed_handler): only queue_resize if requisition has changed
	(btk_text_view_init): don't redraw_on_allocate, since we can do 
	a better job of invalidation ourselves

	* tests/testtext.c: add tests for the fixed-position children

Tue Nov 13 19:51:43 2001  Tim Janik  <timj@btk.org>

	* btk/btkwindow.c (handle_accels_changed): protect idle handle
	with bdk threads macro.

Mon Nov 12 23:08:37 2001  Tim Janik  <timj@btk.org>

	* btk/maketypes.awk: fix type utils generation on unix.

	* btk/btkaccelmap.[hc]: new files, implementing a global accelerator
	registry.

	* btk/btkaccelgroup.[hc]: major API/implementation revamp:
	removed BTK_ACCEL_SIGNAL_VISIBLE, btk_accel_group_get_default,
	btk_accel_group_get_entry, btk_accel_group_(un)lock_entry,
	btk_accel_group_add/remove, btk_accel_group_handle_add/remove,
	btk_accel_group_create_add/remove, btk_accel_group_entries_from_object.
	introduced ::accel_changed signal for change notification, and
	btk_accel_group_connect/disconnect to connect closures to accel groups.
	made btk_accel_group_attach/detach and btk_accel_group_activate private
	functions.
	deprecated btk_accel_group_ref/unref.

	* btk/btkaccellabel.[hc]: changes to make accellabels pay attention
	to accel group changed notification and basically operate on closures.
	removed btk_accel_label_get_accel_object and
	btk_accel_label_set_accel_object.
	introduced btk_accel_label_set_accel_closure, and for convenience,
	btk_accel_label_set_accel_widget.

	* btk/btkitemfactory.[hc]: removed accelerator propagation code
	which mostly moved into btkaccelmap.[hc].
	removed btk_item_factory_parse_rc*, btk_item_factory_dump_*
	and btk_item_factory_print_func.

	* btk/btkmain.c: call _btk_accel_map_init().

	* btk/btkmenuitem.[hc]: introduced btk_menu_item_set_accel_path(),
	that associates an accelerator path with menu items, through which
	persistent accelerator settings on menu items are enabled.

	* btk/btkmenu.[hc]: added btk_menu_set_accel_path() so accelerator
	paths of menu item can be default constructed to allow installation
	of accelerators on menu items that don't come with an accelerator
	binding by default.

	* btk/btksettings.c: fix STRING type rc settings by special casing
	them appropriately in the parser.

	* btk/btksignal.[hc]: allow a class function offset of 0 for
	btk_signal_newv().

	* btk/btkwidget.[hc]: accelerator API revamp.
	removed ::accelerator_add/remove signals, btk_widget_accelerator_signal,
	btk_widget_accelerators_locked, btk_widget_remove_accelerators and
	btk_widget_(un)lock_accelerators.
	accelerators maintained through btk_widget_add/remove_accelerator()
	are not runtime changable now, the correct sequence to setup a
	widget for runtime changable accelerators is now:
	  btk_accel_map_add_entry(accel_path, key, mods);
	  _btk_widget_set_accel_path(widget, accel_path, accel_group);

	* btk/btkwindow.[hc]: accelerator changes, proxy and coalesce accel
	group changes (as well as mnemonic changes) through the new signal
	::accels_changed.

Sat Nov 10 12:08:56 2001  Tim Janik  <timj@btk.org>

	* btk/btksettings.c (_btk_settings_parse_convert): properly handle
	GString->string conversions.

Mon Nov 12 19:33:52 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmessagedialog.c (btk_message_dialog_new): Warn
	if BTK_DIALOG_NO_SEPARATOR is passed in and ignore it.

2001-11-12  Matthias Clasen  <matthiasc@poet.de>

	* btk/btktreeview.c: Documentation fixes. (#64377)
	
	* btk/btktreestore.c: Documentation fixes. (#64376)

2001-11-11  Matthias Clasen  <matthiasc@poet.de>

	* btk/btkiconfactory.c, btk/btktextbuffer.c, btk/btktreemodel.c,
	btk/btkwindow.c, btk/btknotebook.c, btk/btkradiobutton.c, 
	btk/btktextiter.c, btk/btkdialog.c: Mass fixing of trivial doc bugs.  
	(#63544, #57007, #64141, #63472, #57108, #60818, #61562)

2001-11-10  Hans Breuer  <hans@breuer.org>

	* bdk/win32/bdkevents-win32.c (bdk_event_translate) : make sure 
	we know what we are talking about when asked for MINMAXINFO.
	Also some cleaning for !HAVE_DIMM_H etc.

2001-11-10  Matthias Clasen  <matthiasc@poet.de>

	* btk/btktreeviewcolumn.c: Fix docs for 
	btk_tree_view_column_set_sort_order. (#62647)
	
	* btk/btkcontainer.c: Fix docs for 
	btk_container_set_border_width. (#64139)

	* btk/btkcolorsel.c: Documentation fixes.

2001-11-10  Hans Breuer  <hans@breuer.org>

	* btk/btkfontsel.c : use g_strcasecmp(), some poor platforms
	don't have strcasecmp()

	* btk/btktextview.c : to fix crashing on e.g. TextView::find need 
	to remove the idle funcs in btk_text_view_destroy (). To reduce 
	code duplication wrap it in its own function and use it in 
	btk_text_view_unrealize () and btk_text_view_destroy_layout ()

	* bdk/win32/bdkdrawable-win32.c : implement the finalize
	method like the X11 version does, allow to set_colormap NULL
	* bdk/win32/bdkwindow-win32.c : adapt BdkWindowImplWin32::
	set_colormap, also some adaption to X11 version :
	(bdk_window_hide) call _bdk_window_clear_update_area
	(bdk_window_reparent) call _bdk_window_init_position

	* bdk/win32/bdkwindow-win32.c (bdk_window_set_geometry_hints) : 
	call bdk_window_resize() after all hints are set, because the
	window resizing process (WM_GETMINMAXINFO) takes all of them into 
	account

	* bdk/win32/bdkfont-win32.c : make bdk_font_equal return a gboolean

	* bdk/win32/bdkvisual-win32.c : register BdkVisual with 
	sizeof (BdkVisualPrivate)

	* bdk/bdk.def btk/btk.def : upated externals

	* bdk/makefile.msc bdk/win32/makefile.msc bdk-pixbuf/makefile.msc
	  bdk-pixbuf/pixops/makefile.msc btk/makefile.msc.in tests/makefile.msc :
	from now on use make.msc from $(TOP)/bunnylib/build/win32

	* btk/stock-icons/makefile.msc : add stock_missing_image

2001-11-08  Tor Lillqvist  <tml@iki.fi>

	* README.win32: Add headers. Add section about ActiveIMM.

	* configure.in: Add --with-ie55 flag to specify the location of
	the "IE55 libs and headers" package downloadable from Microsoft,
	which contains, among other things, the Active IMM header dimm.h
	and UUID library uuid.lib. Use test -f instead of AC_CHECK_FILE.
	Require GLib 1.3.10.
	
	* config.h.win32.in: New version, produced by merging two
	configure-generated ones (for gcc and MSVC). Hopefully #defines
	the same flags that the previous, hand-written one, did.

	* bdk/Makefile.am
	* bdk/win32/Makefile.am: Handle the uuid library from the IE55 lib.

	* bdk/win32/bdkevents-win32.c: Conditionalize ActiveIMM
	stuff. Remove unused BdkIOClosure.

	* bdk/win32/surrogate-dimm.h: Remove, use real dimm.h instead (if
	available).

	* bdk/win32/libie55uuid.la: New file, handwritten libtool wrapper
	for uuid.lib. (Does it really have to be this hard to use an
	existing library with libtool? Probably I am missing something.)

2001-11-08  Darin Adler  <darin@bentspoon.com>

	* btk/btklabel.c: (btk_label_ensure_layout): Fix an obvious
	typo where it says LEFT instead of CENTER.

2001-11-07  Darin Adler  <darin@bentspoon.com>

	* btk/btkdialog.c: (btk_dialog_set_response_sensitive),
	(btk_dialog_set_default_response): Add g_return_if_fail.

Mon Nov  5 22:34:29 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btktreednd.[ch] (struct _BtkTreeDragSourceIface): 
	Add row_draggable() vfunc, and wrapper function.

	* btk/btktreednd.[ch] (struct _BtkTreeDragDestIface): Make
	row_drop_possible take a BtkSelectionData, rather than
	model/row pair.

	* btk/btktreestore.c btk/btkliststore.c: Update for 
	new DND interfaces.

	* btk/btktreeview.[ch]: Remove the row_draggable_func
	location_dropable_func from btk_tree_view_set_rows_drag_source/dest.
	and rename them to enable_model_drag_source/dest.

	* btk/treeviewcolumn.c: Add DND of columns between rows.
	Still can't drop _to_ the left tree, but other places
	work.

	* btk/btktreeview.c (unset_reorderable): Unset the
	reorderable property if unset/enable_model_drag_source/dest
	are called manually.

	* btk/btktreestore.c (btk_tree_store_row_drop_possible): 
	Correct for change in depth count handling.

	* btk/btktreeview.c (btk_tree_view_create_row_drag_icon):
	Pass in a expose area to btk_tree_view_column_cell_render()

2001-11-06  Havoc Pennington  <hp@redhat.com>

	* demos/btk-demo/textview.c (easter_egg_callback): wacky easter egg

Tue Nov  6 10:13:16 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkgc-x11.c: Fix misplaced HAVE_XFT.

2001-11-05  Havoc Pennington  <hp@redhat.com>

	* btk/btktextview.c (btk_text_view_paint): expose the child
	widgets in here
	(btk_text_view_realize): set parent window of child widgets
	(btk_text_view_size_request): use child req to decide whether
	to invalidate layout, not widget->requisition

	* btk/btktextdisplay.c (render_layout_line): set
	shaped_width_pixels for NULL shape objects, so that we properly
	draw the "missing pixbuf/widget" thing
	(render_layout_line): don't draw the widget here
	(btk_text_layout_draw): pass out a list of widgets that need exposing

	* demos/btk-demo/textview.c (insert_text): add demo of child
	widgets

	* btk/btktextlayout.c (add_child_attrs): remove debug spew

	* btk/btktextdisplay.c (render_layout_line): remove debug spew

	* btk/btktextview.c (btk_text_view_update_child_allocation): add
	scroll offsets
	(btk_text_view_value_changed): poke new X and Y into child allocations

2001-11-06  Tor Lillqvist  <tml@iki.fi>

	* btk/btkmain.c (find_module): Do search BTK_BINARY_VERSION
	-specific directory on Windows, too (#63759).

Mon Nov  5 12:46:44 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkdrawable-x11.[ch] bdk/x11/bdkgc-x11.c
	bdk/x11/bdkpixmap-x11.c bdk/x11/bdkprivate-x11.h
	bdk/x11/bdkwindow-x11.c: Redo Xft support to go
	directly to Picture objects instead of using XftDraw.
	This fixes the problem where we weren't able to 
	properly destroy XftDraw objects before destroying
	the accompanying windows, and probably improves
	efficiency a bit too. (#50214)

Mon Nov  5 10:01:49 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkgeometry-x11.c (bdk_window_compute_position): 
	Clamp max window width/height to 32767, not 32768 since
	we have to be able to deal with a dx/y of -32768 without
	getting a width of 65536 when guffaw scrolling.

	* bdk/x11/bdkgeometry-x11.c: Implement bdk_window_scroll()
	for the guffaw scrolling case, fixing some problems with
	copy-area case as well. Fix BadValue bug with moving windows
	by large amounts.

	* bdk/x11/bdkgeometry-x11.c (bdk_window_clip_changed): Update
	clip in window structue before calling bdk_window_invalidate_rebunnyion
	since that trims new invalidations to the window's visible
	rebunnyion.

	* bdk/x11/bdkwindow-x11.c (bdk_window_set_static_gravities): 
	Really set the static window gravity on the children, not
	repeatedly on the window.

	* btk/testbtk.c: Add a torture test for big windows and 
	bdk_window_scroll().

Sun Nov  4 17:36:08 2001  Manish Singh  <yosh@gimp.org>

	* acconfig.h configure.in: sigsetjmp is macroized in some places,
	so use AC_TRY_LINK instead of AC_CHECK_FUNCS for the check.

Sun Nov  4 19:16:23 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkcolor.c (bdk_color_parse): Implement bdk_color_parse()
	in terms of bango_color_parse().

	* bdk/{linux-fb,win32,x11}/bdkcolor-*.c: Remove port-specific
	bdk_color_parse() implementations.

Sun Nov  4 18:39:43 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btksizegroup.c (btk_size_group_set_mode): 
	queue_resize_on_group with both the old and new mode, not
	just the new mode. (#60171, Nicolas Setton). Also, notify
	the "mode" property.
	
Sun Nov  4 16:02:08 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkwindow.[ch]: Add a function bdk_window_invalidate_maybe_recurse() 
	for use in "shallow invalidation" of a widget. (Windows belonging
	to the widget, but not to the widget's children)

        * btk/btkprivate.h btk/btkwidget.c btk/btksizegroup.c: Add private
	flags BTK_ALLOC_NEEDED, BTK_REQUEST_NEEDED.  These flags are set
	up on ancestors up to the resize container on queue_resize. Size
	requests only actually take place if BTK_REQUEST_NEEDED, size
	allocations only take place if BTK_ALLOC_NEEDED or the size
	changed.

        * btk/btkcontainer.c btk/btkwidget.c: Remove
	container->resize_widgets and the RESIZE_NEEDED flag since the
	above flags are sufficient to figure out what needs to be
	resized/reallocated. Remove code manipulating
	container->resize_widget.

        * btk/btkwidget.[ch]: Add btk_widget_set_redraw_on_alloc(); this
	allows widgets to turn off being automatically invalidated is when
	they are resized.

	* btk/btkwidget.[ch] (btk_widget_size_allocate): Invalidation when
	a widget is resized or moved is "shallow" as described above -
	only the windows that need to be invalidated are invalidated.

	* btk/btkbox.c btk/btktable.c btk/btkalignment.c docs/Changes-2.0.txt: 
	Make these widget's init functions call 
	btk_widget_set_redraw_on_allocate(widget,FALSE).

	* btk/btkwindow.c (btk_window_configure_event): Call 
	_btk_container_queue_resize(), since we don't want
	redrawing. (Probably could be done for other 
	calls to btk_widget_queue_resize() in btkwindow.c,
	but this is the most important one.)

	* btk/btkwindow.c (btk_window_move_resize): Don't call
	btk_widget_queue_draw() - size_allocate() handles
	that as appropriate.

	* btk/btkframe.c (btk_frame_size_allocate): Invalidate instead
	of queue_clear() to avoid invalidating children.

2001-11-04  jacob berkman  <jacob@ximian.com>

	* btk/btkmain.c (find_module): don't free the module name until
	after we load the module

Sat Nov  3 13:57:21 2001  Owen Taylor  <otaylor@redhat.com>
 
 	* btk/btkctree.c: Convert BTK_TYPE_CTREE_NODE to pointer
 	derivation instead of boxed derivation.
 
 	* btk/btkmarshal.list: Remove some now unused marshallers.
 
2001-11-04  Tor Lillqvist  <tml@iki.fi>

	* btk/btkimmodule.c: Can't include btkprivate.h (I added the
	include yesterday, without really thinking), as that defeats the
	working of correct_libdir_prefix() (it becomes a no-op.). Add
	comment mentioning that. Thanks to Hans Breuer for noticing.
	
2001-11-03  Daniel Elstner  <daniel.elstner@gmx.net>

	* btk/btkwindow.h (frame_event): Use BtkWindow* as first
	signal argument (was BtkWidget*).

	* btk/btkwindow.c (btk_window_frame_event),
	  btk/btkwindow-decorate.c (btk_decorated_window_frame_event):
	Fixed argument types as above, removed BTK_WINDOW casts and
	added some BTK_WIDGET casts instead.

2001-11-03  Hans Breuer  <hans@breuer.org>

	* btk/btkfilesel.c (btk_file_selection_finalize) : chain
	finalize to parent class to get removed from the toplevel_list.
	Should fix 'random' crashes of #63474.

	* btk/btktreemodelsort.c : chain finalize() to parent class

2001-11-03  Tor Lillqvist  <tml@iki.fi>

	* modules/input/Makefile.am: Use -no-undefined on Windows. Look
	for .dll or .so as appropriate as module suffix.

	* btk-zip.sh.in: Use correct import library names.

	* btk/btk.def: Add a couple of missing entry points. (#63585)

	* btk/btkimmodule.c (correct_libdir_prefix): New function, used on
	Windows to turn build-time paths from a btk.immodules distributed
	as part of a binary package into runtime ones in the
	end-user-chosen installation directory.
	(btk_im_module_init): Use it for module path and domain
	directory.

2001-11-02  Tor Lillqvist  <tml@iki.fi>

	* btk/btkrc.c (btk_rc_make_default_dir): Fix typo: extraneous
	comma.  Include btkprivate.h for BTK_LIBDIR etc definitions on
	Windows.

2001-10-30  Tor Lillqvist  <tml@iki.fi>

	* Makefile (install-data-hook): Use cp, not $(LN_S) on the .pc
	files. Configure on Win32 (running on Cygwin) thinks symlinks
	exist, but pkg-config is not necesarily a Cygwin program, and
	doesn't understand them.

Fri Nov  2 16:45:17 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkrbtree.c (_btk_rbtree_remove_node): Clean up height code
	a bit.  I don't think it's completely correct yet, but it's
	getting there.

Fri Nov  2 16:14:15 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkviewport.c (btk_viewport_size_request): Remove
	random + 5 for width and height. If people want padding,
	they should add padding. (Note the +5 isn't padding
	that will always appear - it just appears in the case
	where the widget is allocated it's requisition.)
	(#51018, Janet Davis)

Fri Nov  2 15:53:23 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkimcontext.h (struct _BtkIMContextClass): Pad
	the structure for future expansion.

Fri Nov  2 15:30:34 2001  Owen Taylor  <otaylor@redhat.com>

	Patch from HideToshi Tajima (#51922)
	
	* btk/btkimmulticontext.c: Proxy set_use_preedit().

	* btk/modules/input/btkimcontextxim.[ch]: Implement
	set_use_preedit().
	
	* btk/modules/input/btkimcontextxim.[ch]: If we have
	to destroy the input context because we change the
	client window or use_preedit, make sure we empty
	the preedit string.

Fri Nov  2 14:55:53 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/{btkcolorseldialog.c,btkfilesel.c,btkfontsel.c,
	btkgamma.c,btkmessagedialog.c}: Go to the GUP
	proposed ordering of buttons with [OK] in the lower
	right hand corner. Patch from Gregory Merchan,
	#56331.

Fri Nov  2 11:51:49 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btklabel.c (btk_label_select_rebunnyion_index): remove
	extraneous btk_label_clear_layout (label)

2001-11-02  Sebastian Wilhelmi  <wilhelmi@ira.uka.de>

	* tests/makefile.msc, btk/makefile.msc.in: Removed
	-DBTK_DISABLE_COMPAT_H.

	* docs/Changes-2.0.txt:
	s/BDK_DISABLE_COMPAT_H/BDK_DISABLE_DEPRECATED/

	* btk/btkcompat.h.in, bdk/bdkcompat.h: Removed from CVS.

Fri Nov  2 10:21:03 2001  Owen Taylor  <otaylor@redhat.com>

	* examples/**/Makefile.am: Convert to use pkg-config
	rather than btk-config. (#53375, Skip Montanaro)

2001-11-02  Matt Wilson  <msw@redhat.com>

	* btk/btkdialog.c (find_child_by_response_id): remove totally
	broken unused, non-compiling, static function.

Fri Nov  2 08:17:06 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkdialog.c (btk_dialog_set_response_sensitive): 
	Iterate through children of the action area, not of
	the vbox. (#58278, Sergey Kuzminov)

2001-11-01  Havoc Pennington  <hp@pobox.com>

	* btk/btktext.c (btk_text_set_position): handle -1 argument in
	order to remove a workaround in Nautilus that forced
	BTK_ENABLE_BROKEN

	* btk/btkwidget.c (btk_widget_modify_style): fix typos in the docs

Thu Nov  1 20:09:31 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkrange.c: Patch from George Lebl to 
	fix division by zero for full scroll bars. (#62114)

Thu Nov  1 19:56:40 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmain.c (btk_main_do_event): ref/unref
	around btk_widget_event() if we are going to
	set a flag afterwards. (#63464)

Thu Nov  1 19:44:48 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkiconfactory.c btk/stock-icons/Makefile.am: 
	Actually add the missing/broken image icon as the
	image for the "missing image" stock icon.

Thu Nov  1 19:18:34 2001  Owen Taylor  <otaylor@redhat.com>

	* demos/btk-demo/stock_browser.c (do_stock_browser): 
	Set a reasonable default height for the window.

	* demos/btk-demo/stock_browser.c (id_to_macro): Fix
	bug where subsequent '-' weren't converted to '_'.
	(#59550, Matthias Clasen)

	* demos/btk-demo/appwindow.c (menu_items): Don't right 
	justify the Help menu - just include a comment on
	how to do it. (#63539, 	Marius Andreiana)

	* btk/btkiconfactory.c (btk_icon_set_get_sizes): Don't 
	list BTK_ICON_SIZE_INVALID.

	* demos/btk-demo/stock_browser.c: Show the biggest available
	size, not a fixed size. (Often reported, including #63539, 
	Marius Andreiana)

Thu Nov  1 19:11:35 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkrbtree.c (btk_rbtree_reorder_fixup): Fix reorder_fixup,
	#59583

	* btk/btktreeselection.c (btk_tree_selection_set_mode): fix
	warning.

Thu Nov  1 16:54:00 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btktypeutils.h: Make BtkFunction return boolean, not gint.
	(Daniel Elstner).

Thu Nov  1 16:20:56 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkimcontext.[ch]: Add:
	  - A ::retrieve_surrounding signal that asks the widget for
	    context around the insertion point.
	  - A ::delete_surrounding signal that asks the widget to 
	    delete context aroudn the insertion point.
	  - btk_im_context_set_context() for widgets to set context
	    around the insertion point in response to ::retrieve_context.
	  - btk_im_context_get_context() for context to get context
	    around the insertion point

	* btkmarshal.list: Add BOOL:INT,INT

	* btk/btkimmulticontext.c: Proxy the get_surrounding() /
	set_surrounding() methods, and the ::retrieve_surrounding /
	::delete_surrounding signals.

	* btk/btkentry.c btk/btktreeview.c: Hook up to the
	BtkIMContext::retrieve_surrounding / ::delete_surrounding
	signals.

Thu Nov  1 15:45:04 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreemodelsort.c (btk_tree_model_sort_rows_reordered):
	it's amazing how well things work sometimes, even when they're
	completely wrong.

	* btk/btktreeview.c (btk_tree_view_real_collapse_row): Fix bug
	where you could try to collapse a node w/o it having children.

	(btk_tree_view_class_init): remove Shift L<->R as they already
	existed for expand/collapse.

Thu Nov  1 12:21:31 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_focus_to_cursor): Fix crash
	found by Matt Wilson.

Thu Nov  1 00:44:50 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_class_init): Support Shift,
	Control, and Shift|Control L<->R, #63475

Wed Oct 31 18:53:51 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreemodel.c (btk_tree_row_ref_deleted_callback): fix
	infinite loop noticed by yosh.

2001-11-01  Michael Meeks  <michael@ximian.com>

	* btk/btksocket.c (btk_socket_unrealize): unset the
	BTK_REALIZED flag so we don't re-enter when we are
	destroyed from the plug side.

Wed Oct 31 18:23:47 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkoptionmenu.c (btk_option_menu_detacher): 
	Add a "menu" property and notify on it. (#62798,
	Padraig O'Briain)

	* btk/btkselection.[ch] btk/{btkentry.c, btkfilesel.c,
	btkoldeditable.c, btktextbuffer.c, btktextview.c}: 
	Fix set_text to take a gchar, not a guchar, and to have 
	a len argument.

Wed Oct 31 15:31:13 2001  Manish Singh  <yosh@gimp.org>

	* btk/btkstock.c: fix typo to make it compile

Wed Oct 31 17:27:20 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkcellrenderertext.c (btk_cell_renderer_text_render): if
	the widget is insensitive, draw the text insensitively, #63306

2001-10-31  Matthias Clasen  <matthiasc@poet.de>

	* btk/btkstock.c: Add stock items for most stock icons. (#61757)

Wed Oct 31 16:53:48 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreednd.c (btk_tree_set_row_drag_data): rename
	btk_selection_data_set_tree_row, #60218
	(btk_tree_get_row_drag_data): rename
	btk_selection_data_get_tree_row, #60218

	* btk/btktreemodel.c (btk_tree_row_ref_deleted_callback): Actually
	get this right, after the third try, #63122.

2001-10-31  jacob berkman  <jacob@ximian.com>

	* bdk/bdkselection.h (BDK_TARGET_STRING): 
	(BDK_SELECTION_TYPE_STRING): these should be 31, not 3.  Hooray
	for Xatoms (and not using the XA_* macros)!

Wed Oct 31 15:38:14 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwindow.[ch] (btk_window_get_focus): Add a
	btk_window_get_focus() getter to determine the currently
	focused widget within the window. (#63145, request
	from Damian Ivereigh)

Wed Oct 31 14:45:08 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkenums.h (enum): Add BTK_SELECTION_NONE enum, #61695

	* btk/btktreeselection.c (btk_tree_selection_set_mode): Handle new
	BTK_SELECTION_NONE enum.
	(_btk_tree_selection_internal_select_node): ditto

	* btk/btkcellrenderer.h (struct _BtkCellRendererClass): add
	constness.

	* btk/btkcellrenderertoggle.c: more yummy constness.

	* btk/btkclist.c (btk_clist_set_selection_mode): g_return_if_fail
	if mode == BTK_SELECTION_NONE

Wed Oct 31 14:05:17 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_class_init): Added a
	"cursor_changed" signal, #62850.

2001-10-31  Matt Wilson  <msw@redhat.com>

	* btk/btktreedatalist.c (_btk_tree_data_list_alloc): after
	allocating the treedatalist, zero it to make sure the values are
	cleared from any garbage that was in this chunk.

2001-10-31  Murray Cumming  <murrayc@usa.net>

	* btk/cellrenderertext.h: "edited" default signal handler
	gchar* args are now const.
	btk/cellrenderertoggle.h: "toggled" default signal handler
	gchar* arg is now const.
	Also changed other signal handlers for "edited" and "toggled" to
	have the same signature.

Tue Oct 30 19:17:57 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreemodelsort.c (btk_tree_model_sort_sort_level): massize
	rewrite.  Static models now totally work.  I'm not 100% sure about
	row_inserted and row_changed, but I'll get those later.

2001-10-30  Sven Neumann  <sven@gimp.org>

	* configure.in: use BUNNYLIB_AC_DIVERT_BEFORE_HELP() so we get proper
	output for configure --help.

2001-10-30  Havoc Pennington  <hp@pobox.com>

	* btk/btktextview.c (changed_handler): Update the IM spot location
	here, if text was invalidated in the visible area, because the
	scroll offset doesn't normally change in that case, and the mark
	isn't set, just implicitly moved over as text is added/removed
	
Mon Oct 29 19:18:35 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkseparatormenuitem.c: Code cleanup.
	(btk_separator_menu_item_class_init): Fix bugs in this code.

2001-10-29  jacob berkman  <jacob@ximian.com>

	* bdk/Makefile.am (LDFLAGS): 
	* btk/Makefile.am (LDFLAGS): automake doesn't support conditionalized
	LDFLAGS, so put win32 flags in here

Mon Oct 29 15:41:58 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreemodelsort.c (btk_tree_model_sort_sort_level): Darn.
	I can't believe this took this long to fix.

Mon Oct 29 13:54:49 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreemodelsort.c (btk_tree_model_sort_rows_reordered): fix
	reordered signal.

Mon Oct 29 12:27:51 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkfilesel.c (btk_file_selection_rename_file): Grab
	the focus to the fileop entry for create dir / rename
	file. (#62838)

Mon Oct 29 12:21:49 2001  Owen Taylor  <otaylor@redhat.com>

	* configure.in: Don't use AC_CHECK_FILE to check for a 
	file since it always spits warnings about cross compilation,
	use -f instead. It's not like we cross compile properly
	anyways.

	* configure.in (btktargetlib): Move call to AC_PROG_CC
	to suppress autoconf warning.

	* acconfig.h: Add some missing #undefs from recent
	Win32 additions.

Mon Oct 29 11:31:40 2001  Owen Taylor  <otaylor@redhat.com>

	* m4macros/btk-2.0.m4: Don't try to use pkg-config
	when we didn't find it. (#62944, Eric Lemings)

	* m4macros/btk-2.0.m4: Fix problem with spaces around =
	sign in assignment. (#63209, Arkadiusz Miskiewicz)

2001-10-29  Anders Carlsson  <andersca@gnu.org>

	* btk/btktreeview.c (btk_tree_view_size_request): Calculate
	the buttons size request before using it. Fixes #61696.

2001-10-29  Tor Lillqvist  <tml@iki.fi>

	* README.win32: Updates.

	* btk-zip.sh.in: New file, used to build distribution package for
	Windows.

	* bdk/bdkglobals.c: Mark bdk_threads_mutex for DLL export when
	applicable with BDKVAR.

	* bdk/win32/libwntab32x.la: New file, hand-written wrapper for the
	Wintab library.

	* bdk/win32/bdkwin32.h
	* bdk/win32/bdkprivate-win32.h: Reorganise to match corresponding
	X11 headers better, and to enable bdkwin32.h to be installed and
	included from applications, but not the *-win32.h headers.

	* bdk/win32/*.c: Corresponding small changes, simplifications of
	#includes.
	
	* bdk/win32/bdkrebunnyion-win32.c: Remove.

	* bdk/win32/bdkevents-win32.c (print_event): Add BDK_SETTING.

	* bdk/win32/bdkfont-win32.c
	* bdk/win32/bdkgeometry-win32.c: Remove unused variables.

	* bdk/win32/bdkproperty-win32.c (bdk_atom_intern): Don't insert
	BDK_NONE values into hash table.

	* btk/btk.def: Update.

	* btk/btkfilesel.c: Include <winsock.h> (if available) for
	gethostname().

	* btk/btkmain.c 
	* btk/btkrc.c: (Win32) Save actual DLL name for later use in DLL
	entry function. Avoid hardcoded paths BTK_LIBDIR, BTK_SYSCONFDIR,
	BTK_DATA_PREFIX and BTK_LOCALEDIR, instead add functions that call
	g_win32_get_package_installation_subdirectory() with the actual
	DLL name saved above. Redefine above directory name macros to call
	these functions. Remove some ifdefs.

	* btk/maketypes.awk: Output BTKTYPEBUILTINS_VAR (that marks
	variable for export on Win32) also to the _vars file.

	Changes for autoconfiscated build on Win32, and addition of Win32
	backend to the related files:
	
	* configure.in: Like in GLib, set LT_CURRENT_MINUS_AGE for use
	when forming DLL name in some files. Set MS_LIB_AVAILABLE is
	lib.exe is available. Call AC_LIBTOOL_WIN32_DLL. Set
	PLATFORM_WIN32, OS_WIN32 and USE_WIN32 automake conditionals. Add
	win32 target, using bangowin32. Don't use the
	-export-symbols-regex option on Win32, we use .def files to list
	exported symbols. Check <winsock.h> (for gethostname() in
	btkfilesel.c). Enclose nested AC_CHECK_* macros in brackets to
	prevent premature m4 expansion.

	* acconfig.h: Add HAVE_WINTAB.

	* bdk/Makefile.am: Add libbdk-win32-1.3.la target and associated
	macros and rules. Use -no-undefined on Win32. Use bdk.def file. If
	MS_LIB_AVAILABLE, build MS import library. Install the import
	libraries. If HAVE_WINTAB, link with the Wintab library.

	* bdk/win32/Makefile.am: Actually enable building the win32
	objects here, not just list all files in EXTRA_DIST. Link in the
	compiled resource file from rc/bdk-win32res.lo. If HAVE_WINTAB,
	copy the Wintab library into the .libs directory. 

	* bdk/win32/bdkwindow-win32.c (RegisterBdkClass): Don't assume the
	name of the BDK DLL when fetching the icon. Use the HMODULE saved
	in bdk_dll_hinstance by DllMain.

	* bdk/win32/rc/Makefile.am: Build bdk-win32res.lo using the
	build/win32/lt-compile-resource script.

	* bdk/win32/rc/bdk.rc.in
	* btk/btk-win32.rc.in: Use the DLL name that libtool would use.

	* btk/Makefile.am: Add libbtk-win32-1.3.la target and associated
	macros and rules. Use -no-undefined on Win32. Use btk-win32.def
	file. Install import libraries.

2001-10-29  Anders Carlsson  <andersca@gnu.org>

	* btk/btkiconfactory.c (get_default_icons): Fix build.

2001-10-28  Hans Breuer  <hans@breuer.org>

	* bdk/bdk.c bdk/bdkevents.c
	  bdk/win32/bdkcolor-win32.c bdk/win32/bdkdnd-win32.c
	  bdk/win32/bdkdrawable-win32.c bdk/win32/bdkevents-win32.c
	  bdk/win32/bdkfont-win32.c bdk/win32/bdkgc-win32.c
	  bdk/win32/bdkim-win32.c bdk/win32/bdkmain-win32.c
	  bdk/win32/bdkprivate-win32.h bdk/win32/bdkproperty-win32.c
	  bdk/win32/bdkselection-win32.c bdk/win32/bdkwin32.h
	  bdk/win32/bdkwindow-win32.c bdk/win32/bdkwindow-win32.h :
	static correct-ness, underscore prefixing of library internal 
	functions
	(applied the undisputed and the win32 part. Of the latter 
	 I'm probably the one who will change it back again, if Owen
	 decides that the Bdk*Impl types should not be private to Bdk)

	* bdk/bdk.def : added the remaining exported functions

2001-10-28  Matthias Clasen  <matthiasc@poet.de>

	* btk/btkcellrenderertoggle.c, btk/btkimcontextsimple.c,
	btk/btkimmulticontext.c, btk/btkimagemenuitem.c,
	btk/btkiconfactory.c, btk/btkwindow.c: Documentation updates.

2001-10-28  jacob berkman  <jacob@ximian.com>

	* btk/btkcolorsel.c (btk_color_selection_class_init): do not call
	btk_settings_get_default() here as that requires an X connection
	(which breaks doc building with no X connection) and is not
	multihead safe
	(btk_color_selection_init): delay palette loading until realize
	time
	(btk_color_selection_realize): load the palette, and initialize
	the global palette if it hasn't been already

	* btk/btkpreview.c (btk_preview_class_init): don't initialize the
	visual/cmap fields of klass->info since they are gone
	(btk_preview_get_visual): just return bdk_rgb_get_visual ()
	(btk_preview_get_cmap): just return bdk_rgb_get_colormap ()
	(btk_preview_realize): don't set VISUAL and COLORMAP attributes

	* btk/btkpreview.h (struct _BtkPreviewInfo): remove visual and
	cmap fields
	(btk_preview_get_visual):
	(btk_preview_get_cmap): mark as deprecated

	* docs/Changes-2.0.txt: add a little note about the BtkPreviewInfo
	changes

Sun Oct 28 09:15:39 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkimcontext.h (struct _BtkIMContext): Fixed
	structure to have GObject not BtkObject as
	parent_instance. (Jeff Franks.)

2001-10-27  Matthias Clasen  <matthiasc@poet.de>

	* bdk/x11/bdkinput.c: Typo fix.

2001-10-26  Havoc Pennington  <hp@pobox.com>

	* btk/btktextview.c (btk_text_view_mark_set_handler): Call
	update_im_spot_location here explicitly
	(btk_text_view_reset_im_context): don't update the spot location
	here

2001-10-27  Anders Carlsson  <andersca@gnu.org>

	* btk/btktreemodel.c (btk_tree_model_get): Fix typo in docs.
	This fixes #62942.

	* btk/btkspinbutton.c (btk_spin_button_new_with_range): 
	Clarify that we're returning a spin button in the _new function.
	This fixes #54097.
	
Fri Oct 26 20:55:57 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkbutton.c: Revert changes to BTK_RUN_LAST. 
	Unfortunately, people apparently erroneously connect
	to ::clicked for BtkToggleButton and expect
	they know what happened in the default signal handler
	instead of appropriately connecting to notification
	signal ::toggled. When the revolution comes, such
	people will be first against the wall.

	We'll just have to go back to the old less-reliable
	set-it-back hacks for handling model-view check
	buttons and radio buttons. :-(. 

2001-10-27  Hans Breuer  <hans@breuer.org>

	* btk/btkbbox.c btk/btkctree.c btk/btkhbbox.c
	  btk/btkimmulticontext.c btk/btklabel.c btk/btkliststore.c
	  btk/btkmenu.c btk/btkpaned.c btk/btkrc.c btk/btkscale.c
	  btk/btkstyle.c btk/btktextbuffer.c btk/btktextlayout.c
	  btk/btktexttag.c btk/btktexttagtable.c btk/btktextview.c
	  btk/btktreestore.c btk/btkvbbox.c : 
	to simplify parsing for exported functions:
	- made implementation signature static, when the local 
	  prototype already was
	- put the functions return value on it's own line
	- added as space between the function name and the 
	  opening bracket

	* btk/btk.def : added the remaining exported functions

2001-10-27  Anders Carlsson  <andersca@gnu.org>

	* btk/btktreeviewcolumn.c (btk_tree_view_column_set_fixed_width): 
	Add note about width having to be greater than 0. This fixes
	#55574. 

	* btk/btktextiter.c (btk_text_iter_backward_sentence_start): 
	Fix docs to say previous instead of next.
	(btk_text_iter_backward_word_start): Likewise.
	This fixes bug #62980.

	* btk/btkcontainer.c (btk_container_set_border_width): Mention
	that the valid width is in range 0-65535 pixels. Fixes bug 
	#56754.

	* btk/btksizegroup.c (btk_size_group_set_mode): Remove
	a dot in the documentation. Fixes bug #62632.

	* bdk/x11/bdkmain-x11.c: Replace int and guint with
	long and gulong in some places to make the code 64-bit
	clean.
	(_bdk_windowing_init_check): Replace gint with gulong.
	This patch was made by George Lebl and fixes bug #62113.

	* tests/testbtk.c (create_range_controls): Don't set a 
	fixed height on the hscale widget. This fixes "bug" 
	#55840.
	(create_window_states): Set up destroy signals so that
	all windows will be destroyed when one is. This fixes 
	bug #58133.

2001-10-26  Anders Carlsson  <andersca@gnu.org>

	* btk/btktreeview.c: 
	(btk_tree_view_class_init): Create new "indent_expander"
	style property.

	(btk_tree_view_get_arrow_xrange): Add a tree argument
	to the function since the xrange can change depending
	on where in the tree we are. 
	
	(coords_are_over_arrow): Update function call to
	btk_tree_view_get_arrow_xrange.
	(btk_tree_view_draw_arrow): Likewise.
	
	(btk_tree_view_real_expand_collapse_cursor_row):
	Call real_{expand|collapse}_row, so that we'll have an
	animation.

Fri Oct 26 20:13:36 2001  Kristian Rietveld  <kristian@planet.nl>

	* tests/Makefile.am: fixed a small typo

Fri Oct 26 18:27:11 2001  Kristian Rietveld  <kristian@planet.nl>

	* demos/btk-demo/list_store.c (create_model): Anders
	Carlsson suggested to use G_N_ELEMENTS here

2001-10-26  Sven Neumann  <sven@gimp.org>

	* btk/btkbutton.[ch]
	* btk/btkdnd.c: fixed inline comments
	
	* btk/btkgamma.c: btk_entry_get_text() returns a const gchar.

2001-10-26  Hans Breuer  <hans@breuer.org>

	* bdk-pixbuf/bdk_pixbuf.def : 
	* bdk/bdk.def : 
	* btk/btk.def : updated externals

	* bdk/win32/bdkpixmap-win32.c : removed duplicate of
	bdk_window_lookup implementation. It already was in
	bdk/win32/bdkwindow-win32.c

	* bdk/win32/bdkproperty-win32.c : made it compile again
	after BdkAtom API change

	* btk/btk/makefile.msc.in : updated

Wed Oct 24 11:36:33 2001  Owen Taylor  <otaylor@redhat.com>

	* configure.in (BTK_MICRO_VERSION): Version 1.3.10,
	require GLib 1.3.10.

	* NEWS: updates.

Thu Oct 25 16:27:29 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkrbtree.c (_btk_rbnode_rotate_left): Add support for
	invalid nodes.
	 (_btk_rbnode_rotate_right): Ditto.
	 (_btk_rbtree_node_mark_invalid): New function.
	 (_btk_rbtree_node_mark_valid): New function.

	* btk/btktreemodelsort.c (btk_tree_model_sort_class_init): We're a
	GObject, not a BtkObject.
	(btk_tree_model_sort_row_has_child_toggled): Rewrote to be more
	correct.
	(btk_tree_model_sort_row_deleted): ditto.
	(btk_tree_model_sort_{un,}ref_node): Fix.

	* btk/btktreeview.c: Protean incremental reflow support (commented
	out)

	* btk/btktreeview.h (BtkTreeViewSearchEqualFunc): change char *key
	to const char *key.

	* btk/btktreemodel.c (btk_tree_row_reference_unref_path_helper):
	Important 1 line fix to fix a lot of refcounting woes.

2001-10-25  Matt Wilson  <msw@redhat.com>

	* btk/btktextview.c (btk_text_view_destroy): call
	btk_text_view_destroy_layout after btk_text_view_set_buffer (which
	now invalidates) so that we remove our idle functions.
	(btk_text_view_destroy_layout): remove the first_validate_idle as
	well.

	* btk/btktexttag.c (btk_text_tag_class_init): the valid range for
	the 'indent' property is G_MININT to G_MAXINT.  Don't use
	-G_MAXINT for the minimum of the 'rise' property, use G_MININT
	instead.

2001-10-24  Anders Carlsson  <andersca@gnu.org>

	* btk/btktreeview.c: 
	(btk_tree_view_real_expand_row): add an animate argument
	(btk_tree_view_real_collapse_row): likewise
	
	(btk_tree_view_button_press), (btk_tree_view_button_release), 
	(btk_tree_view_collapse_all), (btk_tree_view_expand_row),
	(btk_tree_view_collapse_row): update functions that call
	real_{expand|collapse}_row to set the animate argument 
	accordingly.
	
2001-10-24  Alex Larsson  <alexl@redhat.com>

	* bdk/linux-fb/bdkfont-fb.c:
	Update to new Bango APIs

	* bdk/linux-fb/bdkproperty-fb.c:
	Update to new BdkAtom APIs

	* bdk/linux-fb/bdkwindow-fb.c:
	Remove warnings

Mon Oct 22 20:07:21 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreestore.c (btk_tree_store_prepend): Fix docs, #62808

Wed Oct 24 22:54:07 2001  Kristian Rietveld  <kristian@planet.nl>

	* btk/btktreemodelsort.c (btk_tree_model_sort_row_inserted): treat
	s_path as a child path

Wed Oct 24 20:29:47 2001  Kristian Rietveld  <kristian@planet.nl>

	* btk/btktreemodelsort.c: more changes in an attempt to get
	it right. It's not yet ready for general consumption.

	* tests/treestoretest.c: add a button and entry for the new
	iter_change function
	(iter_change): new function, to test
	the row_changed signal implementation of the BtkTreeModelSort

	* tests/testtreesort.c: cleanups, changes to test more features
	of the BtkTreeModelSort at once

2001-10-24  Havoc Pennington  <hp@redhat.com>

	* btk/btktextbuffer.c (clipboard_clipboard_buffer_received):
	remove hack to strip off the bogus newline, since we killed the
	bogus newline; fixes #61779

2001-10-24  Havoc Pennington  <hp@redhat.com>

	* btk/btktextview.c (btk_text_view_update_adjustments): don't
	create layout if we didn't have one
	(btk_text_view_set_buffer): invalidate so we get the idle handlers
	as appropriate, avoids blanking the screen 
	(btk_text_view_invalidate): new function to do invalidation,
	containing old guts of invalidated_handler

Wed Oct 24 10:29:47 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkalignment.c (btk_alignment_class_init): Improve
	dreadful tooltips.

Tue Oct 23 17:31:42 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkwindow-x11.c bdk/win32/bdkwindow-win32.c: Always 
	set window->parent (except or the root window itself); if 
	the window's parent is not a BdkWindow, or is a window of 
	type BDK_WINDOW_FOREIGN, set window->parent to the root parent.

	* bdk/bdkwindow.c (bdk_window_get_toplevels): Don't include
	windows of type BDK_WINDOW_FOREIGN.

2001-10-24  Havoc Pennington  <hp@pobox.com>

	* btk/btktextiter.c (btk_text_iter_backward_chars): if we move to
	the front of a segment, use the "slow" technique for moving
	backward, so we don't mess up the any_segment field in the iter. 
	Fixes #57707

	* tests/testtextbuffer.c: add code to detect #57707, to avoid
	regression

2001-10-23  Havoc Pennington  <hp@redhat.com>

	* btk/btktextview.c (popup_targets_received): only sensitize Cut
	if selection contains some editable text, #60975
	(btk_text_view_scroll_to_iter): remove warning about scrolling
	prior to map; it should actually be OK to do so in many cases, 
	it would be nice to warn about scrolling when many lines have
	height 0, but I don't know what to do about that. Perhaps 
	move part of flush_scroll into this function? comment added 
	to consider this.

2001-10-23  Havoc Pennington  <hp@redhat.com>

	* btk/btktextview.c (changed_handler): Correctly keep the same
	text on the top of the screen, considering that the changed rebunnyion
	may have overlapped the first paragraph. Should fix msw's "text
	widget scrolled to wrong place on map" bug, and probably some
	other scrolling cases as well.
	(btk_text_view_set_scroll_adjustments): start adjustments at 0.0, 
	instead of some random value

	* btk/btktextview.c (btk_text_view_class_init): actually override
	grab_focus, so #59708 is really fixed

2001-10-24  Anders Carlsson  <andersca@gnu.org>

	* btk/btkentry.c: (append_action_signal): Use an image menu item here
	(popup_targets_received): Call append_action_signal with stock items
	
	* btk/btklabel.c: (append_action_signal): Use an image menu item here
	(btk_label_do_popup): Call append_action_signal with stock items
	
	* btk/btktextview.c: (append_action_signal): Use an image menu item here
	(popup_targets_received): Call append_action_signal with stock items

2001-10-23  Havoc Pennington  <hp@redhat.com>

	* btk/btktextview.c (changed_handler): queue a resize here; will
	temporarily slow down the widget a lot, until we figure out how to
	optimize to avoid full redraw everytime we queue a resize.

2001-10-23  Havoc Pennington  <hp@redhat.com>

	* btk/btktextiter.c (test_log_attrs): handle case where offset ==
	0 and char_len == 0, bug #61729

2001-10-23  Havoc Pennington  <hp@redhat.com>

	* btk/btktextiter.c (btk_text_iter_forward_cursor_positions): fix
	return value, #61714 (Vitaly Tishkov)
	(btk_text_iter_backward_sentence_starts): ditto
	(btk_text_iter_backward_word_starts): ditto
	(btk_text_iter_forward_word_ends): ditto
	(btk_text_iter_forward_sentence_ends): ditto
	(btk_text_iter_backward_cursor_positions): ditto

2001-10-23  Havoc Pennington  <hp@redhat.com>

	* btk/btktextlayout.c (btk_text_layout_get_iter_at_pixel): Apply
	fix from Dov Grobgeld, #61858

2001-10-23  Havoc Pennington  <hp@redhat.com>

	* btk/btktextview.c (btk_text_view_update_im_spot_location): 
	Update IM spot location at appropriate times, #50626
        (Hidetoshi Tajima)

2001-10-23  Havoc Pennington  <hp@redhat.com>

	* btk/btktextview.c (btk_text_view_grab_focus): scroll to cursor
	on grab focus, unless it's caused by button click, #59708

Tue Oct 23 11:53:00 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/Makefile.am (INCLUDES): Remove G_DISABLE_CONST_RETURNS.

	* btk/btkfontsel.[ch]: Make btk_font_selection_get_font()
	G_CONST_RETURN. (Murray Cumming)	

	* btk/btkfontsel.c (btk_font_selection_dialog_get_preview_text):
	Make G_CONST_RETURN.

	* btk/btkfilesel.c (open_user_dir): Fix bug with freeing
	results of g_get_home_dir().

	* btk/btkfilesel.c: Make filesel->fileop_file a duplicated 
	copy. Storing the return from btk_entry_get_text() is evil.

	* btk/btkcombo.c btk/btkcellrenderertext.c btk/btkbindings.c 
	btk/btkfilesel.c btk/btkfontsel.c btk/btkimmodule.c 
	btk/btkobject.c btk/btkoldeditable.c btk/btktreedatalist.c
	btk/btksignal.c: Add const.

	* bdk/x11/bdkkeys-x11.c (get_direction): Add missing const.

	* btk/btktreeview.c: Namespace object data keys to be safe, even 
	if we are setting them on private widgets.

	* btk/btktreeview.c (btk_tree_view_real_start_interactive_search): 
	Duplicate entry->text before setting it as object data.

2001-10-22  Havoc Pennington  <hp@redhat.com>

	* btk/btktextbuffer.c (btk_text_buffer_place_cursor): don't back
	up a char from the end iterator, fixes #61859 ("can't put cursor
	at the end of the buffer")

	* btk/btktextiter.c (btk_text_iter_forward_to_line_end): fix this
	to work with delimiters other than newline.

	* tests/testtextbuffer.c: add some tests for get_chars_in_line,
	get_bytes_in_line

	* btk/btktextiter.c (btk_text_iter_get_chars_in_line): fix for the
	last line, since the newline is no longer counted.
	(btk_text_iter_get_bytes_in_line): ditto

2001-10-22  Havoc Pennington  <hp@redhat.com>

	* btk/btktextbtree.c (_btk_text_btree_insert): add assertion that 
	#58290 would trigger if it reappeared, I think

2001-10-22  Havoc Pennington  <hp@redhat.com>

	* btk/btktextiter.c (_btk_text_iter_forward_indexable_segment):
	add temporary code to dump btree contents on assertion failure
	described in #62656
	
	* btk/btktextbtree.c (ensure_end_iter_segment): add some
	assertions that we're getting the right end iter segment

	* btk/btktextiter.c (_btk_text_iter_forward_indexable_segment):
	verify that we aren't on the end iterator after moving 
	forward one segment - fixes return value in an obscure case. 
	Also, some trivial code cleanup/rearranging.
	
2001-10-22  Havoc Pennington  <hp@redhat.com>

	* btk/btktextlayout.h: add a #error unless you define
	BTK_TEXT_USE_INTERNAL_UNSUPPORTED_API, so people don't use this accidentally

        * btk/btktext*.c: #define BTK_TEXT_USE_INTERNAL_UNSUPPORTED_API as appropriate.
	
2001-10-22  Havoc Pennington  <hp@redhat.com>

	* btk/btktextview.c (btk_text_view_get_border_window_size): fix 
	#62365

2001-10-22  Havoc Pennington  <hp@redhat.com>

	* btk/btktextview.c (btk_text_view_get_window_type): fix 
	#62436

2001-10-22  Havoc Pennington  <hp@redhat.com>

	* btk/btktextview.c (btk_text_view_set_border_window_size): Fix 
	#62366

Mon Oct 22 11:47:47 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btklabel.c: Add cursor-position, selection-bound 
	properties. (#62148, reported by Padraig O'Briain)

	* btk/btkentry.c (btk_entry_class_init): Rename text_position
	to cursor_position. (1.3.x addition, text_position is an awful
	name.) Make cursor_position read-only to avoid sticky questions
	of interaction with selection_bound. (#62636, reported by
	Padraig O'Briain)

Mon Oct 22 16:25:12 2001  Owen Taylor  <otaylor@redhat.com>

	Fixing popup menus to have "Paste" sensitized correctly. Original
	patches from Damian Ivereigh, much mangled.

	* btk/btkselection.c: Add functions btk_selection_data_get_targets(),
	btk_selection_data_targets_include_text(). (#60854)

	* btk/btkclipboard.c: Add a simple do-it-all non-async "check if
	the clipboard has text" function btk_clipboard_wait_is_text_available.
	(#60854)

	* btk/btkentry.c: Only enable the paste item if the clipboard
	contains text. (#60973)

	* btk/btktextview.c: Only enable the paste item if the clipboard
	contains text. (#60975)

2001-10-22  Havoc Pennington  <hp@redhat.com>

	* btk/btktextview.c (btk_text_view_class_init): rip out
	"height_lines" and "width_columns" properties, it doesn't make
	sense to set the size request on a text view really. #62103

Mon Oct 22 15:17:05 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreestore.c (btk_tree_store_iter_depth): Realized
	g_node_depth is broken, and that it's not worth being consistent
	with it.

2001-10-22  Havoc Pennington  <hp@redhat.com>

	* btk/btktextiter.c (btk_text_iter_set_line): Clarify behavior in
	docs, #61777
	(btk_text_iter_forward_search) (btk_text_iter_backward_search):
	change the two boolean args to a flags field, so we can extend 
	to add case insensitive, regexp searches later. #61852

Mon Oct 22 15:07:17 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreestore.c (btk_tree_store_iter_depth): update docs to
	reflect reality, #62810

Mon Oct 22 14:08:26 2001  Jonathan Blandford  <jrb@redhat.com>

	* demos/btk-demo/appwindow.c: Remove handle_box from App demo.

	* btk/btktreeview.c (size_allocate): Move to a different drawing
	system.  Instead of having a window the size of the tree, we have
	a window the size of widget->allocation, and simply draw with the
	offset.
	(coords_are_over_arrow): ditto.  Move to window coordinates.
	(do_prelight): ditto
	(do_unprelight): ditto

	* btk/btktreemodelsort.c (btk_tree_model_sort_rows_reordered):
	Minor fix from Kristian Rietveld to fix unsorted case.

2001-10-22  jacob berkman  <jacob@ximian.com>

	* btk/btkclist.c (cell_size_request): don't cast a PIXTEXT cell to
	a PIXMAP cell (fixes crash when using PIXTEXT cells)

Sat Oct 20 18:58:25 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkentry.h: Deprecate btk_entry_set_editable.
	(#58768, Vitaly Tishkov)
	
	* btk/btkobject.h: Deprecate with abandon. 
	(#61942, Vitaly Tishkov, Matthias Clasen)

	* btk/btksignal.h: Deprecate everything.

	* btk/btkmain.h (BTK_PRIORITY_INTERNAL): Deprecate
	all BTK_PRIORITY_* defines other than GKT_PRIORITY_RESIZE>
	(#61942, Matthias Clasen)

	* btk/btkstyle.h: Deprecate btk_draw_*. (#61140,
	Havoc Pennington)

	* btk/btkitemfactory.h: Deprecate compat functions
	for BtkMenuFactory code. (#62071)

	* bdk/bdkdrawable.h: Deprecate bdk_draw_string,
	bdk_draw_text,bdk_draw_text_wc. (#62071)

Mon Oct 22 10:12:08 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdk.c docs/Changes-2.0.txt (bdk_threads_init): Don't call
	g_thread_init(), we don't want to link to -lbthread if we don't
	have to.

Mon Oct 22 08:51:02 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdk.[ch] (bdk_threads_init) docs/Changes-2.0.txt: 
	Add a function, bdk_threads_init() that must be explicitely 
	called to enable the BDK thread mutex.

2001-10-22  Jakub Steiner <jimmac@ximian.com>

	* btk/stock-icons/stock_stop.png: no body parts
	
Sun Oct 21 23:27:00 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.c (btk_widget_translate_coordinates): Fix
	problem with g_return_if_fail return value.

 	* bdk/x11/bdkproperty-x11.c docs/Changes-2.0.txt: Move over the 
	virtual atom code from the bdk-multihead branch, removing the per-display
	part. Virtualizing atoms needs to be done now to prevent compat
	breakage in direct Xlib accessing code in the future. (#62208)
 
 	* bdk/x11/bdkx.h: bdk/bdk/x11/bdkproperty-x11.c: Export
 	bdk_x11_xatom_to_atom, bdk_x11_atom_to_xatom().
 
	* bdk/bdktypes.h docs/Changes-2.0.txt: Make BdkAtom
	an opaque pointer type so the compiler catches attempts
	to mingle it with X atoms.

	* bdk/x11/{bdkdnd-x11.c,bdkevents-x11.c,bdkglobals-x11.c,
	  bdkkeys-x11.c, bdkmain-x11.c, bdkprivate-x11.c, 
	  bdkproperty-x11.c, bdkselection-x11.c, bdkwindow-x11.c}
	  btk/{btkclist.c,btkctree.c,btkdnd.c,btkplug.c,btksocket.c}
	  tests/testdnd.c,tests/testselection.c: 
	Fix up for above atom changes.

	* bdk/bdkselection.h (BDK_SELECTION_CLIPBOARD): Add, since we
	now have the ability to add custom predefines.

	* btk/{btkentry.c,btklabel.c,btkoldeditable.c,btktextview.c}:
	Use BDK_SELECTION_CLIPBOARD instead of BDK_NONE in calls
	to btk_clipboard_get().

	* bdk/win32/bdkproperty-win32.c: Add CLIPBOARD, fix up
	for BdkAtom => pointer change.

	* bdk/linux-fb/bdkproperty-fb.c: Fix handling of predefined
	atoms, fix for BdkAtom => pointer change.

Mon Oct 22 00:26:46 2001  Kristian Rietveld  <kristian@planet.nl>

	* btk/btkspinbutton.c: remove ARROW_SIZE constant, use
	new function spin_button_get_arrow_size() instead.

	* btk/btkstyle.c (btk_default_draw_arrow): actual size of
	arrow was hardcoded, it's now variable.

	Fixes bug #50200

Sat Oct 20 18:16:04 2001  Manish Singh  <yosh@gimp.org>

	* btk/btktreeview.c (btk_treeview_get_property): PROP_MODEL and
	PROP_EXPANDER_COLUMN can be NULL, so don't do a object cast check
	for those

Sat Oct 20 19:38:16 2001  Owen Taylor  <otaylor@redhat.com>

	* demos/*.c demos/bdk-pixbuf/*.c: Eliminate btk_signal_*
	in favor of g_signal_*, btk_object_* in favor of 
	g_object_*.

Fri Oct 19 18:35:22 2001  Manish Singh  <yosh@gimp.org>

	* btk/{btkentry.c,btktextview.c}: since BtkIMContext derives directly
	from GObject now, we have to use the g_object_* functions, not
	btk_object_*.

Fri Oct 19 22:46:54 2001  Kristian Rietveld  <kristian@planet.nl>

	* btk/btktreemodelsort.[ch]: we probably have rows_reordered
	nailed down now (this code is not yet ready for general consumption)

Fri Oct 19 13:44:51 2001  Manish Singh  <yosh@gimp.org>

	* btk/btktreeview.c (btk_treeview_scroll_to_cell): correct docs
	for use_align

Fri Oct 19 15:34:06 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btk.h btk/Makefile.am: Export BtkIMContextSimple publically. (#61862)

Fri Oct 19 15:08:30 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/{btkimcontext.c,btkimcontextsimple.c,btkimmulticontext.c}
	modules/input/{btkimcontextxim.c,imcyrillic-translit.c,iminuktitut.c,
	imipa.c,imthai-broken.c,imviqr.c}: Make BtkIMContext derive from
	GObject, not BtkObject. (#62621)

Fri Oct 19 12:49:12 2001  Owen Taylor  <otaylor@redhat.com>

	* tests/testsocket.c: Remove now useless include of unistd.h,
	fix wrong argument btk_socket_steal. (Hans Breuer, #58541)
	
Fri Oct 19 12:24:32 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/linux-fb/bdkfont-fb.c: Fix up for change to 
	Bango font API. #61933. (Untested, even for compilation.)

Fri Oct 19 11:24:58 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmain.[ch] (btk_disable_setlocale): Actually
	export btk_disable_setlocale(). (Caught by Sven Neumann)

2001-10-18  Havoc Pennington  <hp@redhat.com>

	* bdk/x11/bdkpixmap-x11.c (bdk_pixmap_lookup): fix compilation

2001-10-18  Havoc Pennington  <hp@redhat.com>

	* btk/btkbutton.c (btk_button_class_init): Change button signals
	to BTK_RUN_LAST, #50239

2001-10-18  HideToshi Tajima  <hidetoshi.tajima@sun.com>

	* btk/btkimmodule.c (match_locale):
	Support "*" for all locales with least priority
	when to select default im module, #58201

2001-10-18  Matthias Clasen  <matthiasc@poet.de>

	* btk/btktreeselection.c (btk_tree_selection_set_mode): 
	Fix docs. (#61976)
 
	* btk/btkplug.c (btk_plug_get_id) : Fix docs. (#62144)

	* btk/btkliststore.c: Fix docs. (#61672, #61675)

        * bdk/bdkwindow.h, bdk/bdkpixmap.h, bdk/x11/bdkx.h,
        bdk/x11/bdkwindow-x11.c, bdk/x11/bdkpixmap-x11.c,
        bdk/win32/bdkwin32.h, bdk/win32/bdkwindow-win32.c,
        bdk/win32/bdkpixmap-win32.c, bdk/linux-fb/bdkfb.h,
        bdk/linux-fb/bdkwindow-fb.c, bdk/linux-fb/bdkpixmap-fb.c:
        Add bdk_window_lookup, bdk_window_foreign_new, bdk_pixmap_lookup
        and gkd_pixmap_foreign_new to the bdk frontend api. (#62063)

        * btk/btkselection.c: Remove bdk backend dependencies. (#62063)

	* btk/btkspinbutton.c (btk_spin_button_size_request): 
	Don't restrict the width of the spinbutton entry field 
	to 10 digits. (#58681)

Thu Oct 18 14:58:14 2001  Jonathan Blandford  <jrb@redhat.com>

	* tests/testtreeflow.c: new test program for the tree.

Thu Oct 18 14:22:10 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreestore.c (btk_tree_store_remove): fix small bug
	reported by (Oleg Maiboroda), #62600

2001-10-18  Michael Meeks  <michael@ximian.com>

	* btk/btkentry.c (btk_entry_set_property),
	(btk_entry_get_property): impl 'text'
	(btk_entry_class_init): add the 'text' prop.
	(btk_entry_insert_text): notify 'text' changed.
	(btk_entry_delete_text): ditto.

2001-10-17  Matthias Clasen  <matthiasc@poet.de>

	* btk/btkdnd.c, btk/btkclipboard.c, bdk/x11/bdkmain-x11.c:
	Documentation updates.

Wed Oct 17 15:17:20 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkentry.c (btk_entry_real_insert_text): Fix mistake
	in truncating length of text to MAX_SIZE. (Found by 
	Padraig O'Briain, #62055)

Tue Oct 16 17:04:44 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.c: Rename ACTIVATE_MNEMONIC enum to
	MNEMONIC_ACTIVATE; signal was changed a long time
	ago.

	* bdk/x11/bdkim-x11.c (_bdk_x11_initialize_locale): 
	Fix wrong return statement. (Reported by HideToshi
	Tajima and others.)

	* btk/btklabel.h (struct _BtkLabelClass): Remove
	left over select_all vfunc.

Tue Oct 16 15:50:03 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.c (btk_widget_translate_coordinates): Add
	a utility function to translate coordinates relative to
	one widget's allocation to coordinates relative to another
	widget's allocation.

	* btk/btkradiobutton.c: Add a special ->focus() implementation
	that:
	 - only accepts external focus if there is no active
   	   member of the group or the button is active.
	 - makes arrow keys move the active button as well
	   as the focus
	 - make tab tab out directly.
	This makes a radio button group act as a single focus location.
	(#53577).
	
	* btk/btkcontainer.c (btk_container_focus): Remove prefiltering -
	it was only a small optimization that didn't matter and made
	things more complicated.

	* btk/btkcontainer.c (btk_container_focus_tab): Get rid of custom
	sorter for FOCUS_TAB as we did for the other focus directions,
	sort by center of widgets, not upper-left corner. (Shouldn't
	matter in general.)

	* btk/btkcontainer.c: Restructure code to remove duplicate code
	from the different types of focusing: encapsulate sorting the
	widgets for the focus direction into one routine
	(btk_container_focus_sort()) and then share the work of moving the
	focus between the different focus directions.

	* btk/btkcontainer.c: Fix bug where arrow navigation might not
	work correctly with focus chains containing non-immediate
	children. Sorting was being done using allocation coordinates for
	each widget in the focus chain, and if there were intermediate
	window-widgets, these allocations would not be in the same
	coordinate system.

Tue Oct 16 15:12:26 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkoptionmenu.c (btk_option_menu_mnemonic_activate): add a
	mnemonic_activate function to option menu.

2001-10-15  Murray Cumming <murrayc@usa.net>

	* btk/btkinputdialog.c, btk/btktoolbar.c,  btk/btkwidget.c:
	  Corrected the type names used in some calls to g_signal_new().
	
Sat Oct 13 07:09:30 2001  Tim Janik  <timj@btk.org>

	* btk/btkbindings.c (btk_binding_set_add_path): to compare pattern
	specs, use g_pattern_spec_equal() instead of direct field accesses.
	upon compressing two equal paths of the same type, the resulting
	priority has to be the maximum.
	* btk/btkenums.h (enum): take BTK_PATH_PRIO_MASK out of the
	BtkPathPriorityType enum and make it a macro.

2001-10-12  Matthias Clasen  <matthiasc@poet.de>

	* btk/btkwidget.c: Fix some doc comments.

Fri Oct 12 11:39:20 2001  Joshua N Pritikin  <vishnu@pobox.com>

	* btk/btktreeview.c (btk_tree_view_get_path_at_pos): Fix to work
	on empty models.

2001-10-11  Matthias Clasen  <matthiasc@poet.de>

	* btk/btkcolorsel.c, btk/btkwidget.c, btk/btktreeview.c:
	Remove stale bdk backend includes.
 
2001-10-10  Michael Meeks  <michael@ximian.com>

	* btk/btkcombo.c (btk_combo_class_init): add enable_empty
	and value_in_list properties.
	(btk_combo_set_value_in_list): notify change.
	(btk_combo_set_property, btk_combo_get_property): impl. prop.

2001-10-11  James Henstridge  <james@daa.com.au>

	* configure.in: add AS=CC and ASFLAGS=CFLAGS substitutions so
	that btk+ can be built with automake 1.5 while not breaking
	things for automake 1.4.

Wed Oct 10 12:48:38 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmain.c (btk_init_check): Call setlocale (LC_ALL, "").
	(#60606)

	* btk/btkmain.c (btk_disable_setlocale): Add function
	to disable calling setlocale (LC_ALL, "").

	* btk/btkmain.c (btk_set_locale): Indicate in the 
	docs that this function is not typically useful.

	* bdk/x11/{bdkim-x11.c,bdkmain-x11.c,bdkprivate-x11.h}: 
	Automatically initialize BDK for the current locale
	on bdk_init(). Don't reset locale to C when
	XSupportsLocale() fails.

	* bdk/linux-fb/bdkim-fb.c (bdk_set_locale): Remove
	useless checks for UTF-8 locale breakage that mattered
	only for X.

	* examples/calendar/calendar.c
	tests/{testbtk.c,testtext.c,testcalendar.c}: Remove calls to 
	btk_set_locale().

	* btk/btkiconfactory.c btk/btkitemfactory.c:
	bdk_pixbuf_new_from_stream => bdk_pixbuf_new_from_inline.

Wed Oct 10 21:13:46 2001  Kristian Rietveld  <kristian@planet.nl>

	* btk/btktreemodel.[ch]: added btk_tree_model_get_iter_from_string().

	Fixes bug #61904

Wed Oct 10 01:19:04 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeselection.c (btk_tree_selection_iter_is_selected):
	new function, #61923
	(btk_tree_selection_path_is_selected): Ditto

Tue Oct  9 17:40:24 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreestore.c (btk_tree_store_finalize): We're a bobject,
	not a BtkObject.  Thanks andersca.

	* btk/btkliststore.c (btk_list_store_finalize): ditto

Tue Oct  9 14:50:51 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeviewcolumn.c
	(btk_tree_view_model_sort_column_changed): fix broken code.

2001-10-08  Matthias Clasen  <matthiasc@poet.de>

	* btk/btkselection.c: s/succesfully/successfully/g

2001-10-08  Havoc Pennington  <hp@pobox.com>

	* demos/btk-demo/stock_browser.c: remove unused enum

	* btk/btktreeselection.c (btk_tree_selection_real_select_node):
	pass the current selection state of the node in to the user
	selection func

2001-10-06  Matthias Clasen  <matthiasc@poet.de>

	* bdk/x11/bdkx.h (BDK_CURSOR_XCURSOR): Replace reference to 
	non-existent function bdk_x11_cursor_get_xid 
	by bdk_x11_cursor_get_xcursor.

Fri Oct  5 20:50:00 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreestore.c (btk_tree_store_iter_has_child): improve
	warning.

	* btk/btktreemodel.c (btk_tree_row_reference_new_proxy): ref and
	unref nodes, #okay61676

	* btk/btktreeviewcolumn.c (btk_tree_view_column_sort): we listen
	to the property; no need to clear the other columns.  Also, we go
	to 'unsorted' if the model supports it.

2001-10-05  Sven Neumann  <sven@gimp.org>

	* demos/testpixbuf-save.c
	* demos/testpixbuf-scale.c: simple tests for the new PNG tEXt chunk 
	feature.

Fri Oct  5 19:06:07 2001  Kristian Rietveld  <kristian@planet.nl>

	* btk/btktreeview.c (btk_tree_view_leave_notify): should
	destroy the search dialog

	* btk/btktreeview.c (btk_tree_view_real_start_interactive_search):
	added check to prevent creation of a search dialog if there's
	already one around

	* btk/btktreeview.c: Define BTK_TREE_VIEW_SEARCH_DIALOG_KEY, and use
	it instead of "search-dialog" (when getting/setting the search dialog
	widget).

2001-10-05  Jakub Steiner <jimmac@ximian.com>

	* btk/stock-icons/stock_broken_image.png: broken images icon

2001-10-04  Havoc Pennington  <hp@pobox.com>

        Fix #56586
	
	* btk/btksettings.c (btk_settings_class_init): move the F10
	accelerator setting here...

	* btk/btkmenubar.c (btk_menu_bar_class_init): ...from over here,
	because we try to use it when a menu bar hasn't necessarily been 
	initialized.

2001-10-03  Havoc Pennington  <hp@redhat.com>

	* tests/testtextbuffer.c (logical_motion_tests): fix test case, 
	it previously verified incorrect behavior

        Fixes for #61565
	
	* btk/btktextiter.c (btk_text_iter_set_line): don't return lines
	off the end
	(_btk_text_btree_get_iter_at_line_char): don't return lines off
	the end
	(_btk_text_btree_get_iter_at_line_byte): don't return lines off
	the end
	(btk_text_iter_forward_lines): if on the last line, move to end of
	it

	* btk/btktextbtree.c (_btk_text_btree_last_could_contain_tag):
	don't return a line off the end

Wed Oct  3 23:47:25  Kristian Rietveld  <kristian@planet.nl>

	* btk/btkeditable.[ch]: move insert_text and delete_text virtual
	functions to do_insert_text and do_delete_text, add signals
	insert_text, delete_text and changed

	* btk/btkentry.[ch]: remove signals insert_text, delete_text
	and changed. Updates to match new situation.

	* btk/btkspinbutton.c: updates to match new situation

	* btk/btkoldeditable.h: remove signals changed, insert_text
	and delete_text

	* btk/btkoldeditable.c: updates to match new situation

	* btk/btktext.c: updates to match new situation

	Fixes bug #59803

2001-10-03  Havoc Pennington  <hp@redhat.com>

	* btk/btktextiter.c (test_log_attrs): allow testing the end 
	position

	* btk/btktextbuffer.c (compute_log_attrs): update for bango
	changes

	* tests/testtextbuffer.c (logical_motion_tests): updates

2001-10-03  jacob berkman  <jacob@ximian.com>

	* btk/btkwidget.c (btk_widget_style_get_property): 
	* btk/btkstyle.c (_btk_style_peek_property_value): 
	* btk/btksettings.c (apply_queued_setting): 
	* btk/btkmain.c (btk_init_check): 
	* btk/btkcontainer.c (btk_container_child_get_property):
	s/retrive/retrieve/

Wed Oct  3 20:29:29 2001  Kristian Rietveld  <kristian@planet.nl>

	* btk/btktreemodelsort.[ch]: preparation for surgery
	* tests/testtreesort.c: ditto

2001-10-02  Havoc Pennington  <hp@redhat.com>

        Throughout: assorted docs
	
	* bdk/bdkwindow.h: deprecate bdk_window_set_hints(), it's broken,
	bdk_window_set_geometry_hints() should be used instead.

	* bdk/bdkimage.h: deprecate bdk_image_ref, bdk_image_unref, and
	document them

	* bdk/x11/bdkx.h: remove bdk_get_client_window() since it doesn't
	seem to exist in any .c files

	* bdk/x11/bdkcolor-x11.c (bdk_colormap_query_color): docs, 
	g_return_if_fail (pixel < colormap->size).

Wed Oct  3 10:42:54 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkdnd.c (btk_drag_dest_find_target): Allow
	NULL for @target_list to mean, use
	btk_drag_dest_get_target_list (widget).

	* btk/btkdnd.c (btk_drag_finish): Fix problem where
	drop could hang when calling btk_drag_finish with 
	success == FALSE and del == TRUE.

	* btk/btkdnd.c (btk_drag_dest_drop): Fix problem where
	drops without a matching target found would propagate
	to the parent widget rather than being rejected.

	* btk/btktextview.c (btk_text_view_drag_data_received): 
	Use text_view->dnd_mark instead of mark name to be
	consistent with the rest of the code.

	* btk/btktextview.c (btk_text_view_drag_motion): Make
	pendantically correct for a drop-only-in-some-places
	widget. (Check whether you can insert in drag_drop,
	not just in drag_motion ... matters in theory, and
	for Motif drag and drop in practice.)

	* btk/btkentry.c (btk_entry_drag_drop): Patch from 
	Damian Ivereigh to not allow drops on non-editable
	entries. (#61124)

	* btk/btkentry.c (btk_entry_motion_notify): Don't allow
	text to be moved from a non-editable entry.
	
2001-10-03  James Henstridge  <james@daa.com.au>

	* btk/btktreeviewcolumn.c (btk_tree_view_column_set_fixed_width):
	s/width/fixed_width/ in order to get things to compile.

Wed Oct  3 00:37:09 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkcelleditable.c: docs

	* btk/btktreemodel.h: more docs.

2001-10-02  Havoc Pennington  <hp@redhat.com>

	* bdk/x11/bdkwindow-x11.c: docs

	* tests/testtextbuffer.c (logical_motion_tests): add sentence
	boundary tests

Tue Oct  2 20:18:32 2001  Kristian Rietveld  <kristian@planet.nl>

	* demos/btk-demo/Makefile.am: add editable_cells.c,
	list_store.c and tree_store.c

	* demos/btk-demo/appwindow.c: remove tearoff item from
	File menu, put menubar and toolbar in handle boxes.

	* demos/btk-demo/genincude.pl: various changes to support trees

	* demos/btk-demo/main.c: various changes to support trees

	* demos/btk-demo/stock_browser.c: changed name of demo
	to Stock Item and Icon Browser, so geninclude.pl doesn't see
	it as child

	* demos/btk-demo/editable_cells.c: new file/demo
	* demos/btk-demo/list_store.c: new file/demo
	* demos/btk-demo/tree_store.c: new file/demo

Mon Oct  1 16:05:44 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkrc.c btk/btksettings.c: 
	g_string_printfa => g_string_append_printf.

Mon Oct  1 16:08:23 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkliststore.c (btk_list_store_class_init): add a finalize
	and destroy handler.

	* btk/btktreestore.c (btk_list_store_class_init): ditto, #59963

	* btk/btktreeview.h (struct _BtkTreeViewClass): Add
	'start_editing' flag to select_cursor_row.  Bug spotted by Manish
	Singh <yosh@gimp.org>.

2001-10-01  Matthias Clasen  <matthiasc@poet.de>

	* btk/btkitemfactory.c (btk_item_factory_parse_rc_scanner): replace
	g_scanner_add/remove_symbol by g_scanner_scope_add/remove_symbol.

	* btk/btkrc.c (btk_rc_parse_any): here as well.

Mon Oct  1 14:07:02 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_size_allocate): change
	scroll_to_cell delayed code to happen in size_allocate.

	* btk/btkstyle.c (btk_default_draw_expander): change
	prelight/normal arrow drawing.

	* btk/btktreedatalist.c: Change compare func to use g_utf8_collate

	* btk/btktreestore.c: refactor.

Sun Sep 30 22:15:52 2001  Manish Singh  <yosh@gimp.org>

	* btk/btkcheckbutton.c (btk_check_button_size_allocate): Applied
	patch from Soeren Sandmann <sandmann@daimi.au.dk>. Vertically
	centers the child in relation to the to indicator height.

Sun Sep 30 15:11:59 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreestore.c (btk_tree_store_remove): Make ITERS_PERSIST
	correct

Sun Sep 30  07:01:42 2001 CEST <mikeh@bahnhof.se>

	* btk/btkcellrenderertext.c: I reverted back to old "weight"
	property code using g_param_spec_int and changed from
	g_value_get_enum to g_value_get_int instead. Probably a better way
	to fix the problem :-)

Sun Sep 30  05:31:32 2001 CEST Mikael Hermansson <tyan@linux.se>

    * btk/btkcellrenderertext.c changed "weight" property type from 
      g_param_spec_int to g_param_spec_enum.

Sat Sep 29 12:25:26 2001  Manish Singh  <yosh@gimp.org>

	* btk/btktreeviewcolumn.c (btk_tree_view_column_class_init): typo
	fix: s/Wether/Whether/ in reorderable property description

Thu Sep 27 16:46:36 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_real_select_cursor_row): only
	start editing when you select with a keyboard.

	(btk_tree_view_button_press_event): much more graceful now.

	* btk/btkstyle.c: Draw togglebutton better.

2001-09-26  Havoc Pennington  <hp@redhat.com>

	* demos/btk-demo/dialog.c (interactive_dialog_clicked): add demo
	of passing non-stock label in to btk_dialog_new_with_buttons

	* btk/btktextview.c (cursor_blinks): disable cursor blink when
	debugging updates

	* btk/btktextiter.h: comment about how BtkTextIter struct contents
	are private

	* btk/btkbutton.c (btk_button_new_from_stock): if stock ID doesn't
	exist, fall back to mnemonic label, not plain label, bug #61184
	
Wed Sep 26 19:48:01 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreestore.c (btk_tree_store_set_valist): Stop being
	stupid and emitting the signal every time.

	* btk/btkliststore.c (btk_list_store_set_valist): ditto

Wed Sep 26 16:35:59 2001  Owen Taylor  <otaylor@redhat.com>

       Patch from Mark McLoughlin <mark@skynet.ie> (#61233)

       * contrib/bdk-pixbuf-xlib/Makefile.am: install
       bdk-pixbuf-xlib-2.0.pc.

Wed Sep 26 16:15:25 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btknotebook.c (btk_notebook_set_tab_label): Fix
	problem where menmonic wasn't removed properly when
	setting a label when there already is a label.
	Also, handle setting the tab label back to the same
	value. (#61160, #61161)

	* btk/btkentry.c (paste_received): Patch from 
        Damian Ivereigh to replace selection if there is 
	one. (#61121)

2001-09-25  Darin Adler  <darin@bentspoon.com>

	* tests/.cvsignore: Ignore new test program.

2001-09-25  Havoc Pennington  <hp@redhat.com>

	* btk/btktextview.c: fix for #50317
	
2001-09-25  Havoc Pennington  <hp@redhat.com>

	* btk/btktextview.c (btk_text_view_key_press_event): use 
	btk_text_iter_can_insert
	
	* btk/btktextbuffer.c: use btk_text_iter_can_insert

	* btk/btktextiter.c (find_line_log_attrs): fixes, #57611, #57613
	 (btk_text_iter_can_insert): new function to fix #60282, should
	also fix msw's "can paste into empty buffer" bug.

	* btk/btktexttag.c (btk_text_tag_event): change type check for 
	"event object,"  #59091

	* btk/btktextbtree.c: indentation fixes

	* btk/btktextiter.c (find_by_log_attrs): fixes

Tue Sep 25 12:41:17 2001  Owen Taylor  <otaylor@redhat.com>

	* configure.in: Version 1.3.9, interface age 0, binary age 0.

	* configure.in: Require GLib-1.39, Bango 0.20, Batk 0.5.

	* NEWS: Updates.

Mon Sep 24 11:59:09 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkstyle.[ch] (_btk_draw_insertion_cursor): Shared
	function for drawing cursors between btkentry/btklabel/btktextview.
	Should this be public? It has a bit of an odd interface, but
	custom editing widgets probably should be using it.
	Function will draw with wider width for taller cursors, and
	draws a little indicator arrow to indicate directoin for split 
	cursors.

	* btk/btktextview.c: Add a "cursor_color" property.

	* btk/btktextdisplay.[ch]: Add a cursor_gc parameter to
	btk_text_layout_draw().

	* btk/btkentry.c btk/btklabel.c btk/btktextdisplay.c: Use
	_btk_draw_insertion_cursor().

Tue Sep 25 11:22:23 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkcellrenderertext.c btk/btktexttag.c: Restore
	the behavior where you could turn family_set (etc) back on
	and get back the values you had before.

	* demos/btk-demo/stock_browser.c (id_to_macro): Use
	g_string_ascii_up() rather than looping through the
	string ourself.

Tue Sep 25 15:32:44 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeviewcolumn.c
	(btk_tree_view_column_set_cell_renderer): Removed
	(btk_tree_view_column_set_alignment): xalign = CLAMP (xalign, 0.0, 1.0);  Fixes 61012.

	* btk/btktreestore.c (btk_tree_store_sort_helper): Fixed #61012
	Patch from Detlef Reichl

2001-09-25  Havoc Pennington  <hp@redhat.com>

	* tests/testtextbuffer.c (line_separator_tests): Add tests for
	line separators, addresses bug #57428

Tue Sep 25 12:34:42 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkentry.c: Make a BtkCellEditable
	(get_widget_window_size): Change to let it honor size_allocate
	when a CellEditable.

	* btk/btktreeview.c: M-x clean-line-ends.  Lots of focus and
	editable changes.
	(btk_tree_view_set_cursor): Now you can set the cursor
	horizontally, as well as start editing.

	* btk/btkstyle.c (btk_default_draw_check): changing toggle drawing
	code to look more like the other check buttons.

	* btk/btkcellrenderertoggle.c (btk_cell_renderer_toggle_get_size):
	Change the way we calculate cell size.

	* btk/btkmarshal.list (VOID:STRING,STRING): new marshaller.

	* demos/btk-demo/sizegroup.c: Add mnemonics.

	* btk/btkcellrenderer.c (btk_cell_renderer_get_size): Fix docs.
	Fix logic.

	* btk/btkcellrenderertext.c: Change to be editable.

	* btk/btkcellrenderertoggle.c: Change to be activatable.

	* test/testtreesort.c: Fix misspelling

	* test/testreecolumns.c: Add mnemonics.

	* test/testreeedit.c: New test program.

2001-09-25  Havoc Pennington  <hp@pobox.com>

	* btk/btkwindow.c: Put notes in btk_window_set_has_frame(),
	etc. docs about how these are not going to do what you want for 
	the X/win32 ports. Futile attempt to avoid a FAQ...

2001-09-24  James Henstridge  <james@daa.com.au>

	* btk/btkmarshal.list (VOID): add marshal function types.

	* btk/btkctree.c (btk_ctree_class_init): make arguments have type
	BTK_TYPE_CTREE_NODE|G_SIGNAL_TYPE_STATIC_SCOPE rather than
	BTK_TYPE_POINTER.
	(btk_ctree_node_get_type): implement boxed type for BtkCTreeNodes
	with no-op copy/free functions.

	* btk/btkctree.h (btk_ctree_node_get_type): add prototype for
	BtkCTreeNode get_type function.

2001-09-24  Havoc Pennington  <hp@redhat.com>

	* btk/btktextiter.c, btk/btktextbuffer.c, btk/btktextbtree.c,
	btktextlayout.c:
	Get rid of the newline-that-could-not-be-deleted; buffers may 
	now be zero-length. Much easier to fix than expected, once 
	I figured out the right way to do it. However, there are 
	various subtle bugs introduced by this that will have to get 
	sorted out. Please use bugzilla.

Mon Sep 24 15:09:08 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwindow.c (btk_window_move_resize): Don't wait for a
	response back from the window manager if our size hasn't changed 
	since we won't get a response back from the window manager;
	there was code in there to do this, but it was in the wrong
	place so if the hints change and the size didn't we'd expect
	a response.

	Also, optimize the position-only-changed case by running
	the resize queue immediately, and clean up some comments
	for the changes.

Mon Sep 24 12:48:25 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btknotebook.h: Add a compat macro that got lost.

	* btk/btktreestore.c: Doc fixes.

	* bdk/x11/bdkevents-x11.c (bdk_event_translate): Fix reference
	leak for windows that receive events after being destroyed.
	(#60863, Joshua N. Pritikin)

	* btk/btktable.c (btk_table_remove): Use btk_widget_queue_resize
	rather than btk_container_queue_resize().

	* btk/{btkcontainer.c,btkwidget.c,btkwindow.c}: _btk prefix
	btk_container_queue_resize, btk_container_queue_resize_widgets,
	btk_container_child_composite_name. (#60217.)

2001-09-22  Hans Breuer  <hans@breuer.org>

	* btk/btkmenu.h : fix compat macros for btk_menu_<prepend|insert>

Sat Sep 22 16:50:34 2001  Kristian Rietveld  <kristian@planet.nl>

	* btk/btktexttag.c (btk_text_tag_set_property): (case PROP_WEIGHT):
	weight value should be an int

Sat Sep 22 15:17:41 2001  Kristian Rietveld  <kristian@planet.nl>

	* btk/btkmenu.c (btk_menu_select_item): move most code
	to btk_menu_scroll_item_visible(). Only call
	btk_menu_scroll_item_visible() if the menu widget has been
	realized. Fixes bug #55310.

2001-09-21  Havoc Pennington  <hp@redhat.com>

	* btk/btktextview.c (btk_text_view_key_press_event): don't pass
	key press to IM context if cursor isn't in an editable location;
	bug #58425, patch from Hidetoshi Tajima

2001-09-21  Havoc Pennington  <hp@redhat.com>

        Bug #60862
	
	* btk/btktextbtree.c (btk_text_btree_node_destroy): 
	(_btk_text_btree_unref): fix up mark memory management

	* btk/btktextmark.c (mark_segment_delete_func): ditto

2001-09-20  Havoc Pennington  <hp@redhat.com>

	* btk/btktextlayout.c (btk_text_layout_get_line_display): don't
	try to handle alignment here, because it's done by BangoLayout
	after we set the layout width. Fix from Dov.

2001-09-21  Hans Breuer  <hans@breuer.org>

	* bdk/bdk.def :
	* btk/btk.def : updated externals

	* btk/btkmain.h : define get_btk_win32_directoty () 
	* btk/btkmain.c (find_module) : don't use module_name after freeing it.
	Also handle that Win32 pathes cann't be hard-coded	

	* btk/btkrc.c : use get_btk_win32_directoty () to cleanup the various
	module, themes etc directory calculations

	* bdk/win32/bdkgeometry-win32.c : some more hacking to get coordinates
	>16 bit right. The size limit within Win9x appears _not_ to be 32767
	but slightly smaller ...

	* bdk/win32/bdkwindow-win32.c : use impl->position_info to avoid 
	>16 bit clipping. Added dummy body for bdk_window_set_icon_list ()

	* bdk/win32/bdkdrawable-win32.c : implement bdk_win32_drawable_get_handle ()

	* bdk/win32/bdkevents-win32.c : some tweaking to get better expose
	handling. I'm not sure if it is better now, but at least not worse

	* bdk/win32/makefile.msc : define INSIDE_BDK_WIN32, some cleanup

	* bdk/win32/bdkwin32.h : reflect recent API restrictions

2001-09-21  Matt Wilson  <msw@redhat.com>

	* btk/btkradiomenuitem.c (btk_radio_menu_item_destroy): set
	radio_menu_item->group to NULL after removing it from the list, as
	it is no longer in the group. (#60869)

	* btk/btkradiobutton.c (btk_radio_button_destroy): likewise

2001-09-20  Havoc Pennington  <hp@pobox.com>

	* configure.in (BANGO_REQUIRED_VERSION)
	(BATK_REQUIRED_VERSION): add variables and checks for specific 
	versions of dependencies. Previously we didn't verify the 
	Bango or ATk versions.

2001-09-09  Havoc Pennington  <hp@pobox.com>

	* btk/btktextiter.c: fool with indentation
	(btk_text_iter_in_range): add g_return_if_fail

Thu Sep 20 17:45:54 2001  Joshua N Pritikin  <vishnu@pobox.com>

	* btk/btktextbuffer.c (btk_text_buffer_create_tag): Fix
	ref count on new tag to be 1.  Update doc.  (#60836)

Thu Sep 20 16:20:47 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkrgb.c (bdk_rgb_allocate_images): Remove unnecessary
	call to bdk_image_new_bitmap(). (#59094, reported by
	by Sven Neumann)

Thu Sep 20 15:31:35 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkcalendar.c (btk_calendar_init): Use the current
	day, as well as the current month and year.
	(#59047, reported by Vitaly Tishkov)

Thu Sep 20 15:10:30 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkdialog.c (btk_dialog_init): Automatically set
	set dialogs to BTK_WIN_POS_CENTER_ON_PARENT. (#60554)
	
Thu Sep 20 18:00:56 2001  Kristian Rietveld  <kristian@planet.nl>

	* tests/testbtk.c (struct OptionMenuItem): get rid of it,

	(build_option_menu): add func argument, connect ::changed
	signal to option menu instead of connecting the ::activate
	signal to the menu items,

	(toplevel): get rid of RADIOMENUTOGGLED macro,

	(list_toggle_sel_mode), (clist_toggle_sel_mode),
	(ctree_toggle_line_style), (ctree_toggle_expander_style),
	(ctree_toggle_justify), (ctree_toggle_sel_mode),
	(progressbar_toggle_orientation), (progressbar_toggle_bar_style):
	use btk_option_menu_get_history() instead of RADIOMENUTOGGLED,

	(notebook_type_changed): merged standard_notebook(),
	notabs_notebook(), scrollable_notebook() and borderless_notebook()
	into notebook_type_changed()

	(create_list), (create_ctree), (create_notebook),
	(create_progress_bar): changed OptionMenuItem arrays into
	gchar * arrays. Removed "Extended" item where used.

	Fixes bug #59885

2001-09-20  Sven Neumann  <sven@gimp.org>

	* configure.in
	* bdk/Makefile.am
	* btk/Makefile.am
	* btk/btkselection.c
	* btk/btktreeview.c
	* btk/btkwindow.c: removed remaining traces of nanox BDK backend.

Thu Sep 20 11:19:42 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkbango.c (bdk_bango_layout_line_get_clip_rebunnyion): Add
	a missing bango_layout_iter_free ().

Thu Sep 20 11:03:51 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkobject.c btk/btklist.c btk/btkplug.c btk/btksocket.c
	btk/btktreemodelsort.c btk/btktreeview.c: Small warning cleanups.

	* btk/btkradiomenuitem.c (btk_radio_menu_item_get_group): Change
	the function definition so we don't accidentally rely on
	the compat #define from btk_radio_menu_item_group.
	(#60782, Jeff Franks)

Thu Sep 20 16:51:02 2001  Kristian Rietveld  <kristian@planet.nl>

        * btk/btkwindow.c (btk_window_get_frame_dimensions): returned
        incorrect values for top, right and bottom due to cut-and-paste
        bug. Pointed out by Vitaly Tishkov, fixes bug #59008

Wed Sep 19 17:59:27 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkwindow-x11.c (bdk_window_new): Set
	_NET_WM_PID and WM_CLIENT_MACHINE properties on each
	window, not just on the client leader. (#58463)

Wed Sep 19 17:28:47 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.c (btk_widget_new): Add missing cast.

	* btk/btkmenuitem.[ch] btk/btkmenushell.c: Underscore prefix
	non-public _btk_menu_item_set_placement.

	* btk/btktooltips.h: Deprecate btk_tooltips_set_delay().

Wed Sep 19 16:16:38 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/win32/bdkcolor-win32.c bdk/x11/bdkcolor-x11.c 
	  bdk/linux-fb/bdkcolor-fb.c:
	Fix propagated (flags && BDK_COLOR_WRITEABLE) typo.
	(#59723)

Wed Sep 19 16:12:16 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkpixbuf-render.c: Allow -1 for width/height
	to mean "width/height of pixbuf" (Patch from Matthias Clasen,
	#59723)

Wed Sep 19 16:01:27 2001  Owen Taylor  <otaylor@redhat.com>

	Patch from Frank Belew #59037 for Solaris compilation.

	* btk/maketypes.awk: Change syntax slightly for a call
	to sub(), apparently making awk on Solaris happier.

	* btk/btktreeview.c: Remove C++ comments.

Wed Sep 19 15:46:29 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwindow.c: Add xgettext:no-c-format comment to
	to handle '99% of the time. (#60473, reported by Christian Rose)

	* btk/btkwidget.h: Remove prototype for btk_widget_get_usize()
	which no longer exists. (#60379, reported by Vitaly Tishkov)

Wed Sep 19 11:06:24 2001  Tim Janik  <timj@btk.org>

	* Released 1.3.8.

	* bdk/Makefile.am: kill EXTRA_DIST clearing.
	
Wed Sep 19 02:50:40 2001  Tim Janik  <timj@btk.org>

	* demos/Makefile.am ($(testpixbuf_OBJECTS)): don't use BUILT_SOURCES
	as its broken in automake 1.4, add explicit object rule to
	generate this.
	
	* bdk-pixbuf/Makefile.am: fix maintainer and normal cleanfiles.
	get rid of uneccessary stamps, group stuff more logically, and build
	sources due to object rules. fix srcdir!=builddir.

Tue Sep 18 20:47:16 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkspinbutton.c (btk_spin_button_size_request): Fix 
	incorrect parameter to compute_double_length
	(#58680, patch from Matthias Clasen)

	Fixes for compilation with Forte cc. (#59734, Derek Rafter)

	* btk/btkwindow.h btk/btksizegroup.h: Remove extra ;.

	* bdk/bdktypes.h (BdkModifierType): Write 1u << 31
	for BDK_RELEASE_MASK to avoid warnings with Forte.

	* btk/btktexttag.c btk/btkcellrendertext.c: Add some missing
	break; statements.

2001-09-18  Alex Larsson  <alexl@redhat.com>

        * btk/btkcheckbutton.c:
	* btk/btkradiobutton.c:
	Don't draw with BTK_STATE_ACTIVE.

	* btk/btkclist.c:
	* btk/btkctree.c:
	Draw lines between rows with base_gc[BTK_STATE_NORMAL].

	* btk/btktextdisplay.c:
	Focused selection is drawn with base_gc [BTK_STATE_SELECTED] and
	unfocused with base_gc [BTK_STATE_ACTIVE].
	
	* btk/btkentry.c:
	Add select all menu-item.
	Default cursor color is red.
	Focused selection is drawn with base_gc [BTK_STATE_SELECTED] and
	unfocused with base_gc [BTK_STATE_ACTIVE].

	* btk/btklabel.[ch]:
	Add keynav + menu to selectable lables.
	Focused selection is drawn with base_gc [BTK_STATE_SELECTED] and
	unfocused with base_gc [BTK_STATE_ACTIVE].

	* btk/btkfilesel.c:
	Add drag and drop support.

	* btk/btkstyle.c:
	(This was checked in earlier)
	New default values for text/base SELECTED and ACTIVE
	
Tue Sep 18 23:51:49 2001  Tim Janik  <timj@btk.org>

	* configure.in: up version to 1.3.8, interface age 0,
	binary age 0, depend on bunnylib 1.3.8.

	* NEWS: 1.3.8 updates.

Tue Sep 18 18:46:54 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_start_editing): centralize all
	the editing code

	* btk/btkcelleditable.c: Got rid of stop_editing, as there was no
	reason to call it beyond emiting the two signals.

	* btk/btkentry.c (btk_entry_class_init): add "has_frame" property
	to BtkEntry.

Wed Sep 12 11:21:14 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkcellrenderertext.[ch] btk/btktexttag.[ch]
	  btk/btktextview.c tests/testbtk.c: Fix up for changes to 
	BangoFontDescription.

	* btk/btkentry.c btk/btkclist.c btk/btkcellrenderertext.c
	btk/btkspinbutton.c: Fix up for change to BangoMetrics
	structure.
  
	* btk/btkfontsel.c: Fix up for new Bango font listing API.

	* btk/btkstyle.[ch]: Add btk_style_get_font/set_font to replace
  	direct access to style->font. Deprecate btk_style_ref/unref.
  
 	* btk/btkclist.c btk/btkctree.c btk/btkstyle.c btk/btkwidget.c:
  	Remove btk_style_ref/unref with g_object_ref/unref.
  
  	* btk/btkcalendar.c: Remove leftover macros accessing
  	style->font.
  
  	* btk/btkhruler.c (btk_hruler_draw_ticks): Remove unused
  	variable.
  
  	* btk/btktext.c btk/btklabel.c: Use btk_style_get_font() instead of 
	style->font.

Tue Sep 18 13:51:35 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkcellrenderer.h (enum): Get rid of broken "can_edit" and
	"can_activate" properties in favor of
	BTK_CELL_RENDERER_MODE_INERT, BTK_CELL_RENDERER_MODE_ACTIVATABLE,
	and BTK_CELL_RENDERER_MODE_EDITABLE

Tue Sep 18 12:12:43 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_put): Add put for use with
	editable widgets.  This function is private, and should only be
	used by BtkTreeView.

2001-09-18  Matt Wilson  <msw@redhat.com>

	* docs/Makefile.am (EXTRA_DIST): don't use += before =

	* docs/faq/Makefile.am (EXTRA_DIST): likewise

	* docs/tutorial/Makefile.am (EXTRA_DIST): likewise
	
	* bdk/Makefile.am (MAINTAINERCLEANFILES): likewise
	(EXTRA_HEADERS): likewise

	* btk/Makefile.am (MAINTAINERCLEANFILES): likewise
	(EXTRA_HEADERS): likewise
	(EXTRA_DIST): likewise
	(CLEANFILES): likewise

	* btk/stock-icons/Makefile.am (CLEANFILES): likewise

	* tests/Makefile.am (EXTRA_DIST): likewise
	
	* Makefile.am (install-data-local): changed to use
	install-data-hook, which runs after install-pkgconfigDATA, so that
	the pkgconfigdir will have been created and populated first.

Mon Sep 17 17:39:52 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkcelleditable.[ch]: Add editable interface.  This should
	be the last big BtkTreeView API change.

	* btk/btkcellrenderer.[ch]: Get rid of the "event" vfunc, and
	replace with "activate" and "start_editing".  Also, added a
	"can_activate" and "can_edit" property.

	* btk/btktreeviewcolumn.c: modify to use above.

2001-09-16  Alexander Larsson  <alla@lysator.liu.se>

	* btk/btkoptionmenu.c:	Handle scroll wheel events.

Fri Sep 14 22:31:25 2001  Matthias Clasen  <matthiasc@poet.de>

	* demos/btk-demo/main.c (setup_default_icon): Use a shaped
	icon instead of one with ugly white background.

Fri Sep 14 22:26:01 2001  Matthias Clasen  <matthiasc@poet.de>

	* demos/btk-demo/stock_browser.c (id_to_macro): make
	the uppercasing work. (#59550)

2001-09-14  Jakub Steiner <jimmac@ximian.com>

	* btk/stock-icons/dialog_error.png:
	* btk/stock-icons/dialog_question.png: more road signs

2001-09-13  Jakub Steiner <jimmac@ximian.com>

	* btk/stock-icons/dialog_question.png:
	* btk/stock-icons/dialog_warning.png: anders and jonathan seem to
	  like a road sign.

Wed Sep 12 19:01:05 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreemodel.h (struct _BtkTreeModelIface): Rename interface
	signals to make them more clear.  Also, change ::range_changed to
	::row_changed.
	* btk/btktreemodel.c: Adjust to interface change
	* btk/btktreemodel.h: ditto
	* btk/btktreemodelsort.c: ditto
	* btk/btktreestore.c: ditto
	* btk/btkliststore.c: ditto
	* btk/btktreeview.c: ditto
	* tests/testtreecolumns.c: ditto
	* btk/btkmarshal.list: Actually remove a marshaller!

2001-09-12  Padraig O'Briain <padraig.obriain@sun.com>

	* btk/btktextview.c
	Add support for Ctrl+Up/Down arrow to move cursor to beginning
	of previous/next paragraph. If within a paragraph cursor moves to
	beginning of that paragraph.

2001-09-12  Jakub Steiner <jimmac@ximian.com>

	* btk/stock-icons/dialog_question.png: replacing the shaky
	  question mark with a sans-serif one.
	* btk/stock-icons/stock_top.png, stock_bottom.png,
     stock_first.png, stock_last.png: using the new style arrows
	* btk/stock-icons/stock_font.png: simple one to replace the ugly
     colors.
	* btk/stock-icons/stock_refresh.png: anti-aliased and changed
     color.
	* btk/stock-icons/stock_zoom*: anti-aliased
	* btk/stock-icons/dialog_error.png, dialog_warning.png: confused
     '-' with a '_', removed the wrong files

Sat Sep  8 16:19:02 2001  Owen Taylor  <otaylor@redhat.com>
 
 	* btk/btkmain.c: Implement a search path for BTK+ modules.
 
 	* configure.in btk/btkrc.c btk/Makefile.am: Look for modules
 	in btk-2.0/<type>/major.minor.(micro-binary_age) rather
 	than in btk-2.0/major.minor.micro/<type>/. This
 	works better for a search path for modules.
 
 	* btk+-2.0.pc.in btk+-2.0-uninstalled.pc.in: Add
 	btk_binary_version variable holding major.minor.(micro-binary_age).
 
 	* modules/input/Makefile.am (moduledir): Fix installation
 	directory to match change in lookup location.
 
 	* btk/btkmain.c (btk_init_check): Remove OS/2 code for dll 
 	suffixes. Needs to be handled in g_module_build_path().

	* btk/btkrc.c btk/queryimmodules.c: Use g_build_filename() where
	appropriate.
 
Tue Sep 11 13:59:12 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkrc.c (insert_rc_property): Fixed reversed comparison
	causing RC properties not to work.

2001-09-11  Jakub Steiner <jimmac@ximian.com>

	* btk/stock-icons/dialog-error.png: less drastic
	* btk/stock-icons/dialog-warning.png: no body parts. (I hope
	  "STOP" is international enough.
	* btk/stock-icons/stock_dnd*.png: get rid of the cursor
	* btk/stock-icons/stock_menu_properties.png: 16x16 version

Mon Sep 10 21:26:24 2001  Joshua N Pritikin  <vishnu@pobox.com>

	* btk/btktextview.c (btk_text_view_set_buffer): Make
	(add|remove)_selection_clipboard symmetric. (bug #59836)

	* btk/btktreeview.c (btk_tree_view_unref_and_check_selection_tree): 
	Avoid SEGV for empty tree. (bug #60243)

Mon Sep 10 20:47:22 2001  Tim Janik  <timj@btk.org>

	* tests/testbtk.c (create_idle_test): slight fix for
	g_object_set() not usable for nesting anymore.

	* btk/btkhandlebox.c (btk_handle_box_class_init): 
	* btk/btkframe.c (btk_frame_class_init): deprecate ::shadow
	properties, supply ::shadow_type properties instead as most
	other widgets do.

2001-09-10  Alex Larsson  <alexl@redhat.com>

	* demos/btk-demo/stock_browser.c:
	* bdk/bdkcolor.c:
	* bdk/bdkfont.c:
	* bdk/bdkcursor.c:
	* bdk/bdkevents.c:
	* bdk/bdkrectangle.c:
	* btk/btktypeutils.c:
	Update to use the new g_boxed_type_register_static API.

2001-09-10  Padraig O'Briain <padraig.obriain@sun.com>

	* btk/btktreestore.c:
	Fix looping in btk_tree_store_init() waiting for zero random int.

Mon Sep 10 16:55:49 2001  Tim Janik  <timj@btk.org>

	* btk/btkalignment.c (btk_alignment_init): fix xscale and yscale
	behaviour which havoc broke. they have to default to 1.0 for
	expand behaviour.

	* btk/btkwindow.c (btk_window_get_property): don't cast NULL objects.

2001-09-10  Padraig O'Briain <padraig.obriain@sun.com>

	* btk/btkstyle.c (_btk_style_peek_property_value)
	Amend previous change to avoid runtime error in g_param_spec_ref()

Mon Sep 10 06:58:56 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkrc.c (insert_rc_property): Fix blank line
	in the wrong place.

Mon Sep 10 06:50:39 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkstyle.c (_btk_style_peek_property_value): Don't
	do a lookup immediately after creating style->property_cache,
	since bsearch crashes on zero length for Solaris.
	(Found by Padraig O'Briain.)

2001-09-09  Alexander Larsson  <alla@lysator.liu.se>

	* btk/btkwidget.c (_btk_widget_peek_colormap):
	Really return NULL if not set.
	(btk_widget_init): Remove unused varaible.
	
2001-09-09  Alexander Larsson  <alla@lysator.liu.se>

	* configure.in:
	Remove bdk/nanox/Makefile from AC_OUTPUT(), since it is no longer
	in cvs.

2001-09-08  Havoc Pennington  <hp@pobox.com>

	* btk/btkaccelgroup.c: add docs to functions that I can imagine 
	people might want to use

2001-09-08  Havoc Pennington  <hp@pobox.com>

	* btk/btkalignment.c (btk_alignment_class_init): default
	xscale/yscale to 0.0, not 0.5, 0.5 isn't useful

	* tests/testtextbuffer.c: fix usage of btk_text_iter_spew

	* btk/btktextiter.c: fix docs
	(btk_text_iter_spew): get rid of this

	* btk/btklayout.c: docs

	* btk/btkbutton.c (btk_button_construct_child): add an alignment
	to center image and label together, instead of having image on
	left and label centered, patch/suggestion from Jacob

	* btk/btkdialog.c: docs

Sat Sep  8 14:19:49 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkliststore.c: Write documentation
	* btk/btktreestore.c: Write documentation

Sat Sep  8 13:53:09 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkrc.[ch] btk/btkstyle.[ch]: Replace uses of GBSearchArray
	with GArray and bsearch(), to remove dependency on a still
	evolving interface that we want to keep private to bunnylib/bobject. 

2001-09-08  Havoc Pennington  <hp@pobox.com>

	* btk/btktreeviewcolumn.c (btk_tree_view_column_add_attribute):
	docs fixes

	* btk/btktable.c (btk_table_get_col_spacing): docs fixes

	* btk/btkspinbutton.c (btk_spin_button_get_increments): docs fixes

	* btk/btksocket.c (btk_socket_steal): docs fixes

	* btk/btkscrolledwindow.h: docs fixes

	* btk/btkimage.c (btk_image_new): docs fixes

Sat Sep  8 01:49:22 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkmain-x11.c (_bdk_windowing_init_check): Prevent a 
	false alarm  constness warning with a cast.

	* bdk/x11/bdkx.h: Undefine BDK_ROOT_PARENT before redefining it
	for the inside-bdk case.

Sat Sep  8 01:44:18 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeviewcolumn.c (btk_tree_view_column_cell_set_dirty):
	remove g_print.

	* btk/btktreeview.c (btk_tree_view_set_model): unref model when we
	change models, #59899

2001-09-07  Havoc Pennington  <hp@pobox.com>

	* btk/btkmain.c: move some docs inline

2001-09-07  Havoc Pennington  <hp@pobox.com>

	* btk/btk.h: tsk tsk, jrb broke the build

Fri Sep  7 20:45:29 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeviewcolumn.c (btk_tree_view_column_pack_{start,end}):
	Removed 'fill' attribute.  It was silly b/c that was a property of
	the cell renderer, anyway.
	(btk_tree_view_column_render): Actually render the packed
	renderers.
	* doc/tree-column-sizing.txt: initial devel documentation.
	* btk/btktreeview.c (btk_tree_view_expand_all): Fix bug.
	* btk/btkcellrenderertextpixbuf.[ch]: removed.

	* tests/testtreefocus.c: fix up to reflect above changes.
	* tests/testtreeview.c: ditto
	* demos/btk-demo/stock_browser.c: ditto

2001-09-07  Alex Larsson  <alexl@redhat.com>

	* bdk/linux-fb/bdkcolor-fb.c:
	Removed unused function.
	
	* bdk/linux-fb/bdkdrawable-fb2.c
	* bdk/linux-fb/bdkfont-fb.c:
	Use BangoLanguage functions.

	* bdk/linux-fb/bdkinput.c:
	* bdk/linux-fb/bdkselection-fb.c:
	Fix const warnings.
	
	* bdk/linux-fb/bdkwindow-fb.c:
	Fix warning. Implement bdk_window_set_icon_list() and
	bdk_window_get_frame_extents(). (No icon support yet though.)

	* btk/btkwindow.c (btk_window_get_position):
	If window->frame is set get the extents of it instead.
	
Fri Sep  7 18:50:59 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.c (btk_widget_get_default_colormap): 
	Make the default default colormap the BdkRGB colormap,
	not the system colormap.

	* btk/btkinvisible.c (btk_invisible_init) 
	  btk/btkwindow.c (btk_window_init): Set the current
	colormap, as returned by _btk_widget_peek_colormap()
	on the widget.

	* btk/btkwidget.[ch]: Export _btk_widget_peek_colormap
	to BTK+. Make it return %NULL instead of the default
	colormap if no colormap has explicitely been pushed.

	* btk/btkwidget.c (btk_widget_get_colormap): Check for
	colormaps on ancestral widgets before defaulting the
	the system default colormap.

	* docs/Changes-2.0.txt: explain colormap changes.

2001-09-07  Havoc Pennington  <hp@redhat.com>

	* btk/btktextiter.c: add some lame code to handle G_MININT, fixes 
	#57424

Fri Sep  7 18:17:47 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdk.h bdk/x11/bdkmain-x11.c: Deprecate bdk_set/get_use_xshm, 
	make bdk_set_use_xshm a noop. Remove --no-xshm command line
	option. If we aren't autodetecting properly, we need
	to fix the problem, or at least make it an environment
	variable setting, to avoid problems with propagating
	to embedded children, plugins, etc.

	* bdk/bdkcolor.h: Deprecate bdk_colormap_get_system_size().

	* bdk/bdkpixbuf-render.c bdk/bdkpixbuf.h
	(bdk_pixbuf_render_pixmap_and_mask_for_colormap):
	New function to render a pixmap and mask for a particular colormap.

	* btk/btkwindow.c (get_pixmap_and_mask): Change to use
	bdk_pixbuf_render_pixmap_and_mask_for_colormap () instead
	of internal implementation of the same.

2001-09-07  Havoc Pennington  <hp@redhat.com>

	* btk/btktextlayout.c (btk_text_layout_get_lines): remove some
	debug code that seems to have caused a breakpoint in valid cases
	
	* btk/btktextbtree.c (_btk_text_btree_add_view): set the prev
	pointer on the first view when adding the second view, fixes
	crash when closing btk-demo text test with active selection

	* btk/btktextbuffer.c
	(btk_text_buffer_remove_selection_clipboard): don't leave dead
	clipboards in the list of clipboards - probably fixes #59836

Fri Sep  7 11:51:44 2001  Owen Taylor  <otaylor@redhat.com>

      Make bdkx.h the only installed header from bdk/x11.
      All structures in bdk/x11 are opaque.

	* bdk/x11/Makefile.am bdk/x11/bdkx.h bdk/x11/bdkprivate-x11.h:
	Don't install bdk{drawable,pixmap,window}-x11.h.

	* bdk/x11/{bdkcolormap-x11.c, bdkfont-x11.c, bdkx.h, bdkvisual-x11.c: 
	Move BdkColormapPrivateX11, BdkFontPrivateX BdkImagePrivateX11, 
	BdkVisualClass into C files.

	* bdk/bdkpixmap-x11.[ch]: Make bdk_pixmap_impl_get_type() static.

	* bdk/x11/{bdkcolor-x11.c, bdkcursor-x11.c, bdkdrawable-x11.c,
	bdkfont-x11.c, bdkgc-x11.c, bdkx.h, bdkimage-x11,bdkvisual-x11.c}
	Add public functions to replace previously exported direct
	structure access.
	bdk_x11_colormap_get_{xdisplay,xcolormap} 
	bdk_x11_cursor_get_{xdisplay,xcursor},
	bdk_x11_drawable_get_{xdisplay,xcursor,bdk_x11_visual_get_xvisual, 
	bdk_x11_font_get_{xdisplay,xfont}, bdk_x11_image_get_{xdisplay,ximage},
	bdk_x11_gc_get_{xdisplay,ximage}
	
	* bdk/bdkprivate.h bdk/bdkinternals.h: Move BdkColorInfo,
	BdkEventFilter, BdkClientFilter, BdkFontPrivate to bdkinternals.

      Fix a number of variables and functions that were exported
      "accidentally" from BDK.

	* bdk/**.[ch]: bdk => _bdk for bdk_visual_init,
	bdk_events_init, bdk_input_init, bdk_dnd_init, bdk_image_exit, 
	bdk_input_exit,	bdk_windowing_exit, bdk_event_func, bdk_event_data,
	bdk_event_notify, bdk_queued_events, bdk_queued_tail,
	bdk_event_new, bdk_events_queue, bdk_events_unqueue,
	bdk_event_queue_find_first, bdk_event_queue_remove_link,
	bdk_event_queue_append, bdk_event_button_generate,
	bdk_debug_flags, bdk_default_filters, bdk_parent_root.

	* bdk/x11/{bdkevents-x11.c, bdkglobals-x11.c, bdkimage-x11.c, 
	   bdkmain-x11.c, bdkprivate-x11.h, bdk/x11/bdkwindow-x11.c}:
	bdk => _bdk for bdk_event_mask_table, gkd_nevent_masks, 
	bdk_wm_window_protocols, bdk_leader_window, bdk_xgrab_window,
	bdk_use_xshm, bdk_input_ignore_core.

	* bdk/x11/xsettings-common.h (xsettings_list_insert): Add
	#defines to namespace functions into the private _bdk_ 
	namespace.

	* bdk/bdkwindow.[ch] bdk/x11/bdkx.h: Add bdk_get_default_root_window ()
	to replace bdk_parent_root exported variable. Adjust and
	deprecate BDK_ROOT_PARENT().

	* demos/{testpixbuf-drawable.c,testpixbuf-save.c}: Fix
	BDK_ROOT_PARENT usage, remove includes of port-specific
	headers.

	* bdk/{win32,x11,fb}/bdkinput*.[ch]: s/bdk/_bdk/ for 
	_bdk_input_gxid_host, _bdk_input_gxid_port, _bdk_input_ignore_core, 
	bdk_input_devices, _bdk_input_windows, bdk_init_input_core.

	* bdk/x11/{bdkevents-x11.,c bdkglobals-x11.c, bdkmain-x11.c}
	docs/Changes-2.0.txt: Remove bdk_wm_protocols, 
	bdk_wm_delete_window functions, bdk_wm_take_focus, 
	use bdk_atom_intern() instead.

	* bdk/linux-fb/{bdkselection-fb.c, bdkmain-fb.c, bdkprivatefb.h}
	  bdk/win32/{bdkselection-win32.c, bdkmbdkwin32.h, bdkprivate-win32.h} 
	  bdk/x11/{bdkselection-x11.c bdkx.h, btkprivate-x11.h}
	  btk/btkselection.c 
        Unexport bdk_selection_property, just use 
	bdk_atom_intern ("BDK_SELECTION").

	* bdk/x11/{bdkprivate-x11.h,bdkdrawable-x11h,bdkgc-x11.c,bdkx.h}: 
	Unexport bdk_drawable_impl_x11_get_type, bdk_gc_x11_get_type, 
	BDK_GC_X11 cast macros, BdkGCX11 structures, BdkCursorPrivate, 
	BdkVisualprivate, bdk_x11_gc_flush.

      Make a number of public exports of variables into functions
      to increase encapsulation.

	* bdk/bdkinternals.h bdk/bdkinput.h bdk/bdkevents.h 
	bdk/linux-fb/bdkmouse-fb.c: bdk_core_pointer => _bdk_core_pointer, 
	move to bdkinternals.h. Add bdk_device_get_core_pointer ().	

	* bdk/bdkprivate.h bdk/bdkbango.c bdk/bdkinternals.h
	docs/Changes-2.0.txt: Unexport bdk_parent_root, bdk_error_code, 
	bdk_error_warnings.

	* bdk/x11/{bdkcolormap-x11.c, bdkmain-x11.c, bdkx.h}
	  docs/Changes-2.0.txt: 
	s/bdk_screen/_bdk_screen/, add bdk_x11_get_default_screen()
	s/bdk_root_window/_bdk_root_window/, add bdk_x11_get_default_root_xwindow()
	Add bdk_x11_get_default_xdisplay().

	* bdk/bdk.h bdk/bdk.c linux-fb/bdkfb.h linux-fb/bdkglobals-fb.c 
	win32/bdkwin32.h x11/bdkglobals-x11.c bdk/x11/bdkmain-x11.c 
	bdk/x11/bdkx.h: bdk/bdk.def: Add bdk_get/set_program_class, 
	Don't export bdk_progclass, move --class command line
	option and handling to common portion of BDK.

      Miscellaneous fixes:

	* bdk/x11/bdkwindow-x11.c (bdk_window_set_icon_list): Fix
	g_return_val_if_fail that should have been g_return_if_fail.

	* bdk/bdkinternals.h bdk/bdkprivate.h: Move
	bdk_synthesize_window_state() to the semi-public bdkprivate.h.

	* btk/btkdnd.c (_btk_drag_source_handle_event): Remove uneeded
	X11 dependency.

	* bdk/linux-fb/bdkmain-fb.c bdk/win32/bdkmain-win32.c bdk/TODO: 
	Remove unused bdk_key_repeat_disable/restore.

	* linux-fb/bdkglobals-fb.c win32/bdkglobals-win32.c 
	x11/bdkglobals-x11.c x11/bdkprivate-x11.h bdk/bdk.def:
	Remove unused bdk_null_window_warnings variable.

	* bdk/Makefile.am (DIST_SUBDIRS) nanox/*: cvs remove nanox;
	it can be retrieved from the repository; it is too far
	from functional to be worth having people check out;
	it would be easier to start from scratch, I suspect.

	* bdk/x11/bdkpixmap-x11.c: Fix lvalue usage of BDK_PIXMAP_XID().

	* bdk/x11/bdkkeys-x11.c bdk/bdkrgb.c bdk/bdkwindow.c 
	bdk/x11/bdkbango-x11.c bdk/x11/bdkselection-x11.c: 
	Fix some accidentally global variables and unused global variables.

	* bdk/x11/bdkkeys-x11.c bdk/bdkrgb.c bdk/bdkwindow.c 
	bdk/x11/bdkbango-x11.c bdk/x11/bdkselection-x11.c: 
	Fix some accidentally global variables and unused global variables.

      Add some space for future expansion to multihead.

	* bdk/bdkdrawable.h: Add four reserved function pointers
	for future expansion of BdkDrawableClass.

	* btk/btkwindow.h btk/btkinvisible.h: Add reserved pointer
	where we can put a BdkScreen * later.

2001-09-07  Havoc Pennington  <hp@redhat.com>

	* btk/btktextview.c (btk_text_view_flush_scroll): update
	adjustments after validating destination yrange; fixes #53918
	(This may cause other issues, but I hope it won't)
	
2001-09-05  Havoc Pennington  <hp@redhat.com>

	* btk/btktextbtree.c (_btk_text_btree_delete): when merging end
	line into start line, update the character counts in parent nodes; 
	caused a bug when end and start line had different parent nodes.

2001-08-30  Havoc Pennington  <hp@redhat.com>
	
	* btk/btktexttag.c (_btk_text_attributes_fill_from_tags): add
	assertion that tag is in a table

Fri Sep  7 12:48:56 2001  Matthias Clasen  <matthiasc@poet.de>

	* bdk/x11/bdkkeys-x11.c (get_direction): Don't call
	g_strcasecmp on NULL strings. (#59058)

2001-09-06  Alex Larsson  <alexl@redhat.com>

	* btk/btkbin.c:
	* btk/btkfontsel.c:
	* btk/btkspinbutton.c:
	* btk/btktipsquery.c:
	Use BtkType/GType instead of uint.

Tue Sep  4 18:13:43 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkliststore.c (btk_list_store_init): fix initial val for
	sort column.

	* btk/btktreestore.c (btk_list_store_init): ditto

	* btk/btktreesortable.c: add docs.

Tue Sep  4 09:37:19 2001  Owen Taylor  <otaylor@redhat.com>

	* Version 1.3.7

	* configure.in docs/Makefile.am docs/btk-config.1.in: Remove 
	docs for btk-config

	* modules/input/Makefile.am (install-data-local): Don't
	run btk-query-immodules if DESTDIR is set.

	* NEWS: Various additions.

Tue Sep  4 03:12:25 2001  Tim Janik  <timj@btk.org>

	* NEWS: updates for 1.3.7 release.

Mon Sep  3 18:03:56 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreestore.c (btk_tree_store_set_default_sort_func):
	handle default sort feature

	* btk/btktreesortable.c (btk_tree_sortable_set_default_sort_func):
	new function to handle default sort.
	(btk_tree_sortable_has_default_sort_func): check if default sort
	is set.

	* btk/btkliststore.c (btk_list_store_set_default_sort_func): 
	handle default sort feature

Sun Sep  2 20:32:36 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_scroll_to_cell): patch from
	vishnu@pobox.com (Joshua N Pritikin) to fix math and an assertion,
	#59731

Sun Sep  2 17:38:42 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_deleted): Patch from
	vishnu@pobox.com (Joshua N Pritikin) to emit signal at the correct
	time, #59727

	* btk/btkbutton.c (btk_button_update_state): Get depressed
	correctly.

Sun Sep  2 21:41:21 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkkeys-x11.c (update_keymaps): Set current serial
	so that we don't eternally update the keymap after we
	get a change notification.

	* btk/btkmenuitem.c (btk_menu_item_set_right_justified): Fix
	incorrect cast.

Sun Sep  2 23:27:16 2001  Kristian Rietveld  <kristian@planet.nl>

	* btk/btktreemodelsort.[ch]: much changes in an attempt to make
	it working. It mostly works now, although there're still a few issues
	to be worked out.

	* tests/testtreesort.c (main): changes to have a better test
	application for the BtkTreeModelSort.

Sun Sep  2 23:19:07 2001  Kristian Rietveld  <kristian@planet.nl>

	* btk/btktreeview.c (btk_tree_view_search_iter): code cleaup,
	fix for bug #59222.

	* btk/btktreeview.c (btk_tree_view_search_equal_func): add
	gpointer search_data argument to function definition and
	prototype, to match BtkTreeViewSearchEqualFunc typedef.

Sat Sep  1 21:57:27 2001  Kristian Rietveld  <kristian@planet.nl>

	* btk/btkrbtree.c (_btk_rbtree_reorder): add warnings
	per jrb's request.

Fri Aug 31 20:01:23 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_search_iter): pass in user data.

	* btk/btktreeview.c (btk_tree_view_destroy): destroy search_data.

Wed Aug 29 20:40:58 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btktextbuffer.[ch] (btk_text_buffer_add/remove_selection_clipboard): 
	Instead of always mirroring the selection to a single PRIMARY
	selection, allow it to be mirrored to any number of clipboards.

	* btk/btktextbuffer.[ch] (btk_text_buffer_paste_primary): Remove, 
	just use btk_text_buffer_paste_clipboard with the appropriate clipboard.

	* btk/btktextbuffer.[ch] (btk_text_buffer_cut/copy/paste_clipboard): Add a
	BtkClipboard argument, and for paste_clipboard, the
	@override_location argument from @paste_primary.

	* btk/btktextview.c: Adapt to above change.
	
2001-08-30  Havoc Pennington  <hp@redhat.com>

	* btk/btktextview.c (invalidated_handler): put validate idle at
	resize - 2 just for flexibility

2001-08-30  Havoc Pennington  <hp@redhat.com>

	* btk/btktextdisplay.c (render_layout_line): handle NULL shaped
	object from the empty-child-anchor case by drawing a little box.
	
	* btk/btktextlayout.c (add_child_attrs): Still set shape attribute
	if the child anchor has no anchored widgets - fixes #59328.

	Also, remove bizarre deletion of preedit string that seems to have
	gotten in here somehow.

2001-08-30  Havoc Pennington  <hp@redhat.com>

	* btk/btktextview.c (btk_text_view_check_cursor_blink): apply fix
	to #58420 from Hidetoshi Tajima and Matthias Clasen

Wed Aug 29 17:28:04 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkcellrenderertoggle.c (btk_cell_renderer_toggle_render):
	change color when the BtkTreeView loses focus.

	* btk/btkcellrenderertext.c (btk_cell_renderer_text_render):
	ditto.
	
	* btk/btkstyle.c (btk_default_draw_flat_box): ditto

2001-08-28  Havoc Pennington  <hp@pobox.com>

	* btk/btkwindow.c (btk_window_set_icon_list): fix g_object_notify

2001-08-28  Havoc Pennington  <hp@pobox.com>

	* demos/btk-demo/main.c (setup_default_icon): add default icon

	* btk/btkradiobutton.c (btk_radio_button_new_with_mnemonic):
	warning fix
	(btk_radio_button_new_with_label): warning fix

	* btk/btkdnd.c: used some random BtkImage private structs, 
	update to reflect BtkImage changes

	* bdk/x11/bdkwindow-x11.c (bdk_window_set_icon_list): don't check
	whether the hint is supported, just always set the icon. A task
	list might want to use it even if the WM doesn't, and the WM may
	change over time. Also, XDeleteProperty() if list == NULL.

	* btk/btkwindow.c (btk_window_set_icon_list)
	(btk_window_get_icon_list)
	(btk_window_set_icon)
	(btk_window_get_icon)
	(btk_window_set_default_icon_list)
	(btk_window_get_default_icon_list):
	new functions

	* btk/btk-boxed.defs (BtkIconSet): add BtkIconSet

	* btk/btkimage.c: Implement property support, bug #59408

	* btk/btkcontainer.c (btk_container_add): make the warning message
	on reparent-without-removing-first a bit more helpful.
	Let's just destroy this FAQ.

Tue Aug 28 21:37:11 2001  Matthias Clasen  <matthiasc@poet.de>

	* demos/btk-demo/appwindow.c (do_appwindow): Use g_signal_connect_object
	instead of btk_signal_connect, to avoid warnings at destruction time. (#58161)

Tue Aug 28 21:00:44 2001  Matthias Clasen  <matthiasc@poet.de>

	* btk/btkprogressbar.c (btk_progress_bar_set_text): Move the setting
	of use_text_format to the end of the function. (#56447)

Tue Aug 28 20:06:07 2001  Matthias Clasen  <matthiasc@poet.de>

	* demos/testpixbuf.c (update_timeout): Use bdk_pixbuf_loader_get_pixbuf
	only in response to an area_prepared signal.

2001-08-28  Alex Larsson  <alexl@redhat.com>

	* btk/btkwidget.c (btk_widget_class_init):
	Make unrealize BTK_RUN_LAST.

Mon Aug 27 22:00:41 2001 Manish Singh <yosh@gimp.org>

	* btk/btkradiobutton.c: fix silly cut'n'paste error,
	with_label and with_mnemonic should create radio buttons, not
	check buttons

Mon Aug 27 15:28:56 2001  Jonathan Blandford  <jrb@redhat.com>

	* tests/testtreefocus.c (main): Fix to use BtkSelectionMode.
	* tests/treestoretest.c (make_window): ditto
	* demos/btk-demo/main.c (create_tree): ditto
	* demos/btk-demo/stock_browser.c (do_stock_browser): ditto.

Mon Aug 27 15:18:14 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeselection.c (btk_tree_selection_set_mode): Use the
	BTK selection types rather than BtkTreeSelectionMode.

	* docs/Changes-2.0: Add comment about selection change.

Mon Aug 27 14:21:30 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkenums.h (BtkSelectionMode): deprecate
	BTK_SELECTION_EXTENDED.

	* btk/btkclist.c: Remove old BTK_SELECTION_MULTIPLE behavior.
	Make BTK_SELECTION_EXTENDED be BTK_SELECTION_MULTIPLE.

	* btk/btkctree.c: ditto

	* btk/btklist.c: ditto

	* btk/btktree.c: ditto

Mon Aug 27 14:18:12 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmenubar.h (btk_menu_bar_prepend): Fix a cuple
	of typos in compat macros. (#59624, Skip Montaro)

Sun Aug 26 20:00:00 2001  Owen Taylor  <otaylor@redhat.com>

	* configure.in acinclude.m4: Use autoconf 2.13/2.50 compat
	macro.

	 (patch from ERDI Gergo  <cactus@cactus.rulez.org>, #58920)
 
 	* btk/btkmenuitem.c (btk_menu_item_set_right_justified): Change
	interface to be a standard setter from btk_menu_item_right_justify.
 	(btk_menu_item_get_right_justified): a getter to go with the setter

	* btk/btkmenuitem.h: Add a deprecated compat macro for
	btk_menu_item_right_justify.

	* demos/btk-demo/menus.c tests/testbtk.c: Switch to 
	btk_menu_item_set_right_justified.
 
2001-08-27  Jens Finke <jens@bunny.org>

	* btk+.spec.in: Updated to match gpp requirements, reworked the
	files section to make it work with 1.3.x releases.

2001-08-26  Alexander Larsson  <alla@lysator.liu.se>

	* btk/btkbutton.[ch]:
	Add properties for labels, mnemonics and stock items.
	Added C accessor functions for the properties.
	Removed deprecated button->child.

	* btk/btkradiobutton.c:
	* btk/btktogglebutton.c:
	Update to use the functions in BtkButton.

	* btk/btkcheckbutton.c:
	Update to use the functions in BtkButton.
	Changed size allocation of child. Now only gets as much
	space as it requests.

	* btk/btkclist.c:
	Don't use BtkButton->child

	* btk/btklabel.c:
	Fixed typo in docs
	
2001-08-26  Alexander Larsson  <alla@lysator.liu.se>

	* tests/testbtk.c:
	* tests/Makefile.am:
	Ressurect the properties test.
	I don't care if it is inferior, I just want to test my property code.

2001-08-25  Chema Celorio  <chema@celorio.com>

	* btk/btktable.c (btk_table_set_child_property): pass ->nrows to
	btk_table_resize as the first argument for CHILD_PROP_RIGHT_ATTACH
	and CHILD_PROP_LEFT_ATTACH v.s. using ->ncols

2001-08-24  Havoc Pennington  <hp@pobox.com>

	* btk/btkcompat.h: remove btk_menu_* compat defines; 
	these are already in btkmenu.h, and the copies
	here were broken.

	Also, change BTK_DISABLE_COMPAT_H to BTK_DISABLE_DEPRECATED

	* bdk/bdkpixbuf-drawable.c (bdk_pixbuf_get_from_image):
	special-case bitmaps to allow no colormap
	(bitmap1): implement no-colormap bitmap-getting
	(bitmap1a): implement no-colormap bitmap-getting to pixbuf with
	alpha
	(rgb8): indentation
	(rgb1a, rgb1): change the way we read the data out of the image, 
	old way didn't seem to work quite right.

	I'm pretty sure a lot of the rgbconvert code is still broken.
	
	* btk/btkwindow.c (btk_window_move_resize): move hints comparison
	above position constraint (I really intended to do this before,
	don't know what's up with that)
	(btk_XParseGeometry): shut up gcc

	* bdk/bdkpixbuf-drawable.c (rgb1a): fix bug where "x1" was used
	and "0" should have been. remove the attempted 4-bytes-at-once
	optimization, it was totally broken.

Sat Aug 25 19:02:39 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkbutton.[ch] btk/btktogglebutton.c: Add optional movement
	on push to buttons (based on patch from Soeren Sandmann, #54720)

	  - Add child_displacement_x/y style properties to control how far the
	    child moves when the button is depressed.

	  - Add non-exported function _btk_button_set_depressed to clean
	    up the handling of the in/out shadow and separate it frmo
	    widget->state.

	  - Lots of code cleanup and simplification of state handling
	    for BtkButton/BtkToggleButton.
 
        * tests/testbtkrc: Set the x/y displacement to 1 to provide a test
        of button movement. testbtk + testbtkrc == test ugly BTK+, as always. 	

Fri Aug 24 23:09:05 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkimage.[ch] docs/Changes-2.0.txt: Break compatibility 
	and make btk_image_new() take no arguments. The compiler will
	catch it, and it is vastly more useful than having
	btk_image_new() be a deprecated alias for btk_image_new_from_image().  

	* btk/btkmenu.c (btk_menu_set_property): Apply patch
	to add tearoff-title property (#51319, Lee Mallabone)

Fri Aug 24 22:12:32 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmenuitem.[ch]: Remove unused and useless function
	btk_menu_item_configure(). (#58925)

Fri Aug 24 16:03:45 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_scroll_to_cell): Add
	"use_align" to give people the option to just make a cell visible.

	* btk/btktreeview.c (btk_tree_view_scroll_to_point): fix bug where
	we were scrolling past the end of the tree.

	* btk/btktreeviewcolumn.c (btk_tree_view_column_pack_start):
	rename btk_tree_view_column_pack_start_cell_renderer to
	btk_tree_view_column_pack_start.  Same for pack_end, and clear.

Fri Aug 24 12:02:08 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btktextbuffer.c (btk_text_buffer_new): Remove
	a stray g_object_ref() left over from btk_object_ref/sink.
	(Pointed out by Josh Pritikin.)

Thu Aug 23 19:33:54 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkcontainer.[ch]: Rename btk_container_children()
	to btk_container_get_children. Added deprecated compatibility
	macro. (Suggested by Vitaly Tishkov, #59051)

	* btk/btktoolbar.c btkdialog.c: Fix btk_container_children()
	calls.

Thu Aug 23 19:10:01 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmenubar.h (btk_menu_bar_insert): Deprecate 
	btk_menu_bar_append/prepend/insert, forgot to do this
	when we deprecated btk_menu_append/prepend/insert.

	* btk/btkmenu.h (btk_menu_insert): Add casts to deprecated
	compat macros.

	* btk/btkmenu.c: Fix problem with static btk_menu_insert() being
	renamed by compat macro.

	* btk/btkfontsel.h: Deprecated btk_font_selection_get_font(),
	btk_font_selection_dialog_get_font(). (Suggested by
	Vitaly Tishkov, #59383)

Thu Aug 23 18:23:31 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btktexttag.c (btk_text_tag_table_get_size): 
	Rename from btk_text_tag_table_size(). (#59366)

Thu Aug 23 20:01:41 2001  Kristian Rietveld  <kristian@planet.nl>

	* btk/btktreemodelsort.[ch], btk/btktreesortable.[ch],
	btk/btktreestore.[ch], btk/btktreeviewcolumn.[ch],
	btk/btkliststore.[ch]: use BtkSortType instead of BtkTreeSortOrder.
	(#59173).

Thu Aug 23 16:26:47 2001  Tim Janik  <timj@btk.org>

	* btk/btktreeviewcolumn.c (btk_tree_view_column_finalize): 
	* btk/btktextmark.c (btk_text_mark_finalize): chain parent class
	handlers, pointed out by Joshua N Pritikin <vishnu@pobox.com>.

Wed Aug 22 19:15:39 2001  Owen Taylor  <otaylor@redhat.com>

	[ Patch from Sebastian Wilhelmi, 52790 ]

	* btk/btkversion.h.in btk/btk.h: New file replacing btkcompat.h

	* bdk/bdkcompat.h bdk/bdk*.h btk/btkcompat.h.in btk/btk*.h: 
	Move compatibility macros from g[dt]kcompat.h to within 
	#ifndef G[DT]K_DISABLE_DEPRECATED in each file.

	* bdk/bdk-pixbuf-csource.c: Fix up include of btkcompat.h.

	* demos/Makefile.am demos/btk-demo/Makefile.am 
	  docs/reference/bdk-pixbuf/Makefile.am modules/input/Makefile.am
	  tests/Makefile.am: Remove references to -G[DT]K_DISABLE_DEPRECATED.

	* demos/{pixbuf-demo.c,testpixbuf-drawable.c,testpixbuf-save.c,
	         testpixbuf.c}: Fix usages of deprecated functions.

Wed Aug 22 19:03:27 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_set_model): clean up selection
	when changing models.

Wed Aug 22 18:25:46 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c: Fix selection.  I think it's all dandy now.
	We check the current event for modifiers rather than try to trap
	all presses.

2001-08-22  Anders Carlsson  <andersca@gnu.org>

	* btk/btkliststore.h (BTK_LIST_STORE_CLASS): Fix a small typo.
	It's LIST_STORE, not LISTSTORE.

Tue Aug 21 12:43:29 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btk.h: Remove commented out btkpacker reference.

2001-08-21  Matthias Clasen  <matthiasc@waldgeist.poet.de>

	* configure.in (all_loaders): Add tga loader, 
	patch by Nicola Girardi. (#56067)

Tue Aug 21 02:57:13 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_button_press): Fix up selection
	a little.  More needs to be done tomorrow.

Tue Aug 21 00:45:55 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_destroy): Grr... Get it right.

Mon Aug 20 23:48:18 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_get_cell_area): Fix bug
	reported by Kristian Rietveld <kristian@planet.nl> to handle row
	== NULL.
	(btk_tree_view_destroy): Fix bug reported by Kristian Rietveld
	<kristian@planet.nl> to change destroy order.

Mon Aug 20 11:39:44 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeselection.c (btk_tree_selection_class_init): Use
	correct marshaller.

Sun Aug 19 03:22:59 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkliststore.c: Fix up warnings, #58928.

	* btk/btktreeselection.h: Change signal prototype, #58647

	* btk/btktreeview.c (_bdk_tree_view_find_node): Make more robust,
	#59221.

	* btk/btkstyle.c: Actually prelight arrow, #50981
	
2001-08-18  Hans Breuer  <hans@breuer.org>

	* bdk/bdk.def : updated externals

	* bdk/win32/bdkselection-win32.c : returning TRUE with bdk_selection_set
	is required to get (at least) visible in entry fields. Some selections
	are really handled now - even on win32 - but copying via middle
	mouse button into a different app needs to wait ... 

	* bdk/win32/bdkdnd-win32.c : implemented inter-app drag&drop
	mostly by stealling code from bdkdnd-fb.c. Thanks to who ever wrote it!

	* bdk/win32/bdkevents-win32.c : some tweaking to get better expose
	handling. I'm not sure if it is better now, but at least not worse

	* bdk/win32/bdkgeometry-win32.c : replaced every call to MoveWindow
	with SetWindowPos () which allows more fine-tuning backing-store wise

	* bdk/win32/bdkwindow-win32.c : allow unraised bdk_window_show ().
	Also changed move/resize to be more like the X version.

	* btk/btk.def : updated externals

2001-08-19  Sven Neumann  <sven@gimp.org>

	* btk/btktooltips.c
	* tests/testtreesort.c
	* tests/treestoretest.c: inserted some casts to get rid of compiler
	warnings.

Sun Aug 19 01:44:44 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeviewcolumn.c
	(btk_tree_view_column_pack_{start,end}_cell_renderer): sink cell.

	* btk/btktreeview.c (btk_tree_view_insert_column): sink column.
	(_btk_tree_view_find_node): If *node is NULL,
	*tree should be NULL too.

	* demos/btk-demo/stock_browser.c (do_stock_browser): don't unref
	column/renderers.
	* tests/testtreecolumns.c: ditto
	* tests/testtreefocus.c: ditto
	* tests/testtreesort.c: ditto
	* tests/testtreeview.c: ditto
	* tests/treestoretest.c: ditto

Sat Aug 18 04:34:31 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkcellrenderer.c (btk_cell_renderer_class_init): 2 new
	signals; is_expander/is_expanded.

	* btk/gtlcellrendererpixbuf.c: Allow other expanded and closed
	pixbufs.

	* btk/btktreeview.c: set above properties.

Sat Aug 18 23:01:33 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.h: Really remove set_default_style().

	* docs/Changes-2.0.txt: added a note about
	btk_widget_push/pop/set_default_style.

2001-08-18  Havoc Pennington  <hp@pobox.com>

	* btk/btkwindow.c (btk_window_move_resize): constrain position on
	hints_changed in addition to the other cases.
	(btk_window_move_resize): include last position from configure
	notify in debug spew

2001-08-18  James Henstridge  <james@daa.com.au>

	* btk/btkaccelgroup.c (btk_accel_group_object_destroy): use the
	second argument to the weak ref notify, cleaning up some uglyness.
	(btk_accel_group_attach): remove and add the weak notifier when
	changing the accel groups slist.
	(btk_accel_group_detach): same here.

2001-08-17  Darin Adler  <darin@bentspoon.com>

	* btk/btktreeview.c: (btk_tree_view_search_equal_func): Add
	missing parameters to utf8 functions to make it compile.

Fri Aug 17 19:30:14 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeprivate.h:
	* btk/btktreeview.c: (btk_tree_view_class_init),
	(btk_tree_view_init), (btk_tree_view_set_property),
	(btk_tree_view_get_property), (btk_tree_view_destroy),
	(btk_tree_view_key_press), (btk_tree_view_leave_notify),
	(btk_tree_view_focus_out), (btk_tree_view_set_model),
	(btk_tree_view_set_destroy_count_func),
	(btk_tree_view_set_enable_search),
	(btk_tree_view_get_enable_search),
	(btk_tree_view_get_search_column),
	(btk_tree_view_set_search_column),
	(btk_tree_view_get_search_equal_func),
	(btk_tree_view_set_search_equal_func),
	(btk_tree_view_search_dialog_destroy),
	(btk_tree_view_search_position_func),
	(btk_tree_view_interactive_search),
	(btk_tree_view_search_delete_event),
	(btk_tree_view_search_button_press_event),
	(btk_tree_view_search_key_press_event),
	(btk_tree_view_search_move), (btk_tree_view_search_equal_func),
	(btk_tree_view_search_iter), (btk_tree_view_search_init):
	* btk/btktreeview.h:
	Add heavily modified patch from Kristian Rietveld to handle
	interactive searching.

Fri Aug 17 17:30:34 2001  Tim Janik  <timj@btk.org>

	* btk/btktreemodel.c (btk_tree_path_new_from_string): const correct
	string parameter.

	* btk/btkoptionmenu.c (btk_option_menu_set_menu): connect to
	BtkMenuShell::selection_done, now that we have it, instead of 
	::deactivate so we're not tearing the menu apart and notify
	the user prematurely.

Thu Aug 16 05:22:01 2001  Tim Janik  <timj@btk.org>

	* btk/btkwindow.c (btk_window_move_resize): if we actually move our
	window, clear window->need_default_position to avoid infinite loops.
	some comment fixups and BTK_RESIZE_IMMEDIATE fixups.

Wed Aug 15 12:36:55 2001  Tim Janik  <timj@btk.org>

	* btk/btktreeview.c (btk_tree_view_set_model): move all model setup
	code into this place. get rid of BTK_TREE_VIEW_MODEL_SETUP usage.
	(btk_tree_view_set_property): don't cast possible NULL objects.
	(btk_tree_view_destroy): reset the model to NULL.

	* btk/btktreeselection.c (btk_tree_selection_finalize): chain
	parent_class handler.

2001-08-17  Matthias Clasen  <matthiasc@waldgeist.poet.de>

	* btk/demos/btk-demo/*: Remove all uses of deprecated functions.

2001-08-17  Anders Carlsson  <andersca@gnu.org>

	* btk/btkstyle.c (create_expander_affine): Divide with floating
	point numbers so that the result will be floating point.

2001-08-16  Matthias Clasen  <matthiasc@waldgeist.poet.de>

	* tests/testbtk.c (create_handle_box): 
	(create_toolbar): Replace btk_window_set_policy calls by
	btk_window_set_resizable.

2001-08-16  Jakub Steiner <jimmac@ximian.com>

	* btk/stock-icons/dialog_info.png: new style bulb
	* btk/stock-icons/dialog_error.png: maybe a little drastic ;)
	* btk/stock-icons/dialog_warning.png: need a hand?
	* btk/stock-icons/stock_add.png, stock_remove.png: I hope 
	  the aa border gets chopped off ok
	* btk/stock-icons/stock_colorselector.png: using the new hand
	* btk/stock-icons/stock_dnd_multiple.png: I'm not totally sure what 
	  this one is for, but the old icon was butt ugly.
	* btk/stock-icons/stock*_insert_image.png: not sure if it belongs here
	* btk/stock-icons/stock*_insert_object.png: "
	* btk/stock-icons/stock_index.png: using new hand icon
	* btk/stock-icons/stock*_new.png: the document template being used 
	  elsewhere too
	* btk/stock-icons/stock*_print*.png: new print and print preview 
	  icons (panel/menu)  
	* btk/stock-icons/stock*_save*.png, stock*_revert.png: new save/revert 
	  icons based on Tuomas' floppy image.
	* btk/stock-icons/stock*_search*.png: search and s'n'r icons for panel/menu
	* btk/stock-icons/stock*_stop.png: replacing the old 'x' button
	* btk/stock-icons/stock*_trash.png: based on Tuomas' trash icon
	* btk/stock-icons/stock*_undelete.png: "
	* btk/stock-icons/stock_preferences.png: I have a version with a 
	  document base if the sliders are no good.
	* btk/stock-icons/stock_properties.png: properties 
	

	* btk/stock-icons/stock*_copy.png, stock*_cut.png, stock*_paste.png: Tuomas' 
	  (tigert@ximian.com) clipboard icons
	* btk/stock-icons/stock_{up,down,left,right}_arrow.png: tigert's new arrows
	* btk/stock-icons/stock*_{undo,redo}.png: tigert's undo/redo icons.
	* btk/stock-icons/stock_open.png: shaded open icon by Tuomas. we should make it a
	  little bigger IMHO

2001-08-16  Sven Neumann  <sven@gimp.org>

	* btk/btkbox.c (btk_box_class_init): removed unused widget_class.

2001-08-15  Padraig O'Briain  <padraig.obriain@sun.com>

	* btk/btkcellrenderertext.c:
	Avoid warning when specifying NULL for "attributes" property

2001-08-15  Matthias Clasen  <matthiasc@waldgeist.poet.de>

	* docs/debugging.txt: Add a warning about --enable-debug=no,
	some editorial changes.

2001-08-13  Matthias Clasen  <matthiasc@waldgeist.poet.de>

	* btk/docs/debugging.txt, bdk/bdk.c, bdk/bdkinternals.h, 
	bdk/x11/bdkmain-x11.c, btk/btkdebug.h, btk/btkmain.c: Update 
	debugging info, remove unused debug flags. (#58330)

Mon Aug 13 13:17:32 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeselection.c (btk_tree_selection_select_all): 
	(btk_tree_selection_select_all): Remove strict checking for rows.

2001-08-13  Matthias Clasen  <matthiasc@waldgeist.poet.de>
	
	* btk/btktooltips.c (btk_tooltips_set_tip, btk_tooltips_draw_tips): 
	Don't remove the tooltip window when the tip text changes. (#15891)

Sun Aug 12 12:02:09 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/Makefile.am ($(srcdir)/btkmarshal.c): Remove extra
	$(srcdir).

Sun Aug 12 10:39:12 2001  Owen Taylor  <otaylor@redhat.com>

	* Makefile.am (EXTRA_DIST): Fix problem with trying to
	dist files from intl/, which is no longer there.

2001-08-11  Hans Breuer  <hans@breuer.org>

	* btk/btkalignment.c, btk/btkarrow.c, btk/btkaspectframe.c,
	  btk/btkcellrenderer.c, btk/btkcellrenderertext.c, 
	  btk/btkcombo.c, btk/btkcurve.c, btk/btkfontsel.c, 
	  btk/btklayout.c, btk/btkmisc.c, btk/btkpacker.c, 
	  btk/btkprogress.c, btk/btkruler.c,, btk/btksettings.c,
	  btk/btkspinbutton.c, btk/btktexttag.c : coalescing property notifies

	* btk/btkclist.c, btk/btktipsquery.c, btk/btktexttag.c,
	  btk/btkwidget.c : added G_SIGNAL_TYPE_STATIC_SCOPE to all
	BDK_TYPE_EVENT signals

	* btk/btkalignment.c : removed 'direct allocation bug',
	which Tim discovered while reading the patch

Sat Aug 11 14:32:14 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.h (btk_widget_set_default_visual): Add some
	compat macros for push/pop/set_visual that were supposed
	to be added a long time ago, but got dropped. 

Fri Aug 10 16:55:53 2001  Tim Janik  <timj@btk.org>

	* btk/btkwindow.c (btk_window_set_policy): coalesce multiple
	property notifies.

2001-08-07  Havoc Pennington  <hp@pobox.com>

	* btk/btkfilesel.c (open_ref_dir): fix a typo.

	* btk/btkplug.c (btk_plug_init): remove setting of auto_shrink;
	some fixage is needed here, but nothing simple. Owen understands
	it. ;-)

        * btk/btkwindow.h, btk/btkwindow.c: Rework code and API for window
	sizing and positioning.  Also, fix bug in compute_geometry_hints
	(width/height confusion for setting min size). 
	(btk_window_move): new function
	(btk_window_resize): new function
	(btk_window_get_size): new function
	(btk_window_get_position): new function
	(btk_window_parse_geometry): new function
	
 	* btk/btkwidget.c (btk_widget_set_size_request): new function
 	(btk_widget_get_size_request): new function
 	(btk_widget_get_usize): delete, that was a short-lived function
 	;-)
 	(btk_widget_set_usize): deprecate
 	(btk_widget_set_uposition): deprecate, make it a trivial 
	btk_window_move() wrapper
	(btk_widget_class_init): remove x/y/width/height properties,
	add width_request height_request
	
        * demos/*: update to avoid deprecated functions
	
	* btk/btklayout.c: add x/y child properties

	* btk/btkfixed.c: add x/y child properties, and get rid of 
	uses of "gint16"

	* tests/testbtk.c (create_window_sizing): lots of tweaks to window
	sizing test

	* bdk/x11/bdkevents-x11.c (bdk_event_translate): Ensure that
	configure events on toplevel windows are always in root window
	coordinates, following ICCCM spec that all synthetic events 
	are in root window coords already, while real events are 
	in parent window coords. Previously the code assumed that 
	coords of 0,0 were parent window coords, which was 
	really broken.
  
 	* btk/btkcontainer.c (btk_container_get_focus_chain): fix
 	warning
 
 	* bdk/bdkwindow.h (BdkWindowHints): add BDK_HINT_USER_POS 
 	and BDK_HINT_USER_SIZE so we can set USSize and USPosition 
 	hints in btk_window_parse_geometry()
 
 	* bdk/x11/bdkwindow-x11.c (bdk_window_set_geometry_hints): support
 	new USER_POS USER_SIZE hints 	

2001-08-09  Matthias Clasen  <matthiasc@waldgeist.poet.de>

	* tests/prop-editor.c (properties_from_type): Use 
	g_object_class_list_properties to get the param specs 
	for a given type. (#58609)

2001-08-09  Matthias Clasen  <matthiasc@waldgeist.poet.de>

	* btk/btkstyle.c (btk_style_real_unrealize): Don't forget to
	free the text_aa parts. (#57549)

2001-08-09  Matthias Clasen  <matthiasc@waldgeist.poet.de>

	* bdk/bdkgc.c (bdk_gc_set_rgb_bg_color): Set the background color,
	not the foreground color. (#57621)

2001-08-09  Alexander Larsson <alexl@redhat.com>

	* bdk/win32/bdkfont-win32.c:
	Update to the new bango win32 api.

2001-08-08  HideToshi Tajima  <tajima@eng.sun.com>

	* btk/btkclipboard.c (request_text_received_func): ask apps for
	COMPOUND_TEXT instead of TEXT
	* bdk/x11/bdkselection-x11.c (bdk_utf8_to_compound_text): correctly
	interpret the return value of g_string_to_compound_text()
	(#55152)

2001-08-08  Matthias Clasen  <matthiasc@waldgeist.poet.de>

	* btk/btktreestore.c (btk_tree_store_iter_n_children): Don't
	fail if iter is NULL. (#58347)

2001-08-07  Matthias Clasen  <matthiasc@waldgeist.poet.de>

	* btk/btktextdisplay.c (render_para, btk_text_layout_draw): Fix
	some off-by-one issues, fixing selection of line-ends. (#50323)

2001-08-07  Matthias Clasen  <matthiasc@waldgeist.poet.de>

	* btk/btkhsv.c (btk_hsv_map, btk_hsv_unmap): Reinstate these
	functions in order to make mouse operation work again in the
	color wheel. (#58604)

2001-08-07  James Henstridge  <james@daa.com.au>

	* btk/btkaccellabel.c (btk_accel_label_set_accel_object): refetch
	the accelerator when the accel object is changed.  Fixes bug
	#58628.

2001-08-06  HideToshi Tajima  <tajima@eng.sun.com>

	* modules/input/btkimcontextxim.c (mb_to_utf8), xim_text_to_utf8):
	Skip g_convert when to_codeset and from_codeset are both 'UTF-8'
	(bunny bugzilla #58202)

2001-08-06  Havoc Pennington  <hp@pobox.com>
 
 	* bdk/x11/bdkimage-x11.c (_bdk_x11_get_image): The whole 
 	BDK_IS_WINDOW() branch of this was a bit screwed up, because 
 	it was expecting a BdkWindow, not a BdkWindowImplX11.
 
 	Also, we were getting the window rect in screen coords 
 	and the screen rect in window coords then intersecting 
 	them; instead, get window rect in window coords.
 
 	Finally, there were codepaths that resulted in a stuck server grab
 	(when the window was fully onscreen, or on bdk_image_new()
 	failure); make the server ungrab thing a bit more
 	robust/consistent.

2001-08-06  Sven Neumann  <sven@gimp.org>

	* bdk/bdkbango.c (bdk_bango_context_destroy): 
	check if info->colormap != NULL before unref'ing it. It might have
	been set to NULL using bdk_bango_context_set_colormap().

Sun Aug  5 11:24:27 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkcolorsel.c (btk_color_selection_set_current_alpha): 
	Fix conversion from float to int so that we don't get
	skew in the int => float => int roundtrip. 
	(#58120, reported by Vitaly Tishkov). Also fix problem
	where if no alpha was set, the returned alpha
	from (say) set_current_alpha() was returned as 1, not 65535.

Sun Aug  5 09:48:08 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btklist.c (btk_list_clear_items): Fix
	problem with selecting a new focus child.

	* btk/btklist.c (btk_list_clear_items): Clear 
	list->undo/list_focus_child after unparenting
	child, since unparenting the child can result
	in list->last_focus_child being set. (#58024)

	* Makefile.am (SUBDIRS): Add target specific pc
	files to DISTCLEANFILES.

	* btk/Makefile.am: add @BTK_DEBUG_FLAGS@
	(58327, Matthias Clasen)

Sat Aug  4 19:28:21 2001  Owen Taylor  <otaylor@redhat.com>

	* tests/testbtk.c: Patch from Hans (with various modifications),
	to add the ability to use testbtk as a rough-and-ready
	benchmark. Try, 'testbtk --bench all:5' (if you want decent
	numbers, run without a window manager)

2001-08-04 Alexander Larsson <alexl@redhat.com>

	* bdk/win32/bdkinput.c:
	Add #ifdef HAVE_WINTAB around wintab.h include.

	* btk/btk.def:
	Removed marshals that have been moved to bunnylib.
	Commented out plug and socket. They didn't compile for me 
	on win32.

2001-08-04  Hans Breuer  <hans@breuer.org>

	* btk/stocks-icons/makefile.msc : new file
	* btk/makefile.msc.in : use it

	* btk/btkstyle.c : not all platforms do provide M_PI and
	friends, but luckily there is G_PI

	* btk/btk.def : updated

	* bdk/win32/bdkwindow.c (bdk_window_new) : don't make all TEMP 
	windows WS_POPUP, but only those without a parent. This fixes the 
	mis-alignment between the selectable (temp, input only) window and 
	the window text of BtkLabel.

	(bdk_window_show) : respect private->state when actually showing
	the window.

	(bdk_window_set_transient_for) : Implementation from Wolfgang 
	Sourdeau <wolfgang@contre.com> ported to 2.0 and added some 
	error handling. Should fix #50586.

	* bdk/win32/bdkevents-win32.c : beautify log output

2001-08-04  Michael Natterer  <mitch@gimp.org>

	* btk/btkitemfactory.c (btk_item_factory_create_item):
	Need to show the image after adding it to the BtkImageMenuItem.
	This used to work without in testbtk because of the
	btk_widget_show_all() at the end of the function.
	(Closes #54978).

Tue Jul 31 22:59:33 2001  Tim Janik  <timj@btk.org>

	* btk/btknotebook.c (btk_notebook_get_child_property): 
	(btk_notebook_set_child_property): fix finding of child's page,
	since we have to validly deal with labels and menus here as well.
	(btk_notebook_get_child_property): fix warning.
	(btk_notebook_class_init): property tab_pack is of type
	BTK_TYPE_PACK_TYPE (enum) not boolean.
	(btk_notebook_find_child): don't always warn, we might be looking
	for a label or menu child.
	(btk_notebook_map): fix mapping of panel.

	* btk/btkwidget.c (btk_widget_set_child_visible): always constrain
	widget's mapped state, regardless of the value being set equals
	old settings, since things like REALIZED(parent) or MAPPED(parent)
	may have changed since the old value was set. make it an error to
	invoke this function on a toplevel widget.

2001-07-31  Darin Adler  <darin@bentspoon.com>

	* bdk/bdkprivate.h:
	* bdk/x11/bdkx.h:
	Put all mentions of BdkFont inside #ifndef BDK_DISABLE_DEPRECATED.

	* demos/btk-demo/menus.c: (do_menus): Cast to G_OBJECT, not
	BTK_OBJECT.

Tue Jul 31 15:34:57 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_remove_column): Whoops.  Stupid
	scoping error pointed out by matthiasc@poet.de.

2001-07-31  Sven Neumann  <sven@gimp.org>

	* demos/btk-demo/appwindow.c
	* demos/btk-demo/item_factory.c
	* tests/testbtk.c: btk_accel_group_attach() takes a GObject.

Mon Jul 30 10:49:16 PDT 2001 Suresh Chandrasekharan <suresh.chandrasekharan@sun.com>

	* btk/btksignal.h (btk_signal_handler_pending): corrected the wrong
	argument order for g_signal_has_handler_pending.

Sun Jul 29 17:14:01 2001  Tim Janik  <timj@btk.org>

	* btk/btkitemfactory.c (btk_item_factory_parse_rc): use g_file_test()
	instead of long deprecated g_scanner_stat_mode().

2001-07-29  Hans Breuer  <hans@breuer.org>

	* bdk/makefile.msc : build in the backend dir after
	auto-generating files

	* bdk/win32/bdkfont-win32.c (bdk_font_load) : reimplement
	with code from win32-production-branch.

	*  bdk/win32/bdkwindow-win32.c : set the private->destroyed flag
	before calling DestroyWindow, which indirectly calls 
	bdk_window_destroy_notify ()

	(performance patch merged from win32-production-branch)
	* bdk/win32/bdkdrawable-win32.c (bdk_win32_draw_segments): 
	Use PatBlt() instead of LineTo() when possible (solid single-pixel pen, 
	R2_COPYPEN rop). It is claimed to be much faster.

Fri Jul 27 11:31:15 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkcellrenderertext.c (btk_cell_renderer_text_get_property):
	add an "attributes" property to the text renderer for BATK.

2001-07-26  Alex Larsson  <alexl@redhat.com>

	* bdk/linux-fb/bdkimage-fb.c (_bdk_fb_get_image):
	Initialize image->bits_per_pixel from the drawable, not from
	the root window.

	* bdk/linux-fb/bdkdrawable-fb2.c (bdk_fb_get_depth):
	Fix cast. argument is an IMPL already.

2001-07-15  James Henstridge  <james@daa.com.au>

	* btk/btkwindow.c (btk_window_add_accel_group): cast to GObject.
	(btk_window_remove_accel_group): same here.
	(btk_window_key_press_event): same here.

	* btk/btkwidget.c (btk_widget_add_accelerator): cast to GObject.
	(btk_widget_remove_accelerator): same here.
	(btk_widget_remove_accelerators): same here.

	* btk/btkplug.c (btk_plug_accel_entries_changed): same here.

	* btk/btkmenushell.c (btk_menu_shell_key_press): cast to GObject
	instead of BtkObject.

	* btk/btkmenu.c (btk_menu_key_press): update since BtkAccelGroup
	now takes GObjects.

	* btk/btkitemfactory.c (btk_item_factory_propagate_accelerator):
	pass a GObject to btk_accel_group_entries_from_object.
	(btk_item_factory_create_item): s/accel_widget/accel_object/

	* btk/btk-boxed.defs: remove BtkAccelGroup boxed def.

	* btk/btkaccellabel.c: convert to handle GObject accel objects.

	* btk/btkaccellabel.h: fix header to reflect that arbitrary
	GObjects can have accelerators set now.  Add compatibility
	defines.

	* btk/btkmarshal.list: add missing marshallers.

	* btk/btkaccelgroup.[ch]: convert to a GObject, and allow setting
	accelerators on plain GObjects.  btk_accel_group_object_destroy
	has been converted into a weak reference, and
	btk_accel_group_delete_entries is now a destroy notify for that
	piece of data.

2001-07-23  Ron Steinke  <rsteinke@w-link.net>

	* bdk/bdkdraw.c: Added a check on the colormap depth to
	bdk_drawable_set_colormap()
	* bdk/x11/bdkimage-x11.c: combination of Matthias Clasen's
	patch to fix colorsel and my patch to fix bdk_drawable_get_image()
	for pixmaps without visuals (more specifically, bitmaps)
	* bdk/x11/bdkpixmap-x11.c: Fixed bdk_pixmap_new() so it
	doesn't set a colormap with the wrong depth


2001-07-22  Anders Carlsson  <andersca@bunny.org>

	* btk/btktreeview.c (btk_tree_view_class_init): Replace the
	expander_height and expander_width properties with a single
	property, expander_size.
	(btk_tree_view_init): Set the tab_offset to expander_size
	plus some padding.
	(btk_tree_view_unrealize): Remove the expand/collapse
	timeout if it exists.
	(coords_are_over_arrow): Fix a small bug.
	(btk_tree_view_motion_draw_column_motion_arrow): Use
	expander_size.
	(btk_tree_view_draw_focus): Use "treeview" instead of
	"add-mode" as detail when drawing the focus.
	(btk_tree_view_bin_expose): Use "treeview-drop-indicator"
	instead of "add-mode" as detail when drawing the focus.
	(btk_tree_view_deleted): If we have a node currently being
	expanded or collapsed, remove the timeout and set the node 
	to NULL.
	(btk_tree_view_queue_draw_arrow): New function that just
	redraws the arrow of a node.
	(btk_tree_view_draw_arrow): Use expander_size instead of
	expander_width/expander_height, also pass a different
	expander_style to btk_paint_expander depending on the 
	state of the node being drawn.
	(expand_collapse_timeout): New function for expanding 
	or collapsing a node depending on the previous state.
	(btk_tree_view_real_expand_row): Add timeout and set 
	correct state for node being expanded.
	(btk_tree_view_real_collapse_row): Add timeout and set
	correct state for node being collapsed.

	* btk/btktreeprivate.h (struct _BtkTreeViewPrivate): Add
	information about the node currently being expanded or
	collapsed, and also a timeout id.

	* btk/btkstyle.h (struct _BtkStyleClass): Replace is_open
	with expander_style for draw_expander.

	* btk/btkstyle.c (btk_draw_expander): Replace is_open with
	expander_style.
	(create_expander_affine): New function for creating an 
	expander affine.
	(apply_affine_on_point): New function for applying an 
	affine to a point.
	(btk_default_draw_expander): Modified to take expander_style
	instead of is_open, and to draw the rectangle rotated differently
	depending on the expander style.
	(btk_paint_expander): Replace is_open with expander_style.

	* btk/btkrbtree.h: Add expander states to BtkRBNodeColor.

	* btk/btkenums.h: Add expander style enum.

2001-07-21  Jonas Borgstrm  <jonas@codefactory.se>

	* btk/btktreemodel.c (btk_tree_model_foreach): Check the return
	value from btk_tree_model_get_iter, the model might be empty.

2001-07-20  Hans Breuer  <hans@breuer.org>

	* bdk/win32/bdkinput-win32.c : bdk_device_get_history moved to
	bdk/bdkinput.c like the other backends

	* bdk/win32/bdkinput-win32.h :
	* bdk/win32/bdkinput.c :
	* bdk/win32/bdkvisual-win32.c :
	* bdk/win32/bdkwin32.h : mechanical adaption to BdkDevice and
	BdkVisual GObjectification. UNTESTED for pen-devices because
	I simply have none.

	* bdk/bdk.def :
	* btk/btk.def : updated externals

	* btk/btkiconfactory.c :
	* btk/btkoldeditable.c : GError *error needs to be initialized (= NULL) 
	before passing &error to functions to avoid strange crashes
	
	* btk/btkcontainer.c (btk_container_real_set_focus_child) : is static

	* btk/btkwidget.c (btk_widget_get_child_visible): use g_return_val_if_fail

	* btk/makefile.msc.in : updated

Thu Jul 19 15:35:32 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkscrolledwindow.c (btk_scrolled_window_set_vadjustment):
	Add property support. (#51858)

Thu Jul 19 14:56:33 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkaccellabel.c (btk_accel_label_class_init) 
	* btk/btkinputdialog.c (btk_input_dialog_set_key):
	Use Shift/Ctrl instead of Shft/Ctl. (#53807)

Thu Jul 19 11:41:00 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkcolorsel.c: Add propery support (roughly
	based on patch from Lee Mallabone, #51014)

	* btk/btkcolorsel.h: Mark btk_color_selection_set_update_policy as
	deprecated, since we already g_warning() on it.

Thu Jul 19 14:24:34 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkentry.c (btk_entry_set_positions): Fix
	typo that sometimes caused selection not to work properly.

	* btk/btkentry.c (btk_entry_grab_focus): Select text in
	entry when tabbing in. (#57743)
	
	* btk/btkentry.c (btk_entry_motion_notify): If the
	user drags up above or down below the entry, move
	to the end or the beginning of the entry. (Suggestion
	from Jay Cox, #50940)

	* btk/btkentry.c (btk_entry_move_cursor): If we have
	a current selection, then when moving by chars or
	words, move to the end of the selection rather than
	from entry->current_pos. (Suggestion from Jay Cox,
	#50942)
	
Thu Jul 19 12:14:28 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwindow.c (btk_window_set_decorated): Actualy
	set window->decorated. (Patch from Hidetoshi Tajima,
	#55846)

Sat Jul  7 02:50:14 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.c (btk_widget_set_parent): Enforce
	the widget/child realization/mapping invariants.

	* btk/btkwidget.[ch] btk/btkprivate.h: Add functions 
	btk_widget_[get/set]_child_visible() to control
	whether visible children of a mapped window are
	mapped.

	* docs/widget_system.txt: Updated for changes in
	container contract, and addition of BTK_CHILD_VISIBLE.

	* btk/btkcontainer.c: Add generic map()/unmap()
	functions that work for almost all containers.

	* btk/btknotebook.c btk/btkpacker.c: Use 
	btk_widget_set_child_visible() where necessary.

	* btk/*.c: Remove excess map(), unmap(), and 
	realization/mapping invariant enforcing code
	from many containers.

Wed Jul 18 19:51:45 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btktextview.c (btk_text_view_set_attributes_from_style): 
	Get the foreground color from 'text', nor 'fg'. (#57568)

Wed Jul 18 19:28:46 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/*.c: Patch from Matthias Clasen to remove remove
	all instances of g_return_if_fail (foo != NULL); that are
	immediately before a g_return_if_fail (BTK_IS_FOO (foo));
	since the second check catches the NULL anyways.

Wed Jul 18 18:23:05 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkbutton.c btk/btkentry.c btk/btkmenu.c btk/btktextview.c
	btktreeview.c: Fix idles and timeouts to be properly surrounded by 
	BDK_THREADS_ENTER()/LEAVE() pairs.

	* btk/btkdialog.c btk/btkclipboard.c: Surround calls
	to g_main_loop_run() with BDK_THREADS_LEAVE()/ENTER()
	pairs. (Problem found by M. Meeks)

2001-07-18  Darin Adler  <darin@bentspoon.com>

	* btk/btkiconfactory.c: (btk_icon_size_register): Reorder code so
	that we don't get a g_warning message every time we register a new
	icon size.

	* bdk/x11/bdkcolor-x11.c: (bdk_colormap_alloc1): Fix warning by
	using pixel variable of the correct type.
	
Fri Jul 13 15:33:32 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkwindow.[ch]: Add a function bdk_window_get_internal_paint_info(),
	so that using X functions on a BdkWindow is possible, if
	a little hairy.

	* bdk/bdkgc.c (bdk_gc_offset): Add a function to offset the clip
	and ts_origin of a GC, so that external parties can offset/restore
	a GC, when using bdk_window_get_internal_paint_info().

2001-07-17  Darin Adler  <darin@bentspoon.com>

	* .cvsignore: Ignore the sgml directory made by btkdoc.
	* demos/pixbuf-demo.c: (main): Use btk_window_set_resizable
	instead of the deprecated btk_window_set_policy.
	* demos/testpixbuf-scale.c: Add missing <stdlib.h> include.
	* bdk/bdkkeys.c: (bdk_keymap_class_init): Remove empty finalize
	function to get rid of warning and some code too.
	* bdk/x11/bdkfont-x11.c: (bdk_font_charset_for_locale): Add
	missing const.
	* bdk/x11/bdkmain-x11.c: (_bdk_windowing_init_check): Remove
	unused local.
	* bdk/x11/bdkbango-x11.c: (bdk_bango_context_get): Add missing
	const.
	* bdk/x11/bdkselection-x11.c: (bdk_text_property_to_utf8_list),
	(bdk_utf8_to_compound_text): Add missing const.
	* btk/btkimage.c: (btk_image_expose): Remove unused local.
	* btk/btkmenubar.c: (btk_menu_bar_hierarchy_changed): Add missing
	cast and get rid of an unnecessary one.
	* btk/btksettings.c: (btk_settings_notify): Remove unused local.
	* btk/btkstatusbar.c: (btk_statusbar_size_allocate): Remove unused
	local.
	* btk/btktreemodelsort.c: (btk_tree_model_sort_build_level):
	Remove unused local.
	* modules/input/btkimcontextxim.c: (btk_im_context_xim_new): Add
	missing const.
	* tests/testsocket.c: (add_child): Add cast so the printf format
	doesn't make us implicitly depend on what integer type
	btk_socket_get_id returns.
	* tests/testtextbuffer.c: Add missing const.
	* tests/testtreefocus.c: (main): Remove unused local.
	* tests/treestoretest.c: (iter_remove): Remove unused local.
	(uppercase_value): Remove unused function.
	(make_window): Add statement to quiet the compiler's uninitialized
	variable warning.

Sat Jul 14 12:47:35 2001  Tim Janik  <timj@btk.org>

	* btk/btkrange.c:
	(second_timeout): 
	(initial_timeout): 
	(update_timeout): add BDK_THREADS_ENTER/BDK_THREADS_LEAVE.
	(btk_range_calc_layout): compute the new layout based on an
	adjustment->value being passed in as argument.
	(btk_range_button_press): for button2 slider warps, first recalc
	the layout, then adjust the value. also, use update_slider_position()
	for adjusting the value, so we keep pixel quantisation at which we
	usually operate (upon motion or button releases). the reason for this
	is that, we can't change the adjustment upon button2 presses to a non
	quantised value and upon button2 release re-quantise the value since
	that'd alter the value even if we didn't get any motion events (causing
	unexpected scroll area warps upon release and/or slider pixel-jitter).
	(btk_range_motion_notify): update the slider position from queried
	coordinates, not event coordinates.

Fri Jul 13 09:47:52 2001  Tim Janik  <timj@btk.org>

	* btk/btkstyle.c (btk_default_draw_focus): fix line style resetting,
	the default gc values are: width=0, CapBut, JoinMiter.

2001-07-13  Anders Carlsson  <andersca@codefactory.se>

	* btk/btkcellrendererpixbuf.c (btk_cell_renderer_pixbuf_render): Take
	into account the xpad and ypad when calculating the width and the
	height of the pixbuf cel.

Thu Jul 12 18:29:40 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkradiomenuitem.[ch] (btk_radio_menu_item_group): 
	Rename to btk_radio_menu_item_get_group(), add deprecated
	alias. (#57044)

	* btk/btkfilesel.c: Indentation fix.

Thu Jul 12 17:33:00 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkbbox.h btk/btkcompat.h: Patch from Mathias 
	Hasselmann to fix warnings in compat macros. 
	(#56773)

	* btk/btkmenubar.c (btk_menu_bar_hierarchy_changed): Fix 
	stupid wrong cast added in last patch.

Thu Jul 12 16:51:34 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.c: Replace a couple of inappropriate calls to 
	BTK_WIDGET_HAS_FOCUS() with btk_widget_is_focus(). (#57067)

Thu Jul 12 14:06:19 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmenubar.c (btk_menu_bar_hierarchy_changed): Add
	missing cast.

	* btk/btkcontainer.c (btk_container_get_focus_chain): Fix
	NULL/FALSE return value confusion.

	* btk/btkrange.c (coord_to_value): Fix division-by-zero
	problem when scrollbar completely fills range. (Patch
	from  Matthias Clasen, #57047)

Thu Jul 12 13:53:28 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkevents-x11.c (bdk_event_translate): Properly
	clean up when handling events for move-resize emulation.
	(Problem traced down by Matthias Clasen, #57271)

Thu Jul 12 13:43:27 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkclist.c btk/btkcolorsel.c btk/btkcombo.c
	  btk/btkctree.c btk/btkcurve.c btk/btkentry.c
	  btk/btkfontsel.c btk/btkhandlebox.c 
	  btk/btkimcontextsimple.c btk/btkmain.c btk/btkmenu.c
	  btk/btkmenuitem.c btk/btkoptionmenu.c btk/btkpixmap.c
	  btk/btkselection.c btk/btktextdisplay.c btk/btktextview.c
	  btk/btktooltips.c btk/btkwidget.c btk/btkwindow.c:
	Formatting fixes from multihead brnach. [ mostly foo(bar) => foo (bar) ]

2001-07-09  Peter Williams  <peterw@ximian.com>

	* btk/Makefile.am ($(srcdir)/stamp-btk.defs): Add a cd $(srcdir)
	for when srcdir != builddir

Mon Jul  9 12:50:51 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreemodel.c: remove btk_tree_model_get_first in favor of
	btk_tree_model_get_iter_root.

	* btk/btkliststore.c: Add a bunch of g_return statements.
	(btk_list_store_iter_n_children): Fix up.

	* btk/btktreestore.c: Add a bunch of g_return statements.

Fri Jul  6 15:38:33 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.c (btk_widget_class_init):
	G_SIGNAL_TYPE_STATIC_SCOPE BtkSelectionData to
	restore some workingness.

	* bdk/x11/bdkwindow-x11.c (bdk_window_new): Fix 
	handle of window type for input-only windows.

Thu Jul  5 21:53:46 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkbbox.[ch] btk/btkbox.[ch] btk/btk[hv]bbox.c:
	Patch from Gregory Merchan to add 
	btk_button_box_set_secondary(), which separates
	the child into a separate group from the normal
	buttons. (#56331)

	* btk/btkdialog.c: Make help buttons secondary by
	default.

	* btk/btkbbox.c: Added a child property "secondary".

	* btk/testbtk.c: Turn on the help button for the 
	color selector to check that it properly appears
	as secondary.

Mon Jul  2 01:09:37 2001  Owen Taylor  <otaylor@redhat.com>
 
 	* bdk/bdkwindow.[ch] bdk/bdkinternals.h bdk/x11/bdkwindow-x11.c
 	bdk/linux-fb/bdkwindow-fb.c bdk/x11/bdkwindow-x11.c bdk/bdk:
 	Add bdk_set_pointer_hooks() to allow pointer-querying to
 	be hooked by an event record/playback system like GERD.
	(#56914)
 	
Thu Jul  5 08:57:07 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.c (btk_widget_reset_rc_style): Pass
	in the right value of initial_emission to
	btk_widget_set_style_internal (#57091)

Wed Jul  4 23:17:04 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkdnd.c (btk_drag_dest_hierarchy_changed):
	Make compile.

	* btk/btkwidget.c (btk_widget_reset_rc_style): Fix problem
	with calling btk_widget_set_style_internal() with
	the old style, not the new style. (#56989)

Wed Jul  4 22:35:40 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btklabel.c btk/btkmenubar.c btk/btktreeviewcolumn.c
	  btk/btkwidget.c:
	Check BTK_WIDGET_TOPLEVEL(btk_widget_get_toplevel (widget)),
	not BTK_WIDGET_GET_ANCESTOR ... see 
	http://mail.bunny.org/archives/btk-devel-list/2001-July/msg00072.html.
	Indicate the best practice in the docs for btk_widget_get_toplevel().

	* btk/btkwidget.[ch]: Expose a private _btk_widget_hierarchy_changed(),
	so BtkPlug can give the correct signals when transforming
	from a child to a toplevel.
	
	* btk/btkdnd.c (btk_drag_dest_hierarchy_changed): Handle
	reparentation correctly.

	* btk/btkwidget.c (btk_widget_propagate_hierarchy_changed):
	Propagate the previous_toplevel argument down properly.

	* btk/btklabel.c (btk_label_finalize): Fix unrefing
	of wrong atr list.

	* btk/btkplug.[ch]: Add an "embedded" signal.

	* btk/btksocket.[ch]: Add "child_added", "child_removed"
	signals.

	* btk/btkplug.[ch] btk/btksocket.[ch]: Add 
	functions btk_plug_get_id(), btk_socket_get_id(),
	to avoid the user having to worry about realization,
	and bdkx.h.

	* tests/testsocket.c: Extend to try out the new signals
	and btk_plug/socket_get_id().

	* btk/btklabel.c (btk_label_set_pattern_internal): Fix
	setting of underline attributes.

	* bdk/x11/bdkevents-x11.c (bdk_event_translate): Ignore
	DestroyNotify events from SubstructureNotifyMask

	* bdk/x11/bdkwindow-x11.c (bdk_window_reparent):
	Switch BDK_WINDOW_TYPE (window) as needed.

	* bdk/x11/bdkwindow-x11.c (bdk_window_new): Clean up,
	allow creation of toplevel windows as children of
	foreign windows.

	* btk/btkplug.c: Remove hacks involving changing private
	fields of BdkWindow.

	* btk/btkplug.[ch] btk/btksocket.c: Work to make 
	exactly the same signals and notification
	be emitted for local embedding as for inter-process
	embedding.

2001-07-04  James Henstridge  <james@daa.com.au>

	* btk/btkliststore.h: add missing btk_list_store_newv prototype.

Mon Jul  2 16:53:25 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/xembed.h btk/btkplug.c btk/btksocket.c: For
	XEMBED embedding add a _XEMBED_INFO property to the
	client with version number and a "mapped" flags.
	Use the mapped flag instead of the racy MapRequestEvent

        * btk/btksocket.c: Clean up the btk_socket_steal()
	code to reliably set things (when the child is a passive
	embedder participating in the XEMBED protocol) intead
	of just being a hack for embedding non-participating
	programs. Fix various bugs and race conditions.
	
	* btk/btksocket.[ch] btk/btkplug.[ch]: Make local embedding
	work by simply making the BtkSocket the btk parent
	of the BtkPlug. Set a flag in this case and make
	the BtkPlug work like a normal container by overriding
	methods such as check_resize and "chaining past" BtkWindow
	to BtkBin.

 	* btk/btkentry.c (btk_entry_real_activate)
	  btk/btkmain.c (btk_propagate_event): 
 	Eliminate use of btk_widget_get_ancestor (widget, BTK_TYPE_WINDOW).
	
	* btk/btkwidget.c (btk_widget_get_toplevel,
	btk_widget_get_ancestor):
	Explain	why btk_widget_get_ancestor (widget, BTK_TYPE_WINDOW)
	might not give the expected result and recommend
	an alternative.

	* tests/testsocket.c tests/testsocket_child.c
	tests/testsocket_common.c tests/Makefile.am: Extended
	to test different type of adding plugs to sockets
	(local,active,passive),	and to test mapping/unmapping
	the plug.

 	* bdk/bdkwindow.c (_bdk_window_destroy_hierarchy): Don't
 	mark the window as destroyed until after we
 	called _bdk_windowing_window_destroy().
	(_bdk_windowing_window_destroy() may use BDK functions
	on the window.)

 	* bdk/x11/bdkinput.c: Remove the check for finalization - 
 	devices can be finalized under some circumnstances.
 
 	* bdk/x11/bdkinput-x11.c (bdk_input_device_new): Fix 
 	small problem with BDK_TYPE_DEVICE.
 
2001-07-02  Havoc Pennington  <hp@pobox.com>

	* bdk/x11/bdkwindow-x11.c (bdk_wmspec_change_state): fix to 
	use constants not atoms.

2001-07-02  James Henstridge  <james@daa.com.au>

	* btk/btktextview.c (btk_text_view_class_init): same here for
	BANGO_TYPE_TAB_ARRAY.

	* btk/btktexttag.c (btk_text_tag_class_init): same here, but also
	for BANGO_TYPE_TAB_ARRAY.

	* btk/btkcellrenderertext.c (btk_cell_renderer_text_class_init):
	s/BTK_TYPE_BANGO_FONT_DESCRIPTION/BANGO_TYPE_FONT_DESCRIPTION/

	* btk/btk-boxed.defs: move all the boxed definitions to the top of
	the file.  Remove Bango types from defs -- they are now defined in
	libbango.

Mon Jul  2 06:35:10 2001  Tim Janik  <timj@btk.org>

	* bdk/bdkkeys.c (bdk_keymap_class_init): s/signal_newc/signal_new/

	* btk/btkobject.c (btk_object_destroy): invoke
	g_object_run_dispose().

	* btk/btkwindow.c: 
	* btk/btkwidget.c: 
	* btk/btkobject.c:
	* btk/btklist.c: s/shutdown/dispose/ for the GObject
	method.

Sat Jun 30 20:44:48 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btktypeutils.c (btk_type_class): Remove
	change check for BTK_TYPE_OBJECT derivation to
	G_TYPE_OBJECTS - it's Tim-approved to use this 
	for arbitary objects.

	* btk/btkwindow.c btk/btkcontainer.[ch]: underscore
	prefix btk_container_dequeue_resize_handler().

	* btk/btkwidget.[ch]: Add a previous_toplevel argument
	to the hierarachy_changed signal, since you otherwise
	have to always keep that around.

	* btk/btkmenubar.c btk/btklabel.c btk/btksocket.c: Adapt
	for extra argument to hierarchy_changed.

Tue Jun 26 19:39:03 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.c (btk_widget_set_style): Allow %NULL
	for style to mean "revert to default style"

	* btk/btkwidget.[ch] (btk_widget_set_rc_style,
	  btk_widget_restore_default_style): Make this functions
	deprecated aliases for btk_widget_set_style (widget, NULL).

	* btk/btkwidget.[ch]: Remove:
	   btk_widget_set_default_style ()
	   btk_widget_push_style ()
	   btk_widget_pop_style ()
	These functions interact are overriden by RC files, and
	thus virtually useless, and complicated.

Fri Jun 22 18:49:48 2001  Owen Taylor  <otaylor@redhat.com>

        * btk/btkrc.c: Add a BtkRcContext structure to hold 
	most of the previous global variables in btkrc.c. This is
	in preparation for multi-head, since each screen can
	have different BtkSettings and RC information.

	* btk/btkrc.[ch]: 

	* btk/btkrc.h (struct _BtkRcStyleClass): Add a
	BtkSettings parameter to BtkRcStyle::parse.

	* bdk/x11/bdkevents-x11.c btk/btksettings.c btk/btkrc.c: 
	Add two new settings btk-theme-name, btk-key-theme-name,
	for RC files that are loaded by name after reading
	the default RC files.
	
	* btk/btkrc.c: Allow priorities for styles, as wll as
	bindings.

	* btk/btkenums.h btk/btkrc.c: Add BTK_PATH_PRIO_THEME,
	and use it by default for RC files loaded via 
	btk-theme-name, btk-key-theme-name.

	* btk/btkiconfactory.c (btk_icon_source_set_filename)
        btk/btkrc.c (btk_rc_parse_pixmap_path_string) 
	tests/testbtkrc: Require pathnames to be absolute.

	* btk/btkrc.c btk/btkiconfactory.c: Look up the full filename for
	the source when parsing, since the operation of looking up a
	pixmap from an RC file depends on the parsing context.

	* btk/btkrc.c (btk_rc_context_reparse_all): Automatically
	reset RC styles on all widgets when files are reparsed.

	* tests/testbtk.c (create_rc_file) 
	  btk/btkwindow.c (btk_window_read_rcfiles): 
	Simplify, now that btk_rc_reparse_all() resets styles on
	all widgets itself.

	* btk/btkmain.c (btk_get_default_language): Fix broken
	return value.

	* btk/btksettings.[ch] (btk_settings_install_property[_ch]): Remove
	BtkSettings argument.

	* btk/btksettings.[ch] (btk_settings_get_default): Rename from
	btk_settings_get_global().

	* btk/btkwidget.[ch]: Add a function btk_widget_Get_settings()
	to get the appropriate BtkSettings for a widget. (For now,
	just gets the default BtkSetttings.) 

	* btk/btkcolorsel.c btk/btkentry.c btk/btkmenu.c btk/btkmenubar.c
	  btk/btktextview.c btk/btktoolbar.c: Fixes for BtkSettings
        changes.

	* btk/btkrc.[ch]: Add btk_rc_get_style_by_paths() to allow
	getting a style for a path without actually having a widget.
	(Allows using a style for a subpart of a widget, for
	example.)

	* btk/btkrc.[ch]: Add btk_rc_reparse_all_for_setting() to allow forcing
	the RC files to be reloaded for just one BtkSettings
	(not sure how useful this really is.)

	* btk/btkrc.h: Deprecate
	btk_rc_add_widget_name/widget_class/class_style

2001-06-30  Alex Larsson  <alexl@redhat.com>

	* bdk/linux-fb/bdkinput-none.c:
	* bdk/linux-fb/bdkinput.c:
	* bdk/linux-fb/bdkinputprivate.h:
	Convert BdkDevice to a GObject.

	* linux-fb/bdkprivate-fb.h:
	* linux-fb/bdkvisual-fb.c:
	Convert BdkVisual to a GObject.

2001-06-29  Alex Larsson  <alexl@redhat.com>

	* bdk/bdkvisual.h:
	* bdk/bdkcolor.c:
	* bdk/x11/bdkx.h:
	* bdk/x11/bdkvisual-x11.c:
	Convert BdkVisual to a GObject.

	* bdk/bdkinput.h:
	* bdk/bdkevents.c:
	* bdk/x11/bdkinputprivate.h:
	* bdk/x11/bdkinput-gxi.c:
	* bdk/x11/bdkinput-none.c:
	* bdk/x11/bdkinput-x11.c:
	* bdk/x11/bdkinput-xfree.c:
	* bdk/x11/bdkinput.c:
	Convert BdkDevice to a GObject.

Fri Jun 29 22:13:28 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreestore.c (btk_tree_store_new): changed new_with_types
	to just plain new, fixing the number of columns, and column types
	at creation time.

	* btk/btkliststore.c (btk_list_store_new): ditto.

	* btk/btkcellrenderertext.c
	(btk_cell_renderer_text_set_fixed_height_from_font): FIX the
	height to a specific font.

	* btk/btktreeview.c (btk_tree_view_is_expander_column): fix brokenness.

	* tests/*c: change to work with new store models.

2001-06-29  Havoc Pennington  <hp@redhat.com>

       * Throughout: fixes to compile with G_DISABLE_COMPAT
	(s/g_signal_connectc/g_signal_connect/,
	s/g_signal_newc/g_signal_new/,
	s/g_signal_disconnect_by_func/g_signal_handlers_disconnect_by_func/)

Fri Jun 29 03:14:16 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeselection.c (btk_tree_selection_selected_foreach):
	add path argument to selection callbacks.

Fri Jun 29 00:13:34 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreemodel.c (btk_tree_model_foreach): New function to
	walk through a model in a depth first manner, with the option to
	break out.

Fri Jun  8 18:52:10 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.[hc]: Patch Thomas Broyer from
	<tbroyer@ltgt.net>. Expander arrows are now attached to a specific
	column and follow it when draged, rather than a location in the
	view. "expander_column" property and drawing functions changed
	accordingly.  Fixes bug #55942.

	(btk_tree_view_{set,get}_expander_column): Now works with a
	BtkTreeViewColumn* instead of int.

Thu Jun 28 22:53:18 2001  Owen Taylor  <otaylor@redhat.com>

	*  bdk/bdk.c btk/btktypeutils.c: Fix args to g_type_init(). 

2001-06-28  Havoc Pennington  <hp@pobox.com>

	* bdk/x11/bdkimage-x11.c (_bdk_x11_get_image): Clip the retrieved
	image data to the screen, using a server grab to avoid race
	conditions.

	* btk/btkitemfactory.c (btk_item_factory_create_item): remove 
	check for NULL return from btk_image_new_from_stock(), it never
	returns NULL.
	(btk_item_factory_create_item): fix bug where we parsed the stock
	ID as an inline pixbuf

	* btk/btktext.c (btk_text_key_press): numeric keypad support

	* btk/btkspinbutton.c (btk_spin_button_key_press): numeric keypad
	support (should be using binding set here)

	* btk/btkoptionmenu.c (btk_option_menu_key_press): numeric keypad
	support (should be using binding set here)

	* btk/btkmenushell.c (btk_menu_shell_class_init): numeric keypad 
	support

	* btk/btkmenu.c (btk_menu_class_init): numeric keypad support

	* btk/btkmenubar.c (btk_menu_bar_class_init): numeric keypad

	* btk/btklistitem.c (btk_list_item_class_init): numeric keypad

	* btk/btkimcontextsimple.c
	(btk_im_context_simple_filter_keypress): keypad

	* btk/btkfilesel.c (btk_file_selection_key_press): keypad 

	* btk/btkentry.c (btk_entry_class_init): numeric keypad fixes

	* btk/btkctree.c (btk_ctree_class_init): numeric keypad support

	* btk/btkcolorsel.c (palette_activate): keypad support (of course,
	should be binding-setted)

	* btk/btkwindow.c (btk_window_class_init): numeric keypad fixes

	* btk/btkclist.c (btk_clist_class_init): numeric keypad fixes

	* btk/btkcalendar.c: numeric keypad fixes

	* btk/btktextview.c (btk_text_view_class_init): numeric keypad
	support

	* bdk/bdkwindow.c (bdk_window_get_clip_rebunnyion): fix infinite loop
	screwup

	* bdk/bdkpixbuf-render.c (bdk_pixbuf_render_to_drawable_alpha): 
	clip the render area to the drawable's clip rebunnyion in advance,
	so we don't get data from the server that we don't need.

	* bdk/bdkpixbuf-render.c (bdk_pixbuf_render_to_drawable_alpha):
	check return value of bdk_pixbuf_get_from_drawable(), fall back 
	to bilevel alpha if we can't get the pixbuf to composite against.

	* bdk/bdkdraw.c (bdk_drawable_get_image): set the image colormap

	* bdk/bdkimage.c (bdk_image_get_colormap): add
	bdk_image_set_colormap, bdk_image_get_colormap

	* bdk/bdkpixbuf-drawable.c (rgbconvert): Change all converters to
	take a rebunnyion of the image, instead of converting the entire
	image.

	* btk/btkwidget.h (struct _BtkWidgetClass): add show_help
	keybinding signal. Add default bindings for it. Add default
	handler for show_help that shows the tooltip for the widget.

	* btk/btkdialog.c (btk_dialog_class_init): add binding set and
	"close" keybinding signal, remove key press handler.

	* btk/btktooltips.c (btk_tooltips_set_colors): Just remove this,
	it's not our usual practice to leave a deprecated function around
	with a runtime warning, plus we don't want it to appear in docs,
	plus if we make them yellow no one will want to change them
	anyhow.

Thu Jun 28 23:53:31 2001  Tim Janik  <timj@btk.org>

	* btk/btkwidget.c (btk_widget_hide): !BTK_OBJECT_DESTROYED() ->
	BTK_WIDGET_REALIZE() for resize queueing.

	* btk/btkmain.c (btk_main_do_event): !BTK_OBJECT_DESTROYED() ->
	BTK_WIDGET_REALIZE() for post event delivery destruction upon
	BDK_DESTROY.
	
	* btk/btkwidget.c: added BtkWidget::event-after notification signal, to
	sompensate for former (pre-2.0) connect_after() facility.
	(btk_widget_send_expose): 
	(btk_widget_event): assert the widget is realized, since event delivery
	to non-realized widgets is essentially a bug. event handlers should
	be able to unconditionally rely on widget->window (unless they
	emit events on their own which can trigger widget destruction).
	(btk_widget_event_internal): removed old outdated BTK_OBJECT_DESTROYED()
	logic. event delivery happens as follows:
	a) emission of BtkWidget::event (RUN_LAST handler). returns was_handled.
	b) if !was_handled in (a) and the widget is still realized, emit event-
	   specific signal (RUN_LAST handler). returns was_handled.
	c) emission of BtkWidget::event-after for notification if the widget is
	   still realized (regardless of was_handled from previous stages, no
	   class handler). no return value.
	d) was_handled gets passed on to caller, to determine further
	   propagation. if the widget got unrealized meanwhile, was_handled
	   is returned as TRUE.

	* bdk/bdkevents.[hc]: added bdk_event_get_root_coords() and
	bdk_event_get_coords().

Thu Jun 28 17:18:41 2001  Tim Janik  <timj@btk.org>

	* configure.in (BTK_MICRO_VERSION): up version to 1.3.7, interface
	age 0, binary age 0. depend on bunnylib 1.3.7.

	* btk/btkcontainer.c: remove g_signal_handlers_disconnect_by_func() hack.

	* btk/btkmenubar.c: same here.
	
	* btk/btkcontainer.c (btk_container_focus_tab): fix param-spec retrival.

	* btk/btkcolorsel.c (btk_color_selection_init): fix connect_data() usage.

	* btk/btkentry.c (btk_entry_focus_in): same here.
	
	* btk/btkmenubar.c (add_to_window): likewise.
	
	* btk/btktextbtree.c: and here...
	
	* btk/btktextview.c (btk_text_view_ensure_layout): same thing.
	
	* btk/btktoolbar.c (btk_toolbar_init): once more.
	
	* btk/btktreemodel.c (connect_ref_callbacks): and another time.
	
	* btk/btktreeviewcolumn.c:
	(_btk_tree_view_column_set_tree_view): yet again.

	* demos/btk-demo/images.c (progressive_timeout): demonstrate
	signal connections without g_signal_connect_data().
	
	* demos/btk-demo/stock_browser.c (do_stock_browser): second
	demo of the matter.
	
	* demos/testpixbuf.c (main): running out of equality phrases for the
	ChangeLog, but had to adapt connections here as well.
	
	* demos/testanimation.c (progressive_timeout): and for the fun of it,
	tackled this the same way.
	
	* tests/testtext.c (create_view): ok, it's becoming a pain at this
	point, but had enough enery for one more fix.

	* tests/testtreecolumns.c (main): stand up man, do your work!

	* tests/testtreeview.c (set_columns_type): ok, this is the last file i
	fix, either that's been all of it or CVS btk is broken yet again.
	
2001-06-29  James Henstridge  <james@daa.com.au>

	The following changes correspond to bug #56812

	* bdk/bdkinput.h, bdk/bdkevents.c (BDK_TYPE_DEVICE): register type
	code for BdkDevice.

	* bdk/bdkcursor.[ch] (BDK_TYPE_CURSOR): register type code for
	BdkCursor.

2001-06-19  Havoc Pennington  <hp@pobox.com>

	* bdk/x11/bdkwindow-x11.c (bdk_window_show_unraised): new function
	for mapping a window without fooling with stacking order, but
	updating the "withdrawn" flag

	* bdk/x11/bdkevents-x11.c (bdk_event_translate): Do event
	filtering as soon as possible, moving move resize and wmspec_check
	handling after the event filter.  Make default filter apply to all
	events, not just those with no BdkWindow wrapped around the X
	window. Fix a FIXME about how the window could be a pixmap using 
	RTTI; this of course assumes BDK_IS_WINDOW() is optimized. 

	Also, be robust against events not on a known BdkWindow.

	* bdk/x11/bdkmain-x11.c (bdk_x11_grab_server,
	bdk_x11_ungrab_server): export reference-counted server grabs, so
	other people can grab server over a BDK function that also does
	so.

Wed Jun 27 19:40:31 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeviewcolumn.c
	(btk_tree_view_column_pack_start_cell_renderer): New function to
	reflect that you can (hypothetically) pack cell renderers into a
	column.
	(btk_tree_view_column_pack_end_cell_renderer): ditto.
	(btk_tree_view_column_cell_is_visible): Move more functionality to
	the column.
	(btk_tree_view_column_cell_can_focus): Move more functionality to
	the column.

	* btk/btktreeview.c: Move to use new column-packing code.
	(btk_tree_view_real_expand_row): remove	totally braindead code.
	(btk_tree_view_real_collapse_row): ditto.

2001-06-27  Kjartan Maraas  <kmaraas@bunny.org>

	* btk/btktreeviewcolumn.c: Fix a typo.
	
2001-06-26  Joel Becker  <jlbec@evilplan.org>

	* bdk-pixbuf/bdk-pixbuf-csource.c: remove '#include "x"' line
	  at the end of the file

2001-06-26  Havoc Pennington  <hp@redhat.com>

	* btk/btkwindow.c (btk_window_set_policy): forgot a notification

2001-06-26  Havoc Pennington  <hp@redhat.com>

	* btk/btkwindow.c (btk_window_class_init): add "resizable"
	property

Tue Jun 26 12:59:28 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreemodelsort.c (btk_tree_model_sort_set_model): fix
	stupid missing statement

	* btk/btktreeview.c (btk_tree_view_set_destroy_count_func): New
	private function for BATK.  It notifies you of how many _visible_
	children are deleted when a node is deleted.  Should be used by
	batk only.

Tue Jun 26 11:06:34 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkclist.c btk/btkentry.c btk/btkspinbutton.c:
	Use new bango_context_get_metrics() to fix problems
	with font lists in descriptions. (#56184, reported by
	Jonas Borgstrm)

Tue Jun 26 10:04:30 2001  Tim Janik  <timj@btk.org>

	* btk/btkiconfactory.c:
	* btk/btkitemfactory.c: use bdk_pixbuf_new_from_stream(). fixed up
	item factory so inlined pixbufs actually work.

2001-06-25  Havoc Pennington  <hp@redhat.com>

	* btk/btktreeviewcolumn.h, btk/btktreeviewcolumn.c:
	s/RESIZEABLE/RESIZABLE/

	* btk/btkwindow.c, btk/btkwindow.h: s/resizeable/resizable/

2001-06-25  Alexander Larsson  <alexl@redhat.com>

	* configure.in:
	Added --enable-fbmanager. This is some experimental code
	that lets several BtkFB apps coordinate their access to the
	framebuffer.
	
	* acconfig.h:
	Added ENABLE_FB_MANAGER.

	* bdk/linux-fb/Makefile.am:
	Added bdkfbmanager and bdkfbswitch.

	* bdk/linux-fb/bdkkeyboard-fb.c:
	* bdk/linux-fb/bdkmouse-fb.c:
	* bdk/linux-fb/bdkprivate-fb.h:
	Split device init and open so that
	they can be opened and closed while switched
	away.

	* bdk/linux-fb/bdkmain-fb.c:
	Add the basic manager communication.

	* bdk/linux-fb/bdkrender-fb.c:
	Don't update to the shadow fb if we're
	blocked by the fb manager.

Sun Jun 24 22:15:16 2001  Owen Taylor  <otaylor@redhat.com>

	* docs/Changes-2.0.txt: Add note about child property
	changes.

Sun Jun 24 21:34:32 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkenums.h btk/btkiconfactory.c: Add a special size for
	drag-and-drop BTK_ICON_SIZE_DND (Default to 32x32)

	* btk/btkdnd.c (btk_drag_dest_set_target_list): Fix problem
	with un'reffing wrong list reported by Jeff Franks.

	* btk/btkdnd.[ch] (_btk_drag_{source,}dest_handle_event): _prefix.

	* btk/btkdnd.c (btk_drag_set_icon_default): Use BTK_STOCK_DND
	for the default icon. Remove inline XPM.

	* btk/btkstock.h btk/btkiconfactory.c:
	Add BTK_STOCK_DND BTK_STOCK_DND_MULTIPLE (Currently, stock_new
	is used for BTK_STOCK_DND, but it is a bit too small.)

	* btk/stock-icons/stock_dnd_multiple.png
	btk/stock-icons/Makefile.am: New stock icon moved from bunny-libs.

	* btk/btkdnd.c (btk_drag_source_event_cb): Only return
	TRUE when starting a drag. In other cases, we are
	just observing. (#52995)

	* btk/btkdnd.[ch] (btk_drag_set_icon_{stock,pixbuf}): Add 
	function to set the icon for a drag from a BdkPixbuf
	or stock ID.

	* btk/btkdnd.[ch] (btk_drag_source_set_icon_{stock,pixbuf}): 
	Likewise, for drag sources.

	* btk/btkdnd.h: Deprecate btk_drag_set_default_icon.
	(Now should be done using the stock system.)

Sun Jun 24 12:06:47 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btktextview.[ch] (btk_text_view_set_text_window_size): 
	Removed - didn't work and not particularly useful anyways
	if it did. 

Sun Jun 24 11:29:35 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkimage-x11.c (bdk_image_new): Fix stupid error
	introduced last night that was making things decidedly not work.

	* btk/*.[ch]: Patch from Kristian Rietveld adding 80 getters
	so that we have getter/setter pairing everywhere it makes
	sense. (#55767)

	* btk/btkradiobutton.[ch] btk/btktoolbar.c tests/testbtk.:
	Rename btk_radio_button_group to btk_radio_button_get_group, add a
	deprecated compat macro. (#55516)

	* btk/btklabel.[ch]: Add functions
	btk_label_set/get_use_underline(), btk_label_set/get_use_markup(),
	btk_label_set_label(), which mirror the property API for BtkLabel.
	Make btk_label_get_attributes() only reflect the attributes
	set by btk_label_set_attributes.

	* btk/btknotebook.c (btk_notebook_set_current_page) btk/btkcompat.h: Rename
	from btk_notebook_set_page().

Sat Jun 23 18:02:46 2001  Owen Taylor  <otaylor@redhat.com>

	* configure.in: Fix tests for XShm.h.

	* bdk/x11/bdkimage-x11.c: Cleanup error handling in
	bdk_image_new() by use of goto, properly use g_object_unref().

Sat Jun 23 22:03:20 2001  Tim Janik  <timj@btk.org>

	* bdk/x11/bdkimage-x11.c (bdk_image_init): disabled g_free (image)
	calls, as BdkImage is an object. these should be g_obejct_unref()
	instead but that won't work because of the g_error() statement
	in bdk_x11_image_destroy(). so for now, i did s/g_free/LEAK_IMAGE/
	to spot these places.

Sat Jun 23 10:27:53 2001  Owen Taylor  <otaylor@redhat.com>

	* modules/input/btkimcontextxim.c: Fixup some problems with 
	text length handling in error cases.

	* btk/btkwidget.c (btk_widget_size_allocate): Reorder
	a bit to make test actually warn on attempt to allocation
	a negative size. (#56101, Matthias Clasen)

Fri Jun 22 14:06:08 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_real_collapse_row): Fix bug
	noticed by Brian Cameron.
	(btk_tree_view_real_expand_row): Fix bug noticed by Brian
	Cameron.

2001-06-22  Hans Breuer  <hans@breuer.org>

	* bdk/bdk.def : updated externals

	* bdk/win32/bdkdrawable-win32.c : corrected some casts
	in BDK_NOTEs

	* bdk/win32/bdkevents-win32.c : use _bdk_windowing_window_get_offsets
	to translate coordinates to the internal > 16 bit system
	Try to handle WM_WINDOWPOSCHANGED to get better performance for
	when moving/resizing

	* bdk/win32/bdkkeys-win32.c : implement bdk_keymap_get_default ()
	and bdk_keymap_get_direction (). The latter is untested for
	the RTL case

	* btk/btk.def : updated externals

	* btk/btkmain.c : btk_get_default_language () should reurn the result
	from bango_language_from_string (), not an already freed pointer

	* btk/stock-icons/stock_menu_sort_ascending.png : PNGs need to be 
	binary (-kb) to be useable on windoze
 
2001-06-21  Alexander Larsson  <alexl@redhat.com>

	* bdk/linux-fb/bdkfont-fb.c (bdk_font_from_description): 
	Update to new BangoLanguage changes.
	
	* btk/btkwindow-decorate.c:
	* btk/btkwindow.[ch]:
	Added setting argument to btk_window_set_has_frame ()
	
Thu Jun 21 13:42:01 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkkeys-x11.c (bdk_keymap_get_direction): Handle
	the case without XKB properly.

	* btk/btkrc.c (btk_rc_set_default_files): Remove
	unused btk_rc_auto_parse variable.

	* btk/btkrc.[ch] btk/btkstyle.c docs/Changes-2.0.txt:
	Remove btk_rc_set_image_loader(), btk_rc_load_image(), no
	longer needed with BdkPixbuf.

	* btk/btkrc.c (_btk_rc_init): Make private.

Fri Jun 15 16:26:12 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkentry.h: Mark deprecated functions with
	BTK_DISABLE_DEPRECATED.

Mon Jun 11 18:15:16 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdk.h: Add missing bdk_rectangle_get_type() prototype.

	* btk/btk[hv]scale.c: Include math.h, stdlib.h

	* bdk/bdkbango.h btk/btkclist.c btk/btkentry.c btk/btkmain.[ch]
	  btk/btkspinbutton.c btk/btkstyle.c btk/btktextbuffer.c
	  btk/btktextdisplay.c btk/btktextiter.[ch]
	  btk/btktextlayout.c btk/btktexttag.[ch] btk/btkwidget.c: Adapt
	  to recent changes in Bango.

	* tests/testbtk.c: Set language tags with btk_label_set_markup()
	  to test whether the basic engine honors them.

Thu Jun 21 02:13:40 2001  Tim Janik  <timj@btk.org>

	* btk/btkcontainer.[hc]: added btk_container_child_set_property() and
	btk_container_child_get_property().

Wed Jun 20 19:19:15 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_move_cursor_up_down): clean up
	(btk_tree_view_move_cursor_page_up_down): implement.

Wed Jun 20 05:32:05 2001  Tim Janik  <timj@btk.org>

	* btk/btkspinbutton.c: make maximum digits compile time configurable
	via MAX_DIGITS and up to 20. 5 was just ridiculously small.
	don't use automatic fixed size buffer for printf-ing floats, doubles
 	can expand to really _huge_ strings, use g_strdup_printf() instead.

Wed Jun 20 04:28:24 2001  Tim Janik  <timj@btk.org>

	* btk/btkrange.c (btk_range_class_init): hum, "adjustment" was a
	construct property in 1.2 and still needs to be.

	* btk/btkwidget.c: "composite_child" is not a settable property.

Tue Jun 19 19:13:19 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkliststore.c (btk_list_store_clear): 
	* btk/btktreestore.c (btk_tree_store_clear): New functions to
	clear a model.

Mon Jun 18 02:00:49 2001  Tim Janik  <timj@btk.org>

	* btk/btkwidget.c (btk_widget_get_property): fix PROP_EVENTS.

	* btk/Makefile.am:
	* btk/btk.h: disabled BtkPacker compilation.

	* btk/btkarg.[hc], btk/btkargcollector.c: got rid of these.

	* btk/btknotebook.c:
	* btk/btktable.c:
	* btk/btkbox.c: ported this over to child properties.

	* btk/btksettings.c: fetch class properties via
	g_object_class_list_properties().

	* btk/btkcontainer.[hc]: implemented child properties, got rid of the
	child arg interface. use bobjectnotifyqueue.c for child property
	notification.

	* btk/btkwidget.[hc]: provide necessary means for container child
	properties, i.e. ::child_notify signal,
	btk_widget_freeze_child_notify(),
	btk_widget_child_notify(),
	btk_widget_thaw_child_notify().

	* tests/testbtk.c: removed inferior property handling code, for
	property editing, a generic module should be used, and GLE
	coincidentally fullfills that purpose.

	* docs/reference/Makefile.am: disabled btk docs building, btk-doc
	needs to be adapted to g_object_class_list_properties() before this
	builds again.

Mon Jun 18 20:06:10 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_row_expanded): New function to
	test if a node is expanded.

Mon Jun 18 19:41:38 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_real_collapse_row): Fix bug
	where collapsing a selected row would result in the cursor/anchor
	getting screwed up.

Fri Jun 15 18:53:48 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreesortable.c (btk_tree_sortable_set_sort_func): Rename
	btk_tree_sortable_sort_column_id_set_func.  It's much shorter now.
	* btk/btktreeview.c (btk_tree_view_sort_iter_changed): WOOO!!!
	Now I can really reorder/sort all Store widgets.  treesorttest
	seems to just work now.
	* btk/btklistview.c (btk_list_store_iter_changed): Whoops.
	testtreesort worked through a big coincidence all this time.
	* btk/btkrbtree.c (_btk_rbtree_reorder): Nasty bug fix in nasty
	code.
	* tests/testtreecolumns.c: Big 'ol warning at the top letting
	people know that this code should never ever ever be copied.

2001-06-15  Jonas Borgstrm  <jonas@codefactory.se>

	* btk/btkwindow.h: Fixed a small typo, it should be
	BTK_WINDOW_GROUP_GET_CLASS and not BTK_WINDOW_GET_CLASS
	on line 134.

2001-06-14  Havoc Pennington  <hp@redhat.com>

        Docs fixups, and:
	
	* btk/btkcompat.h: remove BTK_DISABLE_COMPAT_H, replace with
	BTK_DISABLE_DEPRECATED

Thu Jun 14 19:21:27 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreestore.c (btk_tree_store_sort_helper): Whoops.  Forgot
	this a couple months ago.  Now BtkTreeStore sort of sorts.  I'll
	finish it off tonight, though it basically works now when it's a
	list.  Also, I have a sinking feeling neither BtkTreeStore or
	BtkListStore actually resort when adding a new item.  I'll look
	into it.

2001-06-14  Havoc Pennington  <hp@redhat.com>

	* demos/btk-demo/main.c (load_file): fix bug identified by
	warnings I just added to btktextbuffer

2001-06-14  Havoc Pennington  <hp@redhat.com>

	* btk/btkwindow.c (window_group_cleanup_grabs): fix other typo

	* btk/btkwidget.c (btk_widget_propagate_state): fix typo

	* btk/btktextbtree.c: don't leak node data all over the place.

	* demos/btk-demo/main.c (main): create fontify tags for the right
	buffer

	* btk/btktextbuffer.c, btk/btktexttagtable.c: enhance docs
	to mention tags in the same table can't have the same name,
	suggested by Skip Montanaro

2001-06-11  Havoc Pennington  <hp@redhat.com>

	* btk/btktexttagtable.c (btk_text_tag_table_add): improve warning 
	for trying to add two tags with same name to the tag table

	* demos/btk-demo/main.c (main): fix colors ;-)

`Fri Jun  8 17:56:52 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwindow.[ch] btk/btkmain.c: Add a BtkWindowGroup struct
	that allows grouping together multiple windows so that grabs
	within that set of windows only affect those windows.

	* btk/btkmain.c btk/btkwidget.[ch]: Add a "grab_notify"
	signal for notification when a widget becomes shadowed
	by a grab or is no longer shadowed by a grab.

	* btk/btkwidget.c (btk_widget_propagate_state)
	  btk/btkmain.c: (btk_widget_grab_add): Don't allow
	insenstive widgets to maintain a grab.

2001-06-14  Alexander Larsson  <alexl@redhat.com>

        * docs/README.linux-fb:
	Add some example config files that can be used with the URW fonts.
	
	* bdk/linux-fb/bdkvisual-fb.c (bdk_visual_init): 
	Set up the color ramps for DirectColor mode.

2001-06-11  Havoc Pennington  <hp@redhat.com>

	* Release 1.3.6
	 
2001-06-13  Alexander Larsson  <alla@lysator.liu.se>

	* bdk/linux-fb/bdkwindow-fb.c:
	Unify shaped window code and make it repaint the area that used
	to be part of the shape, but isn't anymore.

2001-06-11  Havoc Pennington  <hp@redhat.com>

	* NEWS: Updates

	* configure.in (BTK_MINOR_VERSION): bump version to 1.3.6

	* btk/Makefile.am: bunnylib_genmarshal already contains top_builddir
	
2001-06-13  Alexander Larsson  <alla@lysator.liu.se>

	* bdk/linux-fb/bdkdnd-fb.c (bdk_drag_status):
	Don't pass on BDK_ACTION_DEFAULT. The Xdnd code
	passes zero instead, so do we.
	
2001-06-13  Alexander Larsson  <alla@lysator.liu.se>

	* bdk/linux-fb/bdkgc-fb.c (bdk_gc_copy):
	Deep copy dash_list too.
	(_bdk_fb_gc_new): Set default cap_style before
	setting values.

2001-06-12  Alexander Larsson  <alla@lysator.liu.se>

	* bdk/linux-fb/bdkkeyboard-fb.c (bdk_keymap_get_default,
	bdk_keymap_get_direction): New functions.

Tue Jun 12 12:41:27 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreemodel.h (BTK_TREE_MODEL_LIST_ONLY): further justify
	btk_tree_model_get_flags by adding a second flag for batk.

	* btk/btktreemodel.c: make cursor behavior interact better with
	mouse presses.

Mon Jun 11 12:43:08 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_class_init): changed
	expand_row/collapse_row to be 2 signals each -- test_expand_row
	and row_expanded as well as test_collapse_row and row_collapsed.

2001-06-10  Anders Carlsson  <andersca@codefactory.se>

	* demos/btk-demo/stock_browser.c (do_stock_browser): Update
	signal name to be changed instead of selection_changed.

2001-06-08  Havoc Pennington  <hp@redhat.com>

	* btk/btkentry.c (btk_entry_class_init): add read-only
	"scroll_offset" property for notification when the layout offsets
	may have changed
	(btk_entry_adjust_scroll): add notify for scroll_offset
	(btk_entry_layout_index_to_text_index): function to compensate for
	preedit string when doing coordinate stuff on the entry's layout
	(btk_entry_text_index_to_layout_index): inverse function
	(btk_entry_get_layout_offsets): hook to get current position of
	the layout	
	(btk_entry_get_layout): hook to get the layout itself.

	* btk/btklabel.c (btk_label_get_layout): new function

Fri Jun  8 19:49:29 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_real_select_cursor_row): New
	keybinding.
	(btk_tree_view_focus): Fix merge conflict.

Fri Jun  8 18:41:30 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_set_cursor): new function to
	clean up cursor handling.

2001-06-08  Havoc Pennington  <hp@redhat.com>

	* btk/btktextbuffer.c (btk_text_buffer_get_start_iter): added this
	function

	* btk/btktextview.c (btk_text_view_get_default_attributes): added
	this function

2001-06-08  Alex Larsson  <alexl@redhat.com>

	* btk/btkcompat.h.in:
	Added compat macros for all old BTK_TYPE_BDK_xxx types.
	Fixes bug #52892

2001-06-08  Havoc Pennington  <hp@redhat.com>
	
	* btk/btkhsv.h (struct _BtkHSVClass): had BtkContainerClass as
	parent still

2001-06-08  Havoc Pennington  <hp@redhat.com>

	* btk/btktextbuffer.c (btk_text_buffer_remove_all_tags): geez,
	don't call g_list funcs on GSList

	* btk/btkwidget.c (btk_widget_child_focus): replaces
	btk_container_focus(), since some widgets have focusable locations
	which are not other widgets. These widgets should not have to be 
	containers just to manage the focus. For example, BtkHSV is
	currently a container for no good reason. Also, this cleans
	up the "if (is_container && is_sensitive && is_drawable)
	container_focus ()" mess in widget implementations.

	* btk/btkcontainer.c (btk_container_focus): deprecate this
	function, and have it just call btk_widget_child_focus().

	* btk/btkhsv.c: derive from widget not container
	
	Throughout: fix to reflect BtkContainer::focus change
	
Fri Jun  8 12:38:49 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktable.c (btk_table_resize): warn if row/cols are out of
	range.  Fix bug #55921

	* btk/btkliststore.c (btk_list_store_new_with_types): fix doc bug
	(#55920).

Fri Jun  8 12:03:07 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkkeys.[ch]: Add a direction-changed signal,
	and bdk_keymap_get_current_direction().

	* bdk/x11/bdkevents-x11.c bdk/x11/bdkkeys-x11.c
	  bdk/x11/bdkmain-x11.c bdk/x11/bdkprivate-x11.h: Track
	the current locked group, use it to set the keymap
	direction.

	* btk/btksettings.c: Add a new btk-split-cursor setting
	to determine whether we draw a split cursor or use
	a jumping cursor based on the current direction.

	* btk/btkentry.c btk/btktextview.c btk/btktextlayout.[ch]:
	Obey the split cursor setting. 

Fri Jun  8 11:57:50 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkimmulticontext.c (activate_cb): Only activate
	when toggling on, not when toggling off... (#55906)

Wed Jun  6 10:37:07 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.c (btk_widget_set_double_buffered): 
	s/bdk_window_begin_paint/bdk_window_begin_paint_rebunnyion/
	in docs. (#55812, Vitaly Tishkov)

2001-06-08  Anders Carlsson  <andersca@codefactory.se>

	* demos/btk-demo/main.c (create_tree): Changed signal name from
	selection_changed to changed in signal connection to BtkTreeSelection,
	also used g_signal_connectc since BtkTreeSelection is now a GObject.

Thu Jun  7 18:25:42 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeselection.c: Now it's a GObject instead of a
	BtkObject.  The BtkTreeSelection::selection_changed signal is now
	the BtkTreeSelection::changed signal.

	* btk/btktreeview.c: Modified to deal with new BtkTreeSelection
	object.

	* tests/btktree*.c: Modified to deal with new BtkTreeSelection
	object.

2001-06-07  Havoc Pennington  <hp@redhat.com>

	* btk/Makefile.am: fix bunnylib-mkenums and bunnylib-genmarshal again

2001-06-07  Havoc Pennington  <hp@redhat.com>
	
	* btk/Makefile.am: fixups for bunnylib-mkenums and bunnylib-genmarshal
	(not tested yet because with absolute path to srcdir I can't build
	batk, but it was broken anyway so this may help)	

2001-06-07  Havoc Pennington  <hp@redhat.com>

	* configure.in: output m4macros/Makefile
	
Wed Jun  6 21:59:16 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_size_allocate): hook up arrow
	buttons.  Fixes #55460 reported by matthiasc@poet.de.

Wed Jun  6 21:18:54 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_real_collapse_row): centralize
	expansion/collapsing so it only happens in one place.
	(btk_tree_view_real_expand_row): ditto.

2001-06-07  Havoc Pennington  <hp@redhat.com>

	* tests/Makefile.am: add missing -I flag

	* btk/Makefile.am: use @BUNNYLIB_MKENUMS@, @BUNNYLIB_GENMARSHAL@, etc.

	* configure.in: use pkg-config to see if GModule is
	supported; fix to properly turn on included loaders 
	when GModule isn't supported; don't use AC_CHECK_LIB 
	when libs are not installed yet

	* autogen.sh: add support for AUTOGEN_SUBDIR_MODE

	* Makefile.am (SUBDIRS): add m4macros subdir

	* btk/Makefile.am: $(srcdir)/foo targets must be $(srcdir)/foo in
	dependencies also.

Wed Jun  6 19:31:11 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_set_model): fix silly bug
	reported by "Padraig O'Briain" <Padraig.Obriain@Sun.COM>.

Wed Jun  6 20:01:38 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c
	(btk_tree_view_real_expand_collapse_cursor_row): Handle key
	bindings to expand and collapse rows.
	(btk_tree_view_real_select_cursor_parent): New key binding.
	(btk_tree_view_real_toggle_cursor_row): New key binding.

	* btk/btkmarshal.list: new
	marshaller. (VOID__BOOLEAN_BOOLEAN_BOOLEAN)

2001-06-06  Havoc Pennington  <hp@redhat.com>

	* btk/btkrange.c (btk_range_class_init): add "inverted" property

	* btk/btkscale.c (btk_scale_class_init): Change Page Up and Page
	Down to move visually rather than logically, since it confuses 
	people. Add -/+ and Ctrl--/+ bindings for logical movement.

2001-06-06  Alex Larsson  <alexl@redhat.com>

	* bdk/linux-fb/bdkmain-fb.c (_bdk_windowing_init_check):
	Fix up error messages.

Wed Jun  6 10:34:42 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btktooltips.h: Include btkwidget.h 
	(#55798, Karl Nelson)

	* bdk/x11/bdkwindow-x11.c (utf8_is_latin1): 0xff is
	a valid latin-1 character. (Marc Lehmann, #35467)

	* bdk/x11/bdkwindow-x11.c: Fix minor typo in comment. 
	(Marc Lehmann, #35467)
	
2001-06-05  Alex Larsson  <alexl@redhat.com>

	* demos/btk-demo/appwindow.c (do_appwindow):
	Don't swap the order of the args to btk_widget_destroyed.

	* tests/testbtk.c (destroy_properties):
	Don't crash when the properties window is destroyed.

	* btk/btkimagemenuitem.c (btk_image_menu_item_new_from_stock):
	Use with_mnemonics to handle the case of stock items with
	underscores in them.

2001-06-05  Havoc Pennington  <hp@redhat.com>

	* btk/btktextiter.c (btk_text_iter_order): rename from 
	btk_text_iter_reorder

2001-06-05  Havoc Pennington  <hp@redhat.com>

	* btk/btktoolbar.c (btk_toolbar_remove_space): new function

2001-06-05  Havoc Pennington  <hp@redhat.com>

	* btk/btkspinbutton.c (btk_spin_button_set_range): clamp the value 
	to the range that was set

	* btk/btkrange.c: add value_changed signal, primarily 
	intended for use with BtkScale
	(btk_range_set_increments): new function
	(btk_range_set_range): new function with weird name
	(btk_range_set_value): new function
	(btk_range_get_value): new function

	* btk/btkspinbutton.c (btk_spin_button_get_value): rename 
	from btk_spin_button_get_value_as_float(). Compat #define
	added for get_value_as_float.

	* btk/btkhscale.c (btk_hscale_new_with_range): new function

	* btk/btkvscale.c (btk_vscale_new_with_range): new function

Tue Jun  5 14:57:18 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeviewcolumn.c (btk_tree_view_column_get_size): Fix bug #55573

Mon Jun  4 12:41:25 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.h: Deprecate btk_widget_set().

	* tests/testbtk.c (create_tooltips): Remove usage of
	btk_widget_set().

2001-06-05  Havoc Pennington  <hp@redhat.com>

	* btk/btkcolorsel.c: Use new mnemonic convenience functions

	Applying patch from Jeff Franks, with function docs added.
	
	* btk/btkcheckbutton.c (btk_check_button_new_with_mnemonic):
	remove call to set_mnemonic_widget, change docs a bit.	

	* btk/btkimagemenuitem.c (btk_image_menu_item_new_with_mnemonic):
	new function

	* btk/btkcheckmenuitem.c (btk_check_menu_item_new_with_mnemonic):
	new function

	* btk/btkmenuitem.c (btk_menu_item_new_with_mnemonic): new function

	* btk/btkradiobutton.c (btk_radio_button_new_with_mnemonic): new
	function
	(btk_radio_button_new_with_mnemonic_from_widget): new function

	* btk/btkradiomenuitem.c (btk_radio_menu_item_new_with_mnemonic):
	new function

	* btk/btktogglebutton.c (btk_toggle_button_new_with_mnemonic): new
	function	

	* btk/btklabel.c (btk_label_new_with_mnemonic): Improve docs on 
	auto-selection of mnemonic widget.

Mon Jun  4 15:05:24 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeviewcolumn.c (btk_tree_view_column_set_max_width):
	Fix segfault found by Vitaly Tishkov <tvv@sparc.spb.su>.
	(btk_tree_view_column_set_min_width): ditto.

Tue Jun  5 11:04:06 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkpixmap.h (BDK_PIXMAP_GET_CLASS): 
	s/BdkPixmapClass/BdkPixmapObjectClass/. (#51890, Jeff Franks)

Mon Jun  4 12:50:11 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkctree.c (btk_ctree_insert_gnode): Add a missing
	btk_clist_thaw().

2001-06-04  Havoc Pennington  <hp@pobox.com>

	* bdk/x11/bdkevents-x11.c (bdk_event_translate): Ignore 
r	eleases for buttons 6, 7

2001-06-04  Havoc Pennington  <hp@redhat.com>

	* btk/btkseparatormenuitem.h: Fix a search-and-replace screwup
	(s/CHECK/SEPARATOR/ gone awry). Patch from Jeff Franks, bug
	#55562

2001-06-04  Havoc Pennington  <hp@redhat.com>

	* btk/btktextview.c (btk_text_view_size_request): handle case
	where text_view->layout == NULL by assuming its size is 0, 
	i.e. same as if we haven't done any reflow. Reported by 
	Hidetoshi Tajima #55448 

2001-06-04  Havoc Pennington  <hp@redhat.com>

	* bdk/x11/bdkevents-x11.c (bdk_event_translate): support button 6
	and 7 for scroll left/right, from Thomas Broyer

2001-05-10  Havoc Pennington  <hp@redhat.com>

	* btk/btksettings.c (btk_settings_get_property): Handle case where
	we need to parse the xsetting as if it were an RC file string.

	* btk/btkcolorsel.c (btk_color_selection_class_init): load initial
	value of palette from settings, not from static variable

	* bdk/x11/bdkevents-x11.c: add color palette, toolbar mode to
	xsettings translation table

	* btk/btktoolbar.c (btk_toolbar_new): Remove arguments, because 
	hardcoding the toolbar style conflicts with new customizable 
	toolbar style philosophy
	(btk_toolbar_class_init): add settings for default toolbar style;
	these are used unless the app specifically forces a toolbar style

	* btk/btksettings.c (settings_install_property_parser): only
	return at the start if we warn and parser == NULL

	* btk/btkcolorsel.c (btk_color_selection_finalize): disconnect the
	palette changed handler so we don't notify dead color selections

	* btk/btkstyle.c (btk_default_draw_shadow): handle
	xthickness/ythickness of 0 or 1 properly 
	(btk_default_draw_resize_grip): clear the background behind the
	resize grips, and align to bottom right if we square the 
	area to be drawn.

	* btk/btkstatusbar.c (btk_statusbar_init): set horizontal usize on 
	statusbar label to 1, so it doesn't make toplevels resize oddly
	(btk_statusbar_size_request): add grip size to request
	(btk_statusbar_size_allocate): hack so the hbox still works with 
	the grip size in the request

	* btk/btktoolbar.c (btk_toolbar_show_all): override to fix 
	bug where showing all on a toplevel makes the toolbar 
	button text appear despite the toolbar mode

	* btk/btkmenubar.c: add internal padding style property

	* btk/btktoolbar.c: Add internal padding style property; add
	shadow type style property

	* btk/btkmenubar.c (btk_menu_bar_paint): paint box with widget
	state; and put Container::border_width outside the frame

	* btk/btktextview.c: don't draw focus rectangle if we're in
	interior focus mode, we just use blinking cursor

2001-06-04  Havoc Pennington  <hp@redhat.com>

	* configure.in: Make bdk-pixbuf have same version number as BTK

2001-06-04  Havoc Pennington  <hp@redhat.com>

	* btk/btkspinbutton.c: Get rid of stupid g_return_if_fail on 
	digits greater than 6. If there actually are limits (which there
	likely aren't), should clamp to them not warn.
	(btk_spin_button_new_with_range): don't take log of 0
	(btk_spin_button_size_request): use digits to compute size
	request, rather than step increment.

	* tests/testbtk.c (create_spins): test larger values of digits
	
	* btk/btkfontsel.c (btk_font_selection_init): scroll to selected
	font on map not expose, so we don't get weirdness during scrolling

2001-06-04  Havoc Pennington  <hp@redhat.com>

	* btk/btkclist.c (vadjustment_value_changed): Apply fix from
	Sam Solon, bug #54577, update value even if not drawable.

2001-06-04  Havoc Pennington  <hp@redhat.com>

	* btk/btkrange.c (btk_range_scroll_event): change SCROLL_RIGHT to
	SCROLL_LEFT, reported by Thomas Broyer.

2001-06-04  Havoc Pennington  <hp@redhat.com>

	* btk/btkrange.c (btk_range_adjustment_value_changed): 
	Process updates immediately, to prevent funny lag effect
	when scrolling, at some mild potential efficiency cost.

2001-06-04  Havoc Pennington  <hp@redhat.com>

	* btk/btkrange.c (btk_range_button_press): on middle click, center
	slider on the click.

2001-06-03  Havoc Pennington  <hp@pobox.com>

	* btk/btkstyle.c (btk_default_draw_slider): make this special-case
	hscale/vscale details, so we can use it for scrollbar as well.

	* tests/testbtk.c (reformat_value): honor digits from BtkScale

	* btk/btkenums.h (BtkTroughType): Remove this enum
	(BtkScrollType): add START and END from BtkTroughType

	* btk/btkstyle.c (btk_default_draw_slider): was not properly using
	its x/y arguments

	* btk/btkrange.h, btk/btkrange.c, btk/btkscrollbar.h,
	btk/btkscrollbar.c, btk/btkscale.h, btk/btkscale.c,
	btk/btkhscrollbar.h, btk/btkhscrollbar.c, btk/btkvscrollbar.h,
	btk/btkvscrollbar.c, btk/btkhscale.h, btk/btkhscale.c,
	btk/btkvscale.h, btk/btkvscale.c: Rewrite BtkRange and subclasses.

	Notable changes in the process:
	 
	- stepper_size style property is the height for vertical 
	  ranges, width for horizontal; the other dimension matches
	  the trough size
	- add ability to do NeXT-style steppers (and several other styles
	  that don't make any sense)
	- added min_slider_length, fixed_slider_length properties to
          BtkScrollbar
        - cleaned some private (or at least useless) functions out of
          btkscale.h	
        - moved bindings to BtkScale from subclasses, even arrow keys,
	  since blind users don't know scale orientation.
        - change move_slider action signal to use new BtkScrollType,
	  remove BtkTroughType argument
	- digits rounds the values a range will input to the given 
	  number of decimals, but will not try to force adjustment 
	  values set by other controllers. That is, we no longer
	  modify adjustment->value inside a value_changed handler.
	- added getters for BtkScale setters
        - middle-click begins a slider drag
	
Fri Jun  1 18:54:47 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c: (btk_tree_view_focus): Initial stab at
	getting the focus code to work.
	(btk_tree_view_class_init): Add a bunch of keybindings.

	* btk/btktreeviewcolumn.c
	(btk_tree_view_column_set_cell_data_func):
	s/BtkCellDataFunc/BtkTreeCellDataFunc.
	(_btk_tree_view_column_set_tree_view): Use "notify::model" instead
	of "properties_changed" to help justify the death of the latter
	signal. (-:

	* tests/testtreefocus.c (main): Let some columns be focussable to
	test focus better.

2001-06-01  Havoc Pennington  <hp@redhat.com>

	* btk/btkentry.c (btk_entry_commit_cb): implement overwrite mode
	
	* btk/btktextview.c (btk_text_view_commit_handler): don't
	overwrite in overwrite mode if we already deleted the selection
	and replaced it with new text.	

	* btk/btklabel.c (btk_label_select_rebunnyion_index): if you set the
	selection to an empty range, clear the clipboard if we owned it.
	(btk_label_set_selectable): give up selection if we become
	unselectable.
	(btk_label_state_changed): override state changed to unselect text
	when insensitive
	(get_text_callback): add paranoia check that indexes aren't
	outside of label->text
	(btk_label_select_rebunnyion): make -1 for start_offset mean "end of
	label," for consistency with BtkEditable

	* btk/btkmessagedialog.c (btk_message_dialog_new): honor
	BTK_DIALOG_NO_SEPARATOR flag

Fri Jun  1 11:47:11 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkcombo.c (btk_combo_set_use_arrows_always): Fix 
	notifications on non-existant "enable_arrow_keys".
	(#53753, Skip Montanaro)

Fri Jun  1 11:31:55 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkrectangle.c (bdk_rectangle_get_type): Add 
	BDK_TYPE_RECTANGLE.

	* btk/btkwidget.c (btk_widget_class_init): Fix type
	of allocation argument be BDK_TYPE_RECTANGLE.

Thu May 31 12:43:57 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkoptionmenu.c: Account for the fact that the border
	width is _outside_ the window. (Fixes #54585, bug found
        by Bastien Nocera.)

Wed May 30 15:56:30 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btksettings.c (btk_settings_get_property): Validate
	value from BDK settings against parameter spec.

	* bdk/x11/bdkevents-x11.c (bdk_setting_get): Add assignments
	to temporary values and use g_value_transform(), since
	thinking that GValue was going to be easy or efficient
	to use was, of course, a mistake.

        * btk/btksettings.c: Add cursor blink setting.
	
	* bdk/x11/bdkevents-x11.c: Add cursor blink X settings.

	* btk/btkentry.c: Add cursor blinking.

	* btk/btktextview.c (btk_text_view_check_cursor_blink): Use
	cursor blink global settings.

	* btk/btkentry.c (btk_entry_button_press): Add notification
	for :text_position in places where it is missing.

Tue May 29 18:17:11 2001  Owen Taylor  <otaylor@redhat.com>

	* autogen.sh (have_libtool): Fix GNU sedism (#55430)

Tue May 29 17:40:29 2001  Owen Taylor  <otaylor@redhat.com>

	* configure.in (BTK_DEP_CFLAGS): Use $PKG_CONFIG,
	not pkg-config. (#51032)

	* bdk/bdkproperty.h: Remove inappropriate B_GNUC_CONST
	(fixes #51952, James Henstridge)
	
2001-05-27  Alexander Larsson  <alla@lysator.liu.se>

	* btk/btkstock.h (BTK_STOCK_GO_UP):
	Rename to the more correct btk-go-up.

	* btk/stock-icons/stock_menu_sort_ascending.png:
	Added new file.
	
	* btk/stock-icons/stock_menu_sort_descending.png:
	Changed to show descending instead of ascending.

	* btk/btkiconfactory.c:
	Added menu size icon to sort ascending.

	* btk/stock-icons/Makefile.am:
	Added stock_menu_sort_ascending.png.
	
	* btk/btkseparatormenuitem.c:
	Use correct typenames.

Sun May 20 20:07:35 2001  Tim Janik  <timj@btk.org>

	* btk/btksignal.[hc] (btk_signal_connect_full): make hanlder id a
	gulong as in GSignal.

Fri May 25 19:04:17 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_calc_size): Remove almost all
	instances of BtkCellRenderer in code (all but dnd icon code).
	Virtualized in BtkTreeViewColumn.  Now I need to move focus in
	there, and I can do multiple Cells per column.

	* btk/btktreeviewcolumn.c: Proxy all cell calls correctly

	* btk/btktreemodel.c (btk_tree_row_reference_new_proxy): fix bug
	when model was unreffed prior to removing the row reference.

2001-05-25  Havoc Pennington  <hp@redhat.com>

	* btk/btkiconfactory.c: fix so that default icons are created if 
	you call btk_stock_list_ids()

	* demos/btk-demo/stock_browser.c (create_model): sort stock items
	in list

2001-05-25  Havoc Pennington  <hp@redhat.com>

	* btk/btkiconfactory.c (btk_icon_set_get_sizes): get sizes an icon
	set can render without falling back to missing image icon

	* btk/btktextview.c (btk_text_view_size_request): request full
	size of text, instead of random values

	* btk/btktreeview.c (btk_tree_view_size_request): request full
	size of tree view, instead of random values

	* btk/btkiconfactory.c (btk_icon_set_render_icon): render fallback
	image in an appropriate size

        * btk/btkstock.h: Rename the stock items including _BUTTON_,
	etc. not to include that. i.e. s/BTK_STOCK_BUTTON_OK/BTK_STOCK_OK/

        Throughout: fix BTK_STOCK_BUTTON_ instances
	
	* btk/btkstock.h, btk/btkstock.c, btk/btkiconfactory.h,
	btk/btkiconfactory.c, btk/stock-icons/Makefile.am:
	Add a bunch of new stock items/icons

	* btk/btktreeview.c (btk_tree_view_insert_column_with_data_func):
	new function, convenience for inserting columns with a data func

	* btk/btkiconfactory.c: keep a list of all existing icon factories
	(_btk_icon_factory_list_ids): use list of all factories to
	generate a list of all known IDs

	* btk/btkstock.c (btk_stock_list_ids): replace
	btk_stock_list_items() with a function that returns all IDs known
	including those for BtkIconFactory.

2001-05-25  Hans Breuer  <hans@breuer.org>

	* bdk/win32/bdkgc-win32.c : made fil mode BDK_STIPPLED actually
	work -> check boxes and radio buttons are drawn now, even on win9x.
	Improved line settings a bit, still no clue how to get really dotted
	lines on win9x, on NT it's PS_ALTERNATE.

	* bdk/win32/bdkwindow-win32.c : use SafeAdjustWindowRect for 
	BDK_HINT_MIN_SIZE as well

	* bdk/win32/makefile.am : added bdkkeys-win32.c to EXTRA_DIST

	* btk/btk.def : updated

	* btk/btktreeprivate.h : change column_drop_func to be a function
	pointer not a function pointer pointer

	* tests/testdnd.c : include <stdlib.h> for putenv prototype

	* tests/testsocket.c : made it compile on win32 again

	* tests/makefile.msc : one more test-app uses prop-editor.obj

2001-05-22  Havoc Pennington  <hp@pobox.com>

	* btk/btkbin.c (btk_bin_get_child): New function

Wed May 23 20:07:53 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkimcontextsimple.c: Add Mode_Switch to list of keys
	to ignore when doing compose processing.

2001-05-22  Joe Shaw  <joe@ximian.com>

	* btk/btktextiter.c (_btk_text_btree_get_iter_at_last_toggle): 
	Simplify as suggested by Havoc. Just get the last iter and work
	backward to the tag instead of getting a line and working back from
	there. Fixes passing in an invalid offset to
	iter_init_from_byte_offset().

Tue May 22 16:25:27 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview*.h: 
	* btk/btkcell*.h:
	* btk/btk*store.h:
	Added patch from Jeff Franks <jcf@tpg.com.au> to add GET_CLASS
	macros to all objects.

Tue May 22 15:13:52 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkcellrenderertext.c
	(btk_cell_renderer_text_set_fixed_size): Evil function to deal
	with very large (TM) amounts of text.  May be moved to
	BtkCellRenderer in the future, though I'm not sure it wants to be
	this accessible.

	* btk/btktreeviewcolumn.c (btk_tree_view_column_update_button):
	More sanity brought to this class.  I like it.

	* tests/testtreecolumns.c (ViewColumnModel): Amazingly scary test
	case.  Kids, don't try this at home.

	* btk/btktreemodel.c (btk_tree_model_get_iter_root): new
	convenience function.

	* btk/btkwindow.c (btk_window_set_geometry_hints): Fix typo in docs.

2001-05-21  Alexander Larsson  <alexl@redhat.com>

	* btk/btkfontsel.c:
	Added properties. Based on patch by Lee Mallabone.

	* btk/btkruler.c:
	* btk/btkhruler.c:
	* btk/btkvruler.c:
	* btk/btktext.c:
	* btk/btktextview.c:
	Converted BtkArg to GParam. Based on patches by John Margaglione.

	* tests/Makefile.am:
	* tests/testtext.c:
	Add a property editor to testtext.
	
Mon May 21 11:29:21 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btk{h,v,}paned.c: Only show the separator if 

	* configure.in: Fixed reversed conditional causing all image
	libraries to be linked in.

2001-05-21  Joe Shaw  <joe@ximian.com>

	* btk/btklayout.c (btk_text_layout_get_lines): Remove the assertion
	that top_y needs to be >= 0.

2001-05-11  Havoc Pennington  <hp@pobox.com>
	
	* bdk/x11/bdkmain-x11.c: Improve error messages for X errors and
	losing connection to the X server.

Sun May 20 13:59:20 2001  Owen Taylor  <otaylor@redhat.com>

	* configure.in: Start checks for X from bangox/bangoxft
	CFLAGS to avoid duplicate libraries.

	* bdk/Makefile.am (LDFLAGS): Remove extra -lm.

	* configure.in (BDK_PIXBUF_PACKAGES): Fix BDK_PIXBUF_PACKAGES
	to include bobject.
	
2001-05-18  Alexander Larsson  <alexl@redhat.com>

	* btk/btkspinbutton.c:
	Convert BtkArgs to GParams. Based on patch by John Margaglione.
	Also do size request reasonable for MAXDOUBLE. Previously it printed
	the limits to a buffer and overran it. Instead do it using log10() and
	limit the width to 10 digits.
	
	* btk/btkwidget.c (btk_widget_get_property):
	Correctly handle setting the parent property to NULL.

Fri May 18 15:26:26 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btktextview.c (btk_text_view_style_set): Reset 
	style attributes even if the widget isn't realized.

	* demos/btk-demo/main.c: Use a slightly smaller font.

Fri May 18 14:25:20 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkcontainer.c: Remove reallocate-redraws property.
	This is something that only a widget writer would ever want
	to change.

	* btk/btksignal.c: Handle G_SIGNAL_TYPE_STATIC_SCOPE for
	btk_signal_emit_by_name().

	* btk/btkviewport.c: Fix some warnings.

	* btk/btkwidget.c btk/btksizegroup.c: Add "size group" facility
	allowing the requisitions of multiple widgets to be grouped
	together.

	* tests/testbtk.c: Add BtkSizeGroup test

	* demos/btk-demo/sizegroup.c: Add BtkSizeGroup demo.

	* demos/btk-demo/main.c demos/btk-demo/pixbufs.c: Fix some
	warnings.

	* configure.in: Switch to using AM_BUNNYLIB_GNU_GETTEXT.

2001-04-28  Martin Baulig  <baulig@suse.de>

	* btk/btkimagemenuitem.[ch]: Renamed btk_image_menu_item_add_icon()
	to btk_image_menu_item_set_icon() and made it work if there's already
	an image.
	(btk_image_menu_item_new): This function doesn't take any arguments anymore.
	(btk_image_menu_item_new_with_label): New function.

Thu May 17 16:20:04 2001  Jonathan Blandford  <jrb@redhat.com>

	* demos/btk-demo/main.c (fontify): It's the worlds ugliest
	highlighting code!!!!  The result is okay so long as you don't try
	to stress it.  It also highlights a bug in the TextView so it's in
	an unproportional font right now until it's fixed.

	*demos/btk-demo/*.c: Clean up code a bit to make it
	ugly-parser(TM) friendly. (-:

2001-05-17  Joe Shaw  <joe@ximian.com>

	* btk/btktextdisplay.c (btk_text_layout_draw): Remove the assertions
	that x_offset and y_offset must be >= 0. Clip the cursor being drawn
	if it is only partially onscreen.

Thu May 17 17:10:13 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkentry.c: Make logical motion and deletion by graphemes, 
	not by characters.

	* btk/btkentry.c: Handle "trailing" returns from Bango when they
	are not zero or one; that is, when graphemes of multiple characters
	are involved.

	* btk/btktextlayout.c (line_display_index_to_iter): Remove unnecessary
	FIXME.

2001-05-17  Alexander Larsson  <alla@lysator.liu.se>
	
	* btk/btkbbox.c:
	Add properties, based on patch by Lee Mallabone.

	* btk/btknotebook.c:
	* btk/btktoolbar.c:
	Convert from BtkArg to GParam, based on patch by John Margaglione.
	
	* btk/btkhscale.c:
	* btk/btkvscale.c:
	* btk/btkhscrollbar.c:
	* btk/btkvscrollbar.c:
	* btk/btkrange.c:
	Move adjustment property to BtkRange.

	* btk/btklabel.c:
	Setup mnemonics on property changes

	* btk/btkwidget.c (btk_widget_get_property):
	BdkExtensionMode is an enum, not a flag. Set it with
	g_value_set_enum ().

	* tests/prop-editor.c:
	Better propery editor.

	* tests/testbtk.c:
	Add new property test. Pass zero to the property editor to
	get properties from all derived types.
	
Sun May 13 12:01:12 2001  Owen Taylor  <otaylor@redhat.com>

	* autogen.sh (have_automake): Require libtool-1.4,
	automake-1.4p1.

	* acinclude.m4: Remove libtool macros.

	* bdk-pixbuf/Makefile.am: Add dependencies to loade
	modules.

	* bdk/Makefile.am: Add dependency on libbdk_pixbuf.la
	for libbdk.

	* btk/Makefile.am: Add dependency on libbdk_pixbuf.la
	libbdk.la for libbtk.

	* modules/input/Makefile.am: Make modules have full
	dependencies.

Wed May 16 14:06:01 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreemodel.c (btk_tree_path_new_from_string): fix bug
	#54699 where paths weren't being checked for correctness.

Tue May 15 20:13:24 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeviewcolumn.c: You can now set all sorts of properties
	in any order you wan, whether or not the column is added to the
	tree, or the tree is realized.  Yay!

	* btk/btktreeviewcolumn.c
	(btk_tree_view_column_setup_sort_column_id_callback): handle
	sorting columns a lot saner

	* btk/btktreeviewcolumn.c (btk_tree_view_column_set_reorderable):
	new function to actually set wether or not a column is
	reorderable.

	* btk/btktreeview.c (btk_tree_view_unrealize): Only destroy things
	if we have 'em.

	* btk/btktreeviewcolumn.c (_btk_tree_view_column_set_tree_view):
	Fix nasty bug where we were showing the button just before
	realizing it.  As a result, the parent window was
	tree_view->window instead of tree_view->priv->header_window.

	* btk/btktreeview.c (btk_tree_view_set_reorderable): new property
	to let you easily reorder a list or tree.

2001-05-15  Alexander Larsson  <alla@lysator.liu.se>

	* btk/btkpacker.c: Apply patch from John Margaglione that converts
	from args to properties.

Tue May 15 10:11:59 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkpreview.c: Apply patch from John Margaglione converting
	from args to properties. (#51957)

	* btk/btkscale.c (btk_scale_class_init): Move install property
	calls to after ->set_property call.

Mon May 14 14:56:21 2001  Owen Taylor  <otaylor@redhat.com>

	* tests/prop-editor.c: Block against redundant changes.

	* btk/btkpaned.c btk/btk[hv]paned.c: Add position, position_set
	properties.

Sun May 13 18:40:04 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkpixmap.h: Remove creative formatting.

Thu May 10 19:22:28 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btktogglebutton.c:  Patch from John Margaglione converting to
	property API. (#51669)

	* btk/btkscale.c: Patch from John Margaglione converting to
	property API. (#51891)

	* btk/btkaccellabel.c: Applied patch from Lee Mallabone, converting
	to property API. (#50985)

Fri May 11 20:13:44 2001  Tim Janik  <timj@btk.org>

	* btk/btkmain.c (btk_main_do_event): remember widget's double
	buffering state across expose event, so we still call end_paint().

2001-05-11  Alexander Larsson  <alexl@redhat.com>

	* btk/btkhsv.c (paint_triangle):
	Expose the ring in the triangle at the correct place when
	exposing just a part of the triangle.

	* btk/btkwindow-decorate.c (btk_decorated_window_focus_change):
	Return FALSE, or window focusing will not work.

2001-05-11  Havoc Pennington  <hp@pobox.com>

	* btk/btkimage.c (btk_image_new_from_stock): docs, fixes bug
	#54144

	* btk/btkcolorsel.c (btk_color_selection_new): docs, fixes
	bug #54330

Fri May 11 02:53:57 2001  Tim Janik  <timj@btk.org>

	* btk/btktogglebutton.c (btk_toggle_button_expose): don't
	propagate exposes to NULL child.

	* btk/btkscrolledwindow.c (btk_scrolled_window_adjustment_changed): guard
	against not having one of the scrollbars.

	* btk/btklabel.c (btk_label_setup_mnemonic): clean up after us,
	we don't keep a mnemonic window if we have no mnemonic installed.

Fri May 11 01:05:00 2001  Tim Janik  <timj@btk.org>

	* btk/btktypeutils.h: grum, btk_type_class() is not GNUC_CONST
	it has the _important_ side effect of initializing a class.

2001-05-10  Alexander Larsson  <alexl@redhat.com>

	* bdk/linux-fb/bdkprivate-fb.h:
	Make sure you can compile out the implementation/wrapper assert
	macros.

	* bdk/linux-fb/bdkdrawable-fb2.c:
	Check implementation/wrappers, initialize type for pixmap dummys.

	* bdk/linux-fb/bdkimage-fb.c (_bdk_fb_get_image):
	Hide the cursor if reading from the screen.

	* bdk/linux-fb/bdkrender-fb.c (bdk_fb_fill_span_generic):
	Fix sign bug in tiling code.

	* bdk/linux-fb/bdkwindow-fb.c (_bdk_windowing_window_clear_area):
	Handle background pixmaps.

Wed May  9 15:27:22 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_set_column_drag_function): New
	function to let user control where columns are dragged.

	* btk/btktreeview.c (btk_tree_view_key_press): Cancel drags if
	Escape is pressed.

Wed May  9 09:08:44 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_class_init): New
	"columns_changed" signal.
	(btk_tree_view_motion_draw_column_motion_arrow): Change column
	motion code to draw arrows to the side if indicator is outside the
	widget.
	(btk_tree_view_map_expanded_rows): Implement.

2001-05-07  Alexander Larsson  <alexl@redhat.com>

	* demos/testpixbuf-save.c: 
	* demos/testpixbuf-drawable.c:
	Include bdkfb.h on linux-fb.

2001-05-07  Alexander Larsson  <alexl@redhat.com>

	* bdk/linux-fb/bdkdnd-fb.c (get_toplevel_window_at):
	New function for getting toplevel window at position.
	(bdk_drag_find_window): Use get_toplevel_window () instead
	of bdk_window_get_pointer(). (bdk_drag_status): Use
	correct context for getting window.

	* bdk/linux-fb/bdkproperty-fb.c (bdk_atom_name):
	g_strdup the atom name.

	* bdk/linux-fb/bdkwindow-fb.c:
	Costmetic fix.

	* btk/btkdnd.c (btk_drag_source_handle_event):
	Add code for changing cursor on linux-fb backend (same as
	win32).

2001-05-07  Federico Mena Quintero  <federico@ximian.com>

	* btk/btkwindow.c (btk_window_focus): Test for bin->child being
	present before doing anything with it.  Patch from Hvard Kvlen
	<havardk@netcom.no>.  Fixes Ximian bugzilla #2492 (OK, the bug
	report was not for the development branch of BTK+, but it applies
	anyways).

2001-05-04  Havoc Pennington  <hp@redhat.com>

	* configure.in: fix some shell typos

	* btk/btkcolorsel.c (btk_color_selection_destroy): warning fix

	* btk/btkimage.c: handle animations

	* btk/btkcheckbutton.c (btk_check_button_size_request): request
	border_width * 2, not just border_width

	* btk/btkscale.c: add "format_value" signal to allow people
	to override the way values are drawn.
	(btk_scale_get_value_size): fix width/height mistake,
	and compute size from actual displayed text, not 
	from made-up text.

	* btk/btktexttag.c (btk_text_tag_class_init): fix return type in 
	signal registration

	* tests/testtext.c: Add "Remove all tags" menu item for testing

	* btk/btktextbuffer.c (btk_text_buffer_remove_all_tags): implement

	* demos/btk-demo/main.c (main): add hack so we can find modules
	without installing btk

	* demos/btk-demo/textview.c (insert_text): demo font scaling

	* btk/btkcellrenderertext.c: Add "scale" property (font scaling
	factor)
	(btk_cell_renderer_text_set_property): remove some bogus
	g_object_notify

	* btk/btktexttag.c: add "scale" property which is a font scaling
	factor

	* btk/btktextlayout.c (add_text_attrs): add font scale attribute 
	to layout

	* btk/btktextiter.c (btk_text_iter_is_start): rename from
	btk_text_iter_is_first

2001-01-06  Hans Breuer  <hans@breuer.org>

	* bdk/bdk.def : updated exports

	* bdk/win32/makefile.msc : -DBDK_ENABLE_BROKEN otherwise
	bdk won't compile anymore
 
	* bdk/win32/bdkevents-win32.c : initialize ret_val when
	processing BDK_FILTER functions, initialize event.key->hardware_keycode.
	Improved bdk_flush () to not only do pending drawing operations
	but also process all currently pending events. This should make
	the behaviour more similar to the X11 version.	

	* bdk/win32/bdkgc-win32.c (predraw_set_background) : a background
	option needs to be set even if there is no BDK_GC_BACKGROUND.
	(bdk_win32_hdc_get) : use predraw_set_background () independent
	of value_mask. This allows to draw dashed lines leaving the original
	background intact.

	* bdk/win32/bdkimage-win32.c (bdk_image_new_bitamp) : free data
	after processing, because we can't reuse it as the X11 version does.

	* btk/btk.def : updated exports

	* btk/makefile.msc.in : added BATK, removed all test apps. (I
	would like to get rid of this file again, and use straight
	makefile.msc again, as the other Btk+ subdirs do)

	* test/makefile.msc (new file) : build the test apps here

2001-05-05  ERDI Gergo  <cactus@cactus.rulez.org>

	* bdk/bdkbango.c (bdk_bango_get_item_properties): Peek
	strike-through setting
	(bdk_draw_layout_line_with_colors): Render strike-through

Sat May  5 10:06:24 2001  Owen Taylor  <otaylor@redhat.com>

	* Release 1.3.5

	* configure.in (BTK_MICRO_VERSION): Up to 1.3.5

	* NEWS: Updated

	* demos/btk-demo/Makefile.am (EXTRA_DIST): Fix minor
	Makefile breakage.

Sat May  5 09:18:30 2001  Owen Taylor  <otaylor@redhat.com>

	* demos/btk-demo/images.c (progressive_timeout): Fix
	typo in filename.

	* btk/btktreeview.c (btk_tree_view_row_activated): Comment
	out FIXME warning; just too annoying.

2001-05-04  Alex Larsson  <alla@lysator.liu.se>

	* bdk/linux-fb/bdkcolor-fb.c:
	Better error messages.

	* bdk/linux-fb/bdkpixmap-fb.c (bdk_pixmap_new):
	Initialize abs_x and abs_y.
	
	* bdk/linux-fb/bdkrender-fb.c (bdk_fb_fill_span_generic):
	Correct handling of stipple offset.

	* bdk/linux-fb/bdkvisual-fb.c (bdk_visual_init):
	Treat directcolor framebuffers as truecolor.
	
Thu May  3 14:13:49 2001  Owen Taylor  <otaylor@redhat.com>

        * INSTALL.in HACKING btk/btkaccessible.[ch] btk/btk.c: Add
	dependency on Batk for accessibility support.

	* configure.in **/Makefile.am: Major reworking of substituted
	variables for CFLAGS/LIBS to make a lot more sane and 
	keep the the compile/link lines a bit shorter.

	* bdk/x11/bdkkeys-x11.c: Fix #endif with trailing stuff.

Thu May  3 08:10:54 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btktexttag.c (btk_text_tag_class_init): Fix return
	value to be G_TYPE_BOOLEAN, not G_TYPE_INT, also,
	use _btk_boolean_handled_accumulator.

Thu May  3 07:00:09 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btktextview.c: Patch from Juan Pablo Mendoza Mendoza
	to fix things so clicking inside selection leaves cursor
	at point where clicked. (#50324)

	* btk/btksettings.c (btk_settings_class_init): Restore
	sane value for default double click time.

	* tests/testtext.c (test_init): Really path to input modules.

2001-05-03  Sven Neumann  <sven@convergence.de>

	* demos/testpixbuf-save.c: include target-specific headers as
	done in testpixbuf-drawable.c

Wed May  2 20:36:38 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkentry.c (btk_entry_real_insert_text): Reduce
	new_text_length appropriately when we run into the 
	size limit for the entry. (#53445, reported by Jeff Franks)

	* tests/testbtk.c (create_entry): Remove most of the
	property toggle buttons. Replace with a "Props" button
	that brings up a property editor.

	* tests/prop-editor.[ch] test/testtreeview.c tests/Makefile.am:
	Split the property editor code out for reuse, improve.

Wed May  2 17:26:22 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkevents-x11.c bdk/x11/bdkwindow-x11.c: Always
	trap errors around calls to XSetInputFocus since we have
	no way of knowing reliably whether we are viewable or
	not. (#53947)

Tue May  1 09:21:23 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_button_release_drag_column):
	fix bug in dropping columns.  Moving columns now basically works
	modula some fine tuning.

Tue May  1 19:09:21 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_horizontal_autoscroll): Add
	autoscroll support.  It mostly works, but could use some fine
	tuning.
	* btk/btktreeview.c (btk_tree_view_button_release_drag_column):
	Actually move the column.

Mon Apr 30 20:29:27 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkbutton.c btk/btkcheckbutton.c btk/btkoptionmenu.c 
	  btk/btkspinbutton.c btk/btkstyle.c btk/btkwidget.c:
  	  New default theme! A slighly improved version of the 2.0 Raleigh
	  theme, with Windows-esque focus/drawing default. 
	  (BtkWidget::interior_focus defaults to TRUE.)

	* btk/btkstyle.[ch]: Add a text_aa color halfway between text and base.

2001-04-30  Havoc Pennington  <hp@pobox.com>

	* tests/testtext.c (line_numbers_expose): fix to work with
	btk_paint_layout change

Mon Apr 30 19:18:07 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkstyle.[ch] btk/btkaccellabel.c btk/btkcellrenderertext.c
	  btk/btkhruler.c btk/btkhscale.c btk/btklabel.c btk/btkprogressbar.c
	  btk/btkvruler.c btk/btkvscale.c: Add an extra parameter
          use_text to btk_paint_label() to deal with style->bg[] vs style->text[].

	* btk/btkbbox.c btk/btkdialog.c: Tweak padding some to deal
	  with BtkWidget::interior_focus = TRUE better.

	* btk/btkbutton.c: Switch ::default_spacing to ::default_border,
	::default_outside_border for more flexibility.

	* btk/btkwidget.c (btk_widget_style_get_valist): Remove 
	G_VALUE_NO_COPY_CONTENTS, to correspond with the recent
	change that had to be made with g_object_get.

Sun Apr 29 20:13:40 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_get_columns): new function.
	(btk_tree_view_move_column_after): Clean up interface. 

Sun Apr 29 03:02:02 2001  Tim Janik  <timj@btk.org>

        * btk/btkpacker.h:
        * btk/btkenums.h: moved BtkAnchorType and BtkSideType from btkpacker.h
	 to btkenum.h.

	* btk/btkmain.c (btk_main_do_event): silence compiler (BDK_SETTING not
	handled in switch).

	* btk/Makefile.am:
	(btk.defs): generate enum portions with  bunnylib-mkenums.
	(btktypebuiltins_evals.c): generate this with bunnylib-mkenums.
	got rid of makeenums.pl and makeenums.awk in distributed tarballs.
	
	* btk/btkaccelgroup.c (btk_accel_group_add): refined havocs warning
	addition.

	* docs/Changes-2.0.txt: keep a note on signal handlers now
	not getting emitted during the emission they were connected within.

2001-04-28  Havoc Pennington  <hp@pobox.com>

	* btk/btkcolorsel.c (palette_new): fix bug in tooltip

2001-04-24  Havoc Pennington  <hp@redhat.com>

	* btk/btktextlayout.c (btk_text_layout_move_iter_to_previous_line): 
	(btk_text_layout_move_iter_to_next_line): fix these two for
	invisible text, lots of other stuff still hosed.

	* btk/btkcolorsel.c (btk_color_selection_set_change_palette_hook):
	new function, replaces the get/set palette stuff. This function 
	is intended for use by libbunnyui which should set the hook to a
	thing which sets the palette in GConf, and we need the
	GConf-to-xsettings proxy which will result in the change being
	propagated back to the BTK app.

	* btk/btkaccelgroup.c (btk_accel_group_add): add note to warning 
	about unusable signals that it may be because the signal has 
	parameters.

	* btk/btkwidget.c (btk_widget_modify_style): always copy the
	style, otherwise btkrc.c won't know to create a new BtkStyle for
	it.
	(btk_widget_modify_color_component): call
	btk_widget_modify_style() so the rc style will get copied.
	(btk_widget_modify_font): ditto

	* btk/btkrc.c: make a couple variables static

	* btk/btkcolorseldialog.c (btk_color_selection_dialog_init): hide
	help button by default, since it does nothing

	* btk/btkcolorsel.c: add tooltips, work on key navigation, fool
	around with UI

	* btk/btkentry.c (btk_entry_realize): request enter/leave notify
	so we can have tooltips

	* btk/btkhsv.c (btk_hsv_realize): request enter/leave notify so we
	can have tooltips

	* bdk/bdkimage.h: mark bdk_image_new_bitmap with
	BDK_ENABLE_BROKEN, because its memory behavior is completely
	hosed.

	* btk/btknotebook.c: remove key press handler, replace with
	binding set, add numeric keypad support

	* btk/btktextview.c (btk_text_view_class_init): accept KP_Delete

	* btk/btktext.c (btk_text_key_press): add a bunch of KP keysyms

	* btk/btkentry.c (btk_entry_class_init): accept BDK_KP_Delete in
	addition to plain Delete

	* btk/btktextview.c (btk_text_view_key_press_event): accept
	BDK_KP_Enter in addition to BDK_Return

	* btk/btkfontsel.c (btk_font_selection_size_key_press): connect to
	activate on entry instead of key press
	(btk_font_selection_on_clist_key_press): get
	rid of this signal handler, not needed with new font sel.

	* btk/btkfilesel.c (btk_file_selection_key_press): remove a
	no-longer-needed emit_stop_by_name(), just return TRUE

	* btk/btkhscrollbar.c, btk/btkvscrollbar.c: remove keybindings
	cruft, this widget is no longer focusable.

	* btk/btkrange.h, btk/btkrange.c, btk/btkvscale.c,
	btk/btkhscale.c: Get rid of trough_keys virtual function, add
	move_slider action signal, add binding set for vscale/hscale, in
	the process support numeric keypad

	* btk/btkentry.c (btk_entry_class_init): Add keypad bindings; 
	make BDK_Return and BDK_KP_Enter activate the entry via 
	binding set, instead of hardcoded.

Fri Apr 27 20:27:21 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.[hc]: Massive reorder/cleanup of a lot of the
	code.  Some documentation added.

2001-04-27  Havoc Pennington  <hp@redhat.com>

	* btk/btkcombo.c (btk_combo_popup_button_press): fix warning

	* btk/btkmessagedialog.c (btk_message_dialog_init): make messages selectable

	* btk/btkentry.c (btk_entry_real_insert_text): don't strip
	line/para separators
	(btk_entry_create_layout): set single paragraph mode on the layout

	* btk/btkbutton.c (btk_button_new_from_stock): don't put much
	spacing between the image and label; instead, inside a button box 
	the button will get extra space that will go there, but if people 
	configure button box for 0 chubbiness, then there's no spacing.

	* btk/btkbbox.c (btk_button_box_class_init): Make child ipadding
	and min/max size style properties, so people can tune their
	chubbiness.

	* tests/testbtk.c (make_toolbar): remove calls to removed toolbar
	functions

	* btk/btktoolbar.c (btk_toolbar_class_init): Make space_size,
	space_style, and button_relief into style properties, remove
	functions for setting them
	
	* btk/btkmenu.c (btk_menu_key_press): handle menu bar accel to pop 
	it back down

	* btk/btkoptionmenu.c (btk_option_menu_get_props): free boxed
	types from btk_widget_style_get

	* btk/btkmenubar.c (btk_menu_bar_set_shadow_type): Remove, replace
	with a style property.

	* bdk/x11/bdkevents-x11.c: namespace the settings

	* btk/btkmenubar.c: Add F10 accelerator to move between menubars.

	* btk/btksettings.c (btk_settings_class_init): remove code with
	side effects from inside g_assert(), so that G_DISABLE_ASSERT can
	be used. Also, translate doc strings for settings. Also, namespace
	the double-click-time property. Also, remove bell properties crap.

2001-04-27  Sven Neumann  <sven@gimp.org>

	* Makefile.am: before creating links, check if pkg-config files
	exist for the default target. Otherwise link to the pkg-config files
	that got installed with this build.

Thu Apr 26 19:11:46 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_motion): clean up column
	dragging code.  Revealed some (potential) BdkWindow bugs.

	* bdk/x11/bdkwindow-x11.c (bdk_window_reparent): add
	_bdk_window_init_position to the end of reparent to fix the case
	of reparenting when new_x != old_x and new_y != old_y.

Thu Apr 26 10:54:50 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkentry.c (strstr_len): Fix optimization that
	was correct for the use here, but completely incorrect
	in general.

Thu Apr 26 10:40:41 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwindow.h: Remove deprecation of btk_window_set_default_size()
	until patch adding btk_window_set_size() is recommitted. 

	* **Makefile.am configure.in bdk/x11/bdkim-11.c
	  btk/btkmain.c btk/btkimmulticontext.c btk/btkmain.c
	  btk/btkrc.c: Remove all traces of -DX_LOCALE support.
	  (#10784)

Wed Apr 25 12:16:36 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/X11/bdkevents-x11.c (bdk_event_translate): Test for 
	window == NULL in a number of cases.

	* tests/testdnd.c: Set module path for bdk-pixbuf.

Thu Apr 19 16:11:07 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/Makefile.am xembed.h: File containing #defines
	for XEMBED protocol.

	* btk/btkplug.[ch] btk/btksocket.[ch]: 

	- Change protocol from old plug/socket specific protocol
	  to XEMBED draft
	- Various fixes to work with BTK+-2.0

	Still quite a bit of work to do here to handle initiation
	from the socket side (as specified by XEMBED), to handle
	the more advanced features of XEMBED, and to figure out
	a good way to handle same-app embedding with less overhead
	than using full XEMBED.

Wed Apr 18 16:04:28 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwindow.[ch] (btk_window_real_set_focus): Keep
	track of whether the toplevel has the focus; only send
	focus-in events to the focus widget when the window
	actually has the focus.

2001-04-25  Havoc Pennington  <hp@pobox.com>

	* btk/btkwindow.h: set_decorations_hint and set_functions_hint
	were still in the header

2001-04-24  Alexander Larsson  <alexl@redhat.com>

	* btk/btkclist.[ch]:
	* btk/btkctree.c:
	When there is a row highlighted for D'n'D it must alse
	be painted hightlighted on exposes. Otherwise exposes from
	the icon being dragged will mess up the hightlight.

	* btk/btkfontsel.c:
	Don't recenter selected font when exposing the font family
	clist. This means you can now actually scroll the font family
	list.

	* btk/btknotebook.c:
	Fix focus movement on scrolling tabs that are placed on the left
	and right.

2001-04-21  Havoc Pennington  <hp@pobox.com>

	* btk/btktextdisplay.c (btk_text_layout_draw): handle 0-height
	empty/invisible lines.

	* btk/btktextiter.c (btk_text_iter_set_visible_line_offset)
	(btk_text_iter_set_visible_line_index): new functions to set
	indexes excluding invisible text

	* btk/btktextlayout.c (line_display_iter_to_index): get visible 
	index

	* btk/btktextiter.c (btk_text_iter_get_visible_line_index)
	(btk_text_iter_get_visible_line_offset): new functions to 
	get indexes excluding invisible text

	* btk/btkmessagedialog.c (btk_message_dialog_init): strip out a
	bunch of extra padding that served no purpose

	* btk/btkdialog.c: Make all the spacings configurable via style
	properties, for chubbiness configuration in themes

	* tests/testtext.c: fix path to the immodules.
	
Mon Apr 23 18:57:03 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btksocket.c (btk_socket_filter_func): add missing '}' that
	got munched by #endif.

	* btk/Makefile.am (btk_plug_c_sources): add missing '\'

	* btk/btktreeview.c: Refactored code to clean up a number of
	events.

	* btk/btktreemodel.c (btk_tree_path_compare): Switched return
	values to make consistent with other functions.  Spotted by Jeff
	Franks <jcf@tpg.com.au>.

	* btk/btktreeview.h (struct _BtkTreeViewClass): Fixes to signal
	declaration spotted by Jeff Franks <jcf@tpg.com.au>.

2001-04-23  Sven Neumann  <sven@gimp.org>

	* btk/Makefile.am
	* btk/btkplug.c
	* btk/btksocket.c: on request of Owen, reverted my last change 
	and exclude btkplug.c/btksocket.c from the build for non-X11 targets

2001-04-23  Sven Neumann  <sven@gimp.org>

	* btk/btkplug.c: put into #ifdef BDK_WINDOWING_X11 to make BTK+
	compile for non-X11 targets again

2001-04-20  Alexander Larsson  <alexl@redhat.com>

	* btk/btkcolorsel.[ch]:
	API Change. Take BdkColor arguments instead of gdouble *.
	Leave the old btk_color_selection_set_color for compatibility,
	but marked deprecated.
	Do correct rounding when converting RGB <-> HSV.
	
	* btk/btkcolorseldialog.c:
	* tests/testbtk.c:
	Use new BtkColorSelection API.

	* btk/btkhsv.c:
	Fix problem selecting colors in triangle when Hue is 330.
	Fix some black dots around the HSB triangle.
	
	* btk/btkfilesel.c:
	return FALSE from the focus_in_event handler to fix focus problems.

2001-04-18  Havoc Pennington  <hp@redhat.com>

	* btk/btkwindow.c (btk_window_class_init): add signals and binding
	set, so keybindings are configurable	
	(btk_window_activate_default): Change to activate the focus widget
	instead if there's a focus widget, to be consistent with the
	behavior that previously existed in key_press_event

2001-04-18  Havoc Pennington  <hp@redhat.com>

	* bdk/bdkkeyuni.c: Handle numeric keypad keysyms; bug #50201

2001-04-18  Havoc Pennington  <hp@redhat.com>

        Close bug #50615:
	
	* btk/btkstyle.c (btk_default_draw_layout): Use text_gc to draw
	the layout

	* btk/btktext.c: Use base/text instead of bg/fg throughout

	* btk/btkentry.c: Use base/text instead of bg/fg throughout

	* btk/btktextdisplay.c: Use base/text instead of bg/fg throughout
	
	* btk/btkstyle.c (btk_style_init): make BTK_STATE_SELECTED default
	to blue for base, in addition to bg
	
2001-04-18  Havoc Pennington  <hp@redhat.com>

	* tests/testbtk.c (create_image): allow shrinking the image window
	to test that we clip to allocation.

	* btk/btkimage.c (btk_image_expose): clip to allocation,
	#9845

	* btk/btkenums.h: move BtkWrapMode in here, #50472

Wed Apr 18 14:23:14 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkimage-x11.c (bdk_image_new): Try changing
	mode on shm segments to 0600. We'll see who complains.

	* bdk/bdkwindow.c (_bdk_window_destroy_hierarchy): Call
	_bdk_windowing_window_destroy() AFTER recursing through
	children.

	* tests/Makefile.am (noinst_PROGRAMS): Build testsocket,
	testsocket_child on X.

	* tests/testsocket[_child].c: Fix uses of
	btk_window_get_default_accel_group().

	[ Merge patch from Ramiro Estrugo  <ramiro@eazel.com> from btk-1-2 ]

	* bdk/bdkimage.c: (bdk_image_get):
	Deal with the possibility that XGetImage() might return NULL.
	Allocate the BdkImagePrivate structure only after XGetImage()
	succeeds in order not to dereference a NULL ximage pointer.  This
	prevents a core dump when XGetImage() fails - which is unlikely,
	but can happen due to race conditions accessing the geometries of
	drawables.  An x error will still be triggered, but the bdk image
	wrapper at least wont seg fault.
	
2001-04-18  Havoc Pennington  <hp@redhat.com>

	* btk/btkimage.c: fix to properly queue resizes when the image is
	set

	* btk/btktextview.c (btk_text_view_do_popup): desensitize Paste
	if the insertion point isn't editable

	* demos/btk-demo/images.c: Added a BtkImage demo

	* demos/btk-demo/drawingarea.c: drawing area demo
	
	* demos/btk-demo/menus.c (create_menu): cleanups

Wed Apr 18 12:15:52 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkwindow-x11.c bdk/x11/bdkwindow-x11.h 
	  bdk/x11/bdkevents-x11.c: Introduce an extra child
	of toplevel windows that serves to hold the focus to
	avoid events being delivered to embedded windows.

	* bdk/x11/bdkwindow-x11.c (bdk_window_new): Introduce
	some extra variables to clean up code and reduce the
	number of casts.

	* bdk/x11/bdkwindow-x11.h (struct _BdkXPositionInfo): Use
	guint for 1 bit bit fields, not gboolean.

Wed Apr 18 10:04:23 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btktooltips.c (btk_tooltips_paint_window): Return FALSE,
	not TRUE. (Fixes #52925)

Tue Apr 17 18:05:34 2001  Owen Taylor  <otaylor@redhat.com>

	* Released 1.3.4

	* NEWS: Updated

	* btk/btktextview.c (btk_text_view_class_init): Fix to not
	use BTK_TYPE_ENUM.

Tue Apr 17 13:47:12 2001  Owen Taylor  <otaylor@redhat.com>

	* configure.in: Don't put -lbthread in BUNNYLIB_LIBS, BUNNYLIB_DEPLIBS

	* btk/btktypeutils.h btk/btksignals.h: Restore proper parameter
	names to compatibility #defines so docs work.

	* btk/btkenums.h: Remove BtkMenuFactoryType

	* btk/btkwindow.c btk/btkdnd.c: Docs cleanups.

	* configure.in: Don't include -lbthread in BUNNYLIB_LIBS, BUNNYLIB_DEPLIBS

	* tests/testbtkrc: No magenta cursors, please.

	* README.in INSTALL.in HACKING README.cvs-commits: Updated.

	* btk/btkenums.h (enum): Remove left over BtkMenuFactoryType.
	
Mon Apr 16 14:38:41 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btklist.c btk/btklistitem.c: Remove explicit pointer
	grabs, since they are no longer necessary.

	* btk/btkcombo.c (btk_combo_popup_button_press): Fix #52926
	by signal_connect() and call btk_button_pressed() rather
	than signal_connect_after().

	* tests/testbtk.c: Restore radio menu items to combos 
	since they'll look OK with Raleigh, and it is easier
	than finishing the process of removing them that was
	started earlier.

2001-04-16  Hans Breuer  <hans@breuer.org>

	* bdk/bdk.def :
	* btk/btk.def : added all exports required to link PyBtk 0.7.1

	* bdk/bdkfont.h : #define BDK_TYPE bdk_font_get_type ()
	we are interested in the functions return value not the function address
	* bdk/bdkvisual.h : same for BDK_TYPE_VISUAL

	* btk/makefile.msc.in : reflect movement of BDK_TYPEs from btk to bdk

2001-04-14  Hans Breuer  <hans@breuer.org>

	* bdk/bdk.def :
	* bdk/makefile.msc : updated

	* bdk/win32/bdkdrawable.win32 (bdk_win32_draw_rectangle) : if modus is 
	"fill with tile" do so with new helper function	bdk_win32_draw_tiles 
	(the testbtk::text backgound pixmap is drawn again)
	Changed SetTextAlign before bango_win32_render to TA_BASELINE to reflect 
	Win32 Bango change
	* bdk/win32/bdkprivate-win32.h : prototype for bdk_win32_draw_tiles

	* bdk/win32/bdkproperty-win32.c : first implementation of bdk_setting_get
	Not sure if the returned settings have the right unit, because I couldn't
	find any docs for the X version ...

	* btk/btk.def :
	* btk/makefile.msc.in : updated

Thu Apr 12 17:41:17 2001  Owen Taylor  <otaylor@redhat.com>

	* btk-2.0.m4: Fix up to refer to BTK+, not to GLib; fix some
	wording problems. (Compared to version from Johannes Stezenbach to
	check correctness.)

Thu Apr 12 21:04:26 2001  Tim Janik  <timj@btk.org>

	* btk/btktreeview.c (_btk_tree_view_column_start_drag): get
	this to compile.

2001-04-12  Anders Carlsson  <andersca@codefactory.se>

	* btk/btkcellrenderertextpixbuf.c (btk_cell_renderer_text_pixbuf_class_init): It's pixbuf_pos,
	not pixbufpos.

	* btk/btkcellrendererpixbuf.c (btk_cell_renderer_pixbuf_render): Fix small typo.

	* btk/btkcellrenderer.c (btk_cell_renderer_get_property): xpad and ypad
	are unsigned insts, therefore use g_value_set_uint.
	(btk_cell_renderer_set_property): Likewise, use g_value_get_uint.

Sun Apr  8 05:36:06 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktextview.c (btk_text_view_class_init): fix a fixme.

	* btk/btkcellrendertoggle.c: change BTK_TYPE_POINTER to
	BTK_TYPE_STRING.

	* btk/btktreeview.c: New functions to allow initial column
	dragging work.

	* btk/btktreeviewcolumn.c: Initial column dragging support.

	* tests/testtreefocus.c: give dave some love.

	* tests/testtreesort.c: Modify test to check really long samples.

2001-04-11  Alexander Larsson  <alexl@redhat.com>

	* btk-2.0.m4: Pass pkg-config options
	before the other args so it works even if
	POSIXLY_CORRECT is set.

Mon Apr  9 19:02:07 2001  Tim Janik  <timj@btk.org>

	* configure.in (BTK_MICRO_VERSION): increment version to 1.3.4 (binary
	0, interface 0).

2001-04-04  Denis Oliver Kropp  <dok@convergence.de>

	* btk/btkcalendar.c (btk_calendar_button_press):
        check for action_func != NULL

2001-04-04  Sven Neumann  <sven@gimp.org>

	* tests/testbtk.c (test_init): corrected path to btk.immodules

Wed Apr  4 09:18:18 2001  Tim Janik  <timj@btk.org>

	* Released Btk+-1.3.3.

Wed Apr  4 07:42:23 2001  Tim Janik  <timj@btk.org>

	* bdk/Makefile.am (EXTRA_DIST): add makeenums.pl to EXTRA_DIST.

Wed Apr  4 04:13:18 2001  Tim Janik  <timj@btk.org>

	* btk/stock-icons/Makefile.am: stay in builddir and read/write
	files to/from source dir. (if we don't stay in builddir, we
	can't reach make-inline-pixbuf.

	* bdk/Makefile.am (bdkenumtypes.c): add $(srcdir) to mekeenums.pl
	deps.

	* configure.in (BTK_MICRO_VERSION): up and away (1.3.3 bin/interface
	ages 0).

Tue Apr  3 15:04:45 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreemodelsort.h:  removed set_sort_column, as it was
	moved to the BtkTreeSortable interface.

	* btk/btktreeselection.c (btk_tree_selection_selected_foreach):
	Make more efficient (fixes #50262).

Tue Apr  3 13:55:37 2001  Owen Taylor  <otaylor@redhat.com>

	* NEWS: Updated.

	* configure.in: Remove support for uninstalled bunnylib.

	* btk/btkdnd.c (btk_drag_highlight_expose): Return FALSE as
	so as not to stop emission.

	* btk-config-2.0.in: Exit with an error message that btk-config-2.0
	is no longer supported.

	* Makefile.am btk/Makefile.am tests/*: Moved all tests
	into tests, change build order to build modules before
	btk/.

	* modules/input/Makefile.am: Move btk-query-immodules-2.0 invocation
	to here.

Tue Apr  3 13:52:57 2001  Tim Janik  <timj@btk.org>

	* btk/btkitemfactory.[hc]: changed btk_item_factory_dump_items()
	and btk_item_factory_dump_rc() BtkPatternSpec argument to
	GPatternSpec. this is actually unlikely to cause breakage in
	third-party apps since except for gle, pretty much ever caller
	passes NULL here.

	* btk/btkbindings.[hc]: removed btk_pattern_*() API.

	* *.c: use g_pattern_*() API.

	* docs/Changes-2.0.txt: BtkPatternSpec->GPatternSpec updates.

	* btk/btkstyle.c (btk_default_draw_resize_grip): assert unhandled
	directions aren't passed in.

	* btk/btksettings.[hc] (_btk_settings_parse_convert): export conversion
	functionality to be usable from btkstyle.c as well, give precedence
	for conversion to user-supplied parsers.
	s/_btk_rc_property_parser_for_type/_btk_rc_property_parser_from_type/;

	* btk/btkstyle.c (_btk_style_peek_property_value): use
	_btk_settings_parse_convert() for rcporperty value conversion.

2001-04-03  Alexander Larsson  <alexl@redhat.com>

	* bdk/linux-fb/bdkevents-fb.c:
	Add empty bdk_setting_get().

Tue Apr  3 05:09:07 2001  Tim Janik  <timj@btk.org>

	* btk/btkmain.c (_btk_boolean_handled_accumulator): use more elaborate
	variable names.
	
	* btk/makeenums.pl: touch this so enum files get remade.

Mon Apr  2 19:36:57 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreestore.c (btk_tree_store_init):  Bug fix to make trees
	work again when not sorted.

	* btk/btktreeview.c (btk_tree_view_class_init): Add "collapse_row"
	and "expand_row" signal, closing bug 52578.

	* btk/btktreeview.c (btk_tree_view_expand_row): Add signal
	support.

	* btk/btktreeview.c (btk_tree_view_collapse_row): Add signal
	support.

Mon Apr  2 18:18:07 2001  Owen Taylor  <otaylor@redhat.com>

        * bdk/bdkevents.h: Add BdkEventSetting event for notification
	of changes to system settings, bdk_setting_get() to retrieve
	a single system setting.

	* bdk/x11/bdkevents-x11.c: Bridge bdk_setting_get() and BdkEventSetting
	to the draft XSETTINGS mechanism.

	* bdk/x11/xsettings-{common,client}.[ch]: Sample-implementation of
	XSETTINGS.

	* btk/btkmain.c btk/btksettings.[ch]: Propagate notification
	of BDK settings changes to the BtkSettings object.

	* bdk/bdkevents.[ch] bdk/btk/btksettings.c: Hook up the
	double-click-timeout property to BDK.

	* bdk/bdkcolor.[ch] bdk/bdkvisual.h bdk/bdkevent.[ch] bdk/bdkfont.[ch]:
	Define BDK boxed types here.

	* bdk/Makefile.am bdk/makeenums.pl: Generate source files
	bdk/bdkenumtypes.[ch] for enum definitions.

	* btk/btkcompat.h: Add defines for BTK_TYPE_BDK_*
	* btk/btk-boxed.defs: Comment out BDK types
	* btk/btktypeutils.h: Remove BDK types
	* btk/Makefile.am: No longer scan BDK headers for enumerataions

Mon Apr  2 16:41:08 2001  Owen Taylor  <otaylor@redhat.com>

	* Applied patch from Ron Steinke to add signal accumulators
	so that signals with the convention 'TRUE return means
	handled' stop emission on a TRUE return.

	* btk/btkmain.[ch]: Add private accumulator 
	_btk_boolean_handled_accumulator, used throughout BTK+.
	
	* btk/btkspinbutton.c: Add accumulator for ::output.

	* btk/btktipsquery.c: Add accumulator for ::widget_selected
	
	* btk/btkwidget.c: Add accumulators for event signals,
	::drag_motion, ::drag_drop. Use _btk_boolean_handled_accumator
	for ::mnemonic-activate.

	* btk/btkwindow.c: Add accumulator for ::frame_event

Mon Apr  2 16:24:21 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.c: Add missing include.

Mon Apr  2 16:56:15 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkmarshal.list (VOID:BOXED,BOXED,BOXED,BOXED): new
	marshaller.

	* btk/btktreemodel.c (btk_tree_model_range_changed): change
	"changed" signal to "range_changed".

	* btk/btktreeview.c (btk_tree_view_set_model): fix small bug where
	removing a tree from one model would remove all trees from that
	model.
	* btk/btktreeview.c (btk_tree_view_range_changed): use range
	changed signal instead.

Mon Apr  2 16:13:58 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkinvisible.c (btk_invisible_style_set): Avoid
	chaining up to parent impl, since we have a INPUT_ONLY
	window.

	* btk/btkentry.[ch]: Add a cursor_color property to set the
	foreground color for the cursor.

Mon Apr  2 15:06:13 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkstyle.c (_btk_style_peek_property_value): Reference 
	param spec when caching property values, since we unref it
	later when we free the style.

	* btk/btkoptionmenu.c (btk_option_menu_get_props): Dont' free
	values since they are retrieved with G_VALUE_NO_COPY_CONTENTS.

Mon Apr  2 10:47:57 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.c (btk_widget_class_init): Fix 
	G_VALUE_NO_COPY_CONTENTS instead of G_SIGNAL_TYPE_STATIC_SCOPE
	stupidity.

Mon Apr  2 00:51:11 2001  Owen Taylor  <otaylor@redhat.com>

	[ First pass at adding style properties. Still needs some definite
	fine-tuning. ]

        * btk/btkbutton.c: Add ::default_spacing style property.
	 
	* btk/btkcheckbutton.[ch] btkradiobutton.c: Add ::indicator_size,
	::indicator_spacing style properties.

	* btk/btkoptionmenu.c: Add ::indicator_size, ::indicator_spacing
	style properties.

	* btk/btk{,h,v}paned.[ch]: Make handle_size a style property
	rather than a normal property.

	* btk/btkwidget.c: Add an ::interior_focus style property to
	draw focus inside buttons, in the Windows/Java Metal/etc. style.

	* btk/btkbutton.c btk/btkcheckbutton.c btk/btktogglenbutton.c:
	Honor ::interior_focus.
	
	* btk/btkentry.c: Don't draw focus at all when ::interior_focus is 
	TRUE.

	* btk/btkrange.[ch] btk/btk{h,v}scrollbar.c btk/btk{h,v}scale.c:
	Add ::slider_width, ::trough_border, ::stepper_size,
	::stepper_spacing style properties.

	* btk/btkscale.[ch] Add ::slider-length style property.

2001-04-02 Alexander Larsson   <alexl@redhat.com>

	* bdk/linux-fb/bdkwindow-fb.c:
	Add bdk_window_begin_resize_drag and bdk_window_begin_move_drag. Remove some
	warnings that were spewed on startup.

	* btk/btkwindow-decorate.c:
	btk_window_reposition -> _btk_window_reposition

Sun Apr  1 21:37:22 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.[ch] btk/btktypeutils.c btk/btk-boxed.defs:
	Add boxed type for BtkRequistion. Use it for ::size-request.

	* btk/btkstyle.[ch] btk/btktypeutils.c btk/btk-boxed.defs:
        Add a new BtkBorder structure useful for geometry properties
	for widgets. Add corresponding BTK_TYPE_BORDER.
	
	* btk/btkwidget.c (btk_widget_class_install_style_property):
	Support automatic parser selection like
	btk_settings_install_property_parser().

	* btk/btksettings.c (_btk_rc_property_select_parser): Export
	functionality for use by btk_widget_class_install_style_property.
	Support BTK_TYPE_BORDER, BTK_TYPE_REQUISITION.

Sun Apr  1 20:48:59 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkentry.c (btk_entry_class_init): Make invisible-char
	g_param_spec_unichar(). 

Sun Apr  1 23:41:37 2001  Tim Janik  <timj@btk.org>

	* bdk/x11/bdkwindow-x11.c (bdk_window_focus): raise window for non
	_NET window managers.

	* btk/btkmenufactory.[hc]: cvs removed those files now.

Sun Apr  1 08:00:13 2001  Tim Janik  <timj@btk.org>

	* btk/btkwidget.[hc]: got rid of btk_widget_popup(), a function that
	bad needs to be nuked, not just deprecated.

	* btk/btktooltips.c (btk_tooltips_draw_tips): don't use 
	btk_widget_popup().

	* btk/*.[hc]: s/activate_mnemonic/mnemonic_activate/g;
	
	* btk/btkmenufactory.[hc]: removed this long-standingly deprecated
	widget.
	
	* docs/Changes-2.0.txt: updates.
	
Sun Apr  1 01:02:54 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreestore.c (btk_tree_store_sort_iter_changed):
	for (i = 0; i < 100; i ++)
	  g_print ("I will confirm it compile before committing\n");

Sun Apr  1 00:52:06 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreestore.c: Initial work on implementing the
	BtkTreeSortable interface.  Basicaly a big cut'n'paste job.

Sun Apr  1 03:28:14 2001  Tim Janik  <timj@btk.org>

	* btk/btkwidget.c: fixed a bunch of notifications, added
	reference counts around emissions where the widget is used afterwards.
	added freeze/thaws around multiple properties being notified.
	(_btk_widget_get_aux_info): cleanups.
	
	* btk/btksettings.c (btk_settings_install_property): provide
	default parsing functions for bdkcolor, enums and flags.

	* btk/btkwindow.[hc]: partially reverted patch from havoc,
	applied by owen.
	backed out btk_window_get_location(), btk_window_set_location(),
	btk_window_get_size() and btk_window_set_size(), these
	have to be sorted out wrg x/y/width/height/default_with/default_height
	properties.
	kept a flag in BtkWindowGeometryInfo to handle user
	resetting default sizes.
	cleaned up ZVT comments.
	bunch of assorted bug fixes, notification fixes.
	(_btk_window_reposition): make this a really internal function.
	
	* btk/testbtk.c: fixups.
	
2001-03-31  Hans Breuer  <hans@breuer.org>

	* config.h.win32.in : disable USE_MMX for msvc build cause
	the assembler doesn't fit and is out of my scope. Disable
	USE_BMODULE for msvc build as wel. The right way to share
	binaries on win32 would be to use libtiff.dll etc. To reduce
	installation hassles IMO it's better to include all fileformats
	builtin to bdk-pixbuf

	* bdk-pixbuf/makefile.msc : new file

	* bdk/bdk.def : updated

	* bdk/win32/bdkevents-win32.c : don't erase the background if
	.no_bg is set. It improves the scrolling (e.g. of testbtk main
	buttons
	* bdk/win32/bdkgeometry-win32.c : added comment about the above

	* bdk/win32/bdkwindow-win32.c : added three new functions like
	the X version. Only one is implemented, because the other two
	"bdk_window_begin_(resize|move)_drag" got no docs and appear to
	be default behaviour on win32 anyway ...

	* btk/btk.def : updated

	* btk/makefile.msc.in : update for new files, use bunnylib-genmarshal
	from where it was built and add an additional rule to automagically
	build btkmarshal.[hc]

	* btk/btkfilesel.c (open_new_dir) : don't increase n_entries
	before array access for the current entry isn't finished

	* btk/btktreeitem.c (btk_tree_item_subtree_button_click) :
	use g_return_val_if_fail

	* btk/testbtk.c (window_controls) : don't use the *wrong* size
	for the static array, but let the compiler calculate it. It
	makes me wonder if gcc isn't capable to catch bugs like this ...

2001-03-31  James Henstridge  <james@daa.com.au>

	* btk/btkwidget.c (btk_widget_size_adjust): fix use of magic
	constant "-1" in the aux info structure.

2001-03-30  Alexander Larsson  <alexl@redhat.com>

	* btk/btkbutton.c (btk_button_get_property):
	* btk/btklabel.c:
	Remove leaks.
	
	* btk/btkcontainer.c:
	* btk/btkhscale.c:
	* btk/btkhscrollbar.c:
	* btk/btklayout.c:
	* btk/btkmisc.c:
	* btk/btkprogress.c:
	* btk/btkprogressbar.c:
	* btk/btkrange.c:
	* btk/btktable.c:
	* btk/btkviewport.c:
	* btk/btkvscale.c:
	* btk/btkvscrollbar.c:
	* btk/btkwidget.c:
	Property patches, based on patches from John Margaglione and Lee Mallabone.

Thu Mar 29 21:20:38 2001  Mike Kestner  <mkestner@ameritech.net>

	* btk/btkspinbutton.c : added value_changed signal which proxies for the
	adjustment. Cleaned redundant preconditions (spin != NULL). Added
	inline API function docs.
	(btk_spin_button_new_with_range): New convenience constructor.
	(btk_spin_button_set_increments): New adjustment helper.
	(btk_spin_button_set_range): New adjustment helper.

	* btk/testbtk.c : added test of the new convenince constructor and
	value_changed signals.

Thu Mar 29 20:20:38 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreemodel.c (btk_tree_row_ref_reordered_callback): Now we
	listen to the reorder signal.

Wed Mar 28 20:30:26 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.[ch] (_btk_widget_get_aux_info): Add private function
	to get the aux info structure fo the widget.

	* btk/btklabel.c btk/btkscrolledwindow.c btk/btkwindow.c: Use
	above function.

        [ Patch from  Havoc Pennington  <hp@redhat.com> ]

	* bdk/x11/bdkwindow-x11.c (bdk_window_get_frame_extents): function
	to get the size of the window manager frame, basically the same
	code that bdk_window_get_root_origin() had
	(bdk_window_get_root_origin): use bdk_window_get_frame_extents()

	* btk/btkwindow.c (btk_window_set_default_size): use
	bdk_window_resize() if the window is realized and resizeable

	* bdk/x11/bdkwindow-x11.c (bdk_window_set_geometry_hints): fix
	typo so that setting gravity works

	* btk/btkwindow.c (btk_window_move_resize): don't ever use
	allocation if auto_shrink is on, even if the default size
	has not changed.

	* btk/btkwidget.c (btk_widget_render_icon): remove bogus
	g_return_if_fail

Thu Mar 29 16:29:12 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkliststore.c (btk_list_store_iter_changed): Massive
	reordering/sorting work.  Now pretty much works.

	* btk/btkrbtree.c (_btk_rbtree_reorder): Lots of work to make
	reorder mostly work.  Still need to get the parity correct.

	* btk/btktreeviewcolumn.c: Listen for "model" property changed
	signal, so I can listen for the sort_column_changed signal so I
	can change my "sort_indicator" property.  Cool.

Wed Mar 28 00:03:10 2001  Owen Taylor  <otaylor@redhat.com>

	[ Patch from Havoc Pennington, hp@redhat.com ]

	* bdk/bdkwindow.h bdk/x11/bdkwindow-x11.c:
	Add functions bdk_window_begin_resize_drag/begin_move_drag
	to start resizing or moving a toplevel window. This
	is done either using the _NET_WM_MOVERESIZE protocol,
	or, if that isn't present, by emulation.

	* btk/btkwindow.[ch]: Add functions btk_begin_move/resize_drag
	to export the above to BTK+-land.

	* btk/btkstyle.[ch]: Add ->draw_resize_grip() paint func.
	
	* btk/btkwindow.c bdk/bdkwindow.[ch] (bdk_window_constrain_size):
	Move this function into bdkwindow, since we need it
	when implementing fallback resizing.

	* bdk/x11/bdkwindow-x11.c: bdk_window_set_geometry_hints.
	Fix typo when setting gravity.

	* btk/btkstatusbar.[ch] (btk_statusbar_set_has_resize_grip):
	Add an optional (but on by default) resize grip for resizing 
	the parent window.

01-03-29  Alexander Larsson  <alexl@redhat.com>

	* btk/btktooltips.c (btk_tooltips_event_handler):
	Don't return TRUE from the event handler,that blocks all
	event signals on the tooltip widget. Now you can press buttons
	in toolbars again.

Wed Mar 28 19:20:43 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/testtext.c (create_buffer): Add missing NULL on
	valist.

	* btk/btkcheckmenuitem.c (btk_check_menu_item_class_init): Fix
	c-n-p problem with INCONSISTENT property.

        [ Patch from Havoc Pennington  <hp@redhat.com> ]

	* btk/btkentry.h (struct _BtkEntryClass): add same populate_popup
	hook.

	* btk/btktextview.h (struct _BtkTextViewClass): add populate_popup
	signal as a hook for extending the default popup menu

	* btk/btkimmulticontext.c (btk_im_multicontext_append_menuitems):
	use radio menu items for the input method menuitems

	* btk/btkimcontextsimple.c (check_hex): do better validation of 
	inserted unicode from Ctrl-Shift-hex input method

	* btk/btktextbtree.c (_btk_text_btree_insert): remove utf8
	validatation here, already done at BtkTextBuffer level.

	* btk/btkwidget.c (btk_widget_class_init): add binding set, add
	popup_menu run action signal and Shift+F10 and Menu keybindings.

	* btk/btkentry.c: implement a default handler for popup_menu

	* btk/btktextview.c: implement a default handler for popup_menu

	* btk/btkmenu.c (btk_menu_popup): select first item if popup is
	from a key event
	
	* btk/btklabel.c: remove "trailer" cruft

Wed Mar 28 17:27:12 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkrbtree.c (_btk_rbtree_reorder): new function to
	handle reordering of trees.  Seems to mostly work w/ the exception
	of the parity flag.

	* btk/btktreeview.c (btk_tree_view_reordered): handle "reordered"
	signal.

Wed Mar 28 21:12:37 2001  Tim Janik  <timj@btk.org>

	* btk/btkwidget.h: c++ fixes.

Sun Mar 25 15:51:28 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btksettings.c (btk_settings_init): Fix use of uninitialized
	memory.

Tue Mar 27 22:36:07 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.h btk/btkrange.h: Apply patch from 
	Nils Barth fixing event return values. (#51041)

	* btk/btkwidget.c: Fix some return values for default
	functions.

	* btk/btk[vh]scrollbar.c btk/btk[vh]range.c: Fix
	return values for trough_keys functions.

	* btk/btkwidget.h (struct _BtkWidgetClass): Fix return
	value for add_accelerator (shoudl have been a void
	return.)

	* btk/btkcellrenderer.[ch]: btkcellrenderertoggle.h:
	Fix return type of EVENT.

	* btk/btkmarshal.list btk/btktexttag.c: Make EVENT
	signal return a boolean.

Tue Mar 27 22:07:44 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkliststore.c (btk_list_store_sort): Fix arguments to
	reordered signal.

	* tests/testtreesort.c (main): fix spelling.

Tue Mar 27 20:55:29 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkliststore.c: More work on implementing sortable
	interface.

Mon Mar 26 15:48:45 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwindow.c (btk_window_list_toplevels): Don't
	reference the widgets in the resulting list. (#11821)
	This makes this consistent with btk_container_children.

	* btk/btkwindow.c btk/btkwidget.c: Fix up the two
	uses of btk_window_list_toplevels.

Mon Mar 26 15:26:17 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkimcontext.c (btk_im_context_set_use_preedit): Add
	a virtual function to set whether the IM context should use 
	the preedit string. (#51922)
	
Mon Mar 26 14:42:59 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkbango.h: Remove stale FIXME comment.

2001-03-26  Alexander Larsson  <alla@lysator.liu.se>

	* btk/btkfilesel.c (btk_file_selection_get_filename):
	Fixed bug that returned NULL if a filename was selected.

2001-03-24  Havoc Pennington  <hp@pobox.com>

	* btk/btkthemes.c (btk_theme_engine_load): improve error message
	to contain the word "theme"

2001-03-24  Havoc Pennington  <hp@pobox.com>

	* btk/btkhsv.c (btk_hsv_move): make motion around the ring much
	slower but finer-grained
	(btk_hsv_focus): get initial focus on the ring or triangle 
	according to tab direction

	* btk/testbtk.c (main): get rid of weird sleep(1) on exit

2001-03-23  Havoc Pennington  <hp@pobox.com>

	* btk/btkhsv.c: make this somewhat key-navigable

	* btk/btkfontsel.c: mnemonics

	* btk/btkgamma.c: mnemonics

	* btk/btkcolorsel.c: add mnemonics to labels

2001-03-22  Havoc Pennington  <hp@pobox.com>

	Applied big patch from Seth Lytle to fix event handler return
	values, slightly modified.

	* btk/btkcalendar.c (btk_calendar_button_press): return TRUE if
	handled.
	(btk_calendar_key_press): return TRUE for BDK_space triggers
	select_day

	* btk/btkclist.c (btk_clist_button_press): return TRUE if handled
	(btk_clist_button_release): return TRUE if handled

	* btk/btkcolorsel.c (mouse_release):
	(palette_activate): 
	(palette_press): 
	(palette_new): 
	(mouse_press): 
	(get_screen_color): 
	fixed return type (void to gboolean), return TRUE,
	added BTK_SIGNAL_FUNC cast

	* btk/btkcombo.c (btk_combo_popup_button_press): fixed return type
	(void to gboolean), and return TRUE
	(btk_combo_button_release): changed return value to TRUE after
	btk_grab_add on combo->popwin

	* btk/btkctree.c (btk_ctree_button_press): return TRUE if triggers a
	collapse or expand

	* btk/btkcurve.c (btk_curve_graph_events): return TRUE for
	button/motion

	* btk/btkdnd.c (btk_drag_source_event_cb): return TRUE for button
	press/release and motion that trigger act

	* btk/btkentry.c (btk_entry_button_release): return TRUE

	* btk/btkfontsel.c (btk_font_selection_size_key_press): return TRUE
	for BDK_Return
	
	* btk/btklist.c (btk_list_button_press): return TRUE mostly
	(btk_list_button_release): return TRUE if selection

	* btk/btklistitem.c (btk_list_item_button_press): return TRUE on
	press

	* btk/btkmenushell.c (btk_menu_shell_button_press):
	(btk_menu_shell_button_release): chain parent_menu_shell retval

	* btk/btknotebook.c (btk_notebook_button_press): return FALSE if
	nothing triggered
	(btk_notebook_button_release): return TRUE if we do anything

	* btk/btkspinbutton.c (btk_spin_button_button_press): 
	(btk_spin_button_button_release): return TRUE or chained retval

	* btk/btktext.c (btk_text_button_press): 
	(btk_text_button_release): return TRUE
	(btk_text_key_press): remove redundant retval code
	
	* btk/btktreeitem.c (btk_tree_item_button_press): return TRUE if button
	and sensitive
	(btk_tree_item_subtree_button_click): changed type to gint, and return
	TRUE if sensitive

	* btk/btktooltips.c (btk_tooltips_event_handler): deactivate implies 
	return TRUE

2001-03-23  Havoc Pennington  <hp@redhat.com>

	* btk/testbtk.c: fix warnings

	* btk/btktoolbar.c (btk_toolbar_insert_element): fix return value

	* btk/btktextview.c: fix warnings

	* btk/btktext.c (find_cursor_at_line): fix warning

	* btk/btkselection.c (btk_selection_notify): fix warning 

	* btk/btkitemfactory.c (btk_item_factory_menu_pos): fix signature
	of this function

	* btk/btkimmulticontext.c (btk_im_multicontext_append_menuitems):
	fix warning

	* btk/btkhandlebox.c (btk_handle_box_style_set): fix warning

	* btk/btkfontsel.c: fix warning

	* btk/btkcolorsel.c: fix warnings

2001-03-23  Havoc Pennington  <hp@redhat.com>

	* btk/btkhandlebox.c: Apply property patch from Lee Mallabone

	* btk/btkbox.c: Apply property patch from Lee Mallabone

	* btk/btkcheckmenuitem.c: Apply property patch from Lee Mallabone,
	and deprecated btk_check_menu_item_set_show_toggle().
	
	* btk/btkbutton.c: Apply property patch from Lee Mallabone

	* btk/btkfilesel.c: Apply property patch from Lee Mallabone

	* btk/btkframe.c: Apply property patch from Lee Mallabone

2001-03-23  Havoc Pennington  <hp@redhat.com>

	* btk/btktoolbar.c, btk/btkimcontext.c, btk/btklabel.c: fix up
	some docs

Fri Mar 23 16:13:43 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeviewcolumn.h (BtkCellDataFunc): Forgot to namespace
	this.

	* btk/btktreestore.c (btk_tree_store_set_value): change from
	set_cell to set_value

	* btk/btkliststore.c (btk_list_store_set_value): change from
	set_cell to set_value

Thu Mar 22 19:27:34 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkcellrenderertoggle.c (btk_cell_renderer_toggle_render):
	fix braino.
	* btk/btktreesortable.[ch]: New interface to add cleanup sortable
	support.

	* btk/btktreeview.c: Addition of initial sortable support.

	* btk/btktreestore.c: Addition of initial sortable support.

	* btk/btkliststore.c: Addition of initial sortable support.

	* btk/btkmarshal.list: yet another marshaller.

	* btk/btktreedatallist.[ch]: shared code between the store models
	for handling sorting headers.

2001-03-22  Havoc Pennington  <hp@redhat.com>

	* btk/btkcontainer.c (btk_container_set_focus_chain): 
	(btk_container_unset_focus_chain): Add ability to override the 
	focus chain for a container explicitly

Thu Mar 22 13:01:44 2001  Tim Janik  <timj@btk.org>

	* btk/btklabel.[hc]: some cleanups, fixed mnemonic_widget handling,
	added PROP_MNEMONIC_WIDGET.

	* btk/btkwindow.c (btk_window_activate_mnemonic): 
	(btk_window_remove_mnemonic): 
	(btk_window_add_mnemonic): fixed assertions.
	(btk_window_activate_mnemonic): constrain modifier checks to those
	permitted by btk_accelerator_get_default_mod_mask().
	got rid of btk_window_get_default_accel_group().

	* btk/btkwidget.c (btk_widget_real_activate_mnemonic): handle non
	activatable widgets either by focussing or a warning.
	added a signal accumulator to ::activate_mnemonic which stops the
	emission once a handler returned TRUE.

2001-03-22  Havoc Pennington  <hp@pobox.com>

	* btk/btktoolbar.c (btk_toolbar_insert_stock): handle mnemonics in
	the stock item label

	* btk/btklabel.c: s/@btk_func/btk_func()/ in docs

	* btk/btkstock.c (builtin_items): add mnemonics where missing

	* demos/btk-demo/*.c: Add mnemonics all over the place

	* btk/btklabel.h: mark parse_uline deprecated

2001-03-21  Alexander Larsson  <alexl@redhat.com>

	* btk/btkitemfactory.[ch]:
	Add support for stock and normal imagemenuitems.
	
	* btk/testbtk.c:
	Add some tests for mnemonics, stock toolbars, stock
	and image menuitems in itemfactory and bdk_window_scroll.

2001-03-21  Alexander Larsson  <alexl@redhat.com>

        * btk/btkbutton.[ch]:
	* btk/btkdialog.c:
	Renamed btk_button_new_stock() to btk_button_new_from_stock() and
	removed accel_group argument. Renamed btk_button_new_accel() to
	btk_button_new_with_mnemonic() and removed accel_group argument.

	* btk/btkcheckbutton.[ch]:
	New function btk_check_button_new_with_mnemonic().

	* btk/btkentry.c:
	Override activate_mnemonic and just grab focus.

	* btk/btkitemfactory.c:
	Don't add menu uline accel group, instead use mnemonics support.

	* btk/btklabel.[ch]:
	New support for mnemonics.

	* btk/btkmarshal.list:
	Needed BOOLEAN:BOOLEAN for activate_mnemonic.

	* btk/btkmenu.[c]:
	* btkmenushell.c:
	Use mnemonics instead of accel groups for uline
	support in menu items.
	Removed btk_menu_get_uline_accel_group() and
	btk_menu_ensure_uline_accel_group().

	* btk/btkmenuitem.c:
	Override activate_mnemonic to handle switching between
	menu items if there are collisions.
	
	* btk/btknotebook.c:
	Connect to activate_mnemonic on the tab_label, so that
	activating it switches to that notebook page.

	* btk/btkwidget.[ch]:
	Add activate_mnemonic signal. New function
	btk_widget_activate_mnemonic() to emit it.
	Default implementation does activate/grab_focus.

	* btk/btkwindow.[ch]:
	Add support for mnemonics in windows.
	New functions:
	btk_window_add_mnemonic, btk_window_remove_mnemonic,
	btk_window_activate_mnemonic, btk_window_set_mnemonic_modifier

	* btk/testbtk.c:
	Update to function name changes.
	
2001-03-21  Alexander Larsson  <alexl@redhat.com>

	* btk/btkimagemenuitem.[c]:
	Add btk_image_menu_item_new_from_stock()

Tue Mar 20 15:00:43 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkcellrenderertoggle.c (btk_cell_renderer_toggle_render):
	Fix buglet in meeting.

2001-03-19  Havoc Pennington  <hp@redhat.com>

	* btk/btkiconfactory.c: Make BtkIconSource an opaque datatype, and
	add a bunch of accessor functions. This is because we have
	reasonable expectations of extending what fields it contains in
	the future.

	* btk/btkstyle.c (btk_default_render_icon): adapt to icon source
	changes

	* btk/btkrc.c (btk_rc_parse_icon_source): fix to use new
	BtkIconSource	

Mon Mar 19 15:53:36 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkitemfactory.c btk/testbtk.c: Handle quoting of / with \; properly
	handle __ in paths, quote " and \n in btk_item_factory_dump_items().

	* btk/btkadjustment.[ch] btk/btkclist.c btk/btkhruler.c btk/btklayout.c 
	  btk/btklist.c btk/btkprogress.[ch] btk/btkprogressbar.[ch] btk/btkrange.[ch]
	  btk/btkruler.[ch] btk/btkscale.c btk/btkscrolledwindow.c btk/btkspinbutton.[ch]
	  btk/btktext.c btk/btktextview.c btk/btkvruler.c btk/testbtk.c:
	Change float to double everywhere with the exception of 0<->1.0 alignment
	and BtkCurve.

2001-03-19  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkdrawable-win32.c
	* bdk/win32/bdkimage-win32.c: Use correct casts in debugging
	output.

	* demos/testpixbuf-drawable.c: If BDK_WINDOWING_WIN32, include
	bdkwin32.h.

2001-03-18  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkevents-win32.c (print_window_state): New function.
	print_event_state, print_event): Use preprocessor macro to make
	code more compact. Print also BDK_WINDOW_STATE events.
	(synthesize_crossing_events): Remove the old #ifdeffed-out code.
	
	* btk/btk.def
	* btk/makefile.mingw.in: Update.

	* btk/btkmain.h: Check for G_PLATFORM_WIN32, not only G_OS_WIN32,
	to catch also Cygwin.

Sun Mar 18 01:15:30 2001  Tim Janik  <timj@btk.org>

	* btk/btkspinbutton.[hc]: added rc-style argument
	BtkSpinButton::shadow_type.
	removed spin_button->shadow_type, btk_spin_button_set_shadow_type()
	and ARG_SHADOW_TYPE as it doesn' make much sense to try to override
	rc-style settings.

	* btk/btkfixed.c: removed btk_fixed_paint() (was unused).

	* btk/btkwidget.c: quark cleanups.

	* btk/btkrc.[hc]: added btk_rc_scanner_new() to create an rc-file
	scanner with appropriate configuration, renamed BtkRcStyleClass.clone
	to create_rc_style() (we don't do cloning in standard OO sense).
	added per rc style properties.
	
	* btk/btkstyle.[hc]: added code to retrive pspec conformant rc-style
	property values and for caching those. some cleanups.
	
	* btk/Makefile.am: -DG_DISABLE_CONST_RETURNS.
	
	* btk/btksettings.[hc]: new file for global rc-file properties
	(at least currently, should get extended to support X properties
	and other communication mechanisms).
	
	* btk/btkwidget.[hc]: added style property support:
	(btk_widget_class_install_style_property_parser): install style
	property pspec with parser function for rc-file values other
	than LONG, DOUBLE or STRING.
	(btk_widget_class_install_style_property): same as above without
	parser (parsers are going to be needed quite infrequently).
	(btk_widget_style_get_property): retrive style property value.
	(btk_widget_style_get_valist): same as above with varargs support,
	has NOCOPY semantics.
	(btk_widget_style_get): wrapper around btk_widget_style_get_valist().

Fri Mar 16 18:24:53 2001  Jonathan Blandford  <jrb@redhat.com>

	* demos/btk-demo/main.c (row_activated_cb): modified to use
	"row_activated" signal.

	* btk/btktreeview.c (btk_tree_view_row_activated): oh, the
	stupidity.  Lets actually pass in the row with this signal...

Fri Mar 16 18:01:17 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeviewcolumn.[ch]: s/BTK_TREE_COLUMN/BTK_TREE_VIEW_COLUMN

	* btk/btktreeview.c (btk_tree_view_row_activated): New signal.

	* btk/btktreeview.c (btk_tree_view_destroy): moved pretty much
	everything into the ::destroy function, and freed a lot more.

2001-03-16  Havoc Pennington  <hp@redhat.com>

	* btk/btkwidget.h (struct _BtkWidgetAuxInfo): change to use gint
	instead of gint16, to avoid overflow issues, since sizes > 16-bit
	are now allowed.

2001-03-16  Havoc Pennington  <hp@redhat.com>

	* Applied patch from Nils Barth (bug # 51041) to 
	replace "gint" with "gboolean" and 0/1 with TRUE/FALSE
	in various places.

2001-03-15  Havoc Pennington  <hp@redhat.com>
	
	* btk/btktextbuffer.c (btk_text_buffer_create_tag): add varargs 
	for properties to set on the tag.

	* btk/testtext.c: fixups to reflect create_tag change
	
	* btk/btktexttag.c (btk_text_tag_set_property):
	background/foreground stipple are objects, not boxed.

	* demos/btk-demo/textview.c: intellihancing

Fri Mar 16 11:38:42 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_set_model): Fixed some
	braindeadness spotted by Jamie Strachan <frostfreek@yahoo.com>.

2001-03-16  Alexander Larsson  <alexl@redhat.com>

	* bdk/x11/bdkgeometry-x11.c (_bdk_window_process_expose):
	Fix sign error with queued rebunnyion translations.

2001-03-15  HideToshi Tajima  <tajima@happy>

	* modules/input/btkimcontextxim.c (btk_im_context_xim_set_cursor_location): 
	* btk/btkimmulticontext.c (btk_im_multicontext_set_cursor_location):
	* btk/btkentry.c (update_im_cursor_location): 
	* btk/btkimcontext.c (btk_im_context_set_cursor_location):
	* btk/btkimcontext.h (struct _BtkIMContextClass): rename
	set_cursor_pos to set_cursor_location in BtkInputContext class

Thu Mar 15 18:22:44 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkcellrenderer.h: Changed prototype to allow for getting
	the location of the cell relative to its area.
	* btk/btkcell*: modified for above change
	* btk/btktreeview.c: modified for above change.

Wed Mar 14 13:58:32 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_set_model): Ref the model.
	 (btk_tree_view_finalize): actually unref the model.  Thanks to
	Jamie Strachan <frostfreek@yahoo.com> for noticing this error.

2001-03-14  Havoc Pennington  <hp@redhat.com>

        * btk/btkdata.h, btk/btkdata.c: Delete.
	
	* btk/btk.h: remove btkdata.h

	* btk/Makefile.am: remove btkdata
	
	* btk/btktext.c (btk_text_set_adjustments): connect to "destroy"
	not "disconnect" on the adjustments.
	
	* btk/btktooltips.h, btk/btktooltips.c: derive from BtkObject not
	BtkData

	* btk/btkadjustment.h, btk/btkadjustment.c: derive from BtkObject
	not BtkData

	* configure.in: handle case where X render exists, but Bango lacks
	Xft support.

2001-03-15 Alexander Larsson  <alexl@redhat.com>

	* btk/btktoolbar.[ch]:
	New functions btk_toolbar_set_icon_size and btk_toolbar_insert_stock
	to add stock items to toolbars.

	* btk/Makefile.am:
	Remove ../bdk/bdkim.h from bdk_headers.

2001-03-15  Sven Neumann  <sven@gimp.org>

	* bdk/bdkim.h: removed
	
	* bdk/bdkprivate.h
	* bdk/x11/bdkim-x11.c: do not include bdkim.h 

2001-03-14  HideToshi Tajima  <tajima@happy.sunsoft.eng.sun.com>

	* btk/btkimmulticontext.c (btk_im_multicontext_set_cursor_pos):
	* btk/btkimcontext.c (btk_im_context_set_cursor_pos):
	* btk/btkimcontext.h (struct _BtkIMContextClass): add
	set_cursor_pos() virtual method

	* modules/input/btkimcontextxim.c (btk_im_context_xim_class_init):
	(btk_im_context_xim_set_cursor_pos): add implementation for
	set_cursor_pos() method

	* btk/btkentry.c (recompute_idle_func): set current cursor
	position to input methods

Mon Mar 12 21:02:08 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_header_focus): Fix up focus
	code a lot.

	* btk/btktreedatalist.c (_btk_tree_data_list_free): use
	g_mem_chunk.
	(_btk_tree_data_list_alloc): use g_mem_chunk.
	(_btk_tree_data_list_node_to_value): Fix to switch on
	G_TYPE_FUNDAMENTAL.
	(_btk_tree_data_list_value_to_node): Fix to switch on
	G_TYPE_FUNDAMENTAL.
	(_btk_tree_data_list_node_copy): Fix to switch on
	G_TYPE_FUNDAMENTAL.

2001-03-12  Havoc Pennington  <hp@redhat.com>

	* btk/btkwindow.c (btk_window_class_init): Patch from John Margaglione 
	to convert to new property API. Also, change default_width and
	default_height get_property to return 0 as the flag value for
	"unset"; -1 is not a valid value for these fields.

2001-03-12  Havoc Pennington  <hp@redhat.com>

	* btk/btkiconfactory.h, btk/btkiconfactory.c: Switch to using an
	enum with registration for icon sizes, instead of strings.

	* btkimage.h, btkimage.c, btkstyle.h, btkstyle.c, btkwidget.h, 
	btkwidget.c: Fix to reflect BtkIconSize
	
2001-03-12  Alexander Larsson  <alexl@redhat.com>

	Make BtkFB compile and link.
	
        * bdk/linux-fb/bdkdrawable-fb2.c:
	window->mapped to BDK_WINDOW_IS_MAPPED(). 
	
	* bdk/linux-fb/bdkwindow-fb.c:
	window->mapped to BDK_WINDOW_IS_MAPPED(). 
	Added bdk_window_shape_combine_rebunnyion.
	Added assorted placeholders for unimplemented new BdkWindow API calls.

2001-03-12  Alexander Larsson  <alexl@redhat.com>

	* btk/btkfilesel.c:
	Add more test when converting filenames from/to utf-8.
	Don't allow entering text in the filename entry which isn't allowed in
	a filename. Just beep instead.

2001-03-12  Alexander Larsson  <alexl@redhat.com>

	* btk/btkclist.c:
	Scroll using bdk_window_scroll(). Don't wait for exposes.
	Move the column headers in an order that makes them flash less.

2001-03-10  Hans Breuer  <hans@breuer.org>

	* bdk/bdk.def : updated

	* bdk/win32/bdkgc-win32.c : pixmaps are visible again, due
	to offseting the clip_mask at the right place

	* bdk/win32/bdkwindow-win32.c : don't create background brushes
	for all the bdkClasses, especially not for the input_only case.
	Otherwise flickering wont be avoidable, because we don't get
	WM_ERASEBKGND message for these windows.

	* bdk/win32/bdkevents-win32.c : initialize event->expose.rebunnyion
	and fixed massive redraw problems apparently triggered by Alexanders 
	recent change. Not fully understood the BDK_EXPOSE / WM_PAINT handling
	but it seems to work quite well :-)

	* bdk/win32/bdkprivate-win32.h : added _bdk_window_process_expose
	prototype

Sat Mar 10 12:15:31 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreestore.c (btk_tree_store_set_cell): Fix a stupid typo.
	(btk_list_store_set_cell): Fix a stupid typo.

Fri Mar  9 20:36:21 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeselection.c (btk_tree_selection_select_all): Make
	select_all not work if you're in SINGLE mode (it doesn't make that
	much sense, anyway.)

	* btk/btktreedatalist.c (_btk_tree_data_list_node_to_value):
	handle types more sanely.
	(_btk_tree_data_list_value_to_node): handle types more sanely.
	(_btk_tree_data_list_node_copy): handle types more sanely.

	* btk/btkliststore.c (btk_list_store_set_cell): fix to work with
	GValue better. Converts the type as well.

	* btk/btktreestore.c (btk_tree_store_set_cell): fix to work with
	GValue better. Converts the type as well.

Wed Mar  7 20:47:41 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btktext.c btk/btkoldeditable.[ch] bdk/bdk.[ch]
	bdk/Makefile.am bdk/x11/Makefile.am bdk/x11/bdkevents-x11.c 
	bdk/x11/bdkglobals-x11.c bdk/x11/bdkprivate-x11.c
	bdk/x11/bdkx.h bdk/x11/bdkim-x11.c: Remove old XIM code.

	* bdk/win32/bdkim-win32.c bdk/linux-fb/bdkim-fb.c: Remove
	bdk_im/bdk_ic.

2001-03-09  Hans Breuer  <hans@breuer.org>

	* bdk/bdk.def : updated

	* bdk/win32/bdkevents-win32.c : don't ask input_only windows
	for their palette

	* bdk/win32/bdkgeometry-win32.c : reflect BdkWindowObject::mapped
	removing

	* bdk/win32/bdkwindow-win32.c : reflect BdkWindowObject::mapped
	removing and implemented Havoc's BdkWindow state functions; 
	stick/unstick only as no-op, cause I don't know how to emulate 
	on win32 ...

	* btk/btk.def : updated

	* btk/btkbox.c (btk_box_get_spacing) : use g_return_val_if_fail ()

	* btk/btktypeutils.c : #include <string.h>

	* btk/btkwindow.h : declare btk_window_set_decorated ()

Fri Mar  9 09:31:55 2001  Tim Janik  <timj@btk.org>

	* btk/btkwidget.c (btk_widget_class_init): fixed signals with
	BDK_TYPE_DRAG_CONTEXT, it needs to be marshaled as an object,
	not a boxed.

2001-03-09  Alexander Larsson  <alexl@redhat.com>

	* docs/Changes-2.0.txt:
	Document expose event->rebunnyion change and that btk_widget_event
	doesn't allow passing expose events.

	* bdk/bdkevents.h:
	Add rebunnyion to expose event.
	
	* bdk/bdkevents.c:
	Handle event->rebunnyion in bdk_event_copy() and bdk_event_free().

	* bdk/bdkwindow.c (bdk_window_process_updates_internal):
	Generate expose_event->rebunnyion when creating expose events.

	* bdk/x11/bdkevents-x11.c:
	Generate expose events with rebunnyions when translating X events.

	* btk/btkcontainer.[ch]:
	Default expose handler that propagates expose events to NO_WINDOW
	children. New function btk_container_propagate_expose()

	* btk/btkwidget.[ch]:
	Moved btk_widget_event implementation to btk_widget_event_internal.
	btk_widget_event calls btk_widget_event_internal but doesn't allow
	expose events. New function btk_widget_send_expose() to send expose
	events. New function btk_widget_rebunnyion_intersect() to calculate
	window/rebunnyion intersections.
	
	* btk/btkmain.c (btk_main_do_event):
	Use bdk_window_begin_paint_rebunnyion() instead of bdk_window_begin_paint_rect().
	Use btk_widget_send_expose() to send expose events.
	
	* btk/btkbin.c:
	* btk/btkbox.c:
	* btk/btkfixed.c:
	* btk/btkimagemenuitem.c:
	* btk/btklist.c:
	* btk/btkpacker.c:
	* btk/btktable.c:
	* btk/btktree.c:
	Remove expose handler, using the default container implementation
	instead.
	
	* btk/btkbutton.c:
	* btk/btkcheckbutton.c:
	* btk/btkeventbox.c:
	* btk/btkfixed.c:
	* btk/btkhandlebox.c:
	* btk/btklayout.c:
	* btk/btklistitem.c:
	* btk/btkmenu.c:
	* btk/btkmenubar.c:
	* btk/btkmenuitem.c:
	* btk/btknotebook.c:
	* btk/btkoptionmenu.c:
	* btk/btkpaned.c:
	* btk/btkscrolledwindow.c:
	* btk/btktogglebutton.c:
	* btk/btktoolbar.c:
	* btk/btktreeitem.c:
	* btk/btkviewport.c:
	Chain expose handler to parent class handler. Use
	btk_container_propagate_expose() to propagate exposes.

	* btk/btkclist.c (check_exposures):
	* btk/btktext.c (process_exposes):
	Use btk_widget_send_expose instead of btk_widget_event.

Thu Mar  8 19:40:28 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_destroy): Add destroy function.

Thu Mar  8 19:18:27 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_unref_tree_helper): Actually
	unref the nodes.   Fixes bug #50058.

	* btk/btktreemodel.c (btk_tree_model_ref_node): change
	"::ref_iter" to "::ref_node".
	(btk_tree_model_unref_node): change "::unref_iter" to
	"::unref_node". Fixes bug #50064.

Thu Mar  8 17:40:09 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_create_row_drag_icon): add
	support for invisible cells.
	 (btk_tree_view_bin_expose): ditto

Thu Mar  8 16:36:00 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreemodel.c (btk_tree_model_get_type): add prerequesite
	on bobjects.

	* tests/testtreefocus.c (main): New test file.

	* tests/testtreeview.c: update to latest bunnylib changes.

	* tests/testtreecolumns.c: update to latest bunnylib changes.

Thu Mar  8 18:13:20 2001  Tim Janik  <timj@btk.org>

	* btk/testbtk.c: re-enabled event watcher emission hooks.

Thu Mar  8 16:51:21 2001  Tim Janik  <timj@btk.org>

	* *.c: added accumulator data argument to g_signal_newc()
	functions.

	* btk/btktreemodelsort.c (btk_tree_model_sort_set_model): 
	* btk/btktreeview.c (btk_tree_view_setup_model): 
	* btk/treestoretest.c (make_window):
	s/g_signal_connect/g_signal_connectc/.

	* btk/btktextbuffer.c: completed signal arg fixups,
	they also needed G_SIGNAL_TYPE_STATIC_SCOPE flag.

Thu Mar  8 00:02:30 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.[ch] (btk_widget_get_name): Make
	G_CONST_RETURN.

	* btk/btkwidget.[ch] btk/btkprivate.h: Add a 
	::hierarchy-changed signal when a widget changes
	from anchored to unanchored or vice versa.
	(anchored means 
	 btk_widget_get_ancestor (widget, BTK_TYPE_WINDOW) != NULL.)
	Use a private flag to keep track of this efficiently.

2001-03-07  Havoc Pennington  <hp@redhat.com>

	* btk/testbtk.c (create_spins): uglify so that size request gets
	tested.

	* btk/btkspinbutton.c (btk_spin_button_size_request): Base size
	request on values for upper/lower, completes #6152

Wed Mar  7 20:07:22 2001  Owen Taylor  <otaylor@redhat.com>

	* Makefile.am: Remove btk-config-2.0 again.
	(Grrrr, pkg-config. And stops make loops.)

Thu Mar  8 00:18:29 2001  Tim Janik  <timj@btk.org>

	* btk/btksignal.[hc]: removed old emission hook API.
	
	* docs/Changes-2.0.txt: fixed sections.
	
	* btk/btktextbuffer.c: signal arg fixups.

2001-03-07  Havoc Pennington  <hp@redhat.com>

	* btk/btktextview.c (invalidated_handler): use PRIORITY_VALIDATE

	* btk/btktextview.h (BTK_TEXT_VIEW_PRIORITY_VALIDATE): add this
	here, bug #50368; changed to be BDK_PRIORITY_REDRAW + 5, instead
	of BDK_PRIORITY_REDRAW + 1, so you can insert stuff in between the
	validation and the redraw which is higher priority than the
	validation.

2001-03-07  Havoc Pennington  <hp@redhat.com>

	* btk/btkentry.c (btk_entry_get_property): remove trailer
	(btk_entry_set_property): remove trailer

	* btk/btkentry.c (btk_entry_set_width_chars): 
	(btk_entry_get_width_chars): new functions, to set size request to 
	a given number of characters

	* btk/testbtk.c (create_dialog): beef up the dialog test slightly

	* btk/btkdialog.c (btk_dialog_set_has_separator): new function
	(btk_dialog_get_has_separator): new function
        (run_delete_handler): fix to not emit "response" signal
	because we already did in the delete event handler installed
	at dialog creation time.
	
	* btk/btkdialog.h: add a has_separator property,
	add BTK_DIALOG_NO_SEPARATOR flag

2001-03-07  Havoc Pennington  <hp@redhat.com>

	* btk/btkwindow.c (btk_window_set_decorated): new function, turns
	off decorations for a window.

	* demos/btk-demo/button_box.c (create_bbox): adapt to button box
	changes

	* btk/btklabel.c (btk_label_get_layout_offsets): new function 
	to get location of BangoLayout inside the label, closes #51198

	* btk/testbtk.c (create_bbox): fix up button box usage

	* btk/testcalendar.c (create_calendar): fix up button box usage

	* btk/btkfilesel.c (btk_file_selection_init): fixup buttonbox usage

	* btk/btkdialog.c (btk_dialog_init): fixup buttonbox usage

	* btk/btkhbbox.h: deprecations

	* btk/btkvbbox.h: deprecations

	* btk/btkbox.c (btk_box_get_spacing): new function, used to
	emulate deprecated btk_button_box_get_spacing

	* btk/btkbbox.h: deprecate some useless functions, remove entirely 
	the "set global default" functions
	(struct _BtkButtonBox): remove "spacing" field, use the one from 
	BtkBox base class

	* btk/btkbbox.c (_btk_button_box_child_requisition): rename with uscore

	* btk/btkiconfactory.c (btk_icon_set_render_icon): If we fail to
	render the icon, return the missing image icon.

	* btk/btkimage.c (btk_image_set_from_file): fall back to missing
	image icon if the load fails.	

	* btk/btkstock.h (BTK_STOCK_MISSING_IMAGE): Add stock icon for use
	when no image is found; should be the Netscape "missing image"
	icon eventually but for now is a random image

	* btk/btkwindow.c (btk_window_set_role): new function, sets the 
	role for the session manager

	* btk/testbtk.c (dnd_drop): remove use of BTK_WINDOW_DIALOG

	* btk/btkcompat.h (BTK_WINDOW_DIALOG): compat #define
	BTK_WINDOW_DIALOG BTK_WINDOW_TOPLEVEL

	* btk/btkenums.h (enum BtkWindowType): remove BTK_WINDOW_DIALOG

Wed Mar  7 13:24:57 2001  Tim Janik  <timj@btk.org>

	* btk/*.c: marshaller fixes.
	
	* btk/btkmarshal.list: extreme cleanup.

	* btk/btktreeview.c (btk_tree_view_class_init): disable interface
	param spec for now.

	* btk/btktexttag.c (btk_text_tag_set_property): use g_value_get_boxed()
	where appliable.

	* btk/btktypeutils.[hc]: updates to GLib API changes.
	special cased autogenerated boxed types from btktypebuiltins_ids.c
	which are not reference counted:
	BtkSelectionData, BdkEvent, BdkColor, BtkTextIter, BangoTabArray,
	BangoFontDescription, BtkTreeIter and BtkTreePath.

Thu Mar  1 03:58:56 2001  Tim Janik  <timj@btk.org>

	* btk/btktreeselection.h: 
	* btk/btktreemodel.c:
	* btk/btktreedatalist.[hc]: fixed includes. no bobject/*
	file should be included directly, and bobject/gmarshal.h
	as well as btk/btkmarshal.h even can't be included directly.

	* Makefile.am: grr, install btk-config-2.0.

	* btk/testbtk.c:
	* btk/simple.c:
	* btk/btkmenu.c:
	* btk/btkitemfactory.c: use g_object_connect() instead of
	passing "*signal*::*" args to btk_widget_set().
	
	* btk/btktypeutils.[hc]: got rid of BTK_TYPE_SIGNAL.
	
	* btk/*.c: removed trailer arg from property setters and getters.
	macro fixups.

2001-03-07  Alexander Larsson  <alexl@redhat.com>

	* btk/btklabel.c (set_markup): Removed warning

Tue Mar  6 19:59:12 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkcellrenderer.h (struct _BtkCellRenderer): Add visible
	field to allow you to hide cell renderers.

	* btk/btkcellrenderer.c: Add support for invisible cells.

	* btk/btktreeview.c: Add support for invisible cells.

Tue Mar  6 17:25:07 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeviewcolumn.c (btk_tree_view_column_button_clicked):
	Add "clicked" signal back to columns.

	* ChangeLog: remove conflict markers.

Tue Mar  6 10:45:45 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkbutton.c: Add animation of activation by, on 
	activate, pressing the button, and adding a timeout that 
	releases the button after 250ms	or on key release and
	emits ::clicked. (#51501)

	* btk/btkdialog.c: Bit of a hack - for buttons in the
	action area, we connect to ::clicked instead of ::activate
	so the dialog stays up through the animation.

Mon Mar  5 16:38:15 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmenushell.c (btk_menu_shell_enter_notify): Only
	check the ignore_enter flag for the menu shell that
	the item is actually a child of, not for attached
	submenus. (#51536)

Tue Feb 27 02:16:14 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmain.c (btk_propagate_event): Only do special
        special key-press grab handling for widgets within
        BtkWindows. Otherwise, fall through to normal case.

        This prevents key events being sent twice to BtkInvisible
        widgets, which can cause all sorts of mischief.

Fri Feb  2 13:20:12 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmain.c (btk_propagate_event): When a grab
	widget is in effect, give the grab widget a first
	crack at KEY_PRESS/RELEASE events. (#424)

2001-03-06  James Henstridge  <james@daa.com.au>

	* btk/btkwidget.c (btk_widget_class_init): set the class closure
	offset for the window_state_event to point at window_state_event
	rather than no_expose_event.

Mon Mar  5 19:10:15 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkimmodule.h: fix busted /* comment */

Mon Mar  5 15:07:05 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c: Apply patch from John Margaglione to add
	object properties.

Mon Mar  5 14:55:19 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkcellrenderertoggle.c: Apply patch from Lee Mallabone to
	add object properties.

	* btk/btkcellrenderertextpixbuf.c: Apply patch from Lee Mallabone
	to add object properties.

	* btk/btkcellrenderertext.c: Apply patch from Lee Mallabone to add
	object properties.

	* btk/btkcellrendererpixbuf.c: Apply patch from Lee Mallabone to
	add object properties.

	* btk/btkcellrenderer.c: Apply patch from Lee Mallabone to add
	object properties.

Mon Mar  5 14:38:54 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreemodel.c: renamed "child_toggled" to
	"has_child_toggled".

	* btk/btktreeview.c: Handle removing columns better.  Updated to
	handle new signal name.

	* btk/btktreestore.c: Updated to handle new signal name.
	* btk/btklisttore.c: Updated to handle new signal name.
	* btk/btktreemodelsort.c: Updated to handle new signal name.

2001-03-05  Alexander Larsson  <alexl@redhat.com>

	* btk/btkmenu.c (btk_menu_set_tearoff_state):
	Set BDK_WINDOW_TYPE_HINT_MENU on tearoff window.

2001-03-05  Michael Natterer  <mitch@gimp.org>

	* btk/btklabel.c: Made the "parent_class" pointer static. The
	pixbuf-engine coincidentially also failed to make one of it's
	parent_class pointers static, causing overwriting of BtkLabel's
	parent_class pointer in pixbuf_style_class_init().
	(Will commit the fix to the pixbuf-engine too).

2001-03-05  Alexander Larsson  <alexl@redhat.com>

	* bdk/bdkwindow.h:
	Added BdkWindowTypeHint type. Added modal_hint field to BdkWindindow.
	New functions bdk_window_set_type_hint, bdk_window_set_modal_hint and
	bdk_window_set_icon_list for net wmspec functionality.

	* bdk/x11/bdkwindow-x11.c:
	Set _NEW_WM_STATE_MODAL from window->modal_hint in set_inital_hints.
	Implement bdk_window_set_type_hint, bdk_window_set_modal_hint and
	bdk_window_set_icon_list.
	Added bdk_wmspec_change_state helper function and used it in the code.
	Set _NET_WM_ICON_NAME in bdk_window_set_title and bdk_window_set_icon_name.

	* btk/btkdialog.c (btk_dialog_init):
	Set BDK_WINDOW_TYPE_HINT_DIALOG.

	* btk/btkhandlebox.c (btk_handle_box_realize):
	Set BDK_WINDOW_TYPE_HINT_TOOLBAR.

	* btk/btkwindow.c:
	new function btk_window_set_type_hint.
	On realize, set type hint and modal hint.

	* btk/btkwindow.h:
	Added type_hint field and btk_window_set_type_hint.

2001-03-05  Alexander Larsson  <alexl@redhat.com>

	* btk/btklabel.[ch]:
	Convert from BtkArg to GParam (originally based on patch from Lee Mallabone).
	New function btk_label_get_accel_keyval () to get the underline accelerator
	of the label. Setting the label pattern overrides other attributes.

Mon Mar  5 14:51:10 MET 2001  Sven Neumann  <sven@gimp.org>

	* btk/btkrc.c: fixed compiler warnings by inserting some consts.
	Added missing initializers to btk_rc_style_init().

Sun Mar 04  07:30:03 2001 CET Mikael Hermansson <mikeh@bahnhof.se>

	* btk/btktextview.c: fixed bug #51097 about setting 
	btk_text_view_set_border_window_size() if the widget is 
	already realized.

Sat Mar  3 16:59:16 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkbango.h bdk/x11/bdkwindow-x11.c: Doc fixes

	* bdk/win32/bdkinput.c (bdk_device_get_axis): Remove doc
	comment. Won't do to have duplicated doc comments between
	the platform subdirs.

Sat Mar  3 16:26:33 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkmain-x11.c bdk/x11/bdkkeys-x11.c 
	  bdk/x11/bdkevents-x11.c bdk/x11/bdkprivate-x11.c:

	Detectable auto-repeat - make a repeating key generate
	press/press/press/release instead of press/release pairs.

	If we have Xkb and XkbSetDectableAutoRepeat supports
	that, we do it that way. Otherwise, when we get
	a release event, we check ahead with XPending to see
	if the next key is a KeyPress with the same keycode
	and timestamp. (Not 100% reliable, but pretty close.)
	  
Tue Feb 27 02:16:14 2001  Owen Taylor  <otaylor@redhat.com>
	
  	* btk/btkmain.c (btk_propagate_event): Only do special
        special key-press grab handling for widgets within
        BtkWindows. Otherwise, fall through to normal case.
 
        This prevents key events being sent twice to BtkInvisible
        widgets, which can cause all sorts of mischief.
 
Fri Feb  2 13:20:12 2001  Owen Taylor  <otaylor@redhat.com>
 
 	* btk/btkmain.c (btk_propagate_event): When a grab
 	widget is in effect, give the grab widget a first
 	crack at KEY_PRESS/RELEASE events. (#424)
 
Sat Mar  3 15:39:49 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkentry.c (btk_entry_button_press): Add shift-clicking
	to extend the selection. (Roughly based on patch
	from Jay Cox, #50939)

	* btk/btkentry.c (btk_entry_button_press): Fix triple-clicking
	to properly handle previous BDK_BUTTON_PRESS. 
	(Patch from Jay Cox, #50938)

	* btk/btkentry.c (btk_entry_real_delete_text): Move the
	'\0' back along with the deleted text. (#51148)

Mon Jan 22 14:31:29 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkevents-x11.c (bdk_event_translate): Unshift
	the group when extracting it from the X keyboard event.

	* modules/input/Makefile.am modules/input/imipa.c: 
	Simple module for entering IPA. (Do we need a 
	btk-stupid-input-tricks CVS module?)

Sat Mar  3 13:32:47 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkimmodule.c (btk_im_module_init): Remove spurious
	const.

	* bdk-pixbuf-2.0.pc.in btk+-2.0.pc.in: Fix include path.

	* btk/btkdialog.c (btk_dialog_set_default_response): If there
	is no focus widget for the dialog currently, grab the focus as well
	as the default.

	* btk/btkdialog.c (btk_dialog_set_default_response): Get
	the action area's children to iterate through, not the
	dialog's children.

Sat Mar  3 13:21:27 2001  Owen Taylor  <otaylor@redhat.com>

	* tests/Makefile.am tests/testsocket.c tests/testsocket_child.c:
	Add plug-socket tests. (Won't work worth a darn until I commit
	the rest of the plug-socket changes, but no reason these
	can't go into CVS now.)

2001-03-02  Havoc Pennington  <hp@redhat.com>

	* bdk/x11/bdkgc-x11.c (_bdk_x11_gc_flush): use
	_bdk_rebunnyion_get_xrectangles()

	* bdk/x11/bdkmain-x11.c (_bdk_rebunnyion_get_xrectangles): new function

	* btk/testbtk.c (create_shapes): add test for shape_combine_rebunnyion

	* bdk/x11/bdkwindow-x11.c (bdk_window_shape_combine_rebunnyion): new
	function, contributed by Ron Steinke	

	* bdk/x11/bdkevents-x11.c (bdk_wmspec_supported): rename
	bdk_net_wm_supports

	* bdk/bdkrebunnyion-generic.c (bdk_rebunnyion_get_rectangles): 
	New function, contributed by Ron Steinke

	* btk/btkentry.c (btk_entry_get_layout_offsets): New function, 
	used to line up the text in the entry when using the entry for
	editable sheet cell hacks

	* btk/testbtk.c (create_entry): test the activate_default setting
	on BtkEntry

	* btk/btkentry.c (btk_entry_set_activates_default): New function to 
	cause the entry to activate the default button for a dialog when 
	activated
	(btk_entry_get_activates_default): new function

Wed Feb 28 19:10:43 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkclist.c (real_remove_row): Patch from ChiDeok
	Hwang to move call to sync_selection() up a few lines
	to before the row list is modified, to fix crash when
	removing rows in the undo_selection list.

	(Test case provided by Daniel Elstner:

        http://mail.bunny.org/archives/btk-list/2001-February/msg00359.html)

Fri Feb 23 15:06:48 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btktree.c (btk_tree_class_init): Do the setting
	of tree->root_tree in parent_set rather than _map(), 
	fixing #50892 in a bit better manner.

Thu Feb 22 17:07:58 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmenu.c (btk_menu_popup): Don't flip cursor. (#50934)

Tue Feb  2 11:22:33 2001  Jody Goldberg <jgoldberg@home.com>

	* btk/btkstyle.c : Remove duplicate fwd decl for
	btk_default_draw_shadow.

ue Feb 20 11:40:58 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkimage.c (bdk_image_new): Remove excess 
	warning, make warnings more verbose, treat a error
	in shmat as permanent, and don't try again.
	(#51163, Ed Randall.)

Mon Feb 19 20:15:28 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkrange.c (btk_range_timer_1st_time): Add an initial
	delay for the first click before starting to scroll.
	(based on #51026, btk-enf-990512-0.patch, Eric Fisher)

	* btk/btktext.c: BtkText should have I-beam cursor. 
	(based on btk-enf-990513-1.patch, Eric Fisher.)

Mon Feb 19 16:42:19 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btklayout.c (btk_layout_allocate_child): Tiny
	cleanup to remove some references to unused
	->xoffset, ->yoffset.

Mon Feb 19 14:20:36 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkrgb.c (bdk_rgb_convert_555_br): Fix incorrect
	mask. (#51039, fix from Martin Maierhofer)

Fri Feb 16 20:09:42 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkctree.c (btk_ctree_class_init): Add bindings
	for unshifted + and shifted = for non-us keyboards.
	Make <Control>+ and <Control>- work as well as 
	<Control>KP_Plus, <Control>KP_Minus for recursive
	open/close.  (#2682, Ren Seindal)

Fri Feb 16 18:50:59 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmenushell.c (btk_real_menu_shell_cancel): Unset
	the active menu item before deactivating the menu,
	so btk_menu_popdown doesn't change the history. (#50964)
	
Fri Feb 16 15:55:22 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btktreeitem.c (btk_tree_item_draw_lines): 
	draw lines with text_gc rather than black_gc.
	(Patch from Vlad Harchev <hvv hippo ru>, #50926)

Thu Mar  1 19:50:56 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeviewcolumn.c (_btk_tree_view_column_realize_button):
	Move handling of buttons fully in btktreeviewcolumn.  This code is
	less interrelated then it was, but it still requires the
	BtkTreeView to map it.

	* test/testtreecolumn.c: Now I can add a column to one view,
	remove it, add it to the another view, remove it, then re-add it
	to the first.  Nifty.

Thu Mar  1 13:14:27 GMT 2001  Tony Gale <gale@btk.org>

	* docs/tutorial/btk-tut.sgml: Minor corrections

Wed Feb 28 16:36:46 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreemodel.c (btk_tree_row_reference_*): Sanitize
	BtkRowReference.

2001-02-28  Havoc Pennington  <hp@redhat.com>

	* btk/btkwidget.h (struct _BtkWidgetClass): Remove draw_focus and
	draw_default
	(btk_widget_draw_focus): remove this function; we could instead
	make it just btk_widget_draw(), but in most cases I think the
	result would be broken user code, so think it's better to have
	that code not compile and get fixed
	(btk_widget_draw_default): ditto

	* btk/btkwidget.c: Add default handlers for focus_in_event and
	focus_out_event that set/unset BTK_HAS_FOCUS and call queue_draw
	
	* btk/btkwindow.c (btk_window_set_default): just queue a draw when
	widgets lose/get the default, instead of calling draw_default
	
	* docs/Changes-2.0.txt: note about all this

	Then fixed every widget in BTK, I won't list all the filenames.

Tue Feb 27 19:32:53 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreemodel.c (deleted_callback): Proxy out to
	_btk_tree_row_reference_deleted.
	(inserted_callback): Proxy out to
	_btk_tree_row_reference_inserted.
	(_btk_tree_row_reference_new_from_view): Somewhat yukky hack to
	get around signal emission ordering problem.

	* btk/btktreeselection.c (btk_tree_selection_real_unselect_all):
	fix to work with SINGLE 
	(_btk_tree_selection_internal_select_node): Major sanitization on
	selections.  SINGLE now seems to work.

	* tests/Makefile.am: add testtreecolumn.c:

	* tests/testtreecolumn.c: New test.  Mostly points out selection
	bugs currently, but will test columns later.

	* btk/btkrbtree.c (_btk_rbtree_remove_node): Fix really nasty
	selection bug.  I hate touching this code -- it's scary.

2001-02-26  Havoc Pennington  <hp@redhat.com>

	* btk/testbtk.c: test the window state stuff

	* btk/btkwindow.c (btk_window_present): new function, makes a
	window come to the user's attention as if it were just created
	(btk_window_iconify): new function
	(btk_window_deiconify): new function
	(btk_window_stick): new function
	(btk_window_unstick): new function
	(btk_window_maximize): new function
	(btk_window_unmaximize): new function

	* btk/btkwidget.h, btk/btkwidget.c: add window_state_event signal

	* btk/btkmain.c (btk_main_do_event): handle BDK_WINDOW_STATE

	* bdk/x11/bdkevents-x11.c: create window state events when
	appropriate
	(bdk_wmspec_supported): new function

	* bdk/x11/bdkwindow-x11.c (bdk_window_iconify): handle
	iconification before showing the window
	(bdk_window_deiconify): new function
	(bdk_window_stick): new function
	(bdk_window_unstick): new function
	(bdk_window_maximize): new function
	(bdk_window_unmaximize): new function

	* bdk/bdkwindow.c: store the window state in the window; 
	change to using the BDK_WINDOW_STATE_WITHDRAWN flag instead of
	window->mapped.
	(bdk_window_get_state): return the current window state

	* bdk/bdkevents.c (bdk_event_get_time): handle BDK_WINDOW_STATE
	(bdk_event_get_state): handle BDK_WINDOW_STATE
	(bdk_synthesize_window_state): function to create the window state
	events

	* bdk/bdkevents.h (struct _BdkEventWindowState): new type of
	event, for changes to "window state" such as maximized, sticky, 
	etc.
	
	* bdk/x11/bdkwindow-x11.c (bdk_window_focus): new function,
	focuses a window

	* bdk/x11/bdkmain-x11.c (_bdk_wmspec_supported): new function, 
	finds out if we support a given WM spec hint

Tue Feb 27 13:37:38 GMT 2001  Tony Gale <gale@btk.org>

	* docs/faq/btk-faq.sgml: New question re memory leaks.

2001-02-25  Hans Breuer  <hans@breuer.org>

	* bdk/bdk.h : changed #ifdef BDK_DISBALE_DEPRECARED to #ifndef
	cause we want to loose those prototypes only in the latter case

	* bdk/win32/bdkevents-win32.c : can't cast from BdkPixmap to
	BdkPixmapImplWin32 because it itsn't derived from it. Use the
	impl member variable instead

	* btk/btk.def : updated

	* btk/btklist.c : 
	* btk/btkmenus.c : include <string.h> for memset ()

	* btk/makefile.msc.in : updated and don't define BTK_COMPILATION
	for everthing built here, but for btk-x.x.dll only. This solves
	problem of indifferent btk type definitions

Sat Feb 24 20:11:39 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkclipboard.h: actually put /* */ around #endif comment.

Fri Feb 23 17:50:13 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_bin_expose): Only draw the
	column that is exposed.

	(_btk_tree_view_update_size): Changed name from set_size, and
	changed function to do more work, and not force people calling it
	to figure out the size.  Simplifies a lot of code elsewhere.

2001-02-23  Alexander Larsson  <alexl@redhat.com>

	* bdk/bdkpixmap.c (bdk_pixmap_colormap_new_from_pixbuf):
	return solid masks for xpms that have no transparent color.
	This makes the ..._create_from_xpm... API backwards
	compatible.

2001-02-23  Tor Lillqvist  <tml@iki.fi>

	* README.win32: Update. Mention the btk-1-3-win32-production
	branch.

	* bdk/win32/bdfcursor.c: New file. A program that generates
	xcursors.h. Thanks to Stefan Ondrejicka.

	* bdk/win32/xcursors.h: New file, contains the X cursor font in a
	compact format.

	* bdk/win32/Makefile.am (EXTRA_DIST): Add new files.

	* bdk/win32/bdkcursor-win32.c (_bdk_win32_data_to_wcursor): New
	function, uses xcursors.h.
	(bdk_cursor_new): Use _bdk_win32_data_to_wcursor to generate
	cursor from inline data instead of using LoadCursor() to generate
	it from a resource.

	* bdk/win32/bdkevents-win32.c (bdk_event_translate): At button up
	event, must check the Windows message for mouse button state, as
	the BDK event state might not have been built if it is
	undelivered. Remove one goto.

	* bdk/win32/bdkwindow-win32.c (bdk_window_set_cursor): Call
	SetCursor() if the current cursor as returned by GetCursor() is
	the window's previous cursor. The ChildWindowFromPoint() test
	apparently didn't work correctly.

	* bdk/win32/rc/*.cur: Remove.

	* bdk/win32/rc/bdk.rc.in: Remove cursors.

	* bdk/win32/rc/Makefile.am (EXTRA_DIST): Remove from here, too.

	* btk/makefile.{mingw,msc}.in: Updates.

Wed Feb 21 20:56:50 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreemodel.h: add functions for signal emission.

	* btk/btktreestore.c: move to use above functions instead of
	g_signal_emit.

	* btk/btkliststore.c: ditto

Wed Feb 21 15:41:34 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreestore.c: removed signals.  Moved to inherit from
	GObject instead of BtkObject.

	* btk/btkliststore.c: ditto.

	* btk/btktreemodelsort.c: ditto.

	* btk/btktreemodel.c (btk_tree_model_base_init): moved signals to
	BtkTreeModelIface, instead of in each model.

2001-02-21  Havoc Pennington  <hp@redhat.com>

	* btk/btktextbuffer.c (btk_text_buffer_insert_child_anchor):
	unbreak this function

	* btk/btkentry.c: apply patch from Lee Mallabone to add object 
	properties

	* btk/btkcurve.c: apply patch from Lee Mallabone to add object
	properties

	* btk/btkcombo.c: apply patch from Lee Mallabone to add object 
	properties

	* btk/btkentry.c (btk_entry_set_max_length): have this take -1 to
	mean unset the max length

Wed Feb 21 14:23:05 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeviewcolumn.c (btk_tree_view_column_set_cell_data_func):
	Changed name to be set_cell_data_func to make it clear what
	the functino does.  Close bug #51069.

Tue Feb 20 16:49:00 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/testbtk.c (main): Remove turning on of profiling malloc,
	have memory actually freed.  Keeps box running longer.

2001-02-21  Alexander Larsson  <alexl@redhat.com>
	
        * btk/btkseparatormenuitem.[ch]:
	Added new menu separator item. The drawing and size handling
	is still done in BtkMenuItem, but the API is a bit more sane.
	
	* btk/Makefile.am:
	Add btkseparatormenuitem.[ch].

	* btk/btk.h:
	Add btkseparatormenuitem.h.
	
	* btk/btkentry.c:
	* btk/btkmenufactory.c:
	* btk/btktextview.c:
	Use the new API for menu separators.
	
	* demos/btk-demo/menus.c (create_menu):
	Add some BtkSeparatorMenuItem demo code.

2001-02-20  Havoc Pennington  <hp@redhat.com>

	* btk/btkaspectframe.c: Convert to new property API, patch from 
	Lee Mallabone

	* btk/btkarrow.c: Convert to new property API, patch from 
	Lee Mallabone

Tue Feb 20 14:26:41 2001  Jonathan Blandford  <jrb@redhat.com>

	* tests/testtreeview.c (toggled_callback): fix to reflect change
	in BtkTreeModelStore.

Tue Feb 20 12:16:12 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkiconfactory.c (btk_icon_set_new_from_pixbuf): New
	function to create an icon set from a pixbuf.

2001-02-20  Alexander Larsson  <alexl@redhat.com>

	* btk/btkcellrenderertext.[ch]:
	Add a "markup" property.

	* btk/treestoretest.c:
	Use the markup property, remove some leftover stuff from
	BtkTreeModelMapping.

2001-02-20  Alexander Larsson  <alexl@redhat.com>

	* btk/btklabel.c (btk_label_set_selectable):
	Queue a redraw if the selectable setting was changed.

2001-02-20  Alexander Larsson  <alexl@redhat.com>

	* bdk/linux-fb/bdkgc-fb.c (bdk_gc_copy):
	Actually copy the whole gc, not just the public parts.
	
	* bdk/linux-fb/bdkwindow-fb.c (bdk_window_new):
	BDK_WINDOW_TEMP are not toplevel. Fixes selectable
	labels.

2001-02-19  Havoc Pennington  <hp@pobox.com>

	* bdk/bdkwindow.c: docs

	* bdk/bdkrgb.c: docs

	* bdk/bdkrebunnyion-generic.c: docs

	* bdk/bdkgc.c (bdk_gc_set_values): docs

	* bdk/bdkdraw.c: docs

	* bdk/bdkdrawable.h: deprecate drawable get/set data

Mon Feb 19 20:37:35 2001  Jonathan Blandford  <jrb@redhat.com>

	* demos/btk-demo/dialog.c: Add simple new demo.

2001-02-19  Havoc Pennington  <hp@redhat.com>

	* btk/btktextbuffer.h (struct _BtkTextBufferClass): add
	insert_child_anchor signal, bug #50245

	* btk/btktextbtree.c (_btk_text_btree_insert_child_anchor): change
	from create_child_anchor, so the anchor is passed in

	* btk/btktextchild.c (btk_text_child_anchor_new): new function
	(_btk_widget_segment_new): have the child anchor object passed in, 
	instead of creating it.

	* btk/btktextbuffer.c (btk_text_buffer_modified): rename
	to btk_text_buffer_get_modified

2001-02-19  Havoc Pennington  <hp@redhat.com>

	* btk/btktreemodel.c (btk_tree_model_get_valist): hmm, someone
	changed GLib without fixing BTK

	* btk/btkrange.h: Rename all the stupid implementation detail 
	functions to have an underscore in front. Most of them should 
	probably just go away, but for starters don't export them.
	Bug #50482

2001-02-19  Havoc Pennington  <hp@redhat.com>

	* bdk/bdkcolor.h: test was backward, so deprecated functions were
	excluded by default

	* btk/btkstyle.c (btk_default_draw_diamond): draw etched in/out,
	clean up the old code a bit

	* btk/btkradiobutton.c (btk_radio_button_draw_indicator): draw
	inconsistent state

	* btk/btkradiomenuitem.c (btk_radio_menu_item_draw_indicator):
	draw inconsistent state

	* btk/testbtk.c (create_toggle_buttons): add test for inconsistent
	(create_menu): add inconsistent test

	* btk/btkcheckmenuitem.c (btk_check_menu_item_set_inconsistent):
	new function
	(btk_check_menu_item_get_inconsistent): new function
	(btk_real_check_menu_item_draw_indicator): draw the inconsistent
	state (using etched in for now)

	* btk/btkcheckbutton.c (btk_real_check_button_draw_indicator):
	draw inconsistent state

	* btk/btktogglebutton.c (btk_toggle_button_set_inconsistent): new
	function, used when the user has selected a range of stuff in
	different states
	(btk_toggle_button_get_inconsistent): accessor for that
	(btk_toggle_button_paint): draw inconsistent state (etched in?
	don't know what else to do)

2001-02-19  Hans Breuer <hans@breuer.org>

	* btk/btk.def : updated exported symbols

	* btk/makefile.msc.in : updated

	* btk/btkstyle.c (btk_style_realize) : gets called without
	a colormap, when invoked from testbtk::entry. I'm not sure where
	the bug is, but g_return_if_fail (BDK_IS_COLORMAP (colormap));
	avoids immediate crashing ...

	* btk/btkmain.c (check_setugid) : totally disabled on win32;
	any objections ?

	* btk/btktreemodel.c : called G_VALUE_LCOPY with an extra
	0 parameter. At least msvc doesn't like macros with var args. 
	I simply removed the extra 0, was it a feature or a typo ?

	* btk/btktreeviewcolumn.[hc] (btk_tree_view_column_set_func) :
	removed the extra indirection from the BtkTreeViewColumnFunc parameter,
	because the value assignment to the internal struct wasn't working.
	I'm not absolutely sure. The problem could have been resolved by
	changing the "func" declartion in the struct, but was the pointer
	to the function pointer intended ?

	* btk+/btk/btktreedatalist.c : include gboxed.h

	* bdk/bdk.def : updated exported symbols

	* bdk/win32/bdkdrawable-win32.c (bdk_win32_draw_image) :
	only use SetDIBitsToDevice if there is a palette at the drawable
	and the image is BDK_VISUAL_PSEUDO_COLOR

	* bdk/win32/bdkkeys-win32.c : msvc still has no <unistd.h> ...

	* bdk/win32/bdkwindow-win32.c : #include "bdk.h" /* bdk_rectangle_intersect */

	* bdk/*/makefile.msc : updated

2001-02-19  Havoc Pennington  <hp@redhat.com>

	* demos/btk-demo/Makefile.am (INCLUDES): BDK_DISABLE_COMPAT_H,
	BDK_DISABLE_DEPRECATED (we need to merge those two #defines)

	* bdk/x11/bdkmain-x11.c (bdk_key_repeat_disable): nuke
	(bdk_key_repeat_restore): nuke

	* bdk/bdk.c (bdk_exit_func): #if 0 this for now, don't install it
	(bdk_init_check): no atexit func

	* bdk/bdkrgb.h: mark some stuff deprecated

	* bdk/bdkcolor.h: mark some stuff deprecated
	
	* bdk/bdk.h: deprecated bdk_exit, bdk_input_*

	* bdk/bdkfont.h: bracket in BDK_DISABLE_DEPRECATED

2001-02-16  Havoc Pennington  <hp@redhat.com>

	* btk/btkvscrollbar.c (btk_vscrollbar_trough_keys): use the visual
	scroll steps.

	* btk/btkvscale.c (btk_vscale_trough_keys): use the visual scroll
	steps, and add Ctrl-arrow shortcuts for paging visually as with
	HScale, since Page Up and Page Down move logically.

	* btk/btkenums.h (BtkScrollType): add BTK_SCROLL_STEP_UP,
	BTK_SCROLL_STEP_DOWN, etc. for visual scroll directions
	
	* btk/btkrange.c (btk_range_key_press): handle the visual scroll
	steps
	(btk_range_scroll): handle the visual steps

	* btk/btklist.c (btk_list_scroll_horizontal): handle the up/down
	scroll steps

	* btk/btkhscale.c (btk_hscale_trough_keys): use the visual scroll
	steps, not the logical ones.

	* btk/btkclist.c (move_focus_row): handle the up/down scroll steps
	(scroll_vertical): handle up/down steps

2001-02-19 Alexander Larsson  <alexl@redhat.com>

	* bdk/linux-fb/bdkimage-fb.c (bdk_image_new_bitmap):
	Copy data and free data with free().

	* bdk-pixbuf/bdk-pixbuf.c:
	* bdk-pixbuf/io-jpeg.c:
	* bdk-pixbuf/io-png.c:
	Use g_try_malloc/g_free instead malloc/free.
	
	* bdk-pixbuf/test-bdk-pixbuf.c:
	Must... initialize... bobject...
	
	* bdk-pixbuf/pixops/timescale.c:
	* btk/btkcalendar.c:
	Use g_malloc instead of malloc.
	
2001-02-19 Alexander Larsson  <alla@lysator.liu.se>

	* btk/testbtkrc:
	Comment out property assignments, these don't work yet.

2001-02-17  Havoc Pennington  <hp@pobox.com>

	* btk/btkalignment.c (btk_alignment_class_init): clean this up a
	bit.

2001-02-17  Havoc Pennington  <hp@pobox.com>

	* btk/btklabel.c (btk_label_ensure_layout): fix screwup with
	shadowed variables that had broken size request in some cases,
	leading to bogus tooltips (#50996)

2001-02-06  Jon K Hellan  <hellan@acm.org>

	Implement fast browsing of tooltips, bug #50619
	
	* btk/btktooltips.h (struct _BtkTooltips): Add use_sticky_delay
	and last_popdown
	
	* btk/btktooltips.c (btk_tooltips_init): Initialize sticky_delay,
	use_sticky_delay and last_popdown.
	(btk_tooltips_draw_tips, btk_tooltips_set_active_widget): Record
	time of popdown.
	(btk_tooltips_set_active_widget): Unset sticky behaviour if widget
	is NULL.
	(btk_tooltips_recently_shown): New static function.  Return true
	if < sticky_delay has elapsed since last popdown.
	(btk_tooltips_event_handler): Display window after sticky_delay
	(presumably < normal delay) if < STICKY_REVERT_DELAY has elapsed
	since last popdown.
	
2001-02-17  Havoc Pennington  <hp@pobox.com>

	* btk/btktypeutils.h (BtkSignalFunc): change it to take (void)
	instead of (). #6394

	* btk/btkprogressbar.c (btk_progress_bar_get_text): Add
	G_CONST_RETURN, make it return by reference, #50473
	
Sat Feb 17 06:47:27 2001  Tim Janik  <timj@btk.org>

	* btk/btkmenu.c (btk_menu_motion_notify): default initialize the
	generated ENTER_NOTIFY event with 0, otherwise not explicitely
	setup fields contain garbage (e.g. subwindow, breaking
	bdk_drawable_ref() upon event copy).
	(btk_menu_stop_navigating_submenu_cb): same here.

	* btk/btklist.c (btk_list_vertical_timeout): 
	* btk/btklist.c (btk_list_horizontal_timeout): 
	* btk/btkclist.c (vertical_timeout): 
	* btk/btkclist.c (horizontal_timeout): change direct assignment
	default-zero-intialization for unions to memset(,0,), as unions are
	not fully default-zero-initialized by compilers (BdkEvent x = { 0, };
	has to become BdkEvent x; memset (&x, 0, sizeof (x)); )

	* btk/btktreeview.c (btk_tree_view_set_rows_drag_source): scratch
	g_closure_sink() warning.

	* btk/btktreemodel.c (btk_tree_model_get_valist): 
	* btk/btktreestore.c (btk_tree_store_set_valist): 
	* btk/btkliststore.c (btk_list_store_set_valist): 
	fix G_VALUE_COLLECT() and G_VALUE_LCOPY() calls.
	
Fri Feb 16 17:49:59 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreestore.[hc], btk/btkliststore.[ch]: removed
	btk_*_store_get, and moved to BtkTreeModel.

	* btk/btktreemodel.h (btk_tree_model_set{v,}): Added

	* btk/btktreeviewcolumn.c (btk_tree_view_column_finalize): added.

	* btk/Makefile.am: remove btktreemodelmapping.[ch]

	* btk/btktreeviewcolumn.c (btk_tree_view_column_set_func): let you
	set the func.

	* btk/btktreeviewcolumn.c (btk_tree_view_column_set_cell_data):
	freeze/thaw notify between setting all the properties for a cell.

	* btk/btk.h: remove btktreemodelsimple.h, and btktreemodelmapping.h

2001-02-15  Havoc Pennington  <hp@redhat.com>

	* bdk/bdkbango.c (bdk_bango_layout_line_get_clip_rebunnyion): convert
	the X coordinates so they're with respect to the line, rather than 
	with respect to the layout.

	* btk/btkalignment.c: Convert to new property API, patch from Lee
	Mallabone

	* btk/testbtk.c (create_range_controls): add vscale tests, 
	and inverted test

	* btk/btkrange.c (btk_range_set_inverted): new function to fix 
	#50806

	* btk/btkentry.c (btk_entry_get_text): add G_CONST_RETURN

	* btk/btktextiter.h (btk_text_iter_is_last): rename 
	btk_text_iter_is_end

	* btk/btktextbuffer.h (btk_text_buffer_get_last_iter):
	rename btk_text_buffer_get_end_iter

	* btk/testbtk.c (create_labels): Add test for selectable

	* btk/btkentry.c (btk_entry_draw_text): Use new BDK API to draw
	the selection stuff. This code is kind of broken since it doesn't 
	use the theme engine.

	* bdk/bdkbango.c (bdk_bango_layout_line_get_clip_rebunnyion): 
	fix infinite loop and y offset problem
	(bdk_draw_layout_line_with_colors): fix foreground color handling

        * btk/btklabel.h, btk/btklabel.c: Implement a "selectable" flag 
	that makes the label selectable.
	
	* btk/btklabel.c (btk_label_style_set): recreate the label's
	layout when the style is set, since fonts etc. could have changed.	

Fri Feb 16 14:22:05 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/Makefile.am: Removed btktreemodelsimple.[ch]

	* btk/btktreemodelsimple.[ch]: removed.

2001-02-16  Alexander Larsson  <alexl@redhat.com>

	* btk/btktreemodelmapping.[ch]:
	New files. Implement BtkTreeModelMapping.
	
	* btk/Makefile.am:
	Add btktreemodelmapping.[ch].
	
	* btk/btk.h:
	Add btktreemodelmapping.h

	* btk/treestoretest.c:
	Test the BtkTreeModelMapping

Tue Feb 13 13:16:09 2001  Jonathan Blandford  <jrb@redhat.com>

	* demos/btk-demo/panes.c (create_pane_options): If we're going to
	have a demo, we might as well pass in real values.  Thanks to
	clahey for pointing this out.

2001-02-14  Havoc Pennington  <hp@pobox.com>

	* btk/btkimagemenuitem.c (btk_image_menu_item_remove): add
	"static" to a private function
	(btk_image_menu_item_class_init): remove destroy handler,
	add "image" object property

2001-02-13  Alexander Larsson  <alla@lysator.liu.se>

	* bdk/linux-fb/bdkdrawable-fb2.c (bdk_fb_clip_rebunnyion):
	Add a shortcut if the window and the current clip_rebunnyion doesn't
	overlap. This is needed when there are a lot of windows in a
	window. The layout test in testbtk is a good test.

	* bdk/linux-fb/bdkwindow-fb.c:
	Whitespace fix.

2001-02-13  Sven Neumann  <sven@convergence.de>

	* demos/testanimation.c: replaced deprecated btk_drawing_area_size

2001-02-13  Alexander Larsson  <alexl@redhat.com>

	* bdk/linux-fb/bdkcursor-fb.c (bdk_fb_cursor_unhide):
	Don't reference last_cursor if it is null. Fixes crash when rotating
	the screen before having moved the mouse.

	* bdk/linux-fb/bdkcc-fb.c: Zapp!

	* bdk/linux-fb/Makefile.am: Don't compile bdkcc-fb.c

	* bdk/linux-fb/bdkwindow-fb.c: Fix typo. width->height. Fixes redraw 
	when using 90 or 270 degrees rotation.

2001-02-12  Havoc Pennington  <hp@pobox.com>

	* bdk/bdkbango.c (bdk_bango_get_gc): fix bug where 
	it always set the foreground, even if we were only using
	a stipple.
	(bdk_draw_layout_line_with_colors): new function, allow
	override colors
	(bdk_draw_layout_with_colors): new function, allow override
	colors
	(bdk_bango_layout_line_get_clip_rebunnyion): function to get the clip
	rebunnyion for a logical text range
	(bdk_bango_layout_get_clip_rebunnyion): get the clip rebunnyion for a
	logical text range

	* bdk/x11/bdkcolor-x11.c: forward declare bdk_colormap_sync(),
	(bdk_colormap_new): fix call to bdk_colormap_sync() so it has 
	the right number of arguments.

	* btk/btktextbtree.c (btk_text_btree_node_check_consistency):
	enhance the function to check that node data corresponds to a 
	view still belonging to the tree.

	* btk/btktreeview.c (btk_tree_view_changed): we were leaking the 
	BtkTreePath
	(btk_tree_view_inserted): ditto
	(btk_tree_view_child_toggled): ditto

	* btk/btktreemodel.c (btk_tree_path_append_index): use realloc to
	simplify this code.

	* btk/btkcellrenderertext.c (get_layout): fix leak of 
	a BangoAttrList

	* demos/btk-demo/main.c (load_file): Fix leak of a GString

	* btk/btkentry.c (btk_entry_realize): Fix leak of a BdkCursor

	* btk/btkmenubar.c (btk_menu_bar_size_request): consider toggle
	size in the size request 
	(btk_menu_bar_size_allocate): consider toggle size here

	* btk/btkimagemenuitem.h, btkimagemenuitem.c: Menu item
	that displays a widget in the toggle slot

	* btk/testbtk.c: test BtkImageMenuItem

	* btk/Makefile.am, btk/btk.h: Add BtkImageMenuItem
	
	* btk/btkmenuitem.h: Use "gint" not "guint16" for toggle size
	request and allocation

	* btk/btkmenu.c (btk_menu_size_request): use gint not guint16

	* btk/btkcheckmenuitem.c
	(btk_check_menu_item_toggle_size_request): ditto
	
Mon Feb 12 23:43:30 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/Makefile.am (bdk_headers): Remove bdkcc.h 
	reference.

	* configure.in btk/btkmain.c: Add checks for setuid/setgid,
	and refuse to initialize BTK+ if they fail.

Mon Feb 12 15:02:07 2001  Owen Taylor  <otaylor@redhat.com>

	* configure.in: Add check for btk-doc version.

Thu Feb  8 17:18:26 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btklabel.c (btk_label_size_request): Fix bug
	where the xpad/ypad was only being used on one side!

2001-02-11  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkcolor-win32.c (bdk_colormap_query_color): New
	function, copied from X11 version.

	* bdk/win32/bdkwindow-win32.c (bdk_window_set_cursor): Eliminate
	DestroyCursor failures. The reason for the problem (despite the
	inconsistent messages from GetLastError()) was that
	DestroyCursor() cannot be called while a cursor is set in a
	window. Set the new cursor first and then destroy the old one.
	Thanks to jpe@archaeopteryx.com.

	* bdk/win32/bdkcc-win32.c: Remove.

	* bdk/win32/Makefile.am: Remove from here, too.
	
	* bdk/bdk.def
	* bdk/makefile.mingw.in: Update. Godbye BdkColorContext.

	* btk/btk.def
	* btk/makefile.mingw.in: Updates.

2001-02-08  Havoc Pennington  <hp@redhat.com>

	* btk/btkbin.c (btk_bin_add): better error message if you try to
	add a widget to a bin that already has a child.

	* bdk/bdkcc.h, bdk/bdkcc-x11.c: Remove BdkColorContext, #50512

	* docs/Changes-2.0.txt: note that BdkColorContext is gone.
	
	* bdk/x11/Makefile.am (libbdk_x11_la_SOURCES): remove bdkcc-x11.c

	* bdk/bdk.h: remove bdkcc.h

	* bdk/Makefile.am (bdk_public_h_sources): remove bdkcc.h

	* btk/btkpixmap.c (build_insensitive_pixmap): rewrite using
	BdkPixbuf, since the previous implementation was BdkColorContext
	dependent.

	* btk/testbtk.c (create_pixmap): add test for insensitive BtkPixmap
	
Thu Feb  8 19:00:00 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (TREE_VIEW_VERTICAL_SEPARATOR): moved back to
	a sane value!

2001-02-08  Havoc Pennington  <hp@redhat.com>

	* btk/btkstyle.c (get_darkened_gc): let's darken colors, not
	lighten them.

2001-02-08  Havoc Pennington  <hp@redhat.com>

	* btk/btktextview.c (btk_text_view_destroy_layout): remove
	validation idle

	* demos/btk-demo/main.c (create_tree): adjust to changes in text
	cell renderer

	* demos/pixbuf-demo.c (timeout): remove deprecated
	btk_widget_draw

	* demos/testpixbuf-save.c (main): remove deprecated
	btk_drawing_area_size

	* btk/btktreeview.c (btk_tree_view_size_allocate): allocate
	buttons even if the model isn't setup. btk_tree_view_check_dirty()
	at the start of the allocation.
	(btk_tree_view_check_dirty): handle column->button == NULL, handle
	unsetup or NULL model.

	* btk/btkstyle.c (btk_default_draw_flat_box): drawing for the 
	even/odd/sorted cells in the tree view.

	* btk/btktreeselection.c (btk_tree_selection_real_unselect_all):
	bugfixes

	* btk/btktreeview.c: assorted bugfixy stuff. Draw the row
	backgrounds with draw_flat_box using different detail for even/odd
	rows.

	* btk/btkrbtree.c, btkrbtree.h: Keep track of the parity of each
	row, so we can draw the alternating colors thing

	* btk/btktexttag.c (btk_text_tag_set_property): if we change a
	property from a synonym property, notify for the synonym.
	Also, nuke the background_bdk_set and foreground_bdk_set synonyms
	(btk_text_tag_get_property): Always return the font, even if
	all its fields aren't set

	* btk/btkcellrenderertext.h (struct _BtkCellRendererText): don't
	store the attr list; it leaves us with no way to change attributes
	in _render according to the render flags, and no way to implement
	get_property. Instead store all the specific text attributes. 
	Separate whether an attribute is enabled from its value. Sync all
	properties with BtkTextTag, make them all consistent, etc.

	* btk/btkcellrenderer.h: Add a flag BTK_CELL_RENDERER_SORTED so
	renderers can highlight the sort row/column	

	* btk/btktreeviewcolumn.c (btk_tree_view_column_get_property): use
	accessor functions to get values; this has the side effect of
	showing up which accessor functions were missing. Added those.

	* btk/btktreeviewcolumn.h: Replace set_justification with
	set_alignment, to be consistent with BtkLabel, BtkMisc

	* btk/btktreeviewcolumn.c: Added code to display sort indicator
	arrow.

	* btk/Makefile.am (btk_public_h_sources): add btktreesortable.h

	* btk/btktreesortable.h: updates in here

2001-02-07  Sven Neumann  <sven@convergence.de>

	* btk/btkentry.c (btk_entry_draw_text): convert area_height to 
	bango dimensions after painting the background. We used to draw
	gigantic flat boxes here.

Mon Feb  5 22:05:57 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/linux-fb/bdkimage-fb.c (_bdk_fb_get_image): Fix syntax
	error introduced with earlier commit) (pointed out by
	Ollie Lho)

Mon Feb  5 12:25:06 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkbutton.c: Remove calls	to btk_grab_add/btk_grab_remove,
	which are no longer necessary.

Mon Feb  5 13:22:54 GMT 2001  Tony Gale <gale@btk.org>

	* docs/faq/btk-faq.sgml: s/MISK/MISC/

2001-02-04  Tor Lillqvist  <tml@iki.fi>

	* bdk/bdk.def
	* bdk/win32/bdkim-win32.c (bdk_ic_attr_new, bdk_ic_attr_destroy):
	Provide dummy implementations.

Sun Feb  4 07:55:17 2001  Tim Janik  <timj@btk.org>

	* btk/btksignal.h: removed btk_signal_init() compat define.

	* btk/btktypeutils.[hc]: btk_tpye_init() take an additional argument
	GTypeDebugFlags debug_flags and pass it on to g_type_init ();
	deprecated this function.

	* bdk/bdk.c (bdk_init_check): call g_type_init () with 0 as
	argument.

Sun Feb  4 07:45:45 2001  Tim Janik  <timj@btk.org>

	* btk/btkdebug.h: nuke BTK_DEBUG_OBJECTS and BTK_DEBUG_SIGNALS.

2001-02-03  Havoc Pennington  <hp@pobox.com>

	* btk/btktextbtree.c (_btk_text_btree_tag): Fix bug reported by
	Mikael Hermansson with patch from Mikael (if there was a toggle
	start one after the first character in the range, this function
	was broken). Bug #50380

Sat Feb  3 11:28:03 2001  Owen Taylor  <otaylor@redhat.com>

	* configure.in: Remove confusing comment about X11.

Fri Feb  2 19:21:23 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkwindow.c (bdk_propagate_shapes): Surround additional
	rebunnyions with HAVE_SHAPE_EXT. (#50511, Eric Ding)
	
Fri Feb  2 18:31:54 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkimage-x11.c: Remove definition of _XOPEN_SOURCE, since
	it breaks things on BSD. If you want to compile BTK+ with
	-ansi -pedantic, you should supply CPP_FLAGS=_XOPEN_SOURCE 
	when configuring, since BTK+ simply can't be "pure ANSI" 
	in the header files it uses. (#8170, Greg Hudson)

2001-02-02  Havoc Pennington  <hp@redhat.com>

	* btk/btkwindow.c: docs

	* btk/btkwidget.c: docs
	(btk_widget_set_colormap): add a reference to the colormap
	(btk_widget_get_default_colormap): add a reference to the colormap

	* btk/btktextbtree.c (btk_text_mark_set_visible): docs

	* btk/btktextiter.c: docs

	* btk/btkmain.c (btk_propagate_event): docs

	* btk/btkpaned.c (btk_paned_get_position): docs
	(btk_paned_set_position): docs

	* btk/btktreesortable.h (struct _BtkTreeSortableIface): Initial
	sort interface, no implementation yet.

	* demos/testpixbuf.c (new_testrgb_window): replace
	btk_drawing_area_size() with btk_widget_set_usize()

	* demos/testpixbuf-drawable.c (main): ditto
	
	* btk/testbtk.c: remove use of BtkStatusbarMsg

	* btk/btktextbuffer.c: docs

	* btk/btkstock.c: docs

	* btk/btkscrolledwindow.c (btk_scrolled_window_set_shadow_type): docs

	* btk/btkoptionmenu.c (btk_option_menu_get_history): docs

	* btk/btklabel.c (btk_label_set_markup_with_accel): fix docs
	
	* btk/btkimage.c: add some docs in here
	(btk_image_size_request): change name of
	btk_widget_render_stock_icon
	(btk_image_get_icon_set): don't dup returned string
	(btk_image_get_icon_set): don't dup returned string

	* btk/btkwidget.c (btk_widget_render_icon): rename from 
	btk_widget_render_stock_icon(), more consistent with btkstyle.h
	and btkiconfactory.h functions

	* btk/btkiconfactory.c: add some docs in here

	* btk/btkmain.c (btk_get_default_language): document
	(btk_get_current_event): document
	(btk_get_current_event_state): document
	(btk_get_event_widget): document

	* btk/btkentry.c (btk_entry_set_invisible_char): document

	* btk/btkcontainer.c: Add some documentation
	(btk_container_add): give a more explanatory warning on adding an
	already-parented widget, this is kind of a FAQ and also a common
	typo that's easier to debug with a nice warning	

	* btk/btkcellrenderertoggle.c
	(btk_cell_renderer_toggle_get_active): remove, I was on crack
	adding this, it's useless
	(btk_cell_renderer_toggle_set_active): remove
	(btk_cell_renderer_toggle_get_radio): add

	* btk/btkcellrenderer.c (btk_cell_renderer_get_size): don't allow
	the NULL cell renderer, that doesn't make any sense to me. 

	* demos/btk-demo/Makefile.am (INCLUDES): -DBTK_DISABLE_DEPRECATED,
	demo code should never use deprecated features.

	* demos/Makefile.am (INCLUDES): -DBTK_DISABLE_DEPRECATED, demo
	code should never use deprecated features.

	* btk/btkwidget.h: Mark btk_widget_draw, btk_widget_queue_clear,
	btk_widget_queue_clear_area deprecated

	* btk/btklayout.h: mark btk_layout_freeze/btk_layout_thaw
	deprecated

	* btk/btklabel.h: mark btk_label_get() deprecated

	* btk/btkimage.h: mark the legacy BtkImage functions that took 
	a BdkImage deprecated, replaced by new consistently-named
	functions	

	* btk/btkmain.h: Mark btk_exit() deprecated

	* btk/btkdrawingarea.h: mark btk_drawing_area_size deprecated

	* btk/btkstyle.h: mark btk_draw_string, btk_paint_string 
	deprecated

	* btk/btkstatusbar.h: Move BtkStatusbarMsg to the .c file, 
	so it won't appear in docs and confuse people.

	* btk/btkprogressbar.h: Mark all the old methods deprecated

	* btk/btkprogress.h: Mark all methods deprecated, mark the cast
	macros deprecated. (can't mark the type itself deprecated, since
	BtkProgressBar is not deprecated and we need the type decl to use
	BtkProgressBar)

	* btk/btkpixmap.h: Mark deprecated

	* btk/btkoldeditable.h: Mark deprecated

	* btk/btklist.h: Mark deprecated

	* btk/btklabel.h: delete "BtkLabelWord" typedef, not used 
	for anything anymore.

	* btk/btkctree.h: Mark deprecated

	* btk/btkclist.h: Mark deprecated

	* btk/btkpreview.h: Mark deprecated

	* btk/btkpacker.h: Mark deprecated

	* btk/btktipsquery.h: Mark deprecated

	* btk/btkinputdialog.h: Add comment that it will move out of BTK

	* btk/btkvruler.h: Add comment that it will move out of BTK

	* btk/btkhruler.h: Add comment that it will move out of BTK

	* btk/btkruler.h: Add comment that it will move out of BTK

	* btk/btkgamma.h: Add comment that it will move out of BTK

	* btk/btkcurve.h: Add comment that it will move out of BTK

Fri Feb  2 17:16:09 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkcolor-x11.c (bdk_colormap_sync): Make
	bdk_colormap_sync private since it was never exported
	in a header file.

	* bdk/x11/bdkcolor-x11.c (bdk_colormap_new): Fill in
	colormap->colors[] for StaticGray, StaticColor colormaps.

	* bdk/bdkpixbuf-drawable.c: Fix problems where image->bpp
	was being used as if it was image->bits_per_pixel.

	* bdk/bdkimage.h, bdk/x11/bdkimage-x11.c: Save the bits-per-pixel
	for the image in the BdkImage structure since it isn't
	reconstructable, and we need it to handle packed types

	* bdk/win32/bdkimage-win32.c: Set image->bits_per_pixel. (I'm making
	the assumption that on Win32 image->bits_per_pixel == image->depth,
	always.

	* bdk/linux-fb/bdkimage-fb.c: Set image->bits_per_pixel.

	* bdk/bdkrgb.c (bdk_rgb_select_conv): Exit with an informative
	warning message if no converter can be found. 

Fri Feb  2 15:09:51 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/fnmatch.c (FOLD): Fix problem with passing signed
	chars to isupper() / tolower(). (#567)

	* examples/packer/pack.c: Add GINT_TO_POINTER, GPOINTER_TO_INT
	to clear up 64-bit warnings. (#567)

Fri Feb  2 12:26:50 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkrc.c (btk_rc_add_initial_default_files): Get rid of
	a bunch of g_strdup_printf("%s%s") in favor of g_strconcat().

	* btk/btkrc.c Makefile.am: Use $(libdir), not $(exe_prefix),
	since some people set $(libdir) separately. (#1290, David Kaelbling)

Thu Feb  1 18:25:46 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkfilesel.c: If PATH_MAX and MAXPATHLEN are not
	defined, define MAXPATHLEN to 2048. (The Hurd doesn't have
	MAXPATHLEN, but the code here depends on a fixed value.)
	(#4524)

Wed Jan 31 22:01:04 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkhandlebox.c (btk_handle_box_button_changed): Handle the case
	where child == NULL and handle_position == RIGHT or BOTTOM. (#8041g)

Wed Jan 31 21:20:39 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkctree.c (real_tree_move): If the node being moved isn't
	viewable there is no way that moving the node will cause the 
	focus row to become not viewable, so omit check on the visibility
	of new_sibling, which is irrelevant. (Fixes #8002, David Helder)

Wed Jan 31 20:38:17 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkentry.c (btk_entry_commit_cb): Delete the current
	selection before inserting new text.

Wed Jan 31 18:49:33 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkoptionmenu.c (btk_option_menu_item_state_changed_cb):
	Make the sensitivity of the reparented child track that of
	the original parent menu item. (#34218, David Hodson)

	* btk/btkoptionmenu.c (btk_option_menu_item_destroy_cb): Handle
	the case where the current item is destroyed properly.

	* btk/btkoptionmenu.c: Some additional code cleanups and fix
	some edge cases with child-less menuitems.
	
Wed Jan 31 17:16:13 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkcombo.c (btk_combo_window_key_press): Make Return
	key pop down window. (#12074, Jon K Hellan)

Wed Jan 31 16:21:42 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btklist.c (btk_list_signal_item_toggle): Don't allow
	toggling of rows off in BROWSE or EXTENDED mode. (#12072, Jon K Hellan) 
	The solution here isn't perfect - you get an extraneous
	emission of "toggle", which could conceivably confuse an app,
	but better than the current situation. LXR search seems to
	indicate that no apps in BUNNY CVS connect to "toggle".

Wed Jan 31 15:46:13 2001  Owen Taylor  <otaylor@redhat.com>

        * btk/Makefile.am (libbtkinclude_HEADERS): Move btkcompat.h from
        btk_public_h_sources to directly here to avoid warning when
        building srcdir != builddir. (#9656)

Tue Jan 30 19:49:02 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkrange.c: Patch from Kipp Hickman to make the event
	handlers in btkrange.c return the proper values (TRUE == handled)
	(#10316).

	This is just the tip of the iceberg, but btkrange.c is the
	most common place where the propagation is problematical,
	and also a place where it is almost certainly safe to change
	this in the stable branch.

	(You don't want right click popups on a range control or anything...)

Tue Jan 30 18:57:59 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btktext.c (clear_focus_area): We need to clear the focus
	area on focus out, even if a background pixmap isn't set.
	(#13941)
	
Tue Jan 30 18:24:10 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btknotebook.c (btk_notebook_set_shape): Fix from Sean Cunningham
	to deal with setting the shape properly when scrolling arrows are
	turned on, but not visible because there is sufficient space.
	(#13432)

Tue Jan 30 16:39:25 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkitemfactory.c (btk_item_factory_delete_item): For menu
	items with submenus, destroy the item along with the submenu.
	(#7841, Brian Masney(?)) Also, handle paths of the form '<foo>/abcd...' 
	properly.

	* btk/testbtk.c (menu_items): Add a dummy branch that we delete
	later.

Tue Jan 30 15:51:25 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwindow.c (btk_window_real_set_focus): Fix a problem where
	the focus widget sometimes wasn't drawn with the default if there
	was no default widget.

	* btk/btkstyle.c (btk_style_real_unrealize): free colors,
	unreference pixmaps. 

	* btk/btkstyle.c (btk_style_realize): Reference colormap
	for some extra safety.

Mon Jan 29 19:00:01 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btk{ctree.c,clist.c} (set_cell_contents): Handle setting
	the text of a cell to the old pointer value better, by
	copying the new text before freeing the old text. Some code
	cleanup. (#8079, Karl Nelson)

Mon Jan 29 16:50:19 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btklabel.[ch] btk/btkframe.[ch]: Make btk_label_get_text()
	btk_frame_get_label() non strdup'ing, and G_CONST_RETURN.

Mon Jan 29 15:22:51 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmenu.c (btk_menu_remove): When removing an
	item from a menu, check to see if it matches 
	menu->old_active_menu_item, and if so, unref and clear
	old_active_menu_item (Patch from Pavel Cisler)

	* btk/btkmenushell.c (btk_menu_shell_remove): Unset 
	menu_shell->active_menu_item, if it is the child being
	removed. (Patch based on that of Gene Ragan, #50337)

2001-01-31  Alexander Larsson  <alla@lysator.liu.se>

	* bdk/linux-fb/bdkselection-fb.c: 
	* bdk/linux-fb/bdkcolor-fb.c: 
	* bdk/linux-fb/bdkdrawable-fb2.c: 
	* bdk/linux-fb/bdkfont-fb.c: 
	* bdk/linux-fb/bdkim-fb.c: 
	* bdk/linux-fb/bdkinput.c: 
	* bdk/linux-fb/bdkkeyboard-fb.c: 
	* bdk/linux-fb/bdkmain-fb.c: 
	* bdk/linux-fb/bdkrender-fb.c: 
	A bunch of whitespace cleanup.
	
2001-01-30  Havoc Pennington  <hp@pobox.com>

	* btk/btktreeitem.h, btk/btktree.h, btk/btktext.h: bracket in 
	#ifdef BTK_ENABLE_BROKEN.

	* btk/btktreeitem.c, btk/btktree.c, btk/btktext.c: #define
	BTK_ENABLE_BROKEN just before including the broken headers.
	
	* btk/btktypeutils.c: #define BTK_ENABLE_BROKEN, so we can get the
	deprecated types registered.

	* btk/testbtk.c, btk/testselection.c: #define BTK_ENABLE_BROKEN,
	we have to test the broken stuff.

        * docs/Changes-2.0.txt: explain BTK_ENABLE_BROKEN
	
2001-01-30  Havoc Pennington  <hp@redhat.com>

	* btk/btkliststore.c (btk_list_store_insert_before): fix bug in
	here where prev pointer was set to the wrong thing

	* btk/btktreemodel.c (btk_tree_path_is_ancestor): new function
	(btk_tree_path_is_descendant): new function

	* btk/btkliststore.c (btk_list_store_iter_n_children): return
	cached length
	(btk_list_store_get_iter): don't modify iter if we can't get the
	path.

	* btk/btkliststore.h (struct _BtkListStore): cache the length
	
	* btk/btktreednd.h: add virtual function row_drop_possible() to
	BtkTreeDragDest

	* btk/btktreestore.c (copy_node_data): fix varargs type error that
	was causing segfault

	* btk/btktreedatalist.c (_btk_tree_data_list_node_copy): set next
	pointer to NULL

	* btk/btktreestore.c (btk_tree_store_append): fix memleak

	* btk/btkliststore.c (btk_list_store_iter_next): don't modify iter
	on returning FALSE
	(btk_list_store_iter_children): ditto
	(btk_list_store_iter_nth_child): ditto
	(btk_list_store_iter_nth_child): ditto
	(btk_list_store_iter_parent): ditto

	* btk/btktreestore.c (btk_tree_store_get_path): g_return_if_fail
	on iter->user_data != NULL instead of silently accepting it.
	(btk_tree_store_iter_next): ditto. Also, don't modify iter unless
	we are returning TRUE.
	(btk_tree_store_iter_children): ditto
	(btk_tree_store_iter_nth_child): ditto
	(btk_tree_store_iter_parent): ditto
	(btk_tree_store_insert): remove handling of parent->user_data ==
	NULL, replace with parent == NULL	

	* btk/btktreemodel.c (inserted_callback): put some fixes in here,
	and a comment explaining things

	* btk/btktreestore.c: add BtkTreeDragSource/BtkTreeDragDest
	interface support to BtkTreeStore.

	* btk/btktreemodel.c (btk_tree_path_prev): didn't properly return
	FALSE if no prev, fix

	* btk/btktreeview.c (set_source_row): use a row reference
	(set_dest_row): use a row reference

Sat Jan 27 15:52:02 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeselection.c (btk_tree_selection_unselect_iter): Fix
	stupid typo pointed out by Kristian Rietveld <kristian@planet.nl>.
	(btk_tree_selection_select_iter): The same as above.

2001-01-26  Havoc Pennington  <hp@redhat.com>

	* btk/btktreemodel.c, btk/btktreemodel.h: add BtkTreeRowReference
	which holds a handle to a specific row (particular set of values
	in the model, i.e. pointer-identity row).

	* btk/btktreeview.c, btk/btktreeprivate.h, btk/btktreeselection.c:
	use BtkTreeRowReference for anchor, cursor, and drag_dest_row.
	Still need to use it for the src/dest row saved on the drag context.

2001-01-26  Havoc Pennington  <hp@redhat.com>

	* btk/btktextlayout.c (convert_color): adapt to handle BangoColor

	* btk/btktreeview.c (btk_tree_view_widget_to_tree_coords): fix to
	not offset by TREE_VIEW_HEADER_HEIGHT
	(btk_tree_view_tree_to_widget_coords): fix to not offset by
	TREE_VIEW_HEADER_HEIGHT

	* configure.in (included_loaders): for me, --with-included-loaders
	generates the error "the specified loader yes does not exist",
	i.e. the arg defaults to "yes", so change test for value ""
	to test for value "yes", and include all loaders in that case.

	* btk/btkrbtree.c (_btk_rbtree_get_depth): new function

	* btk/btktreeview.c (btk_tree_view_get_cell_rect): fix to properly
	handle TREE_VIEW_VERTICAL_SEPARATOR
	(btk_tree_view_bin_expose): fix to consider the row offset as
	pointing halfway into vertical separator.	
	(btk_tree_view_draw_node_focus_rect): ditto

	* btk/btkdebug.h, btk/btkmain.c (btk_init_check): Add
	--btk-debug=updates, which causes bdk_window_set_debug_updates
	(TRUE) to be called.

	* bdk/bdkwindow.c (bdk_window_set_debug_updates): Allow enabling a
	debug mode where the invalid rebunnyion is colored in on invalidate,
	so you can see the flicker and know whether your redraw code is 
	doing a good job.

	* btk/btktreeview.c (btk_tree_view_queue_draw_node): Work in 
	tree window coordinates (clip rect is in tree window coords)

	* btk/Makefile.am: add btktreednd.[hc]

	* btk/btkliststore.c: implement btktreednd interfaces.

	* btk/btktreednd.c, btk/btktreednd.h: New interface to support
	drag-and-drop data operations on a model (so we can set up tree
	drag-and-drop automatically)

	* btk/testbtk.c: Add a window to change sensitivity in the
	BtkLabel test; add a way to change the entry frame in BtkEntry
	test

	* btk/btkentry.c (btk_entry_set_has_frame): 
	(btk_entry_get_has_frame): new functions to remove the frame
	around an entry
	(btk_entry_size_request): shrink requisition if no frame
	(btk_entry_draw_focus): don't draw frame if no frame

	* btk/btkstyle.c (btk_default_draw_check): draw custom look for
	checks inside a cell renderer
	(btk_default_draw_option): ditto for options

	* btk/btktreeviewcolumn.c (update_button_contents): add/remove
	children from the alignment, not the button
	(btk_tree_view_column_init): ref/sink the column, to emulate
	GObject refcounting.

	* btk/btkcellrenderer.c (btk_cell_renderer_init): ref/sink
	
	* btk/btkcellrenderertoggle.c (btk_cell_renderer_toggle_render):
	Use theme functions to draw the toggles	

	* bdk/bdkbango.c (bdk_bango_get_gc): use BdkRGB to alloc colors

	* bdk/bdkbango.h, bdk/bdkbango.c: Add BdkBangoAttrStipple and
	BdkBangoAttrEmbossed to use in rendering insensitive text

	* bdk/bdkbango.c (bdk_draw_layout_line): render new properties

	* btk/btkstyle.c (btk_default_draw_layout): handle sensitivity
	using new BDK features
	
2001-01-24  Alexander Larsson  <alexl@redhat.com>

	* btk/btkimage.c:
	Splitted btk_image_clear into btk_image_clear() and
	btk_image_reset(). Call btk_image_clear() in ::destroy
	to avoid leaks.

	* btk/btklabel.c (set_markup):
	Don't leak text.

	* btk/btktextlayout.c:
	Always free display->shaped_objects.

	* btk/testbtk.c (create_clist):
	Don't leak custom style.

2001-01-23  Alexander Larsson  <alexl@redhat.com>

	* btk/btkcolorsel.c (grab_color_at_mouse):
	Don't leak image. Simplify using bdk_colormap_query_color().
	(btk_color_selection_init): Don't leak dropper_pixmap and mask.

	* linux-fb/bdkcolor-fb.c:
	Implemented bdk_colormap_query_color.

2001-01-23  Alexander Larsson  <alexl@redhat.com>

        * linux-fb/bdkcursor-fb.c:
	Don't leak built-in cursors.

	* linux-fb/bdkdrawable-fb2.c (bdk_fb_draw_polygon):
	Don't leak tmp_points.

	* linux-fb/bdkfont-fb.c (bdk_font_from_description):
	Don't modify desc. Don't leak font if the BangoFont
	isn't found.
	
	* linux-fb/bdkgc-fb.c (bdk_fb_gc_finalize):
	Free dash_list.

	* linux-fb/bdkkeyboard-fb.c (bdk_fb_handle_key):
	Don't leak string.
	
2001-01-20  Havoc Pennington  <hp@pobox.com>

	* btk/btktexttag.h (enum BtkWrapMode): rename member fields
	from BTK_WRAPMODE_WORD to BTK_WRAP_WORD, etc., seems nicer to 
	me, matches Bango

2001-01-22  Havoc Pennington  <hp@redhat.com>

	* demos/testanimation.c: fix to reflect bdk-pixbuf changes

	* demos/testpixbuf.c: fix to reflect bdk-pixbuf changes

	* btk/bdk-pixbuf-loader.c, btk/bdk-pixbuf-loader.h: 
	Remove, move back to bdk-pixbuf

	* btk/btktextiter.c, btk/btktextiter.h: add sentence equivalents
	to all the word functions

	* btk/btktextview.c (btk_text_view_start_cursor_blink): return
	before doing anything on NULL layout or if we don't have the focus

	* btk/testtext.c (fill_example_buffer): "justification"

	* btk/btktexttag.h, btk/btktexttag.c: change the tag attribute
	to be called "justification" not "justify"

	* demos/btk-demo/textview.c (create_tags): "justification"
	
	* btk/btktextlayout.c (set_para_values): Handle char-wise wrapping

2001-01-22  Alexander Larsson  <alexl@redhat.com>

	* bdk/bdkwindow.c (bdk_window_invalidate_rebunnyion):
	Don't leak visible_rebunnyion. Use visible_rebunnyion instead of rebunnyion.
	
	* bdk/linux-fb/bdkwindow-fb.c (bdk_window_new):
	Don't do extra bdk_drawable_ref(). This is not X.
	(bdk_fb_window_find_focus, bdk_fb_change_focus): make sure
	bdk_fb_focused_window is ref:ed.
	(bdk_fb_window_send_crossing_events): Watch out for destroyed
	windows.

2001-01-22  Alexander Larsson  <alexl@redhat.com>

	* btk/btkwindow-decorate.c (btk_decorated_window_realize):
	Don't leak the BangoFontDescriptor.

Sun Jan 21 09:58:00 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_scroll_to_point): Make fail
	when not realized.
	(btk_tree_view_scroll_to_cell): Make work when not realized.
	(btk_tree_view_realize): add scroll_to support
	(btk_tree_view_finalize): add a finalize method.  Populate.
	(btk_tree_view_insert_column): ref and sink the column.
	(btk_tree_view_append_column): ref and sink the column.
	(btk_tree_view_queue_draw_node): New function to handle redrawing
	individual nodes.  Should make the code much more efficient, if
	actually used.

2001-01-19  Havoc Pennington  <hp@redhat.com>

	* btk/btktextlayout.c (btk_text_layout_get_line_display):
	byte_offset variable was being used to mean both "offset into
	layout" and "offset into buffer line" which was no longer true
	with addition of preedit string; fix

2001-01-19  Havoc Pennington  <hp@redhat.com>

	* demos/btk-demo/main.c (button_press_event_cb): sync to tree changes

	* btk/btkrbtree.c (_btk_rbtree_node_find_offset): fix this
	function

	* btk/btktreeviewcolumn.c (btk_tree_view_column_set_widget):
	implement

	* btk/btktreeview.c (btk_tree_view_move_to): rename
	scroll_to_cell, matches TextView scroll functions better
	(btk_tree_view_tree_to_widget_coords): new function
	(btk_tree_view_widget_to_tree_coords): new function
	(btk_tree_view_get_visible_rect): new function
	(btk_tree_view_get_path_at_pos): accept negative coordinates
	(btk_tree_view_draw_node_focus_rect): new function moved from
	draw_focus, also, use width of bin_window as width of the focus
	rect
	(btk_tree_view_expand_row): fix bug where it didn't recognize
	already-expanded rows
	(btk_tree_view_get_cell_rect): new function
	(btk_tree_view_get_path_at_pos): return the click position
	relative to the passed-in cell
	(btk_tree_view_set_expander_column): new function

	* configure.in: remove btk-config-2.0 chmod

	* btk/btktextview.c (btk_text_view_drag_motion): small cleanups,
	and properly handle drags with targets we don't understand
	(btk_text_view_drag_end): don't stop scrolling, the source isn't
	scrolling anyway
	(btk_text_view_drag_drop): stop scrolling here though, and set the
	mark invisible

	* btk/btkdnd.c (btk_drag_dest_find_target): export as a public
	function
	(btk_drag_dest_get_target_list): new function
	(btk_drag_dest_set_target_list): new function
	
	* btk/btktreeview.c: Add a bunch of drag-and-drop implementation

	* btk/btktreeprivate.h (struct _BtkTreeViewPrivate): add fields
	related to drag-and-drop

2001-01-19  Alexander Larsson  <alexl@redhat.com>

	* bdk/linux-fb/bdkprivate-fb.h:
	Define EMULATE_BDKFONT.
	Add extra bango_font stuff to GfkFontPrivate.
	
	* bdk/linux-fb/bdkdrawable-fb2.c:
	* bdk/linux-fb/bdkfont-fb.c:
	If EMULATE_BDKFONT defined, implement a slow lame BdkFont
	emulation using BangoFont.

2001-01-17  Havoc Pennington  <hp@pobox.com>

	* btk/btkprogressbar.c, btk/btkprogressbar.h: Add "getters" for
	all the non-deprecated set_foo functions. Added missing object
	properties, and added g_object_notify() to setters. 
	Wrote docs.
	
2001-01-18  Tor Lillqvist  <tml@iki.fi>

	* btk/btkmain.c
	* btk/btkrc.c: (Win32) Use the new
	g_win32_get_package_installation_(sub)directory() functions.

	* config.h.win32.in: New file.
	
	* config.h.win32: Removed.

	* configure.in: Output config.h.win32.

	* Makefile.am: Add it to EXTRA_DIST.

	* btk/btk.def: Update.

Wed Jan 17 16:22:54 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btklabel.c (btk_label_size_request): Set the
	attributes onto the BangoLayout even if they are newly
	created from label->pattern.

Tue Jan  9 11:20:48 2001  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkdnd-x11.c: Remove unused variable.

	* btk/btkdnd.c: Encapsulate storing and retrieving info
	structures in functions. Fixes bug where btk_dataset_*
	was accidentally still being used in one place, causing
        every dest side event to be treated independently.

	* btk/btkdnd.c: Remove last vestages of handling
	::draw (fixes warning)
	
	* btk/btkentry.[ch]: Add drag and drop support.

	* btk/btkdnd.[ch] btk/btktextview.c btk/btkentry.c: Add
	new function btk_check_drag_threshhold() for checking
	to check if (dx,dy) has exceeded the threshhold for starting
	a drag and use it everywhere.

Mon Jan  8 11:58:05 2001  Owen Taylor  <otaylor@redhat.com>

	* btk+-2.0.pc.in bdk-pixbuf-2.0.pc.in (Cflags): Remove -I${includedir},
	add -I{includedir}/btk-2.0.

	* btk/btktreeview.[ch] btktreemodelsort.[ch] btknotebook.c
	bdk/bdk-pixbuf.h: Doc fixups.
	
	* btk/btkobject.h: Remove trailing , from enum

2001-01-17 Alexander Larsson <alexl@redhat.com>	

	* bdk/linux-fb/bdkdrawable-fb2.c (bdk_shadow_fb_draw_arc):
	Doh! Mixed up x and y.

	* bdk/linux-fb/bdkglobals-fb.c:
	Removed bdk_fb_pointer_grab_window_events,
	added _bdk_fb_pointer_grab_owner_events and
	_bdk_fb_keyboard_grab_owner_events.

	* bdk/linux-fb/bdkmain-fb.c (bdk_fb_pointer_grab):
	Set all button mask if BDK_BUTTON_MOTION_MASK set. Send
	crossing events before grabbing. Set _bdk_fb_pointer_grab_owner_events.
	(bdk_fb_pointer_ungrab): Unset _bdk_fb_pointer_grab_owner_events
	Send crossing events after ungrab finished.
	(bdk_keyboard_grab): Set ..._owner_events
	(type_masks): Move out of function.
	(bdk_fb_other_event_window, bdk_fb_pointer_event_window,
	bdk_fb_keyboard_event_window): New functions, return the
	window an event should be targeted at. Handles grabs and
	event propagation. Can return NULL.
	(bdk_event_make): Remove event_mask checking. Now always
	returns an event.
		
	* bdk/linux-fb/bdkkeyboard-fb.c:
	* bdk/linux-fb/bdkproperty-fb.c:
	* bdk/linux-fb/bdkselection-fb.c:
	Use new event_window/bdk_event_make() behaviour.
	
	* bdk/linux-fb/bdkmouse-fb.c:
	Use new event_window/bdk_event_make() behaviour.
	Only send motion events if in the same window.
	If grabbed, use cursor from window if sibling of grabbed
	window, and cursor from grabbed window otherwise.

	* bdk/linux-fb/bdkprivate-fb.h:
	Update bdk_fb_window_send_crossing_events, bdk_event_make
	and grab varaible declarations. Add bdk_fb_*_event_window().

	* bdk/linux-fb/bdkwindow-fb.c:
	Use new event_window/bdk_event_make() behaviour.
	Keep correct track of focus window.
	(bdk_window_set_events): Set all specific button motion masks
	if BDK_BUTTON_MOTION_MASK set.

	* btk/btkdnd.c (btk_drag_update):
	Free info->last_event if bdk_drag_motion returned FALSE.

2001-01-16  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkwindow-win32.c (bdk_window_show, bdk_window_hide):
	Eliminate redraws when input-only windows are shown or
	hidden. Thanks to jpe@archaeopteryx.com.

Tue Jan 16 13:13:13 GMT 2001  Tony Gale <gale@btk.org>

	* docs/faq/btk-faq.sgml: FAQ update:
	  - Update to bugzilla
	  - Add BTK+ and security/SUID/SGID
	  - Add DnD question

2001-01-16  Alexander Larsson  <alla@lysator.liu.se>

	* bdk/linux-fb/bdkdnd-fb.c:
	Some cleanups.
	
2001-01-15  Havoc Pennington  <hp@pobox.com>

	* tests/testtreeview.c: add test stuff for CellRendererToggle

	* btk/btktreemodelsort.c (btk_tree_model_sort_get_model): add this
	accessor

	* btk/btkcellrenderertoggle.c: distinguish different event types,
	only toggle on button press (would do release like BtkButton, but
	we'd need implicit grab code for treeview cells)

2001-01-16  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkvisual-win32.c: Include <stdlib.h> for getenv().

	* bdk/win32/bdkevents-win32.c (bdk_event_translate): Don't use
	BDK_COLORMAP_PRIVATE_DATA on a potentially NULL BdkColormap.

	* bdk/win32/bdkfont-win32.c (bdk_font_load_internal): Adapt calls
	to g_{locale,filename}_{to,from}_utf8 to match current API.

	* btk/makefile.msc.in (btk_OBJECTS)
	* btk/makefile.mingw.in (btk_OBJECTS): Add btkwindow-decorate.

	* btk/btk.def: Update.

2001-01-15  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkevents-win32.c (synthesize_crossing_events): New
	implementaion that more closely mimics the events that an X server
	would generate. Especially, properly generate BDK_NOTIFY_VIRTUAL and
	BDK_NOTIFY_NONLINEAR_VIRTUAL crossing events. This makes buttons
	with nested preview widgets, for instance, more responsive when
	you move the mouse quickly into them.
	(find_window_for_pointer_event): Make it actually compile.
	(bdk_event_translate): Set send_event to the value of
	InSendMessage (). This doesn't really mean the same as X11's
	send_event flag, but is close enough, says jpe@archaeopteryx.com

2001-01-15  Alexander Larsson  <alexl@redhat.com>

	* bdk/linux-fb/bdkdnd-fb.c:
	Implemented drag and drop.
	Seems to be mostly working. I sometimes get an assert from btkdnd.c:2664
	when it tries to free and then copy the same event (info->last_event).
	I am not sure about why	this happens, but will continue looking.

2001-01-15  Alexander Larsson  <alexl@redhat.com>

	* bdk/linux-fb/bdkwindow-fb.c:
	Use bdk_window_invalidate_rect instead of
	bdk_window_invalidate_rect_clear to minimise flashing.
	When hiding windows you need to clear the root window though.

2001-01-15  Alexander Larsson  <alexl@redhat.com>

	* bdk/linux-fb/bdkdrawable-fb2.c:
	For optization, add an full_shapes argument to bdk_fb_clip_rebunnyion.
	If this is false, only the cliprects of the shapes are used.

	* bdk/linux-fb/bdkprivate-fb.h:
	Export bdk_fb_window_peek_shape.
	Add full_shapes to bdk_fb_clip_rebunnyion.

	* bdk/linux-fb/bdkwindow-fb.c (bdk_fb_window_move_resize):
	When moving a window, don't clear everything under the it, just the
	root window. Makes stuff faster and flash less.
	(bdk_window_get_pointer): Correctly handle offseted shapes, due to
	USE_CHILD_SHAPE. (bdk_fb_window_peek_shape): Return the correct
	offset of the shape.
	

2001-01-12  Havoc Pennington  <hp@redhat.com>

	* bdk/x11/bdkgeometry-x11.c (bdk_window_scroll): offset the 
	current invalid rebunnyion, fixes redraw bug while scrolling the 
	text widget

	* btk/btktextview.c, btk/btktextview.h:
	Rearrange the scrolling/validation/etc. code in a major way, 
	so it seems to make sense to me. Probably isn't genuinely that
	much better, but...

	* btk/btktexttag.c (set_fg_color): fix name of property used for
	notifies

	* btk/btktextmark.c (btk_text_mark_get_left_gravity): new function

2001-01-12  Alexander Larsson  <alla@lysator.liu.se>

	* bdk/linux-fb/bdkmain-fb.c (bdk_fb_set_rotation):
	Hide mouse pointer while rotation. Show it afterwards.

2001-01-12  Alexander Larsson  <alexl@redhat.com>

	* bdk/linux-fb/bdkdrawable-fb2.c (bdk_fb_clip_rebunnyion): Take shaped
	windows in consideration when generating clip rebunnyion.

	* bdk/linux-fb/bdkfb.h:
	Huge HACK. Added BDK_FB_USE_CHILD_SHAPE.

	* bdk/linux-fb/bdkprivate-fb.h:
	Add shape to BdkWindowFBDatat.
	exported bdk_fb_window_get_abs_shape().
	removed bdk_fb_draw_lines declaration.

	* bdk/linux-fb/bdkwindow-fb.c (bdk_window_impl_fb_init):
	Init shape to NULL. (bdk_fb_window_send_crossing_events): Don't
	send focus changes when there is a grabbed window.
	(bdk_window_get_pointer): Handle shaped windows.
	(bdk_fb_rebunnyion_create_from_bitmap): Convert bitmap to rebunnyion.
	(bdk_fb_window_peek_shape): Returns the shape for a window,
	handles BDK_FB_USE_CHILD_SHAPE.
	(bdk_fb_window_get_abs_shape): Returns the shape of the window,
	offseted to absolute positions. Handles BDK_FB_USE_CHILD_SHAPE.
	(bdk_window_shape_combine_mask): Implement.

	* btk/btkwindow-decorate.c:
	HACK! Set BDK_FB_USE_CHILD_SHAPE on window->frame to make sure
	setting the shape of a window makes the window transparent.

2001-01-11  Havoc Pennington  <hp@redhat.com>

	* btk/btktreemodelsimple.h: Oops, broke some macros

2001-01-10  Havoc Pennington  <hp@redhat.com>

	* btk/btktreeviewcolumn.c (btk_tree_view_column_clear_attributes):
	add this function, bug 40251

	* btk/btktreemodelsimple.h (BTK_TYPE_TREE_MODEL_SIMPLE): fix name
	of type macro	

2001-01-11  Alexander Larsson  <alexl@redhat.com>

	* acconfig.h:
	Added ENABLE_SHADOW_FB

	* configure.in:
	Added --disable-shadowfb

	* bdk/linux-fb/bdkcursor-fb.c:
	Update shadowfb when updating cursor

	* bdk/linux-fb/bdkdrawable-fb2.c:
	Added wrappers for shadowfb that calls 	the normal drawable
	methods, but calls bdk_shadow_fb_update(bounding box) when
	BdkWindows are drawed to.
	Moved bdk_draw_glyphs implementation to _bdk_draw_glyphs
	which also returns the bounding box.

	* bdk/linux-fb/bdkfb.h:
	Added BdkFBAngle type and bdk_fb_set_rotation declaration.

	* bdk/linux-fb/bdkgeometry-fb.c:
	Update shadowfb when scrolling window.

	* bdk/linux-fb/bdkglobals-fb.c:
	Add _bdk_fb_screen_angle.
	
	* bdk/linux-fb/bdkkeyboard-fb.c:
	Test code for screen rotation. Shift-F2 in the xlate driver
	rotates the screen.

	* bdk/linux-fb/bdkmain-fb.c:
	Handle shadowfb. Add bdk_fb_set_rotation(). Remove CM and RP.

	* bdk/linux-fb/bdkmouse-fb.c:
	Use fb_width/height instead of modeinfo.xres/yres.

	* bdk/linux-fb/bdkprivate-fb.h:
	Added fb_men, fb_width, fb_height & fb_stride. When using
	shadow fb these can differ from the framebuffer stuff.
	Declarations for bdk_shadow_fb_update, bdk_shadow_fb_init,
	bdk_shadow_fb_stop_updates, bdk_fb_recompute_all,
	_bdk_fb_screen_angle. Removed CM, RP.

	* bdk/linux-fb/bdkrender-fb.c:
	Added code for shadowfb handling and screen rotation using
	shadowfb.

	* bdk/linux-fb/bdkwindow-fb.c:
	Use fb_mem, fb_stride, fb_width, fb_height.
	Added recompute_rowstride to reset the rowstride of all windows.
	Added bdk_fb_recompute_all() which recomputes rootwindow size,
	window abs positions and window rowstrides. Useful when the
	rotation has changed.

Thu Jan 11 13:16:50 GMT 2001  Tony Gale <gale@btk.org>

	* docs/faq/btk-faq.sgml: update to make web site updating easier

2001-01-10  Havoc Pennington  <hp@redhat.com>

	* btk/btktreestore.c (btk_tree_store_insert_before): handle case
	where sibling == iter
	(btk_tree_store_insert_after): handle sibling == iter
	(btk_tree_store_prepend): remove stamp checks
	(btk_tree_store_insert_before): ditto
	(btk_tree_store_append): ditto
	(btk_tree_store_get_path): ditto
	(btk_tree_store_get_value): ditto
	(btk_tree_store_iter_has_child): ditto
	(btk_tree_store_iter_n_children): ditto
	(btk_tree_store_iter_nth_child): ditto
	(btk_tree_store_insert_after): ditto
	(btk_tree_store_is_ancestor): ditto
	(btk_tree_store_iter_depth): ditto
	(btk_tree_store_insert_before): assert that sibling's parent is
	the same as the passed-in parent
	(btk_tree_store_insert_after): assert that sibling's parent is
	the same as the passed-in parent

	
	* btk/btktreemodel.c (btk_tree_model_get_first): new convenience 
	function to get the first iterator in a model
	
	* btk/btktreestore.c (btk_tree_store_get_root_iter): remove,
	conventionally the "root" in this sense is just NULL afaict.

	* btk/btkliststore.c (btk_list_store_insert_before): handle case
	where sibling == iter
	(btk_list_store_insert_after): handle case where sibling == iter

	* tests/testtreeview.c (run_automated_tests): fairly lame basic
	automated tests for ListStore, TreeStore

        * btk/btkliststore.c (btk_list_store_remove): update tail pointer
	(btk_list_store_insert): update tail pointer, and fix it to work
	(btk_list_store_insert_before): update tail pointer, and fix it to work
	(btk_list_store_append): use tail to be faster
	(btk_list_store_prepend): fix it, update tail pointer
	(btk_list_store_insert_after): fix it, update tail pointer

	* btk/btkliststore.h (struct _BtkListStore): add tail pointer for 
	the list

2001-01-09  Havoc Pennington  <hp@redhat.com>

	* btk/btklabel.c (btk_label_expose): don't draw if label->layout
	is NULL due to a pending resize

	* btk/btktreeview.c (btk_tree_view_check_dirty): don't set the
	column width to values less than 1

	* btk/btktreeviewcolumn.c (btk_tree_view_column_set_width): clamp
	width to be between min/max width, and still set the width 
	even if autosize is turned on, so the tree view can use this 
	function in order to autosize.
	(btk_tree_view_column_init): set initial width to 1 not 0

	* btk/btktreeview.c (btk_tree_view_size_request_buttons): use
	setter function to modify column width, so we get notification
	(btk_tree_view_insert_iter_height): ditto
	(btk_tree_view_calc_size): ditto
	(btk_tree_view_check_dirty): ditto

	* btk/btktreeviewcolumn.c (btk_tree_view_column_class_init): Add
	properties to change all the interesting attributes of the tree
	view column.
	(btk_tree_view_column_set_header_clickable): rename set_clickable
	(btk_tree_view_column_get_clickable): add
	(btk_tree_view_column_set_cell_renderer): don't unset the current
	attributes; assume a cell renderer with equivalent object
	properties has been swapped in. Do g_object_notify().
	(btk_tree_view_column_set_visible): g_object_notify
	(btk_tree_view_column_get_sizing): rename from get_col_type
	(btk_tree_view_column_set_sizing): g_object_notify
	(btk_tree_view_column_set_width): add g_object_notify
	(btk_tree_view_column_set_min_width): ditto
	(btk_tree_view_column_set_max_width): ditto
	(btk_tree_view_column_set_title): ditto
	(btk_tree_view_column_set_clickable): ditto
	(btk_tree_view_column_set_widget): ditto
	(btk_tree_view_column_set_justification): ditto

2001-01-09  Havoc Pennington  <hp@redhat.com>

	* btk/btktreeview.c (btk_tree_view_check_dirty): handle case where
	there are no rows in the model

	* btk/btkliststore.c (btk_list_store_iter_children): if parent is
	NULL, then return the start of the list

	* btk/btktreeview.c (btk_tree_view_setup_model): don't build tree
	if we can't get any rows from an empty model 

	* btk/btktreeviewcolumn.h (struct _BtkTreeViewColumn): remove
	extraneous * after function pointer typedef usage

	* Makefile.am: don't specify full path to cp and rm

	* btk/btkcellrenderertextpixbuf.c
	(btk_cell_renderer_text_pixbuf_get_size): check width/height !=
	NULL before dereferencing, fixes a segfault that happened from
	time to time

	* btk/btkcellrendererpixbuf.c (btk_cell_renderer_pixbuf_render):
	use bdk_pixbuf_render_to_drawable_alpha() to get alpha channel,
	and reindent the function
	(btk_cell_renderer_pixbuf_get_size): indentation

	* btk/btkdialog.c (btk_dialog_run): destroy main loop only after
	we quit it
	(btk_dialog_add_buttons_valist): add g_return_if_fail
	(btk_dialog_set_default_response): New function, to set default
	button
	(btk_dialog_set_response_sensitive): New function, to set 
	sensitivity of buttons

	* btk/btkcellrendererpixbuf.c
	(btk_cell_renderer_pixbuf_get_property): allow getting a NULL pixbuf
	(btk_cell_renderer_pixbuf_set_property): allow setting a NULL pixbuf

	* btk/btktreedatalist.c (_btk_tree_data_list_node_to_value):
	handle any G_TYPE_OBJECT subclass, not just the base class, and 
	also boxed types.
	(_btk_tree_data_list_value_to_node): ditto

	* btk/btkrbtree.c: Run _btk_rbtree_test at strategic points if 
	--btk-debug=tree

	* btk/btkmain.c: add BTK_DEBUG_TREE

	* btk/btkdebug.h: add BTK_DEBUG_TREE

2001-01-09  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkevents-win32.c: Implement better mouse
	capturing. Do use SetCapture(). Thanks to jpe@archaeopteryx.com.
	(find_window_for_pointer_event): New function.
	(bdk_event_translate): Use it when handling mouse events.

2001-01-09  Alexander Larsson  <alla@lysator.liu.se>

	* configure.in:
	Added --with-included-loaders option

	* bdk-pixbuf/Makefile.am:
	* bdk-pixbuf/bdk-pixbuf-io.c:
	Add support for including selected bdk-pixbuf loaders only.

	* btk/btkwindow.c (btk_window_set_frame_dimensions,
	btk_window_set_has_frame):
	Added inline documentation.

	* bdk/x11/bdkwindow-x11.c (bdk_window_get_decorations):
	* docs/reference/bdk/tmpl/windows.sgml:
	Added inline documentation.

Mon Jan  8 14:42:06 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_realize_buttons): Skip
	realizing buttons that have already been realized.

Mon Jan  8 14:06:29 2001  Jonathan Blandford  <jrb@redhat.com>

	* tests/testtreeview.c (main): Show menu items before adding to
	option menu.

	* btk/btktreeview.c (btk_tree_view_set_model): Keep the columns
	around if we kill them.

	* btk/btktreeviewcolumn.c (btk_tree_view_column_set_cell_data):
	Return if we pass in a NULL model.

2001-01-08  Havoc Pennington  <hp@redhat.com>

	* tests/testtreeview.c: hack on this some

	* btk/btktreestore.c (btk_tree_store_setv): rename
	btk_tree_store_set_valist, v is for arrays, valist for varargs
	list
	(btk_tree_store_getv): rename btk_tree_store_get_valist

	* btk/btkliststore.h: Add varargs set() and get() convenience
	functions

2001-01-08  Alexander Larsson  <alexl@redhat.com>

	* btk/btkwindow-decorate.[hc]:
	* btk/Makefile.am:
	New files. Contains an implementation of a minimal WM for
	linux-fb.

	* btk/btkwindow.h:
	Add the possibility for BtkWindows to specify a frame. This
	is used for the window decoration code, but could concievably
	be used for X programs too (xmms style windows).
	BtkWindow->frame is the toplevel window if the window is framed.
	The signal frame_event gets all events that are targeted to
	BtkWindow->frame.
	(_btk_window_constrain_size): Exported for usage by btkwindow-decorate.c.
	
	* btk/btkwindow.c:
	Implement btk_window_set_has_frame and btk_window_set_frame_dimensions.
	Call out to btkwindow-decorate.c for WM support in linx-fb.

2001-01-08  Alexander Larsson  <alexl@redhat.com>

	* docs/README.linux-fb:
	Correct filename ~/.bangoft2_aliases

	* bdk/bdkwindow.h:
	Added new function bdk_window_get_decorations.

	* bdk/linux-fb/bdkfb.h:
	Removed _bdk_window_get_decorations declaration.
	Renamed _bdk_window_set_child_handler to
	bdk_fb_window_set_child_handler.

	* bdk/linux-fb/bdkwindow-fb.c:
	Renamed _bdk_window_set_child_handler to
	bdk_fb_window_set_child_handler.

	* bdk/x11/bdkwindow-x11.c:
	New function bdk_window_get_mwm_hints().
	Implemented bdk_window_get_decorations.

	* docs/reference/bdk/tmpl/windows.sgml:
	* docs/reference/bdk/bdk-sections.txt:
	Added bdk_window_get_decorations docs.
	
2001-01-08  Alexander Larsson  <alla@lysator.liu.se>

	* bdk/linux-fb/bdkwindow-fb.c (_bdk_fb_window_find_focus,
	bdk_fb_window_find_focus, bdk_fb_send_focus_change,
	bdk_fb_window_send_crossing_events):
	Possibly send focus events when the mouse moves from one
	window to another.

2001-01-07  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkwindow-win32.c (bdk_window_set_title,
	bdk_window_new): Adapt calls to g_{locale,filename}_{to,from}_utf8
	to match current API.

	* bdk/win32/bdkvisual-win32.c (bdk_visual_init): If a secret
	environment variable is set, don't call g_error when on a
	palettized (PseudoColor) display. Some people want to use BTK+ 
	in 256-colour mode even though works only partially.

	* bdk/bdk.def
	* btk/btk.def
	* btk/makefile.mingw.in: Update.

2001-01-05  Havoc Pennington  <hp@redhat.com>

	* tests/testtreeview.c: hack on this a bit

	* btk/btktextlayout.c (btk_text_layout_class_init):
	s/BTK_RUN_LAST/G_SIGNAL_RUN_LAST

	* btk/btktreemodelsimple.h (BTK_IS_TREE_MODEL_SIMPLE_CLASS): 
	was spelled incorrectly
	(BTK_IS_TREE_MODEL_SIMPLE): ditto

	* btk/btktreeview.c (btk_tree_view_set_headers_clickable): rename
	from btk_tree_view_set_headers_active	

	* btk/btktexttag.c:
	(btk_text_tag_get_property): handle PROP_DIRECTION
	(btk_text_tag_set_property): g_object_notify when we toggle the _set
	properties, bug 40235

	* btk/btktextiter.c (btk_text_iter_forward_to_delimiters): rename
	forward_to_line_end

Fri Jan  5 16:16:29 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/{btkcalender.c,btkfilesel.c,btkimcontext.c},
	modules/input/btkimcontextxim.c: Adapt to new prototypes
	for unicode,locale,filename conversion functions.

2001-01-05  Havoc Pennington  <hp@redhat.com>

	* btk/btktextiter.c (btk_text_iter_ends_line): this function was
	broken if called on the first position in the buffer.

	* btk/btktextlayout.c (line_display_index_to_iter): fix
	forward_to_delimiters to be called only if we aren't already at
	the delimiters.

2001-01-05  Havoc Pennington  <hp@redhat.com>

	* demos/btk-demo/main.c (create_tree): Oops, that didn't link. Fix.

2001-01-05  Alexander Larsson  <alexl@redhat.com>

	* bdk/linux-fb/bdkdrawable-fb2.c (bdk_fb_drawable_finalize): free
	colormap in here. Sync from X port.
	(bdk_fb_set_colormap): allow the colormap to be NULL if you like.
	Sync from X port.
	(bdk_fb_clip_rebunnyion): Comment out g_warning about empty clip rebunnyion.
	This happens now and then, and i don't think it is a bug.
	(bdk_fb_draw_polygon): Correctly add extra point if startpoint
	!= endpoint.
	(bdk_fb_draw_lines): Don't draw dashed lines if line_style is
	BDK_LINE_SOLID.

	* bdk/linux-fb/bdkfont-fb.c: Return bogus BdkFont that has
	some of the fields filled in at least.

	* bdk/linux-fb/miwideline.c: The widths argument to miLineArcI, and
	miLineArcD is no more, remove it from the function definition.

2001-01-04  Havoc Pennington  <hp@redhat.com>

	* btk/btktreeselection.c (btk_tree_selection_get_tree_view): add
	this

	* btk/btktreemodel.h (struct _BtkTreeIter): rename fields to
	user_data instead of tree_node

	* btk/btktreeprivate.h (TREE_VIEW_COLUMN_WIDTH): rename from
	TREE_VIEW_COLUMN_SIZE

	* btk/btktreeviewcolumn.h (struct _BtkTreeViewColumn): rename
	"size" field to "width" finishes bug 40061

	* btk/btkcellrenderer.h: Use BtkCellRendererState instead of guint
	for bitfields, bug 40268

2001-01-04  Havoc Pennington  <hp@redhat.com>

        Rename some stuff:
	
	s/btk_tree_view_column_set_size/btk_tree_view_column_set_width/g;

	s/BtkModelSimple/BtkTreeModelSimple/g;
	s/BTK_MODEL_SIMPLE/BTK_TREE_MODEL_SIMPLE/g;
	s/btk_model_simple/btk_tree_model_simple/g;
	s/btkmodelsimple/btktreemodelsimple/g;

	s/btk_tree_view_column_set_header_active/btk_tree_view_column_set_header_clickable/g;

	s/BtkTreeViewColumnType/BtkTreeViewColumnSizing/g;
	s/column_set_col_type/column_set_sizing/g;

	s/BtkTreeSelectionType/BtkTreeSelectionMode/g;
	s/btk_tree_selection_set_type/btk_tree_selection_set_mode/g;

	s/BtkCellRendererType/BtkCellRendererState/g;
	
	* btk/btkcellrenderertoggle.c: remove _ macro, include btkintl.h
	(btk_cell_renderer_toggle_class_init): change "state" property to
	"active", to match BtkToggleButton
	(btk_cell_renderer_toggle_get_active): new function, bug
	40269
	(btk_cell_renderer_toggle_set_active): new function
	(btk_cell_renderer_toggle_set_property): route changes to toggle
	state through btk_cell_renderer_set_active

Thu Jan  4 15:46:18 2001  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkmodelsimple.c: Changed a bunch of boxed types to pointers
	temporarily until they work again.  Brought up to date with
	changes in the model.
	* btk/btkmodelsimple.h: Brought up to date with changes in the
	model.

2001-01-04  Havoc Pennington  <hp@redhat.com>

	* btk/btktextlayout.c (line_display_index_to_iter): if index is
	equal to the line length, then position iterator before paragraph 
	separators. Fixes crash reported by Mikael Hermansson when
	pressing left arrow from the start of a line.	

	* btk/btktextiter.c (iter_set_from_byte_offset): Add g_error
	about byte indexes off the end
	(iter_set_from_char_offset): add g_error about char offsets
	off the end

2001-01-03  Havoc Pennington  <hp@redhat.com>

	* btk/btktextbtree.c: Adapt to uscore-ification of btktextiterprivate

	* btk/btktextdisplay.c (btk_text_layout_draw): remove use 
	of private functions; remove inclusion of private headers.

	* btk/btktextlayout.c (btk_text_layout_get_iter_at_line): Add this 
	function, so we don't need private functions in btktextdisplay.c

	* btk/btktextiterprivate.h: underscore-ification

	* btk/btkwidget.c: Clean up a bunch of docs that said "INTERNAL"
	to instead say "only useful to implement widgets"

	* btk/btkenums.h (BtkMovementStep): Rename BTK_MOVEMENT_CHARS,
	BTK_MOVEMENT_POSITIONS to BTK_MOVEMENT_LOGICAL_POSITIONS,
	BTK_MOVEMENT_VISUAL_POSITIONS. Resolves bug 40249.

	* bdk/x11/bdkwindow-x11.c (bdk_window_impl_x11_set_colormap):
	This function was completely broken

	* btk/testtext.c (line_numbers_expose): use btk_paint_layout

	* btk/btkvscale.c (btk_vscale_draw_value): use btk_paint_layout

	* btk/btkvruler.c (btk_vruler_draw_ticks): use btk_paint_layout

	* btk/btklabel.c (btk_label_expose): use btk_paint_layout

	* btk/btkhscale.c (btk_hscale_draw_value): use btk_paint_layout

	* btk/btkhruler.c (btk_hruler_draw_ticks): use btk_paint_layout

	* btk/btkcellrenderertext.c (btk_cell_renderer_text_render): use
	btk_paint_layout

	* btk/btkaccellabel.c (btk_accel_label_expose_event): use
	btk_paint_layout

	* btk/btkstyle.h: Add draw/paint expander to draw tree expanders.
	Progress on bug 40103. Add draw_layout to draw a BangoLayout.
	(struct _BtkStyleClass): Remove draw_cross, draw_oval, draw_ramp,
	which were not implemented.	

	* btk/btktextbuffer.h (struct _BtkTextBufferClass): Add
	insert_pixbuf signal. Rename delete_text to delete_range since it
	also deletes pixbufs and child anchors. This almost closes bug
	40245 (still need to deal with child anchors)

	* btk/btktextbuffer.c (btk_text_buffer_class_init): Add
	insert_pixbuf, change signal names as appropriate, change types of
	signals taking marks/tags to have the specific type, not just
	G_TYPE_OBJECT
	
	* btk/btkmain.c (btk_get_current_event_state): Add this function; 
	closes bug 40051

	* btk/btkoptionmenu.c (btk_option_menu_set_history): clean up
	unnecessary remove_contents() call
	(btk_option_menu_class_init): add a "changed" signal, closes
	bug 40039
	(btk_option_menu_update_contents): emit "changed" if the 
	active menu item changes

	* btk/bdk-pixbuf-loader.c (bdk_pixbuf_loader_frame_done): fix bad
	cast to BtkObject, reported by Jonas Borgstrom
	(bdk_pixbuf_loader_finalize): don't close the loader on finalize;
	we can't do stuff with side effects in finalize. Instead, spew a
	warning if the loader isn't closed.

	* bdk/x11/bdkdrawable-x11.c (bdk_drawable_impl_x11_finalize): free
	colormap in here, non-X ports probably need to sync to this change

	* bdk/x11/bdkdrawable-x11.c (bdk_x11_set_colormap): remove 
	assertion that colormap != NULL, you can set the colormap to NULL
	if you like.
	
	* Makefile.am: remove btk-config-2.0

	* configure.in: Use pkg-config to locate GLib. Remove
	separated-out BMODULE_LIBS, BMODULE_CFLAGS; these were not used,
	and the bmodule libs/cflags were in BUNNYLIB_LIBS BUNNYLIB_CFLAGS anyhow.
	Use pkg-config to locate Bango. Output correct Bango libs to
	bdk-2.0.pc.in. Fix test for FREETYPE_CONFIG (typo fix).

	* Makefile.am (pkgconfig_DATA): install only target-specific pc
	files
	(install-data-local): symlink btk+-2.0.pc and bdk-2.0.pc to the
	X11 pc files

	* btk+-2.0.pc.in (Requires): require the BDK for the current target
	unref from here

2001-01-03  Alexander Larsson  <alla@lysator.liu.se>

	* configure.in:
	Change BTK_NO_CHECK_CASTS to G_DISABLE_CAST_CHECKS.

Tue Jan  2 16:23:05 2001  Owen Taylor  <otaylor@redhat.com>

	* btk/btktextlayout.c
	(btk_text_layout_move_iter_to_previous_line): Fix unitialized
	variable when moving back onto a single line.

2001-01-01  Havoc Pennington  <hp@redhat.com>

	* btk/Makefile.am (LDFLAGS): add @LIBTOOL_EXPORT_OPTIONS@

	* bdk/Makefile.am (LDFLAGS): add @LIBTOOL_EXPORT_OPTIONS@

	* configure.in (LIBTOOL_EXPORT_OPTIONS): define
	LIBTOOL_EXPORT_OPTIONS with options to control symbol export

2001-01-01  Havoc Pennington  <hp@redhat.com>

	* btk/btktexttagprivate.h: uscore-prepend all the stuff in here.

	* btk/btk-boxed.defs (BtkTextAttributes): Add boxed type for 
	BtkTextAttributes

	* btk/btktexttag.c: Fix up BtkTextAttributes copying to close bug 
	#40246
	(btk_text_attributes_copy_values): rename from 
	btk_text_attributes_copy
	(btk_text_attributes_copy): a more standard BTK copy function, 
	which returns a new object

2001-01-01  Havoc Pennington  <hp@redhat.com>

	* btk/btktreeview.c: Adapt to BtkTreeSelection changes
	
	* btk/btktreeselection.c (_btk_tree_selection_set_tree_view):
	don't fill in tree_view->priv->selection, kind of an unexpected
	side effect

	* btk/btkcellrenderertext.c: Remove definition of _ and include
	btkintl.h
	
	* btk/btkcellrenderer.c: Remove definition of _ and include
	btkintl.h
	(btk_cell_renderer_get_property): remove calls to g_value_init

	* btk/btkcellrendererpixbuf.c: Remove definition of _ and include
	btkintl.h

	* btk/btkcellrenderertextpixbuf.c: Remove definition of _ macro
	and include btkintl.h
	(btk_cell_renderer_text_pixbuf_class_init): remove spaces from
	property names

	* btk/btktreeselection.c (_btk_tree_selection_new): rename, return
	BtkTreeSelection
	(_btk_tree_selection_new_from_with_view): rename, return
	BtkTreeSelection
	(_btk_tree_selection_set_tree_view): rename with uscore
	(btk_tree_selection_get_selected): fill in the "model" out param
	first, so it gets filled in even if we return at the top of the 
	function
	(btk_tree_selection_real_select_all): add a comment and an else{}
	to clarify this a bit
	(btk_tree_selection_real_unselect_all): add the same else{}

	* btk/btktreeselection.h: Rename new, new_with_tree_view, and
	set_tree_view to have underscore prefixes, move them to the
	private header, fix return type of new_with_tree_view
	(struct _BtkTreeSelection): mark struct
	fields private	

	* btk/btktreemodel.c (btk_tree_model_get_flags): return
	BtkTreeModelFlags, not a guint
	(btk_tree_path_prev): return gboolean not gint
	(btk_tree_path_up): return gboolean not gint

	* btk/btktreemodel.h (struct _BtkTreeModelIface): make get_flags
	return BtkTreeModelFlags, not a guint

	* btk/btktreemodelsort.c (btk_tree_model_sort_finalize): check
	that child model is non-null before unrefing it
	(g_value_int_compare_func): make this a qsort compare func, not 
	a boolean predicate

	* btk/btktreemodelsort.h: rename btk_tree_model_set_sort_column,
	(add -umn to the end), and mark it unimplemented
	(btk_tree_model_sort_resort): remove, this wasn't implemented, and 
	I don't see what it's for - doesn't the model always sort itself?
	(btk_tree_model_sort_set_compare): this had the wrong signature

	* btk/btktreeviewcolumn.c (btk_tree_view_column_set_attributes):
	Fix the docs to say that it destructively replaces existing
	attributes (previously said that it added attributes).
	(btk_tree_view_column_set_visible): canonicalize bool before
	equality testing. Also, check for realization before
	hiding/showing the tree_column->window; if this window could exist
	before realization, then it's busted and needs fixing, we can't 
	create BDK resources pre-realization. Also, remove
	superfluous queue_resize(), since set_size() does that for us.
	(btk_tree_view_column_set_col_type): check realization before 
	using tree_column->window

	* btk/btktreedatalist.c: fix filename in copyright notice

2000-12-31  Havoc Pennington  <hp@pobox.com>

	* btk/btktextview.c: Rearrange all the
	scroll-while-dragging-or-selecting code to be different, not
	necessarily better. ;-)
	(btk_text_view_scroll_to_mark): Change this
	function to take within_margin as a fraction instead of a pixel
	value, and to take alignment arguments (indicating where to align 
	the mark inside the visible area)
	
	* btk/testtextbuffer.c (fill_buffer): fix bad cast of BtkTextTag
	to BtkObject

	* btk/btktextiter.c (btk_text_iter_set_line_offset): change
	behavior so that offsets past the end of the line are not 
	allowed, and an offset equal to the line length moves the iterator
	to the next line
	(btk_text_iter_set_line_index): make parallel change
	(btk_text_iter_get_bytes_in_line): add this function
	
	* btk/btktextbtree.c (_btk_text_line_byte_locate): change handling
	of byte indexes off the end of the line; byte index at the end of
	the line now returns FALSE and doesn't fill in the requested
	values, byte index past the end of the line is an error.  Also,
	don't allow -1 offset anymore, since its meaning is unclear.

	This change exposes some bug in visual cursor motion, where we
	end up with a huge invalid byte index; needs fixing. Symptom of 
	bug is a crash when you hit up arrow.
	
	(_btk_text_line_char_locate): match the change to byte_locate

	* btk/btktextiter.c (find_by_log_attrs): Handle iteration backward
	from start of line properly. fixes bug reported by Mikael
	Hermansson where backspace would delete all text before the
	cursor.

2000-12-30  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkwindow-win32.c
	(bdk_window_impl_win32_get_visible_rebunnyion): New function, as in
	the X11 backend.
	(bdk_window_new, bdk_window_set_title): Use g_locale_from_utf8()
	instead of duplicating the same code here.

	* bdk/win32/bdkwin32.h (BDK_COLORMAP_PRIVATE_DATA): Use
	BDK_COLORMAP macro.

	* bdk/win32/bdkevents-win32.c (bdk_event_funcs): Use NULL as
	destroy function.
	(bdk_event_translate): Use BDK_COLORMAP_PRIVATE_DATA to correctly
	access that.

	* btk/btk.def: Update.

	* btk/makefile.mingw.in: Use bunnylib-genmarshal from $(BUNNYLIB)/bobject.

2000-12-30  Havoc Pennington  <hp@pobox.com>

	* bdk/x11/bdkwindow-x11.c (bdk_window_new): Set the system
	colormap on input only windows, to avoid special cases all over
	the code for these windows.

2000-12-26  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkvisual-win32.c (bdk_visual_init): Call g_error if
	we are on a palettized display ("PseudoColor" in X11), as the code
	for that doesn't work anyway, and never has.

2000-12-22  Alexander Larsson  <alexl@redhat.com>

	* bdk/linux-fb/bdkkeyboard-fb.c (xlate_io):
	Don't use isprint() for chars > 255.

2000-12-21  Havoc Pennington  <hp@redhat.com>

	* tests/testtreeview.c: more work

2000-12-21  Alexander Larsson  <alexl@redhat.com>

	* docs/README.linux-fb:
	Update the docs to the new bangoft2 way.

2000-12-21  Alexander Larsson  <alexl@redhat.com>

	* configure.in:
	For linux-fb get the bangoft2 cflags and libs. This needs a recent
	bango version.
	Remove modules/linux-fb/Makefile.

	* bdk/linux-fb/bdkdrawable-fb2.c:
	Render glyphs using freetype.

	* bdk/linux-fb/bdkfb.h:
	Add new fb-specific functions needed for managing windows.

	* bdk/linux-fb/bdkmain-fb.c:
	Remove bdk_font_init/fini() calls.

	* bdk/linux-fb/bdkbango-fb.c:
	Remove old implementation. Use bangoft2 instead.

	* bdk/linux-fb/bdkprivate-fb.h:
	Remove BangoFBFont and related stuff.

	* bdk/linux-fb/bdkwindow-fb.c:
	Implement drawable->get_visible_rebunnyion.
	Implement support for _bdk_window_set_child_handler () and
	_bdk_window_get_decorations().

	* modules/Makefile.am:
	Remove linux-fb subdir.

	* modules/linux-fb/*:
	Removed all.
	
2000-12-20  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkcellrenderer*.c (::get_property): remove g_value_init
	calls, as they are no longer needed.

	* btk/btktreemodelsort.c: Fix up the comparison code.
	
	* btk/btktreemodel.h: Start work on ::reordered signal.  Need to
	figure out how to emit a signal on an interface.

2000-12-20  Havoc Pennington  <hp@redhat.com>

	* tests: new directory to contain tests, btk/test* should move
	here sometime (with appropriate on-cvs-server hackery)

	* tests/testtreeview.c, tests/Makefile.am: a test
	
	* configure.in (AC_OUTPUT): add tests/Makefile

	* btk/btktexttag.c (btk_text_tag_get_property): Add "invisible"
	and "invisible_set" which were missing

	* btk/btkrbtree.h: some cheesy indentation fix
	
2000-12-20  Alexander Larsson  <alexl@redhat.com>

	* btk/btkinvisible.c (btk_invisible_realize):
	Attach the style to the window so that the style it is not
	leaked when unrealizing the window.

2000-12-18  Havoc Pennington  <hp@redhat.com>

	* btk/btktextview.c (btk_text_view_delete_from_cursor): do
	begin/end user action where appropriate
	(btk_text_view_commit_handler): add begin/end user action

	* btk/btktextbuffer.c: add begin/end user action signals, and
	bracket interactive operations with begin/end user action pair.
	
	* btk/btktextbuffer.h (struct _BtkTextBufferClass): remove
	"interactive" arg from insert_text and delete_text signals.
	Add begin_user_action, end_user_action signals
	(btk_text_buffer_begin_user_action): 
	(btk_text_buffer_end_user_action): New functions to delimit 
	a user-visible action

	* btk/btkmarshal.list: update to reflect changes to btktextbuffer
	signals.
	
2000-12-18  Havoc Pennington  <hp@redhat.com>

	* bdk/bdkevents.c (bdk_event_get_state): wow, that implementation
	was pretty non-working.

	* btk/testtext.c (fill_file_buffer): make this a bit more robust
	by passing the length to g_utf8_validate().

2000-12-16  Havoc Pennington  <hp@pobox.com>

	* btk/bdk-pixbuf-loader.h, btk/bdk-pixbuf-loader.c: 
	Port to GObject, can go back in bdk-pixbuf after setting up 
	a bdk-pixbuf-marshal.h header over there.

	* btk/btktreeview.c: s/SEPERATOR/SEPARATOR/g;
	(btk_tree_view_class_init): specify BTK_TYPE_ADJUSTMENT for signal
	args
	(btk_tree_view_init): don't unset BTK_NO_WINDOW, it shouldn't be
	set
	(btk_tree_view_realize_buttons): don't btk_widget_show() buttons
	here, do it when we create the buttons later
	(btk_tree_view_realize_buttons): add some g_return_if_fail 
	(btk_tree_view_map): paranoia checks that column->button is shown 
	and unmapped
	(btk_tree_view_size_request): only request visible children.
	Move header size calculation in here, for cleanliness, and 
	to maintain invariants for child widgets if we eventually 
	let users set different children inside the buttons
	(btk_tree_view_map_buttons): factor out code to map buttons,
	since it was being called several times
	(btk_tree_view_size_allocate_buttons): move_resize the drag
	windows instead of just moving them; their height may change 
	if we allow random widgets in there, or the theme changes.
	(btk_tree_view_size_allocate): move button size allocation 
	above emitting the scroll signals, to ensure a sane state when we
	hit user code
	(btk_tree_view_button_release): remove queue_resize after
	tree_view_set_size(), set_size() will handle any resize queuing
	that's needed
	(btk_tree_view_focus_in): just queue a draw, don't fool with
	draw_focus goo
	(btk_tree_view_focus): use btk_get_current_event() and
	bdk_event_get_state()
	(btk_tree_view_deleted): don't queue_resize() after calling set_size()
	(btk_tree_view_build_tree): fix a "if (foo); {}" bug - i.e. remove
	semicolon
	(btk_tree_view_create_button): show the button here
	(btk_tree_view_button_clicked): actually emit the clicked signal
	on the column
	(_btk_tree_view_set_size): return right away if the size is
	unchanged, as a cheesy optimization
	(btk_tree_view_setup_model): rename set_model_realized to 
	setup_model to match the flag that indicates whether we've 
	called it
	(btk_tree_view_get_hadjustment): create adjustment if it doesn't
	exist, because set_scroll_adjustment does that and it shouldn't
	matter what order you call these in
	(btk_tree_view_get_vadjustment): ditto
	(btk_tree_view_set_headers_visible): canonicalize the bool, 
	for paranoia
	(btk_tree_view_set_headers_visible): call
	btk_tree_view_map_buttons() instead of using cut-and-paste code
	(btk_tree_view_append_column): clarify whether the return value
	is the count of columns before or after, and do the increment 
	separately from the return statement so you can tell from the code.
	(btk_tree_view_remove_column): ditto
	(btk_tree_view_insert_column): ditto
	(btk_tree_view_get_column): remove g_return_if_fail for columns
	outside the existing range, the docs say that outside-range
	columns are allowed, so we handle them as documented. (Presumably
	this allows a nice loop with column != NULL as test.)
	(btk_tree_view_move_to): document what 0.0, 0.5, 1.0 alignments 
	mean (left/right/center etc.).
	(btk_tree_view_collapse_all): only queue a draw if we're mapped
	(btk_tree_view_expand_row): add docs
	(btk_tree_view_collapse_row): add docs

	* btk/btktreeviewcolumn.c (btk_tree_view_column_clicked): new
	function to emit the clicked signal on a column
	
	* bdk/bdkevents.c (bdk_event_get_state): new function, to get the
	state of an event
	(bdk_event_get_time): don't treat BDK_SCROLL 
	as a button event, remove default case from switch so gcc 
	will whine if we don't explicitly handle all event types

	* btk/btktreeselection.h: added some FIXME 
	
	* btk/btktreeprivate.h (struct _BtkTreeViewPrivate): rename
	"columns" to "n_columns" and "column" to "columns" for clarity

2000-12-16  Havoc Pennington  <hp@pobox.com>
	
	* btk/btktextiter.c: General cleanup of the log attr iteration
	stuff. This should make e.g. the delete key work again in the
	text widget...
	(btk_text_iter_forward_cursor_positions): handle negative count
	(btk_text_iter_backward_cursor_positions): handle negative count
	(btk_text_iter_forward_word_ends): handle negative count
	(btk_text_iter_backward_word_starts): handle negative count

	* btk/btktextlayout.h, btk/btktextlayout.c, btk/btktexttag.h,
	btk/btktexttag.c, btk/btktexttagtable.h, btk/btktexttagtable.c, 
	btk/btktextbuffer.h, btk/btktextbuffer.c: Convert everything to 
	GObject. No doubt will cause breakage.

	* demos/btk-demo/textview.c: remove hacks around
	non-GObject-ification of the text objects

	* demos/btk-demo/main.c (main): use g_object_set() to manipulate 
	the text tag
	
2000-12-14  Havoc Pennington  <hp@pobox.com>

	* configure.in: only AC_DEFINE(HAVE_XFT) if we actually determined
	that we have Xrender

Thu Dec 14 20:22:31 2000  Owen Taylor  <otaylor@redhat.com>

        * bdk/{bdkdrawable.[ch],bdkpixmap.c,bdkwindow.c,x11/bdkwindow.c}:
	Add two virtualized functions bdk_drawable_get_clip_rebunnyion - to
	get the clip rebunnyion when drawing.
	
	* bdk/bdkwindow.c (bdk_window_invalidate_rect): Rewrite to simple
	use invalidate_rebunnyion.

	* bdk/bdkwindow.c (bdk_window_invalidate_rebunnyion): Clip to visible
	rebunnyion.

	* acconfig.h configure.in: Check for Xft. For now, assume
	that if Xft is found, Bango was compiled with Xft support
	as well.

	* bdk/bdkcolor.h bdk/x11/bdkcolor-x11.c: Add 
	bdk_colormap_query_color().
	
	* bdk/x11/bdkdrawable-x11.c (bdk_x11_draw_glyphs): Draw
	with Xft if appropriate.

	* bdk/x11/bdkbango-x11.c (bdk_bango_context_get): Create
	a bangoxft context if we have XFT and the environment
	variable GD_USE_XFT is set.
	
	* bdk/x11/bdkx.h (struct _BdkGCX11): Cache the fg_pixel
	and also possibly an XftDraw structure.

        * btk/btkfontsel.c: Handle the case where the font from the
	style doesn't match any of the fonts a bit better.
	
	* btk/testbtk.c: Add tabs between directional segments for
	hebrew/arabic test. (Not really necessary, just a little
	prettier.)

2000-12-14  Havoc Pennington  <hp@redhat.com>

	* btk/testtext.c (fill_file_buffer): fix unicode validation when
	reading a file

2000-12-14  Havoc Pennington  <hp@redhat.com>

	* btk/btktextbtree.c (_btk_text_btree_validate_line): remove
	unused call to get_last_line()

	* btk/btkobject.c (btk_object_add_arg_type): add G_TYPE_POINTER
	here until boxed is working (and maybe after that - we should
	really not gratuitously break old code)

	* btk/btktexttag.c (btk_text_tag_class_init): add commented-out
	specific types for font_desc and tabs args, move them to
	BTK_TYPE_POINTER for now, waiting on g_param_spec_boxed() to get 
	fixed. Move BdkColor args to BTK_TYPE_POINTER also.

	* btk/btktextbuffer.c (btk_text_buffer_class_init): temporarily
	use BTK_TYPE_POINTER for signal signatures as a hack-around

	* btk/btk-boxed.defs: Add boxed types for BangoFontDescription and
	BangoTabArray

	* btk/btktextlayout.c (line_display_iter_to_index): 
	make static
	(line_display_index_to_iter): make static

	* btk/btktextbuffer.c (btk_text_buffer_class_init): fix marshaller
	to marshal a string not a boxed

	* btk/btkmarshal.list: add marshaller for BtkTextBuffer:insert_text

	* btk/testtext.c (fill_file_buffer): don't use g_utf8_next_char
	since the UTF-8 isn't validated yet

	* btk/btktextsegment.c (char_segment_check_func): don't require
	lines to end in '\n'
	
	* btk/btktextview.c (btk_text_view_move_cursor): update to use
	forward_to_delimiters, and grapheme boundaries
	(btk_text_view_delete_from_cursor): properly handle non-newline
	delimiters, and grapheme boundaries

	* btk/btktextiter.c (btk_text_iter_forward_to_newline): rename
	to btk_text_iter_forward_to_delimiters, and make it work properly
	if empty lines end with a character other than '\n'

	* btk/btktextiter.h, btk/btktextiter.c: Add movement by cursor
	position

2000-12-15  Tor Lillqvist  <tml@iki.fi>

	* bdk/makefile.{mingw.in,msc} (bdk_OBJECTS): Add bdkkeys.

	* btk/btk.def
	* bdk/bdk.def: Update.

	* bdk/win32/bdkmain-win32.c
	* bdk/win32/bdkkeys-win32.c: New file. Move some functions from
	bdkmain-win32.c here.

	* bdk/win32/makefile.mingw.in (all): No need to make
	bdk-win32res.o here, the makefile one step up will call us to make
	it.

	* bdk/win32/makefile.{mingw.in,msc} (bdk_win32_OBJECTS): Add
	bdkkeys-win32.

	* bdk/win32/bdkcolor-win32.c: Silence gcc -Wall.

	* bdk/win32/bdkevents-win32.c (bdk_events_init): Remove leftover
	call to g_source_add().

	* bdk/win32/bdkgc-win32.c (BitmapToRebunnyion): Plug memory
	leak. Thanks to Andreas Kemnade.

2000-12-13  Havoc Pennington  <hp@pobox.com>

	* btk/btktextbtree.h: Remove double _ in front of some functions

	* btk/btktext*.[hc]: update accordingly
	
2000-12-13  Havoc Pennington  <hp@pobox.com>

	* btk/btktextbtree.h: Put _ in front of every function in this 
	header file

	* btk/btktext*.[hc]: update to reflect renamed btree functions

2000-12-13  Alex Larsson  <alexl@redhat.com>

	* bdk/linux-fb/bdkmouse-fb.c (mouse_devs):
	Add support for ps2 intellimouse.

	* bdkkeyboard-fb.c:
	Move shift-F1 repaint handling to xlate handler only.
	
	* docs/README.linux-fb:
	Add imps2 to docs.
	Document the new refresh keys.
	
Tue Dec 12 23:46:44 2000  Tim Janik  <timj@btk.org>

	* btk/stock-icons/Makefile.am: doh, this was broken beyond believe.

	* btk/btkbox.c: change property types from (u)long to (u)int for
	::position and ::padding.

	* btk/btkcontainer.c: make ::border_width an INT property.

	* btk/btkpacker.c: make ::position an INT property.

	* btk/btkscrolledwindow.c (btk_scrolled_window_adjustment_changed):
	guard against NULL h/v scrollbars, since this is used at construction
	time.

	* btk/btkclist.[hc]: nuked btk_clist_construct(), implemented
	internal btk_clist_constructor().

	* btk/btkctree.[hc]: nuked btk_ctree_construct(), implemented
	btk_ctree_constructor().

	* btk/btkprogressbar.c (btk_progress_bar_class_init): property
	::pulse_step should use ARG_PULSE_STEP, not ARG_FRACTION.

	* docs/reference/Makefile.am: fun stuff, disabled docs generation
	again, btk-scan.c needs to introspec paramspecs, not BtkAgs.

	* btk/btkwidget.[hc]:
	removed btk_widget_setv(), btk_widget_getv(), btk_widget_newv()
	and btk_widget_get().
	(btk_widget_new): use g_object_new_valist().
	(btk_widget_set): use g_object_set_valist().

	* btk/btkobject.[hc]:
	removed btk_object_arg_get_info(), btk_object_getv(),
	btk_object_query_args(), btk_object_newv(),
	btk_object_class_add_signals(),
	btk_object_class_user_signal_new(),
	btk_object_class_user_signal_newv(),
	btk_object_arg_set(), btk_object_arg_get(),
	btk_object_args_collect(),
	btk_object_default_construct(),
	btk_object_constructed(),
	BTK_CONSTRUCTED and BTK_OBJECT_CONSTRUCTED().
	removed nsignals, signals and n_args members from BtkObjectClass.
	(btk_object_new): use g_object_new_valist().
	(btk_object_set): use g_object_set_valist().
	(btk_object_get): use g_object_get_valist().
	
	* btk/btkcompat.h: define btk_object_default_construct().
	
	* btk/btktypeutils.c (btk_type_new): create constructed objects via
	g_object_new().

	* btk/*.c: removed btk_object_class_add_signals() from class_init()
	fucntions, cleaned up method assignments (make sure your structures
	are setup properly before calling out). removed all BTK_CONSTRUCTED
	hacks ;)

Tue Dec 12 11:52:16 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkclist.c (btk_clist_optimal_column_width): Fix 
	off-by-one error in checks. (Dave Lambert)

2000-12-12  Alexander Larsson  <alexl@redhat.com>

	* bdk/linux-fb/bdkkeyboard-fb.c (xlate_close, raw_close):
	Don't free bdk_fb_keyboard twice.

Tue Dec 12 08:24:42 2000  Tim Janik  <timj@btk.org>

	* btk/testbtk.c:
	(create_tooltips): 
	(create_statusbar): get rid of object_signal:: BtkObject argument uses,
	use GObject swapped_signal:: properties instead.

	* btk/btkcellrenderertoggle.c: 
	* btk/btkcellrenderertextpixbuf.c: 
	* btk/btkcellrenderertext.c: 
	* btk/btkcellrendererpixbuf.c: 
	* btk/btkcellrenderer.c:
	* btk/btktreeviewcolumn.c: s/[sg]et_param/[sg]et_property/, fixed
	missing warnings for invalid property ids, install properties
	with g_object_class_install_property() now.
	
	* btk/btksignal.c:
	(btk_signal_emit): let g_signal_emit_valist() collect the values for us.
	
Wed Oct 25 14:17:43 2000  Owen Taylor  <otaylor@redhat.com>
	
	* btk/btkwidget.[ch] (btk_widget_is_focus): Add a function
	to determine if a window is the focus widget within
	its toplevel.

	* btk/btkcontainer.[ch]: Fix the return type of ::focus
	to be boolean.

	* btk/btkcontainer.c (btk_container_real_focus): Move handling 
	of the case where the container CAN_FOCUS to here instead
	of having it in each individual move-the-focus place.

	* btk/btkcontainer.c: Rewrite handling of left-right and up-down
	focusing to be geometric in a much more obvious sense. Arrowing
	around is still non-intuitive because it isn't perfect and
	because entries, etc, grab the arrow keys, but it at least
	usually will do what you expect now.
	
	* btk/btknotebook.[ch]: Many cleanups. Moved docs inline in this
	file.

	* btk/btknotebook.c: Change tabs to be a single item in
	the focus chain. Make movement of focus on tabs with arrow
	keys wrap around.
	
	* btk/btknotebook.c (btk_notebook_find_child): Add
	CHECK_FIND_CHILD macro to give informative error messages
	instead of silent returns.

	* btk/btknotebook.c (btk_notebook_init): Set the RECEIVES_DEFAULT 
	flag since we handle BdkReturn on the tabs.

	* btk/btknotebook.c (btk_notebook_expose_tabs): Invalidate
	windows rather than sending expose events directly.

	* btk/btknotebook.[ch] docs/Changes-2.0.txt: Move structure 
	definition for BtkNotebookPage into .c file, since it is private.

	* btk/testbtk.c (create_notebook): Add option for 
	testing borderless notebook.

	* btk/testbtk.c (page_switch): Removed egrebunnyious poking
	around in BTK+ internals.

	* docs/widget-system.txt: Remove references to BTK_REDRAW_PENDING.

	* btk/btkclist.[ch]: Remove key press handler, handle focusing
	properly through btk_clist_focus. Make the title headers a
	single item in the tab-focus chain, and make left-right wrap
	around.

	* btk/btkwindow.c (btk_window_focus): Add a custom
	focus method so that wrapping around works properly.

	* btk/btktreeview.c: Remove calls to btk_container_set_focus_child() - 
	that is handled for the widget now. 

Mon Dec 11 11:41:12 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkinvisible.c (btk_invisible_init): Flag invisible
	widgets as TOPLEVEL.

	* btk/btkwidget.c (btk_widget_queue_resize): Don't assume
	TOPLEVEL widgets are containers.

	* btk/btkinvisible.h: Remove useless include.

2000-12-11  Havoc Pennington  <hp@redhat.com>

	* btk/btktextlayout.c (btk_text_layout_get_line_display): 
	Handle chopping off \r\n and 0x2029 in addition to \n before
	passing to BangoLayout

	* btk/btkimcontextsimple.c
	(btk_im_context_simple_get_preedit_string): 
	return an empty string if no match is pending

	* btk/btkimcontext.c (btk_im_context_get_preedit_string): add
	assertion that the returned preedit string was sane

	* btk/btktext*.[hc], btk/testtext.c, btk/testtextbuffer.c:
	s/btk_text_iter_next_char/btk_text_iter_forward_char/g;
	s/btk_text_iter_prev_char/btk_text_iter_backward_char/g;

Mon Dec 11 10:02:26 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkimcontextsimple.c (btk_im_context_simple_finalize): 
	Fix up finalizer to chain to its parent.

2000-12-11  Alexander Larsson  <alexl@redhat.com>

	* docs/README.linux-fb (BDK_KEYBOARD_TYPE):
	Clearified the difference between the keyboard types. Wrote a note
	about the magic sysrq key to get out of raw mode.

2000-12-09  James Henstridge  <james@daa.com.au>

	* bdk/linux-fb/bdkmouse-fb.c (BdkFBMouseDevice): add prot struct
	member to hold masks for detecting the start of a protocol packet.
	(mouse_devs): add packet start masks for ps2 and ms device types.
	Left the mask for fidmour blank, as I have no idea what it should
	be.
	(handle_mouse_io): skip bytes until we get to the start of a
	packet.  My Logitech mouse seems to be passing an extra NULL pad
	byte, and GPM does a similar thing here.
	(bdk_fb_mouse_ms_open): changed error message to not say psaux, as
	this is the ms mouse driver.
	(bdk_fb_mouse_ms_packet): fix up button handling, which was
	completely broken except for button1.  It was checking the wrong
	bit in the packet for the status of the right mouse button, and
	wrongly assuming right == button2 rather than 3.  I fixed that and
	also added support for middle button (button2).

2000-12-08  Havoc Pennington  <hp@redhat.com>

	* btk/btktextbtree.c (btk_text_btree_insert): fix breakage here
	that cause a segfault on text insertion

	* btk/btktextchild.c (btk_text_child_anchor_queue_resize): fix 
	warning

	* btk/btktextiter.c (test_log_attrs): use
	_btk_text_buffer_get_line_log_attrs to speed things up a bit

	* btk/btktextbuffer.c (_btk_text_buffer_get_line_log_attrs): 
	Get log attrs for a line, using a cache stored on the buffer
	
	* btk/btkcolorsel.h (BTK_COLOR_SELECTION_GET_CLASS): fix typo,
	reported by Jeff Franks

2000-12-08  Alexander Larsson  <alla@lysator.liu.se>

	* bdk/linux-fb/bdkmouse-fb.c (bdk_fb_mouse_ms_open):
	/dev/ttyS0 -> /dev/mouse

2000-12-08  Alexander Larsson  <alla@lysator.liu.se>

	* bdk/linux-fb/bdkfont-fb.c (bdk_fontset_load):
	Added dummy bdk_fontset_load.

2000-12-08  Alexander Larsson  <alexl@redhat.com>

	* docs/README.linux-fb:
	* docs/Makefile.am:
	Initial BtkFB docs.
	
	* bdk/linux-fb/Makefile.am:
	Define BDK_DATA_PREFIX.

	* bdk/linux-fb/bdkmain-fb.c:
	Fix typo.
	Change default display to /dev/fb0.

	* bdk/linux-fb/bdkbango-fb.c:
	Add $(prefix)/share/fonts/ to font path.
	
2000-12-08  Alexander Larsson  <alla@lysator.liu.se>

	* bdk/linux-fb/bdkkeyboard-fb.c:
	New file containing the abstracted keyboard driver. Most code
	taken from bdkinput-ps2.c

	* bdk/linux-fb/bdkinput-ps2.c:
	Removed file.
	
	* bdk/linux-fb/Makefile.am:
	Added bdkkeyboard-fb.c, removed bdkinput-ps2.c.

	* bdk/linux-fb/bdkcolor-fb.c:
	display->fb was renamed to display->fb_fd.

	* bdk/linux-fb/bdkcursor-fb.c:
	bdk_mouse_get_info -> bdk_fb_mouse_get_info

	* bdk/linux-fb/bdkinput.c:
	Moved bdk_input_init here from bdkinput-ps2.c

	* bdk/linux-fb/bdkmain-fb.c:
	display->fb was renamed to display->fb_fd.
	Now the tty and the console is opened here instead
	of in the keyboard driver. Also check BDK_VT to see what
	tty to open.
	Move bdk_beep () here from bdkinput-ps2.c
	bdk_mouse_get_info -> bdk_fb_mouse_get_info

	* bdk/linux-fb/bdkmouse-fb.c:
	Add header.
	bdk_mouse_get_info -> bdk_fb_mouse_get_info
	Return correct keyboard modifiers.
	BDK_MOUSETYPE -> BDK_MOUSE_TYPE for consistancy

	* bdk/linux-fb/bdkprivate-fb.h:
	Add tty and vt info to display.
	Add orignal modeinfo storage to display
	Update global functions

	* bdk/linux-fb/bdkwindow-fb.c:
	Added bdk_fb_window_find_focus().
	bdk_mouse_get_info -> bdk_fb_mouse_get_info

2000-12-07  Havoc Pennington  <hp@pobox.com>

	* bdk/x11/bdkkeys-x11.c (bdk_keymap_lookup_key): fix name of 
	function, noticed by Alex

2000-12-06  Elliot Lee  <sopwith@redhat.com>

	* configure.in: Detect freetype properly

	* modules/basic/Makefile.am, bdk/linux-fb/Makefile.am: Make use of
	above.

2000-12-06  Alexander Larsson  <alexl@redhat.com>

	* bdk/linux-fb/Makefile.am:
	Add bdkmouse-fb.c
	
	* bdk/linux-fb/bdkmouse-fb.c:
	New file. Abstracted the mouse drivers a bit.

	* bdk/linux-fb/bdkcursor-fb.c:
	The cursor hide/show functions was moved here from bdkinput-ps2.c.

	* bdk/linux-fb/bdkinput-ps2.c:
	Removed old mouse handling code. Moved cursor handling code
	to bdkcursor-fb.c, moved bdk_fb_window_send_crossing_events() to
	bdkwindow-fb.c. bdk_input_get_mouseinfo was renamed to
	bdk_mouse_get_info.

	* bdk/linux-fb/bdkmain-fb.c:
	Pass NULL pointers for x,y in bdk_mouse_get_info call.

	* bdk/linux-fb/bdkprivate-fb.h:
	Removed public bdk_fb_find_common_ancestor, added and renamed
	functions for the new mouse handling code.

	* bdk/linux-fb/bdkwindow-fb.c:
	Moved bdk_fb_window_send_crossing_events here. added global
	variable bdk_fb_window_containing_pointer. made
	bdk_fb_find_common_ancestor static. bdk_input_get_mouseinfo was
	renamed to bdk_mouse_get_info.

2000-12-06  Alexander Larsson  <alexl@redhat.com>

	* bdk/linux-fb/bdkevents-fb.c:
	Update to match latest gmain/gsource changes.

	* bdk/linux-fb/bdkinput-ps2.c:
	Bogus bdk_keymap_get_entries_for_keycode implementation so that
	it links. Will be implemented later.

2000-12-03  Havoc Pennington  <hp@pobox.com>

	* bdk/Makefile.am: add bdkkeys.[hc]

	* bdk/bdkkeys.h, bdk/bdkkeys.c: Move all the keyval stuff to these
	files from bdk.h, bdk.c; add BdkKeymap type and operations on it.

	* acconfig.h, configure.in: add checks and command line options
	for XKB

	* bdk/x11/bdkkeys-x11.c: Implement the above functions
	
	* bdk/x11/bdkevents-x11.c (bdk_event_translate): Put the keycode
	and group in the key event

	* bdk/bdkevents.h (struct _BdkEventKey): Add a hardware_keycode
	field with the low-level hardware key code, and a group
	field with the keyboard group

	* bdk/x11/bdkprivate-x11.h: include config.h for HAVE_XKB,
	and declare a couple globals used for keymap handling
	
	* btk/btkimcontextsimple.c: Implement ISO 14755 input method,
	hold down Shift-Control and type a hex number to get a Unicode 
	character corresponding to the hex number
	(btk_im_context_simple_get_preedit_string): Fix cursor position
	(return bytes not chars)

2000-12-05  Elliot Lee  <sopwith@redhat.com>

	* bdk/bdkcolor.h: Make BdkColor specify element sizes
	to avoid waste on 64-bit platforms.

Tue Dec  5 15:49:31 2000  Owen Taylor  <otaylor@redhat.com>

	* INSTALL: Fix link to PNG home, remove reference
	to fribidi.

	* bdk/x11/bdkevents-x11.c: Fix up for new GMain API.
	
	* bdk/win32/bdkevents-win32.c: Fix up for new GMain API. (Not
	tested.)

	* btk/btkcheckmenuitem.c: Permanently turn on
	always_show_toggle.

	* btk/btkclist.c (btk_clist_get_pixtext): Allow mask to 
	be NULL. (Vladimir Klebanov, #26545)

	* btk/btkspinbutton.c (btk_spin_button_insert_text): Fix 
	some signed/unsigned comparison problems. (#6510,
	David Kaelbling)

	* btk/btkwidget.[ch] (btk_widget_is_ancestor): Change
	return type to boolean (Oskar Liljeblad, #18648)

2000-12-05  Alexander Larsson  <alexl@redhat.com>

	* bdk/linux-fb/bdkmain-fb.c (bdk_fb_display_new):
	Remove bogus colormap setting.

2000-12-05  Alexander Larsson  <alexl@redhat.com>

	* bdk/linux-fb/bdkcolor-fb.c:
	More complete colormap handling. Now BdkRGB work in 8 bpp modes.

	* bdk/linux-fb/bdkdrawable-fb2.c (bdk_fb_draw_image):
	Must set colormap.
	
Tue Dec  5 13:17:53 GMT 2000  Tony Gale <gale@btk.org>

	* docs/tutorial/btk-tut.sgml: DND updates

2000-12-05  Alexander Larsson  <alla@lysator.liu.se>

	* bdk/linux-fb/bdkdrawable-fb2.c (bdk_fb_draw_drawable_3):
	Remove old debug g_warning().
	(bdk_fb_draw_drawable): The src argument can be either a wrapper
	or an implementation, just pass the implementation to draw_drawable_2.
	
	* bdk/linux-fb/bdkprivate-fb.h:
	Added BDK_IS_DRAWABLE_IMPL_FBDATA()

	* bdk/linux-fb/bdkwindow-fb.c (_bdk_windowing_window_destroy):
	clear and invalidate area when window is destroyed.
	(send_map_events): Remove old commented out code.

2000-12-05  Alexander Larsson  <alexl@redhat.com>

	* bdk/linux-fb/bdkbango-fb.c:
	Use italic instead of oblique in font aliases.
	
	* bdk/linux-fb/bdkrender-fb.c (bdk_fb_fill_span_generic,
	_bdk_fb_gc_calc_state): Support BDK_XOR, add g_warning for
	other unsupported functions.

2000-12-04  Havoc Pennington  <hp@redhat.com>

	* btk/btkpaned.c (btk_paned_expose): fix this to be sane

	* btk/btkvpaned.c (btk_vpaned_expose): Add an expose handler

	* btk/btkhpaned.c (btk_hpaned_expose): Add an expose handler

	* btk/btknotebook.c (btk_notebook_draw_tab): put in a temporary 
	hack to avoid infinite loops (synthetic expose event) - 
	Owen has more appropriate fixes in a branch he'll check in later.

	* btk/btktextiter.c (btk_text_iter_ends_line): handle paragraph
	separator, CR, and CRLF as line ends

	* btk/btktextbtree.c (btk_text_btree_insert): on insertion, break
	into lines using bango_find_paragraph_boundary(); other bits of
	the widget are still going to be broken if the boundary isn't '\n'
	though

2000-12-04  Alexander Larsson  <alexl@redhat.com>

	* bdk/linux-fb/bdkfont-fb.c (bdk_text_width): Divide size by 2, not
	multiply.

	* bdk/linux-fb/bdkbango-fb.c:
	Copied some 26.6 scaling macros from bango to clean up the rounding.
	(bango_fb_font_get_glyph_info): Correct sign on x value.

	* bdk/linux-fb/bdkprivate-fb.h:
	Removed unreferenced external functions.

	* modules/linux-fb/Makefile.am: Use ` instead of '.

	* modules/linux-fb/basic.c:
	Remove dead code. In particular the dummy lang engine which broke all
	bango layouts in BtkFB. Don't include tables-big.i anymore.

	* modules/linux-fb/tables-big.i:
	Upgrade to latest version from bango. Left for reference, basic_ranges
	moved to basic.c.
	
2000-12-04  Havoc Pennington  <hp@redhat.com>

        Fix bugs Alex found:
	
	* btk/btktooltips.c (btk_tooltips_force_window): nuke connection
	to "draw"

	* btk/btkdnd.c (btk_drag_highlight): nuke connection to "draw"

	* btk/btkcolorsel.c (palette_new): nuke connection to "draw"

	* btk/btklistitem.c (btk_list_item_expose): Put the old _draw() 
	implementation in here, apparently the expose() implementation was
	dead code.

2000-12-04  Alexander Larsson  <alexl@redhat.com>

	* bdk/linux-fb/bdkbango-fb.c (bango_fb_font_get_metrics):
	Return positive descent.

2000-12-02  Havoc Pennington  <hp@pobox.com>

	* btk/btkwidget.h (struct _BtkWidgetClass): Remove "draw" virtual
	method and signal
	
	* btk/btkwidget.c (btk_widget_draw): Now just queues a draw then
	calls bdk_window_process_updates() to push the exposes through
	(btk_widget_class_init): No more draw signal, no
	btk_widget_real_draw()	
	
	* btk/btkbin.c (btk_bin_draw): remove

	* btk/btkbox.c (btk_box_draw): remove

	* btk/btkbutton.c (btk_button_draw): remove

	* btk/btkcalendar.c (btk_calendar_draw): remove

	* btk/btkcheckbutton.c (btk_check_button_draw): remove

	* btk/btkcheckmenuitem.c (btk_check_menu_item_draw): remove

	* btk/btkclist.c (btk_clist_draw): remove

	* btk/btkentry.c (btk_entry_draw): remove

	* btk/btkeventbox.c (btk_event_box_draw): remove

	* btk/btkfixed.c (btk_fixed_draw): remove

	* btk/btkframe.c (btk_frame_draw): remove

	* btk/btkhandlebox.c (btk_handle_box_draw): remove

	* btk/btkhpaned.c (btk_hpaned_draw): remove

	* btk/btklayout.c (btk_layout_draw): remove

	* btk/btklist.c (btk_list_draw): remove

	* btk/btklistitem.c (btk_list_item_draw): remove

	* btk/btkmenu.c (btk_menu_draw): remove

	* btk/btkmenubar.c (btk_menu_bar_draw): remove

	* btk/btkmenuitem.c (btk_menu_item_draw): remove

	* btk/btknotebook.c (btk_notebook_draw): remove

	* btk/btkoptionmenu.c (btk_option_menu_draw): remove

	* btk/btkpacker.c (btk_packer_draw): remove

	* btk/btkrange.c (btk_range_draw): remove

	* btk/btkscrolledwindow.c (btk_scrolled_window_draw): remove

	* btk/btkspinbutton.c (btk_spin_button_draw): remove

	* btk/btktable.c (btk_table_draw): remove

	* btk/btktearoffmenuitem.c (btk_tearoff_menu_item_draw): remove

	* btk/btktext.c (btk_text_draw): remove

	* btk/btktextview.c (btk_text_view_draw): remove

	* btk/btktogglebutton.c (btk_toggle_button_draw): remove

	* btk/btktoolbar.c (btk_toolbar_draw): remove

	* btk/btktree.c (btk_tree_draw): remove

	* btk/btktreeitem.c (btk_tree_item_draw): remove

	* btk/btktreeview.c (btk_tree_view_draw): remove

	* btk/btkviewport.c (btk_viewport_draw): remove

	* btk/btkvpaned.c (btk_vpaned_draw): remove

	* btk/btkvscale.c (btk_vscale_draw): remove

	* btk/btkwindow.c (btk_window_draw): remove

2000-20-01  Anders Carlsson  <andersca@gnu.org>

	* btk/btktogglebutton.c (btk_toggle_button_draw): Fix bug when
	a BtkToggleButton is both insensitive and active, it was being
	drawn by the BtkButton draw handler which doesn't check the
	state. Now it's calling btk_toggle_button_paint instead.
	
2000-12-01  Havoc Pennington  <hp@redhat.com>

	* btk/btktextdisplay.c (btk_text_layout_draw): don't create
	dangling pointers to the appearance attributes from the 
	line display

	* bdk/bdkdraw.c (bdk_drawable_get_image): allow negative
	width/height to mean "full width/height of drawable"

 	* btk/btktextview.h, btk/btktextview.c: Implement double/triple
	click to select word/line
	
	* btk/btktextiter.c (test_log_attrs): include paragraph delimiters 
	when getting log attrs. Get a slice, so that pixmaps and stuff
	are properly handled.

	* btk/btktextbuffer.c (paste): Fix pasting to work properly if you
	paste into the selection (replaces selection now, previously
	crashed or added to selection). Reveals longstanding btree bug -
	select multiple lines, middle-click on the selection, boom. This
	isn't related to my changes though.

	* btk/btkentry.c (btk_entry_move_forward_word): Update to reflect
	BangoLogAttrs changes
	(btk_entry_move_backward_word): ditto

        * btk/btktextlayout.h, btk/btktextlayout.c: Make the iter motion
 	functions return bool whether the iter moved onto a
 	dereferenceable position.
 
 	* btk/btktextview.h, btk/btktextview.c: Add a bunch of public
 	functions for motion in terms of display lines.

	* btk/btktextmark.c (btk_text_mark_get_buffer): Add function to
	get the buffer a mark is inside
	
2000-12-01  Alexander Larsson  <alexl@redhat.com>

	* bdk/linux-fb/Makefile.am:
	* modules/linux-fb/Makefile.am:
	Freetype 2 final uses freetype-config

	* bdk/linux-fb/bdkbango-fb.c:
	Upgrade to use Freetype 2 final.
	More flexible support for font aliases, this also fixes a bug with
	BtkFontSelector, as the aliases must be visible in the font/family list,
	or BtkFontSelector reads uninitialized memory.

2000-11-30 Hidetoshi Tajima  <tajima@eng.sun.com>

	* modules/input/btkimcontextxim.c (setup_im): Add NULL argument to
	XGetIMValues to properly terminate variable argument list, and do
	NULL return check for ic_values and xim_styles.

	* modules/input/btkimcontextxim.c (btk_im_context_xim_reset):
	Restore preedit state after XmbResetIC().
	
	* modules/input/btkimcontextxim.c (btk_im_context_xim_get_ic):
	XvaCreateNestedList() should take XvaNestedList, but not
	XvaNestedList*.

	* modules/input/btkimcontextxim.c (btk_im_context_xim_reset,
	preedit_draw_callback, preedit_caret_callback): Match
	"preedit-changed" signal name to "preedit_changed" to be
	consistent to the spec.

	* btk/btkimcontextsimple.c (check_table):
	Match "preedit-changed" to "preedit_changed" to be consistent
	to the spec.

Thu Nov 30 23:03:04 2000  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkgc-x11.c (bdk_gc_copy): Properly handle
	gc->clip_rebunnyion == NULL>

2000-11-30  Tor Lillqvist  <tml@iki.fi>

	Changes by Hans Breuer:
	
	* bdk/win32/bdkwindow-win32.c (bdk_window_set_geometry_hints):
	Dont't use negative width and height as max_hints. This fixes
	Owen's recent testbtk changes for win32.

	* bdk/win32/bdkgc-win32.c (bdk_win32_hdc_get,
	bdk_win32_hdc_release): These are exported and may be called with
	other drawable types than our BdkDrawableImplWin32 (?).

	* bdk/bdkwindow.c: Backing store appears to work on Windows now,
	so always #define USE_BACKING_STORE.

	* btk/btktextdisplay.c (render_layout_line): Use g_print instead
	of printf for debugging output.

	* btk/btktextlayout.c (allocate_child_widgets): Ditto.
	
	* btk/btktextview.c (btk_text_view_child_allocated): Ditto.

	* btk/btkmain.h (BTKMAIN_C_VAR): Win32 fix for dllimport
	declaration.

	* btk/btktexttypes.h: Ditto.

	* btk/btklabel.c (btk_label_set_markup_with_accel): Return a value
	(BDK_VoidSymbol) also if in case of arg check failure.

	* btk/btkimcontextsimple.c
	(btk_im_context_simple_get_preedit_string): Don't assign cursor
	position to the pointer, but to the variable it points to.

	* btk/makefile.msc.in (DEFINES): Define BTK_VERSION.

	* btk/btk.def: Updates.

2000-11-29  Elliot Lee  <sopwith@redhat.com>

	* btk/btkmodelsimple.c: Inherits from BTK_TYPE_OBJECT, not
	BTK_TYPE_TREE_MODEL.

2000-11-29  Alexander Larsson  <alexl@redhat.com>

	* bdk/linux-fb/bdkfont-fb.c (bdk_font_from_description):
	Set the size of the font from the description.
	(bdk_text_width): Gross hack that calculates the width
	of text by text_length * size/2. This is necessary because
	BtkLabel does some ugly btk_string_width call to calculate
	an good size.
	(linux-fb/bdkprivate-fb.h): Removed unused field FT_Face.

Wed Nov 29 13:39:19 GMT 2000  Tony Gale <gale@btk.org>

	* docs/tutorial/btk-tut.sgml: DND updates

2000-11-29  Alexander Larsson  <alexl@redhat.com>

	* bdk/linux-fb/bdkwindow-fb.c (_bdk_windowing_window_clear_area):
	If you pass width or height == 0 to bdk_window_clear_area they
	should be calculated from the window size.

2000-11-29  Alexander Larsson  <alexl@redhat.com>

	* bdk/linux-fb/bdkinput-ps2.c (move_pointer): If there is
	a grab, but no grab-cursor, use the cursor from the grabbed
	window. (bdk_fb_window_send_crossing_events): Send normal
	enter/leave notifications if grab and owner_events == TRUE.

2000-11-29  Alexander Larsson  <alexl@redhat.com>

	* bdk/linux-fb/bdkinput-ps2.c (send_button_event):
	Do implicit button grabs, even if the window doesn't
	want the event.
	(bdk_fb_window_send_crossing_events): If there is a
	grab, only the grabbed window gets normal enter/leave
	notifications. On ungrab go from grabbed window to current.
	Don't send any notification to b when propagating from c -> b.
	If setting a grab on window, don't set prev_window.
	(handle_mouse_input): Send enter/leave events to the window the
	mouse is over, not the grabbed one.
	
2000-11-28  Elliot Lee  <sopwith@redhat.com>

	* bdk/bdkrebunnyion-generic.c: Zap warning.
	* modules/input/Makefile.am: Only build im-xim if USE_X11 is enabled
	* btk/btkrc.c: s/strcpy/memcpy/ to save a few nanoseconds.

2000-11-28  Alexander Larsson  <alla@lysator.liu.se>

	* bdk/linux-fb/bdkwindow-fb.c (bdk_fb_window_move_resize):
	The cursor should be hidden if it is part of either the
	source or destination rebunnyion. Not only if it is in both.
	(bdk_window_set_transient_for): Silence warnings.

2000-11-28  Alexander Larsson  <alexl@redhat.com>

	* bdk/linux-fb/mifillarc.c (miFillArcSliceSetup):
	The default mode in X is Pie Arcs, therefore that is
	what Btk+ uses.

2000-11-28  Alexander Larsson  <alexl@redhat.com>

	* bdk/linux-fb/bdkinput-ps2.c:
	Implement correct EnterNotify/LeaveNotify:
	(bdk_fb_window_send_crossing_events): New function that sends
	all BdkCrossingEvents from the last mouse-window to the specified
	destination.
	(bdk_fb_window_visibility_crossing): Removed function.
	(handle_mouse_input): Use bdk_fb_window_send_crossing_events()
	(send_button_event, bdk_fb_cursor_reset): Use bdk_window_at_pointer
	instead of bdk_window_get_pointer() for	better readability.

	* bdk/linux-fb/bdkmain-fb.c (bdk_fb_pointer_grab,
	bdk_fb_pointer_ungrab): Use bdk_fb_window_send_crossing_events.

	* bdk/linux-fb/bdkprivate-fb.h:
	removed bdk_fb_window_visibility_crossing, added
	bdk_fb_window_send_crossing_events and bdk_fb_find_common_ancestor.

	bdk/linux-fb/bdkwindow-fb.c (bdk_fb_find_common_ancestor):
	New function that finds the least common ancestor of two windows.
	(bdk_window_show, bdk_window_hide):
	Use bdk_fb_window_send_crossing_events.
	(bdk_fb_window_move_resize): Send configure events to toplevel
	windows. Use bdk_fb_window_send_crossing_events.

2000-11-27  Havoc Pennington  <hp@redhat.com>

	* btk/btkprivate.h (enum): Remove a trailing comma

2000-11-27  Federico Mena Quintero  <federico@helixcode.com>

	* btk/btkspinbutton.c (btk_spin_button_set_adjustment): Connect to
	the "changed" callback of the adjustment.  We need to redraw the
	spin button's arrows when the adjustment's range changes.
	(adjustment_changed_cb): Draw the arrows.
	(btk_spin_button_value_changed): Draw the arrows.

2000-11-23  Alexander Larsson  <alexl@redhat.com>

	* bdk/linux-fb/bdkselection-fb.c:
	Initial selection implementation.

	* btk/btkselection.c:
	if BDK_WINDOWING_FB defined, include linux-fb/bdkfb.h and look up
	requestor in btk_selection_request.
	
	* bdk/linux-fb/bdkfb.h, bdk/linux-fb/bdkglobals-fb.c:
	Added bdk_selection_property atom.

	* bdk/linux-fb/bdkprivate-fb.h:
	Export _bdk_selection_window_destroyed.
	Removed mask_off_x/y from BdkCursorPrivateFB.
	Removed hbearing, added top, left to BangoFBGlyphInfo.

	* bdk/linux-fb/bdkwindow-fb.c (_bdk_windowing_window_destroy):
	Call _bdk_selection_window_destroyed
	(_bdk_windowing_window_init): Don't call bdk_cursor_new() before
	the root window has been created.
	(static_dx_hack, static_dy_hack, compare_draw_rects,
	bdk_fb_window_move_resize): Remove unnecessary sort of rectangles
	in rebunnyion. They are already sorted. Instead just traverse them in
	reverse if draw_direction < 0.
	
	* bdk/linux-fb/bdkinput-ps2.c (send_button_event):
	Double-clicks must be sent after the normal button_press.
	(bdk_fb_cursor_unhide): Remove usage of mask_off_x/y. Clean up.
	
	* bdk/linux-fb/bdkgeometry-fb.c (bdk_window_scroll):
	Pass _bdk_fb_screen_gc instead of NULL.

	* bdk/linux-fb/bdkmain-fb.c (_bdk_windowing_init_check):
	Initialize bdk_selection_property.
	(bdk_event_make): Remove unused code.

	* bdk/linux-fb/bdkcursor-fb.c:
	Make the pixmap for the cursor the same size as the mask. Also remove
	the mask_off_x/y fields in BdkCursorPrivateFB and combine
	_bdk_cursor_new_from_pixmap() and bdk_cursor_new_from_pixmap()
	Now the whole cursor is visible.

	* bdk/linux-fb/bdkdrawable-fb2.c (bdk_fb_draw_drawable_3):
	Fix bug where xdest+height instead of ydest+height was used
	to calculate if the source and dest overlapped. This fixes the
	redraw bug when the main window in testbtk was scrolled when
	partially covered by a tall window.
	Copy rectangles in rebunnyion in order depending on draw_direction.
	Also moved the draw_direction flipping of start_y and end_y into
	the gc functions, as this might not be what all of them want.
	(bdk_fb_draw_lines): Support dashed lines.
	(bdk_fb_draw_glyphs): Clean up glyph placement. Also fix positioning
	so that the text is positioned correctly (was 1 pixel high).

	bdk/linux-fb/bdkgc-fb.c:
	Initialize cap_style to BTK_CAP_BUTT. This fixes a problem where
	all lines were drawn a pixel to short. Also checked the default of
	the rest of the values, and they're the same as X now.

	* bdk/linux-fb/bdkbango-fb.c (bango_fb_font_get_glyph_info):
	Clean up pixel positioning of the glyphs. Just use bgy->top and
	bgy->left. Also used BANGO_PIXEL where appropriate and added 0.5
	to all divisions to get correct rounding behaviour.

	* bdk/linux-fb/bdkrender-fb.c (bdk_fb_draw_drawable_generic,
	bdk_fb_draw_drawable_memmove, bdk_fb_draw_drawable_aa_24):
	Moved start_y/end_y flip into draw_drawable implementations.
	Flip also x rendering when draw_direction < 0.
	Remove unneccesary multiply with draw_direction.

Wed Nov 22 14:11:19 GMT 2000  Tony Gale <gale@btk.org>

	* docs/tutorial/btk-tut.sgml:
	  - get rid of btk_toggle_button_toggled FUD
	  - start DND section - needs work - based on:
		http://wolfpack.twu.net/docs/btkdnd/

2000-11-22  Alexander Larsson  <alexl@redhat.com>

	* bdk/linux-fb/bdkbango-fb.c (bango_fb_font_get_metrics):
	Correct calculation of font metrics. Now BtkEntrys have sane
	size.

2000-11-22  Alexander Larsson  <alexl@redhat.com>

        * bdk/bdktypes.h:
	Add new type BdkSpan
	
	* docs/reference/bdk/bdk-sections.txt,
	docs/reference/bdk/tmpl/rebunnyions.sgml, bdk/bdkrebunnyion-generic.c,
	bdk/bdkrebunnyion.h:
	Implement and document bdk_rebunnyion_spans_intersect_foreach.

	* bdk/linux-fb/Makefile.am, bdk/linux-fb/bdkrender-fb.c:
	Add new file bdkrender-fb.c which contains all core
	rendering code.
	Add bdk_fb_fill_rectangle_generic (old rectangle code) and
	bdk_fb_fill_rectangle_simple_16, bdk_fb_fill_rectangle_simple_32
	(optimized rectangle fillers).

	* bdk/linux-fb/bdkdrawable-fb2.c:
	Move all rendering code to bdkrender-fb.c.
	Change from using BdkRectangles and BdkSegments for spans to BdkSpan.
	Use the new span intersection functions in bdk_fb_fill_spans.
	bdk_fb_draw_rectangle() clips filled rectangles and calls
	gc->fill_rectangle with the result.
	bdk_fb_fill_spans() gets extra argument "sorted".

	* bdk/linux-fb/bdkevents-fb.c:
	Remove unused includes and defines.
	New function bdk_fb_get_time() to get correct time for events.

	* bdk/linux-fb/bdkinput-ps2.c:
	Use bdk method of generating multiple-clicks (bdk_event_button_generate)
	Make sure to set the time of all events.

	* bdk/linux-fb/bdkmain-fb.c:
	Use bdk_fb_get_time ().

	* bdk/linux-fb/bdkprivate-fb.h:
	New virtual GC calls: fill_span & fill_rectangle.
	Export bdk_fb_get_time().
	bdk_fb_fill_spans() gets extra argument "sorted".

	* bdk/linux-fb/mi*.c:
	Use BdkSpan instead of BdkRectangle.
	Pass correct sorted to bdk_fb_fill_spans. (sorted value taken
	from XFree 4 source)
	
2000-11-22    <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_calc_size): It's amazing what
	reversing the order in an if statement will do.  Doing so managed
	to make the treemodelsort half work.  Other half will follow after
	I get the insert function fully fixed.

2000-11-21  Elliot Lee  <sopwith@redhat.com>
	* btk/btkmenushell.h: BdkEventButton->button can occupy significantly
	more than 2 bits. Besides, I need to implement an evil hack. :)

Tue Nov 21 14:17:51 GMT 2000  Tony Gale <gale@btk.org>

	* docs/tutorial/btk-tut.sgml: minor corrections

2000-11-20  Jonathan Blandford <jrb@redhat.com>
	* btk/btktreemodelsort.h: Add convertion functions to let you
	  convert to and from relative path's and iters.

	* btk/treestoretest.c: move to having a sorted/unsorted view.  Start
	  testing sorting functions a bit better.  Currently broken -- will
	  fix in morning.

2000-11-20  Havoc Pennington  <hp@redhat.com>

	* btk/btkwidget.c: Documented a bunch of functions in here
	(btk_widget_realize): Warn if you try to realize
	a widget with no parent that isn't a toplevel
	(btk_widget_intersect): return a gboolean

2000-11-20  Havoc Pennington  <hp@redhat.com>

	* btk/btktextview.c, btk/btktextlayout.c, btk/btktextchild.c,
	btk/testtext.c: Semi-finish widget embedding. Need guffaw
	scrolling to be implemented in BDK to finish. Also, right now
	we just size_allocate all children on every layout change,
	which is pretty lame. Test commented out of testtext.c, 
	until it works better.

2000-11-20  Alexander Larsson  <alla@lysator.liu.se>

	* bdk/linux-fb/bdkdrawable-fb2.c:
	Removed unused arguments from bdk_fb_drawable_get_pixel().

	* bdk/linux-fb/bdkinput-ps2.c (handle_input_ps2):
	Renamed fidur specific mouse packet data in MouseDevice to
	generic. Used it in ps2 mouse handling code to avoid blocking
	reads.

Sat Nov 18 18:00:17 2000  Jonathan Blandford  <jrb@redhat.com>

	* demos/btk-demo/main.c: Changed to have the list become
	non-italic when the demo window is destroyed through an external
	event (like a close button).  Doing so found three bugs in the
	widget.

	* demos/btk-demo/*.c (do_*): Changed to return the toplevel window.

	* btk/btkliststore.c (btk_list_store_set_cell): emit "change" when
	we actually set the cell.

	* btk/btktreestore.c (btk_tree_store_set_cell): ditto

	* btk/btktreeselection.c (btk_tree_selection_real_select_node):
	free a leaked path.  Thanks memprof.

Sat Nov 18 11:58:17 2000  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkrgb.c (bdk_rgb_allocate_images): Fix 
	off-by-one error when destroying allocated segments
	on failure. (Elliot)

Sat Nov 18 11:45:09 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkcalendar.c: Patch from ChiDeok Hwang to fix
	memleaks found by Evan Martin.

Fri Nov 17 20:14:20 2000  Owen Taylor  <otaylor@redhat.com>

        * Released 1.3.2
	
	* NEWS: Updates for 1.3.2

2000-11-17  Tor Lillqvist  <tml@iki.fi>

	* bdk/bdkevents.h: Add comment that BdkXEvent isn't only for XEvent,
	but in general for window system specific events.

	* btk/btk.def
	* btk/makefile.mingw.in
	* btk/makefile.msc.in: Update.
	
	* btk/btktexttypes.h: Mark variables for export/import from DLL.

Thu Nov 16 16:11:39 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/Makefile.am (EXTRA_DIST): Do not, in any circumstances,
	distribute btk.immodules.

	* btk/Makefile.am (install-data-local): Don't install the
	btk.immodules file created for the uninstalled modules;
	instead run btk-query-immodules after install

Wed Nov 15 21:51:31 2000  Owen Taylor  <otaylor@redhat.com>

	* modules/input/Makefile.am (im_xim_la_LDFLAGS): Point
	-rpath to the right install location.

	* modules/input/Makefile.am (im_inuktitut_la_LDFLAGS): Remove
	-export-dynamic.

	* btk/btkthemes.c (btk_theme_engine_get): Set engine->name
	properly.

2000-11-15  Havoc Pennington  <hp@pobox.com>

	* btk/btktextview.c (btk_text_view_start_cursor_blink): Apply
	patch from Mikael Hermansson to temporarily stop blinking while
	the user is using the keyboard to type or navigate. 

	Also, when blinking, stay on for longer than we stay off. Also,
	return from start_cursor_blink if !cursor_visible, to save
	checking that flag all over the place before we call
	start_cursor_blink.

Thu Nov 16 01:25:51 2000  Robert Brady  <robert@suse.co.uk>

	* btk/btkrc.*: Remove the locale-specific btkrc's, as they
	only contain a "fontset" line, which is now ignored.

	* btk/btkentry.c (btk_entry_button_release): Make 
	double-click-to-select-word work.
	
Wed Nov 15 20:16:54 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btktextlayout.c (btk_text_layout_move_iter_to_line_end): 
	Don't move back one char when we are actually at the end of the 
	paragraph.

2000-11-15  Robert Brady  <robert@suse.co.uk>

	* modules/input/iminuktitut.c (inuktitut_compose_seqs): 
	'o' < 'p'.
	
	* btk/btkmain.c: s/CODSET/CODESET/, include <libintl.h> for
	bind_textdomain_codeset.

	(btk_init_check): Make the warning about translating default:LTR
	sterner.
	
Wed Nov 15 18:39:40 2000  Owen Taylor  <otaylor@redhat.com>

	* **/Makefile.am : remove unecessary rules for win32-specific
	config-substituted targets. If you want these rules, use
	--enable-maintainer-mode (called automatically by autogen.sh).
	Stops a lot of unneccessary make-time warnings.

	* btk/btktext{layout,display}.c: Factor in total width as
	well as screen when figuring alignment for word-wrap as well as
	no wrap; this is necessary to handle lines that cannot be wrapped
	at all.

2000-11-15  Havoc Pennington  <hp@redhat.com>

	* btk/testtext.c: Implement essential color cycling feature

2000-11-15  Havoc Pennington  <hp@redhat.com>

	* btk/btktextview.c (changed_handler): Invalidate the side windows
	when we invalidate the main window.

	* btk/testtext.c (create_view): Get rid of text_changed_callback,
	BtkTextView will now invalidate the side windows for us when text
	changes.

Wed Nov 15 16:02:20 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btktextview.c (changed_handler): Call scroll_calc_now()
	unconditionally, since we may need to update the horizontal
	scrollbars even if the height didn't change.

	* btk/btktextlayout.c (add_preedit_attrs): Always get
	the extra attrs, since some of them affect size.

	* btk/btktextdisplay.c (btk_text_layout_draw): Factor in
	x_offset correctly.

2000-11-15  Havoc Pennington  <hp@redhat.com>

	* btk/btktextlayout.c (set_para_values): If indent is negative,
	don't move the first line out into the margin, instead move the
	whole paragraph in order to make space for the first line within 
	the margin

2000-11-15  Havoc Pennington  <hp@redhat.com>

	* btk/btktextview.c (changed_handler): offset redraw rect by
	xoffset in addition to yoffset, so horizontal scrolling doesn't
	break redraws

2000-11-15  Havoc Pennington  <hp@redhat.com>

	* btk/btktextdisplay.c (btk_text_layout_draw): Remove extra pixel
	from the cursor
	(render_layout_line): fix reversed test that caused weird
	underlines to get drawn

2000-11-15  Alexander Larsson  <alla@lysator.liu.se>

	* bdk/linux-fb/bdkprivate-fb.h:
	Fix debug macros.
	
2000-11-15  Alexander Larsson  <alla@lysator.liu.se>

	* bdk/linux-fb/bdkprivate-fb.h:
	Added virtual functions set_pixel, get_color,
	fill_span and draw_drawable to the GC.
	Added global _bdk_fb_screen_gc to use instead of
	NULL when drawing to the screen.
	Added _bdk_fb_gc_calc_state() prototype.

	* bdk/linux-fb/bdkgc-fb.c:
	Call _bdk_fb_gc_calc_state() on any gc state change.

	* bdk/linux-fb/bdkglobals-fb.c:
	Add _bdk_fb_screen_gc
		
	* bdk/linux-fb/bdkdrawable-fb2.c:
	_bdk_fb_gc_calc_state() calculates best functions
	for the GC state and depth.
	Moved bpp specialized code to separate functions.
	Added optimized 24 bpp AA draw_drawable.

	* bdk/linux-fb/bdkevents-fb.c:
	Silence gcc warning.

	* bdk/linux-fb/bdkimage-fb.c:
	Use _bdk_fb_screen_gc

	* bdk/linux-fb/bdkwindow-fb.c:
	Init and use _bdk_fb_screen_gc

	* bdk/linux-fb/mitypes.h:
	Remove unused types.

2000-11-14  Havoc Pennington  <hp@pobox.com>

	* btk/btktextlayout.c (add_cursor): use BANGO_PIXELS() to convert
	to pixels

2000-11-14  Havoc Pennington  <hp@pobox.com>

	* btk/testtextbuffer.c (fill_buffer): change "offset" to "rise"

	* btk/btktexttypes.h (BTK_TEXT_UNKNOWN_CHAR): Add macro for
	unknown char, no real reason we were using a variable. 
	Remove btk_text_unknown_char variable. Fix all the text widget
	files accordingly.

	* btk/btktexttypes.c: Change "unknown character" to 0xFFFC, 
	since the Unicode spec seems to prefer that character for our
	purposes.

Wed Nov 15 02:18:01 2000  Robert Brady  <robert@suse.co.uk>

	* btk/btkrc.c (btk_rc_get_im_module_file): The return 
	value of g_getenv() isn't freeable, so g_strdup it.

	* modules/input/inuktitut.c: Inuktitut input method.

	* modules/input/Makefile.am: Build this.
	
2000-11-14  Elliot Lee  <sopwith@redhat.com>

	* btk/Makefile.am: Install btk.immodules, needed for operation
	of btk programs.

Tue Nov 14 20:13:06 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btktextlayout.c (btk_text_layout_move_iter_to_line_end): Fix
	reversed > that was causing Home to go to end of previous line.

	* btk/btkimcontextsimple.c (btk_im_context_simple_filter_keypress): Ignore
	modified-keypresses (leave for bindings.)

	* modules/input/Makefile.am: Remove useless -export-dynamic
	from module LDFLAGS.

2000-11-14  Havoc Pennington  <hp@redhat.com>

	* bdk/bdkbango.c (bdk_draw_layout_line): Draw underlines one pixel
	higher.

	* btk/btktextdisplay.c (render_layout_line): Take rise into
	account. Also, render rise, underline, background, etc. for
	pixbufs as well as text. Also, draw underlines one pixel higher.

	* btk/btktextlayout.c (btk_text_layout_get_line_display): Add a
	BangoAttribute for the rise, so it gets drawn properly. Also,
	add the BtkTextAppearance attribute for pixbuf/widget segments
	as well; we should go ahead and have rise, underline, background,
	stipple work for those

	* btk/btktexttag.c: Rename "offset" property to "rise" to match
	Bango

2000-11-15  Tor Lillqvist  <tml@iki.fi>

	* btk/makefile.{mingw,msc}.in (btk_OBJECTS): Add new objects.

	* btk/btk.def: Update.

	* btk/btkrc.c: Can't check for G_OS_WIN32 until bunnylib.h has been
	included.
	(btk_rc_get_im_module_file): Use run-time installation directory
	on Win32.

	* bdk/win32/rc/bdk.rc: Remove.
	* bdk/win32/rc/bdk.rc.in: New file.
	* bdk/win32/rc/Makefile.am: New file
	* bdk/win32/Makefile.am: Corresponding changes.

	* btk/btk.rc: Remove.
	* btk/btk-win32.rc.in: New file.
	* btk/Makefile.am: Corresponding changes.

	* configure.in: Corresponding changes.

	* btk/btkcompat.h.win32: Remove, useless. A distribution already
	has a built btkcompat.h. Developers using CVS code on Win32 can
	hand-edit it from btkcompat.h.in.

	* btk/makefile.{mingw,msc}.in: Correspondingly don't try to make
	btkcompat.h from btkcompat.h.win32.

2000-11-14  Havoc Pennington  <hp@redhat.com>

	* btk/btktextview.c (btk_text_view_drag_motion): Fix drag-and-drop
	to default to BDK_ACTION_MOVE if the drag is within a single
	widget. Defaults to BDK_ACTION_COPY between widgets.

Mon Nov 13 14:43:48 2000  Owen Taylor  <otaylor@redhat.com>

	* demos/Makefile.am (test-inline-pixbufs.h): Fix srcdir != builddir

	* btk/Makefile.am (INCLUDES): Add -I$(builddir)/btk

	* btk/stock-icons/Makefile.am (btkstockpixbufs.h): Handles
	srcdir != builddir

	* modules/input/Makefile.am (INCLUDES): add $(top_srcdir)/bdk

	* configure.in (BTK_VERSION): Up to 1.3.2

	* modules/input/Makefile.am (im_xim_la_SOURCES): Add 
	btkimcontextxim.h

	* btk/btkimcontext.c (btk_im_context_get_preedit_string): Add
	missing doc comment.

2000-11-14  Alexander Larsson  <alexl@redhat.com>

	* modules/linux-fb/basic.c:
	Use the bunnylib iconv wrappers.

2000-11-13  Havoc Pennington  <hp@pobox.com>

	* demos/btk-demo/textview.c: spiff up the demo a bit; reveals
	still more bugs.

	* btk/btktextview.c (btk_text_view_value_changed): don't try to
	scroll the BdkWindows before realization.

2000-11-13  Havoc Pennington  <hp@redhat.com>

	* btk/btktextdisplay.c (btk_text_render_state_update): fix bug 
	where GC didn't always get updated properly

	* demos/btk-demo/textview.c (create_tags): Use subattributes
	of fonts instead of setting the entire font

	* btk/testtext.c (fill_example_buffer): Use "size" instead of
	setting entire font

	* btk/btkdialog.c (btk_dialog_add_button): Fix some warnings

	* btk/btktexttag.h, btk/btktexttag.c: Explode font_desc into 
	a bunch of individually-settable font attributes. You can still 
	use the "font" and "font_desc" args, they just set all the font
	attributes at once.

2000-11-13 Elliot Lee <sopwith@redhat.com>

	* bdk/bdk.h: Add a couple of missing B_GNUC_CONST's.

Mon Nov 13 14:29:32 2000  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreemodel.c (btk_tree_path_copy): confirm path != NULL
	* btk/btktreemodel.c (btk_tree_path_free): ditto

	* btk/btktreemodelsort.c (btk_tree_model_sort_insert_value): make
	work better.

2000-11-13  Havoc Pennington  <hp@redhat.com>

	* btk/btkimmodule.c (btk_im_module_init): Free the filename of 
	the module file.

	* btk/btktexttag.c (btk_text_attributes_copy): fix memory leak of
	dest->language

	* btk/testtext.c: Test pixels above/below/inside paragraphs
	settings

	* btk/btktextview.c: Implement object args and setters/getters for
	all the aspects of the BtkTextAttributes that are not set from
	BtkWidget attributes. This is spacing, justification, margins,
	etc.

	(btk_text_view_set_arg)
	(btk_text_view_get_arg): implement get/set for editable, wrap mode
	args
	(btk_text_view_class_init): Add args for justify, left_margin,
	right_margin, indent, and tabs
	

	* btk/btktextlayout.c (set_para_values): fix to display indent
	attribute properly

	* btk/btktexttag.c: Remove left_wrapped_line_margin attribute, 
	replace with indent attribute

	* btk/btktextlayout.c (set_para_values): multiply indent by
	BANGO_SCALE

	* btk/btktextdisplay.c (render_para): Use BangoLayoutIter,
	rearranging code to do that
	(btk_text_layout_draw): Pass in the y for the whole LineDisplay,
	i.e. don't subtract the top_margin first, just to keep
	all margin-futzing in one place.

	* bdk/bdkbango.c (bdk_draw_layout): Use BangoLayoutIter

	* btk/btktextlayout.c (btk_text_layout_get_iter_location): Remove
	special case of last line, Bango now handles this itself.
	(btk_text_layout_get_iter_at_pixel): Fix incorrect clamp of the 
	Y coordinate
	(btk_text_layout_move_iter_to_x): port to use BangoLayoutIter
	(find_display_line_above): wasn't moving the byte index as it
	iterated over lines, so always returned byte 0. Also, port to use
	BangoLayoutIter.
	(find_display_line_below): same problem as
	find_display_line_above. Also, port to use BangoLayoutIter.

2000-11-13  Alexander Larsson  <alexl@redhat.com>

	* bdk/linux-fb/*.[ch]:
	Massive reindent to btk+ standard. My hands hurt.

	* bdk/linux-fb/bdkcolor-fb.c:
	Move BdkColorPrivateFB from inherited to windowing_data

	* bdk/linux-fb/bdkcursor-fb.c:
	_bdk_cursor_new_from_pixmap made static

	* bdk/linux-fb/bdkdnd-fb.c:
	BdkDragContextPrivate moved to windowing_data

	* bdk/linux-fb/bdkdrawable-fb2.c:
	Removed endian.h, use bunnylib endianness macros instead
	Some cleanups in the usage of BDK_DRAWABLE_FBDATA
	and BDK_DRAWABLE_IMPL_FBDATA

	* bdk/linux-fb/bdkfont-fb.c:
	Add empty bdk_font_load(). Needed for linking of Btk+.

	* bdk/linux-fb/bdkimage-fb.c:
	Removed endian.h, use bunnylib endianness macros instead
	Moved BdkImagePrivateFB to windowing_data
	bdk_image_new_bitmap didn't always allocate enough
	memory.

	* bdk/linux-fb/bdkinput-ps2.c:
	Added semi-working support for MS serial mice.

	* bdk/linux-fb/bdkprivate-fb.h:
	s/BdkWindowPrivate/BdkWindowObject/
	Removed BdkWindowPrivate typedef
	s/BDK_DRAWABLE_P/BDK_DRAWABLE_FBDATA/
	Removed BDK_DRAWABLE_P
	Move BdkColorPrivateFB from inherited to windowing_data
	Moved BdkImagePrivateFB to windowing_data

	* bdk/linux-fb/bdkvisual-fb.c:
	Removed some unused debug code.

	* bdk/linux-fb/bdkwindow-fb.c:
	Use stock cursors instead of including X headers.
	s/BdkWindowPrivate/BdkWindowObject/

	* bdk/linux-fb/mitypes.h:
	Removed unused types.

	* modules/linux-fb/basic.c:
	Use the bango fribidi wrappers.

2000-11-13  Sebastian Wilhelmi  <wilhelmi@ira.uka.de>

	* bdk/linux-fb/bdkcolor-fb.c, bdk/nanox/bdkmain-nanox.c,
	bdk/win32/bdkcolor-win32.c, bdk/win32/bdkwin32id.c,
	bdk/x11/bdkcolor-x11.c, bdk/x11/bdkvisual-x11.c, bdk/x11/bdkxid.c,
	btk/btkgc.c, btk/btkrc.c, btk/btktext.c: GCompareFunc ->
	GEqualFunc where applicable.
	
	* bdk/linux-fb/bdkbango-fb.c: bango_font_description_compare ->
	bango_font_description_equal as changed in bango.
	
	* bdk/nanox/bdkmain-nanox.c: bdk_xid_compare -> bdk_xid_equal.

	* bdk/win32/bdkcolor-win32.c: bdk_colormap_cmp -> bdk_colormap_equal.

	* bdk/win32/bdkwin32id.c: bdk_handle_compare -> bdk_handle_equal.

	* bdk/x11/bdkcolor-x11.c: bdk_colormap_cmp -> bdk_colormap_equal.

	* bdk/x11/bdkvisual-x11.c: bdk_visual_compare -> bdk_visual_equal.

	* bdk/x11/bdkxid.c: bdk_xid_compare -> bdk_xid_equal.

	* btk/btkgc.c: btk_gc_key_compare -> btk_gc_key_equal and
	btk_gc_drawable_compare -> btk_gc_drawable_equal.

	* btk/btkrc.c: btk_rc_style_compare -> btk_rc_style_equal and
	btk_rc_styles_compare -> btk_rc_styles_equal.

2000-11-12  Havoc Pennington  <hp@pobox.com>

	* demos/btk-demo/Makefile.am (democodedir): change demo install
	dir to datadir/btk+-2.0/demo

	* demos/btk-demo/textview.c: Text widget demo; reveals all 
	sorts of text widget and Bango font bugs. Urgh.

	* demos/btk-demo/Makefile.am (demos): Add textview.c

	* demos/btk-demo/main.c (create_tree): Add instructions at top of
	tree that you should double click to see the demo. Fix 
	types of variables to reflect changed return values from 
	BtkTreeStore and BtkTreeViewColumn constructors.

	* btk/btktextbuffer.c (btk_text_buffer_new): ref/sink the
	newly-created buffer to prepare for GObject semantics

	* btk/testtext.c: don't leak the buffer with GObject semantics

	* btk/testtextbuffer.c: ditto
	
2000-11-12  Havoc Pennington  <hp@pobox.com>

        Rename this testbtk to btk-demo to avoid confusion, and 
	install it so people can use it as a supplement to 
	the documentation.
	
        * demos/btk-demo: Moved from demos/testbtk

	* demos/testbtk: Removed

	* configure.in: make Makefile in btk-demo
	
	* demos/btk-demo/Makefile.am: Install sample source to 
	datadir/btk-demo (maybe there's a better place?), and 
	rename the binary to btk-demo
	
	* demos/btk-demo/main.c (load_file): Load installed sample
	source if source isn't found in pwd.

2000-11-09  Havoc Pennington  <hp@pobox.com>

	* btk/btkentry.c (btk_entry_class_init): Add an "invisible_char" 
	argument to set the char displayed when visibility == FALSE
	(btk_entry_create_layout): If !entry->visible, replace 
	all chars with the "invisible char"

	* btk/testbtk.c: Test the invisible_char deal
	
Mon Nov 13 02:16:33 2000  Robert Brady  <robert@suse.co.uk>

	* btk/btkstyle.c (btk_style_init): Fall back to "fixed" if we
	can't get a native font in the right encoding.

Mon Nov 13 00:09:29 2000  Robert Brady  <robert@suse.co.uk>

	* configure.in: Chinese .pos have been renamed to zh_CN and zh_TW
	respectively.

Sun Nov 12 19:11:42 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btktextlayout.c (btk_text_layout_move_iter_to_next_line):
	Fix warning when moving between paragraphs.

	* btk/btkentry.[ch]: Change move => move_cursor, 
	delete => delete_from_cursor, insert => insert_at_cursor

Sun Nov 12 22:52:51 2000  Robert Brady  <robert@suse.co.uk>

	* modules/input/imviqr.c: A vietnamese VIQR-based input method.

	* modules/input/imthai-broken.c: A Thai input method for use if
	Thai keys are really generating Latin1 keysyms.

	* modules/input/Makefile.am: Build these.

Sun Nov 12 22:15:35 2000  Robert Brady  <robert@suse.co.uk>

	* btk/btkfileselection.c, bdk/win32/bdkfont-win32.c: 
	g_filename_{to,from}_utf8 now takes an extra parameter.

	* btk/btkcalendar.c (btk_calendar_init): Convert output of
	strftime into UTF-8.

	(column_from_x, btk_calendar_paint_day_names): Support RTL
	calendars.

	(btk_calendar_paint_day_names): Draw day names in the right 
	place.
	
Sun Nov 12 14:10:09 2000  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkselection-x11.c (bdk_utf8_to_compound_text): Fix
	problem with using result of g_get_charset() backwards -
	pointed out by Mikael Hermansson <mikeh@bahnhof.se>.

	* btk/btkwindow.c (btk_window_compute_hints): Support
	negative min_width/height and max_width/height to
	mean "requisition"; this allows setting a window
	to be user-resizable in only one direction easily.

	* btk/testbtk.c (create_main_window): Remove hard-coded
	usize - set a default size in the vertical direction.

Sun Nov 12 13:33:01 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkrange.c: Add some missing casts. Support 
	2 and 3 button clicks on the arrows to mean 
	"move by pages" and "jump to end". (Like btkspinbutton)

2000-11-12 Hans Breuer <Hans@Breuer.Org>

	* bdk/win32/makefile.msc : reflect build module changes

	* bdk/win32/bdkcursor-win32.c : can't cast to impl type directly
	from BdkPixmap*, cast implementation member instead.

	* bdk/win32/bdkdrawable-win32.c (bdk_win32_draw_drawable) : The
	passed in drawable is of type BdkDrawableImplWin32, the BdkPixmap *src 
	maybe either BdkDrawable or BdkDrawableImpl. Corrected all casts, add
	more Gdi functions return value checking. 
	(bdk_win32_draw_image) : use IMAGE_PRIVATE_DATA to get on the
	BdkImagePrivateWin32 *.

	* bdk/win32/bdkevents-win32.c : Disable the SetCapture call to make
	menus useable again. Add #pragma message to keep reminded on this issue.
	(bdk_event_translate) : don't generate BDK_EXPOSE events for InputOnly
	windows. This allows to enable backing store on Win32!

	* bdk/win32/bdkimage-win32.c (_bdk_win32_get_image) : the passed
	in drawable is of impl type. Correct specific type checks appropriate.
 
	* bdk/win32/bdkpixmap-win32.c (bdk_pixmap_create_from_data) : check 
	BDK_WINDOW_DESTROYED before allocating new resources.

	* bdk/win32/bdkselection-win32.c : Handle BDK_WINDOW_DESTROYED case

	* bdk/win32/bdkwindow-win32.c : more Gdi return value checking,
	(bdk_window_foreign_new) initialize parent handle.
	(bdk_window_destroy_notify) add BDK_IS_WINDOW check

	* bdk/win32/bdkgeometry-win32.c (_bdk_window_move_resize_child) :
	Let the GDI invalidate the window on MoveWindow call to fix scrolling
	problems (e.g. main buttons in testbtk). 

Sat Nov 11 23:07:30 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkentry.c (btk_entry_key_press): Call 
	btk_widget_activate for BDK_Return.

	* btk/btkentry.c (btk_entry_preedit_changed_cb): Fix handling
	of preedit cursor position.

Sun Nov  5 04:24:53 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkcellrenderertextpixbuf.c: Make parent_class
	static.

Tue Sep 19 10:54:22 2000  Owen Taylor  <otaylor@redhat.com>

	* modules/input/{btkimcontextxim.[ch],imxim.c}: Rip
	out support for multiple locales; that simple doesn't
	work reliably with current Xlib

	* btk/btkimcontext*.[ch] btk/btkimmulticontext.[ch]
	btk/btktextlayout.[ch] btk/btktextview.c btk/btkentry.c: 
	Add support for positioning the cursor within the preedit string.

Mon Sep 18 23:56:32 2000  Owen Taylor  <otaylor@redhat.com>

	* modules/input/{imxim.c,btkimcontextxim.[ch]}: Start
	at XIM input method module.

	* btk/btktextview.c: Check for bindings after passing
	events to im context filter.

Mon Sep 18 11:50:51 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btktextlayout.c (add_preedit_attrs): Handle
	empty attribute lists properly.

Sun Sep 17 10:08:16 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/queryimmodules.c (main): Return non-zero exit
	status if errors were encountered querying any
	modules.

	* modules/input/Makefile.am (moduledir): remove
	leftover bin program target.

	* docs/make-todo: Fix typo in error message.

Sat Sep 16 14:04:30 2000  Owen Taylor  <otaylor@redhat.com>

	* configure.in: Add modules/input/Makefile

Sat Sep 16 14:01:52 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btk.h: include btkmodule.h btkoldeditable.h,
	don't include btkthemes.h.

	* btk/testbtk.c btk/testtext.c: Set environment variables
	to point

	* btk/Makefile.am: Add new .c and .h files, build 
	btk-query-immodules and use it to create a btk.immodules
	file for use of test programs.

	* btk/btkpreview.c: remove extra blank line.

Sat Sep 16 13:21:04 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkimcontextsimple.c (btk_im_context_simple_add_table): 
	Add the ability to add extra tables beyond the default
	one, and also the ability to have compose sequences 
	that are prefixes of other compose sequences. 

	* btk/btkimcontextsimple.c: Export a preedit string which
	consists of possible candidates for keystrokes that have
	been entered but not yet committed.

	* btk/btkimcontext.[ch] btk/immulticontext.[ch]
	btk/btkimcontextsimple.[ch]: add btk_im_context_reset()

	* btk/btkmulticontext.[ch] (btk_im_multicontext_append_menuitems): 
	Add a function to add input-method switching menu items
	to a menu.

	* btk/btkimmulticontext.[ch]: Properly handly set_client_window
	when switching input methods.

	* btk/btkimcontextsimple.[ch]: Change the format of
	the compose table to allow compose tables of different
	lengths / sequence.

Sat Sep 16 13:05:48 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkimmodule.[ch]: Support routines for loading
	BtkIMContext implementations dynamically at runtime.

	* modules/input/imcyrillic-translit.c: A sample input
	method (based on BtkIMContextSimple with an extra table),
	which demonstrates preedit strings and the module
	system for input modules

	* btk/queryimmodules.c: Program to query the available
	input modules and write the results into a file.
	 
	* btk/btkrc.[ch] (btk_rc_get_im_module_file): Add
	extra config options "im_module_file" (cache file for
	input method modules), and "im_module_path" - path
	to look for modules when generating cache file.

	This doesn't scale.

Sat Sep 16 13:09:06 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkthemes.[ch] btk/btkmodule.[ch]: Move most of the 
	generic	code from btkthemes into a new abstraction
	BtkModule which has the logic for implementing
	a loadable module which implements a number of 
	GObject types.

Sat Sep 16 13:07:13 2000  Owen Taylor  <otaylor@redhat.com>

        * btk/btkeditable.[ch]: Convert BtkEditable from
	a class into an interface  
	
	* btk/btkoldeditable.[ch]: Move the old editable
	implementation into here, so legacy widgets can
	still rely on the implemenation. BtkOldEditable
	exports BtkEditable. Make selection handling
	code use new text conversion functions (and
	handle UTF-8 as a side-effect). Use BtkClipboard
	for CLIPBOARD.

	* btk/btktext.[ch] btk/btkcombo.c btk/btkspinbutton.c:
	Adopt to match above changes.

	* btk/btkentry.[ch]: Implement BtkEditable directly,
	avoid BtkOldEditable implementation. Restructure
        to reduce number of places that modify state directly.
	Move to BtkBindingSet. Display the preedit string.
	Queue recomputation of BangoLayout and scroll position
	to improve effiency of doing complex changes naively.
	Add a menu with cut/copy/paste and input method selection.

Thu Sep 14 22:11:05 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btktextlayout.[ch]: Add btk_text_layout_set_preedit_string()
	to set preedit string and attributes; display preedit string by
	inserting string and attributes at cursor when creating the
	BtkTextLineDisplay.

	* btk/btktextlayout.c: Move all conversions between byte
	positions in BangoLayout and BtkTextIter into new functions
	line_display_iter_to_index/index_to_iter that properly
	handle the preedit string.

	* btk/btktextmark.[ch]: Restore btk_text_mark_get_name, modify
	it to return const char * (eventually will end up
	as GCONST char *, most likely.)

	* btk/btktextview.[ch]: Handle the preedit string, call
	btk_im_context_reset() as necessary, add a menu to switch
	input methods.
	
	* btk/btktextlayout.[ch]: Remove useless
	btk_text_layout_get_log_attrs() function.

2000-11-11  Tor Lillqvist  <tml@iki.fi>

	* bdk/bdk.def
	* btk/btk.def: Update.

	* bdk/win32/*.c: Add last argument to g_type_register_static()
	calls.

	* bdk/win32/bdkwindow-win32.c: Silence gcc -Wall.

	* bdk/win32/bdkevents-win32.c: Handle MSH_MOUSEWHEEL messages
	generated by older wheel mouse drivers. Get the correct y
	coordinate from WM_MOUSEWHEEL messages.

	* bdk/win32/bdkgc-win32.c (bdk_win32_cap_style_to_string,
	bdk_win32_fill_style_to_string, bdk_win32_function_to_string,
	bdk_win32_join_style_to_string, bdk_win32_line_style_to_string):
	Debugging functions.

	* bdk/win32/bdkprivate-win32.h: Declare them.

	* bdk/win32/bdkinput-win32.h: Add declaration for
	bdk_input_window_destroy().

	* btk/makefile.mingw.in: Pass -DBTK_VERSION. Add btktreemodel.o.

Fri Nov 10 19:06:41 2000  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreemodelsort.c (btk_tree_model_sort_insert_value): New
	function to help handle keeping things in sync.

Fri Nov 10 12:10:34 2000  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkliststore.c (btk_model_simple_class_init): use the new
	BOXED marshallers.

	* btk/btkliststore.c (btk_list_store_get_column_type): Add this.
	(btk_list_store_class_init): use the new BOXED marshallers.

	* btk/btktreestore.c (btk_tree_store_new_with_types): change
	new_with_values to new_with_types.
	(btk_tree_store_get_column_type): add this.
	(btk_tree_store_class_init): use the new BOXED marshallers.

	* btk/btkmarshal.list: Added a number of BOXED marshallers to
	mirror some POINTER marshallers.

Thu Nov  9 11:23:22 2000  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreemodel.h (struct _BtkTreeIter): added more fields to
	allow more interesting iterators.  Also, made the lifecycle of
	iterators more explicit.

	* btk/btktreemodelsort.[ch]: New model for sorting.

	* btk/btk-boxed.defs (BtkTreeIter, BtkTreePath): Added two boxed
	types.

2000-11-09  Alexander Larsson  <alexl@redhat.com>

	* demos/testbtk/menus.c:
	Changes to make the new testbtk compile after
	btk_menu_append was removed.

	* bdk/linux-fb/bdkdrawable-fb2.c
	(bdk_fb_get_depth, bdk_fb_get_visual,
	bdk_drawable_impl_fb_class_init): Implement
	these drawable functions. Now BtkImages work again.

	* bdk/linux-fb/bdkimage-fb.c (_bdk_fb_get_image): Change prototype.

	* bdk/linux-fb/bdkprivate-fb.h (_bdk_fb_get_image): Change prototype.
	
	* bdk/linux-fb/bdkmain-fb.c (fb_modes_parse_mode,
	bdk_fb_setup_mode_from_name, bdk_fb_set_mode, bdk_fb_display_new);
	Parse /etc/fb.modes, use the environment variables BDK_DISPLAY_MODE,
	BDK_DISPLAY_DEPTH, BDK_DISPLAY_WIDTH, BDK_DISPLAY_HEIGHT.

2000-11-08  Havoc Pennington  <hp@pobox.com>

	* btk/btktexttag.c (btk_text_tag_class_init): Add visible and
	visible_set args, don't know where these had gone, I thought they
	used to be there

	* btk/testtext.c: Add a menu item to apply invisibility tag;
	now we can test the feature and see that it's totally broken.

2000-11-08  Havoc Pennington  <hp@pobox.com>

        Make DND copy pixbufs and tags when source and target share a 
	tag table.
	
	* btk/btktextview.c (btk_text_view_drag_data_get): provide the
	in-process BTK_TEXT_BUFFER_CONTENTS target
	(btk_text_view_drag_data_received): Paste from
	BTK_TEXT_BUFFER_CONTENTS if we receive it.

2000-11-08  Alexander Larsson  <alexl@redhat.com>

	* docs/Changes-2.0.txt: Add note about BtkMenuPositionFunc
	API changes.

	* btk/btkmenu.c: Add support for scrolling menus.
	Remove btk_menu_append/prepend/insert, these have been moved to
	btkcompat.h as #defines.

	* btk/btkcompat.h.in:
	Add compatibility #defines for btk_menu_append/prepend/insert

	* btk/btkmenu.h: Add data needed for scrolling menus.
	BtkMenuPositionFunc gets an extra argument push_in.
	btk_menu_append/prepend/insert removed.
	
	* btk/btkmenuitem.c (btk_menu_item_position_menu): Change menu
	positioning behaviour to fit to scrolling menus.

	* btk/btkmenuitem.c (btk_menu_item_forall): Don't recurse
	into menuitem->submeny. That is wrong, and broke torn
	off submenus of torn off menus, since they were unrealized
	when the first menu was unrealized.

	* btk/btkmenushell.[ch]: Virtualize btk_menu_shell_insert() and
	btk_menu_shell_select_item() since these need to be overridden in
	BtkMenu.

	* btk/btkoptionmenu.c (btk_opttion_menu_position): Change menu
	positioning behaviour to fit to scrolling menus.
	(btk_option_menu_key_press, btk_option_menu_button_press): Select
	the current item so that it is prelighted when the menu pops up.
	This is a workaround to the fact that the menu doesn't get the
	initial enter event (due to grabs).

	* btk/btkfilesel.c, btk/btkinputdialog.c, btk/testbtk.c:
	s/btk_menu_append/btk_menu_shell_append/

	* btk/btknotebook.c:
	s/btk_menu_insert/btk_menu_shell_insert/

	* btk/testbtk.c (create_menu, create_menus):
	Create the first menu with 50 items so that menu scrolling
	can be tested.
	
	
	Patch from Jonathan Blandford  <jrb@redhat.com>

	* btk/btkmenuitem.[ch] (btk_menu_item_toggle_size_request): new
	system to handle size requests.  First, we ask what the size of
	the toggle is.  Then, when allocating the size, we allocate the
	toggle_size first.  This way we can have multiple menu-item
	classes w/o needing a seperate class for each.

	* btk/btkmenu.c (btk_menu_size_request): Actually use the new system.
	* btk/btkmenu.c (btk_menu_size_allocate): Use the new system.

	* btk/btkcheckmenuitem.c
	(btk_check_menu_item_toggle_size_request): New function to handle
	the toggle size-request.

2000-11-07  Havoc Pennington  <hp@redhat.com>

	* btk/btktextlayout.c (btk_text_layout_get_iter_location):
	Half-ass somewhat fix this function, so that scrolling to the
	insertion point works. Bango hacking is in the future to really
	fix it.

	* btk/btktextview.c (btk_text_view_drag_data_get): Don't calculate
	length of data, no longer used.

	* btk/btktextbuffer.c (btk_text_buffer_finalize): move destroy
	method contents in here, get rid of destroy method
	(btk_text_buffer_insert_range): Fix some g_return_if_fail checks
	that were backward. Remove debug spew.
	(cut_or_copy): Make the clipboard work with insert_range to
	preserve tags and pixbufs, not just the primary selection.

2000-11-07  Havoc Pennington  <hp@redhat.com>

	* btk/btktextmark.c (btk_text_mark_is_visible): rename 
	to btk_text_mark_get_visible

	* btk/btktextlayout.c (btk_text_layout_move_iter_to_line_end): fix
	bug that was generating an invalid iterator

	* btk/btktextiter.c (btk_text_iter_get_offset): move call to
	ensure_char_offsets() in front of code placing the iter in an
	invalid state.

	* btk/btktextbuffer.c (btk_text_buffer_paste_primary):
	make override_location arg const
	(paste): Replace the selection if we paste into the 
	current selection

	* btk/btkselection.h: Remove "BtkSelectioData"
	(struct _BtkSelectionData): move the definition here.

	* btk/btktextbuffer.c (btk_text_buffer_update_primary_selection):
	Export the BTK_TEXT_BUFFER_CONTENTS target for in-process copies

	* btk/btktextiter.c (btk_text_iter_get_tags): New function

	* btk/btktextbuffer.c (btk_text_buffer_insert_range): implement
	(btk_text_buffer_insert_range_interactive): implement
	(btk_text_buffer_get_tags): Remove, replaced by
	btk_text_iter_get_tags()

	* btk/btktextiter.c (btk_text_iter_forward_search): Add a search
	limit parameter, to avoid infinite linear scan.
	(btk_text_iter_backward_search): Add search limit
	(btk_text_iter_forward_find_char): Add search limit
	(btk_text_iter_backward_find_char): Add search limit

2000-11-07  Alexander Larsson  <alla@lysator.liu.se>

	* bdk/linux-fb/bdkcolor-fb.c, bdk/linux-fb/bdkdnd-fb.c,
	bdk/linux-fb/bdkgc-fb.c, bdk/linux-fb/bdkimage-fb.c,
	bdk/linux-fb/bdkbango-fb.c, bdk/linux-fb/bdkpixmap-fb.c,
	bdk/linux-fb/bdkwindow-fb.c:
	use g_object_new() instead of g_type_create_instance() which
	is a private function for fundamental type implementations.

	* bdk/linux-fb/bdkinput-ps2.c:
	Use MEDIUMRAW instead of RAW keycodes. Remove keyboard state-table
	instead just store the current modifier state. Add a (somewhat broken)
	keyboard input parser for XLATE mode too, if we couldn't use MEDIUMRAW.
	Rename exported function bdk_input_ps2_get_mouseinfo to
	bdk_input_get_mouseinfo.

	* bdk/linux-fb/bdkmain-fb.c, bdk/linux-fb/bdkprivate-fb.h,
	bdk/linux-fb/bdkwindow-fb.c:
	bdk_input_ps2_get_mouseinfo was renamed to bdk_input_get_mouseinfo.
	

2000-11-02  Havoc Pennington  <hp@redhat.com>

	* btk/btkfilesel.h, btk/btkfilesel.c: Derive from BtkDialog, and
	use stock buttons. Should be 100% source compatible, appropriate
	filesel fields now point to dialog->vbox and dialog->action_area.
	On the bizarre side, dialog->action_area and filesel->action_area
	are not the same widget.
	(btk_file_selection_init): Put some padding around the selection
	entry, so it isn't touching the BtkDialog separator.	

	* btk/btkfontsel.h, btk/btkfontsel.c: Derive from BtkDialog, 
	use stock buttons, etc. Should also be source compatible.
	Set the dialog default title in _init not _new().
	
	* btk/btkcolorseldialog.c (btk_color_selection_dialog_init): 
	Use stock buttons; don't put a button box inside the existing
	dialog button box. Don't bother with push/pop colormap anymore.

	* btk/btkdialog.h (BtkResponseType): Add a bunch of more 
	specific BTK_RESPONSE_* values. This is clearer than ACCEPT/REJECT
	for message dialog, and necessary for the font selection and color
	selection with help and apply buttons.
	
	* btk/btkdialog.c (btk_dialog_add_button): Return a pointer 
	to the created button widget. Set BTK_CAN_DEFAULT on the button.
	(btk_dialog_init): Default to BTK_BUTTONBOX_END, put less spacing
	between buttons, put less padding around the action area.
	(btk_dialog_run): Exit on unmap rather than on destroy. 
	This will also exit the loop if the widget is hidden.
	(btk_dialog_delete_event_handler): Use BTK_RESPONSE_DELETE_EVENT
	instead of BTK_RESPONSE_NONE; since we're already adding a bunch
	of BTK_RESPONSE_* stuff, this seems cleaner, and lets you 
	special-case delete event.

	* btk/btktexttagtable.c, btk/btktextview.c: Fix doc comment
	formatting
	
Sun Nov  5 05:32:39 2000  Tim Janik  <timj@btk.org>

	* btk/testbtk.c (uposition_stop_configure): provide a toggle
	button to temporarily disable position recording in the
	"saved position" test.

Sat Nov  4 05:37:17 2000  Tim Janik  <timj@btk.org>

	* btk/btkthemes.c: added compat code that temporarily implements
	BtkThemeEnginePlugin as a GObject exporting GTypePlugin. this is
	going to be revamped by owen's upcoming BtkModule patches, but
	untill then people want btk to build, right? ;)

2000-11-04  Havoc Pennington  <hp@pobox.com>

	* btk/btkenums.h: remove trailing comma from BtkDeleteType member
	list

	* docs/Changes-2.0.txt: Add note about
	btk_container_get_toplevels()

	* btk/btktextview.h: formatting
	
	* btk/btktextview.c: don't start descriptions with "Returns",
	confuses btk-doc

Sat Nov  4 10:12:27 2000  Owen Taylor  <otaylor@redhat.com>

	* autogen.sh: When doing sanity checking on ACLOCAL_FLAGS,
	look for bunnylib-2.0.m4 not bunnylib.m4. (Ali Abdin)

2000-11-03  Havoc Pennington  <hp@redhat.com>

	* btk/btktexttagtable.c: Docs
	(btk_text_tag_table_size): return a signed int

	* btk/btktexttag.c: s/tkxt/text/g; write documentation
	(btk_text_tag_event): make the event_object a GObject

	* btk/btktextview.c: Write API docs for all functions.

	* btk/btktextview.h: add BTK_TEXT_WINDOW_PRIVATE as return value
	for btk_text_view_get_window_type() called on one of the private
	windows.

	* btk/btktextview.c: Instead of accessing text_view->buffer
	directly, call get_buffer() which demand-creates a default
	buffer. So btk_text_view_new() can be used to create a view with a
	default buffer in it, if you just want an empty text box users can
	put data in. Useful for GUI builders also.

2000-11-03  Pablo Saratxaga <pablo@mandrakesoft.com>

	* btk/btkrc.zh_TW.*: moved btkrc.zh_TW.Big5 to btkrc.zh_TW.big5;
	the charset encodign portion MUST be in lowercase.
	* btk/btkrc.az: added file for Azeri language

2000-11-03  Havoc Pennington  <hp@redhat.com>

        Get widgets working on the btree/buffer side. Display of them 
	still doesn't work.
	
	* btk/btktextview.c: start implementing child widget stuff

	* btk/btktextiter.c (btk_text_iter_get_child_anchor): new function

	* btk/btktextlayout.c: handle embedded widgets

	* btk/btktextdisplay.c: handle embedded widgets

	* btk/btktextchild.c: Implement all the child anchor goo

	* btk/btktextbuffer.c (btk_text_buffer_create_child_anchor): New
	function

	* btk/btktextbtree.c: Add child anchor table to the btree struct
	(insert_pixbuf_or_widget_segment): abstract out common portions of 
	creating a child anchor or a pixbuf segment.
	(btk_text_btree_create_child_anchor): new function
	(btk_text_btree_unregister_child_anchor): new function

	* btk/btkmarshal.list: added VOID:OBJECT,INT,INT for the
	allocate_child signal on BtkTextLayout

	* btk/btktextiter.c (btk_text_iter_get_pixbuf): fix bogus return
	values
	(btk_text_iter_get_child_anchor): new function

	* btk/btktextbuffer.c (btk_text_buffer_real_changed): Add a
	default handler for the changed signal, which calls
	btk_text_buffer_set_modified(), instead of just always emitting
	changed then calling set_modified() manually. I guess this is
	maybe more flexible. It seems logical.

Fri Nov  3 08:58:38 2000  Tim Janik  <timj@btk.org>

	* btk/btkobject.c: _g_signal_handlers_destroy() is prefixed with '_'
	now.

	* btk/btksignal.c: use g_signal_connect_closure_by_id() now.

Thu Nov  2 14:10:51 2000  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkdnd-x11.c: Fix a bunch of functions that should have
	been marked static.

2000-11-02  Havoc Pennington  <hp@redhat.com>

	* btk/testbtk.c (create_labels): had a test backward

	* bdk/x11/bdkgc-x11.c (bdk_gc_copy): Copy the client-side GC
	fields, so the dest GC ends up with the correct clip origin, 
	etc. Fixes a bug where colored labels didn't redraw 
	properly.

2000-11-02  Alexander Larsson  <alexl@redhat.com>

	* bdk/linux-fb/bdkcolor-fb.c, bdk/linux-fb/bdkdnd-fb.c,
	bdk/linux-fb/bdkgc-fb.c, bdk/linux-fb/bdkbango-fb.c,
	bdk/linux-fb/bdkpixmap-fb.c, bdk/linux-fb/bdkwindow-fb.c:
	Add last argument to t_type_register_static call.
	
	* bdk/linux-fb/bdkdrawable-fb2.c:
	Add last argument to t_type_register_static call.
	export the get_image drawable virtual function.

	* bdk/linux-fb/bdkimage-fb.c:
	Add last argument to t_type_register_static call.
	rename btk_image_get to _bdk_fb_get_image and
	export it for use by bdkdrawable-fb2.

	* bdk/linux-fb/bdkprivate-fb.h:
	export _bdk_fb_get_image.

	* bdk/linux-fb/bdkselection-fb.c:
	Add new api call stubs.

	* btk/Makefile.am:
	Missing ( in linux-fb part.

	* modules/linux-fb/Makefile.am:
	Must link with bdk_pixbuf or get unresolved symbol.

2000-11-01  Havoc Pennington  <hp@pobox.com>

	* btk/btktextbuffer.c (btk_text_buffer_class_init): Use 
	BTK_TYPE_TEXT_ITER and BOXED marshallers

	* btk/btktexttagtable.c (btk_text_tag_table_class_init): ditto

	* btk/btktexttag.c (btk_text_tag_class_init): ditto
	
	* btk/btk-boxed.defs: add BtkTextIter

	* btk/btkmarshal.list: Add marshallers for text widget that 
	properly use OBJECT and BOXED

2000-11-01  Havoc Pennington  <hp@redhat.com>

	* btk/testbtk.c (create_labels): Test set_markup_with_accel()

	* btk/btklabel.c (set_markup): Convert the unichar to a BDK keyval
	before returning it. 
	
2000-11-01  Havoc Pennington  <hp@redhat.com>

	* bdk/bdkpixbuf-render.c (bdk_pixbuf_render_to_drawable_alpha):
	Clip the rectangle to be rendered to the drawable, since
	get_from_drawable() requires a rebunnyion within the drawable

2000-11-01  Havoc Pennington  <hp@redhat.com>

	* btk/btkimage.c (btk_image_expose): Um, don't randomly subtract 4
	from coordinates.

Wed Oct 25 20:10:57 2000  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkevents.c (bdk_event_copy): Only ref the window if
	it isn't NULL.

2000-11-01  Havoc Pennington  <hp@pobox.com>

	* btk/btklabel.c (btk_label_set_attributes): Set a BangoAttrList
	on a label
	(btk_label_finalize): unref the attr list if any.

	* btk/testbtk.c (create_get_image): close test on second click
	(make_message_dialog): close dialog if it exists

	* bdk/bdkbango.c (bdk_draw_layout): Handle rise attribute

	* bdk-2.0.pc.in (Requires): Make it require bdk-pixbuf-2.0 not
	bdk-pixbuf

	* btk/btklabel.c (btk_label_set_markup): new function to set label
	from Bango markup format
	(btk_label_set_markup_with_accel): ditto but with accelerator
	parsing

	* btk/btkimage.c (btk_image_expose): reformatting.

	* bdk/bdkpixbuf-drawable.c (bdk_pixbuf_get_from_drawable): Hack to
	reflect current state of BDK - use bdk_drawable_get_colormap, etc.
	Check BDK_IS_WINDOW() not !BDK_IS_PIXMAP() to decide whether to 
	call bdk_window_get_origin().

	* bdk/bdkpixbuf-render.c (bdk_pixbuf_render_to_drawable_alpha):
	implement BDK_PIXBUF_ALPHA_FULL
	
Wed Nov  1 03:43:42 2000  Tim Janik  <timj@btk.org>

	* btk/btksignal.c (btk_signal_compat_matched): make use of
	g_signal_handlers_block_matched, g_signal_handlers_unblock_matched and
	g_signal_handlers_disconnect_matched to block/unblock and disconnect
	multiple handlers respectively, instead of only treating the
	first handler found (bug reported by owen).

Mon Oct 30 19:23:50 2000  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_expand_row): New function.

	* btk/btktreeview.c (btk_tree_view_collapse_row): New function.

	* btk/btktreeview.c, btk/btktreemodel.c, btk/btktreeselection.c
	btk/btktreestore.h, btk/btktreeview.h, btk/btktreeviewcolumn.c,
	btk/btktreeviewcolumn.h: Fixed inline docs.

	* docs/reference/btk/tree_widget.sgml: Proto intro to the tree
	widget.  Needs writing someday.

	* docs/reference/btk/tmpl/btktree*sgml: Added the tree widget to
	the docs.

2000-10-30  Havoc Pennington  <hp@redhat.com>

	* btk/btktextview.h, btk/btktextview.c:
	Rename delete_at_cursor delete_from_cursor, and 
	move to move_cursor.

2000-10-30  Havoc Pennington  <hp@redhat.com>

	* btktextbtree.c, btktextbtree.h, btktextbuffer.c,
	btktextbuffer.h, btktextchild.c, btktextchild.h,
	btktextchildprivate.h, btktextdisplay.c, btktextdisplay.h,
	btktextiter.c, btktextiter.h, btktextiterprivate.h,
	btktextlayout.c, btktextlayout.h, btktextmark.c, btktextmark.h,
	btktextmarkprivate.h, btktextsegment.c, btktextsegment.h,
	btktexttag.c, btktexttag.h, btktexttagprivate.h,
	btktexttagtable.c, btktexttagtable.h, btktexttypes.c,
	btktexttypes.h, btktextview.c, btktextview.h:

	Massive reindentation and reformatting. Arg alignment and comments
	still need fixing in various places.

2000-10-30  Havoc Pennington  <hp@redhat.com>

	* btk/btktextview.h, btk/btktextview.c: Change run action signals
	to be named insert_at_cursor and delete_at_cursor so C++ can
	handle them.

2000-10-28  Tor Lillqvist  <tml@iki.fi>

	* btk/btkrc.c (btk_rc_append_default_module_path): Make sure not
	to get a double directory separator in case the home directory
	ends with one. This would cause trouble especially on Windows,
	where the path will be confused with the syntax for an an UNC
	(network share) path \\server\share\path.
	(btk_rc_add_initial_default_files): Ditto.

Sat Oct 28 02:33:09 2000  Robert Brady  <robert@suse.co.uk>

	* btk/btkmarshal.list: add new marshallers for BtkTextView.

	* btk/btktextview.c: Use correct marshallers.

Fri Oct 27 17:56:26 2000  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkliststore.c: Not sure how this ever worked.  Fixed it to
	use new iter stuff, and added all the appropriate signals et al.

	* btk/btktreedatalist.h: s/btk/_btk to further reinforce that this
	code is internal to btk only.

2000-10-28  Tor Lillqvist  <tml@iki.fi>

	* btk/btk.def
	* btk/makefile.{mingw,msc}.in: Adjust to Tim's changes. Use
	bunnylib-genmarshal etc.

Fri Oct 27 20:15:00 2000  Tim Janik  <timj@btk.org>

	* btk/Makefile.am: added dependancies for testtextbuffer which broke
	parallel builds.

Fri Oct 27 18:51:44 2000  Tim Janik  <timj@btk.org>

	* btk/btksignal.[hc]: adapt to GSignal signature changes.

2000-10-27  Robert Brady  <robert@suse.co.uk>

	* configure.in (ALL_LINGUAS): Add en@IPA (English, phonetic), 
	en_GB (British), ia (Interlingua).

2000-10-26  Havoc Pennington  <hp@redhat.com>

	* btk/btktextiter.c (my_strrstr): fix constness warning

        Fixed output of:
	nm -g -l .libs/libbtk-x11-1.3.so | grep ' T ' | grep -v btk_ | grep -v BTK_
	
	* btk/btktextsegment.c (char_segment_new): rename
	(_char_segment_new_from_two_strings): rename
	(_toggle_segment_new): rename
	
	* btk/btkclipboard.c (ensure_clipboard_widget): make this static
	(make_clipboard_widget): make it static
	(text_get_func): static
	(text_clear_func): static

	* btk/btkcolorsel.c (adjustment_changed): make this function
	static
	(hex_changed): make it static
	(hsv_changed): make it static
	(opacity_entry_changed): make it static

	* btk/btktextbtree.c (change_node_toggle_count): rename with _btk
	(toggle_segment_check_func): rename with _btk

	* btk/btktextchild.c (_pixbuf_segment_new): rename with _btk
	(_widget_segment_new): rename
	(_widget_segment_add): rename
	(_widget_segment_remove): rename
	(_widget_segment_ref): rename
	(_widget_segment_unref): rename

	* btk/btktextmark.c (_mark_segment_new): Rename
	_btk_mark_segment_new	

2000-10-26  Havoc Pennington  <hp@redhat.com>

	* btk/btkmarshal.list: add new marshallers used by the text widget
	* btk/btktextbuffer.c (btk_text_buffer_class_init): fix marshaller
	types

	* btk/btktexttagtable.c (btk_text_tag_table_class_init): fix
	marshaller types

	* btk/btktextlayout.h, btk/btktextlayout.c, btk/btktextdisplay.h,
	btk/btktextdisplay.c: We need to preserve Tk copyrights and
	license on these files.

	* btk/btktextiter.c (btk_text_iter_backward_search): Make this
	work.

	* btk/btktextbtree.c (btk_text_btree_new): init stamps to 
	runtime random number different for each tree, instead of 
	a constant I made up.

Thu Oct 26 07:36:16 2000  Tim Janik  <timj@btk.org>

	* btk/Makefile.am: buncha cleanups, kludged build sources
	dependencies with a Makefile: oldest-source-stamp dependancy
	for the moment. automake is really fighting us here, with
	intentionally not allowing user-defined rules or dependancies
	prior to it's -include $(DEP_FILES) statement. sucks rocks!

	* btk/Makefile.am: added btktextlayout.h and btktextdisplay.h
	to public headers. tehy have a comment stating that they are
	"semi-public" aren't included by btk.h and if enums popup there,
	they can be /*< skip >*/-ed.

	* btk/btktextlayout.h: 
	* btk/btktextdisplay.h: indentation fixes, comment fixes,
	added LGPL... <SIGH>

Wed Oct 25 20:40:25 2000  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreemodel.h: Got rid of BtkTreeNode, and changed it to
	BtkTreeIter.  Added iterators everywhere.

	* btk/btktreeviewcolumn.c: Changed to use the iterators.

	* btk/btktreeviewselection.c: Changed to use the iterators.

	* btk/btktreestore.c: Changed to use the iterators.

	* btk/btkliststore.c: Commented out the code.  Will convert to
	iterators tomorrow.

	* btk/btkmodelsimple.c: Commented out the code.  Will convert to
	iterators tomorrow.

	* btk/treestoretest.c: Changed to use iterators.

	* demos/testbtk/main.c: Moved to use the new iterator system.

Thu Oct 26 02:10:32 2000  Tim Janik  <timj@btk.org>

	* btk/Makefile.am: invoke maketypes.awk with LC_ALL=C to avoid
	localization misbehaviour.

	* btk/btk-boxed.defs: nuked "boxed" type BtkCTreeNode, since it's
	a useless type without copy/free.

	* btk/btkctree.c (btk_ctree_class_init): use BTK_TYPE_POINTER instead
	of BTK_TYPE_CTREE_NODE.

Thu Oct 26 00:51:52 2000  Tim Janik  <timj@btk.org>

	* btk/btksignal.c:
	(btk_signal_emitv): use g_value_set_static_{string|boxed} where
	applicable.

	* btk/btk-boxed.defs (BtkSelectionData): specify
	btk_selection_data_copy and btk_selection_data_free
	do BtkSelectionData work as params in signals.

Wed Oct 25 20:47:41 2000  Tim Janik  <timj@btk.org>

	* btk/bdk-pixbuf-loader.c (bdk_pixbuf_loader_class_init): urg, removed
	implementation of btk_marshal_VOID__INT_INT_INT_INT. if people do that,
	couldn't they at least give it a non-standard name?
	
	* btk/btktextlayout.c: arg! yet another implementation of
	btk_marshal_VOID__INT_INT_INT_INT(), is this a conspiracy?

	* btk/btktextbuffer.c: gotcha! captured a vagabonding
	btk_marshal_VOID__INT_POINTER_INT() implementation, braught it back
	home. now i know this _is_ a conspiracy.

	* btk/btkwidget.c (btk_widget_class_init): marshaller fixups for
	::state-changed.

	* btk/btkaccelgroup.c (btk_accel_group_create_remove): 
	(btk_accel_group_create_add): marshaller signature fixups.

	* btk/btklistitem.c (btk_list_item_class_init): signal creation fixups,
	pass in BTK_TYPE_SCROLL_TYPE instead of BTK_TYPE_ENUM.

	* btk/btkobject.[hc]: removed BTK_CONNECTED flag, it's not valid
	anymore.

Tue Oct 24 23:59:21 2000  Tim Janik  <timj@btk.org>

	* docs/reference/Makefile.am: disabled SUBDIRS for the moment, since
	due to the signal system changes, it wouldn't build currently. to
	be fixed soon.

	* docs/Changes-2.0.txt: BtkSignal/GSignal updates.

	* btk/btkwidget.c: ::direction_changed takes an enum as argument,
	so it needs btk_marshal_VOID__ENUM() instead of
	btk_marshal_NONE__UINT().

	* bdk/bdk*.c: adapted type registration functions.

	* btk/btkbindings.c:
	* btk/btkaccelgroup.c: operate on GSignalQuery, BtkSignalQuery is
	gone.

	* btk/btkenums.h: define BtkSignalRunType in terms of GSignalType.

	* btk/btkobject.c:
	(btk_object_destroy):
	(btk_object_shutdown): fixed recursion guards. basically we have to
	catch the case where any of GObject.shutdown() or btk_object_destroy()
	is called during ::destroy, and avoid recursion there.

	* btk/btktypeutils.c:
	* btk/maketypes.awk: awk-script hackup to provide btk_type_init() with
	boxed_copy/boxed_free. this needs a more general solution based on a
	publically installed code-generator utility.

	* btk/btktypeutils.[hc]: compat aliased BTK_TYPE_BOXED to G_TYPE_BOXED,
	bunnylib's bobject has support for that now.
	define BtkSignalMarshaller in terms of GSignalCMarshaller.

Mon Oct 23 09:36:42 2000  Tim Janik  <timj@btk.org>

	* btk/btksignal.[hc]:
	* btk/btkmarshal.[hc]:
	* btk/Makefile.am: generate marshallers with bunnylib-genmarshal and don't
	compile btkmarshal.c on its own anymore, just include it in btksignal.c.
	removed #include <btkmarshal.h>s all over the place, btksignal.h takes
	care of that.

	* *.c: marshaller name fixups.

	* btk/btkmarshal.list: added a comment briefing the format.

Sun Oct 22 23:14:39 2000  Tim Janik  <timj@btk.org>

	* btk/btksignal.[hc]: nuked old implementation. we mostly have
	compatibility macros here now. more specifically, most of
	the API is preserved (yes, _most_, nonwithstanding the
	following exceptions listed, the API is stil lHUGE ;)
	things that got removed completely:
	BtkSignalQuery, btk_signal_query(), btk_signal_n_emissions(),
	btk_signal_n_emissions_by_name(), btk_signal_handlers_destroy(),
	btk_signal_set_funcs(), btk_signal_handler_pending_by_id(),
	btk_signal_add_emission_hook(), btk_signal_add_emission_hook_full(),
	btk_signal_remove_emission_hook().
	non-functional functions variants:
	btk_signal_add_emission_hook(), btk_signal_remove_emission_hook().
	the BtkCallbackMarshal argument to btk_signal_connect_full() is
	not supported anymore.
	(btk_signal_compat_matched): new internal function to aid
	implementation of the compatibility macros, it 	provides
	functionality to block/unblock/disconnect handlers based
	on func/data.

	* btk/btkenums.h: define BtkSignalRunType in terms of GSignalType,

	* *.c: adaptions to new type registration API signatures.

Fri Oct 20 15:26:33 2000  Tim Janik  <timj@btk.org>

	* btk/btktypeutils.[hc]: removed G_TYPE_BTK_POINTER cludge.

2000-10-25  Robert Brady  <robert@suse.co.uk>

	* bdk/x11/bdkproperty-x11.c (bdk_property_get, bdk_property_change,
	bdk_property_delete): If window == NULL, assume the root window.
	(restoring the behaviour that was in 1.2).
	
	* btk/testtext.c (save_buffer): Allow creation of new files when
	saving.

	(fill_file_buffer): Don't die if a UTF-8 sequence is split across
	calls to read().

2000-10-25  Tor Lillqvist  <tml@iki.fi>

	* bdk/bdkwindow.c: Include x11/bdkx.h only when building for X11.

	* bdk/win32/bdkdrawable-win32.c
	* bdk/win32/bdkimage-win32.c
	* bdk/win32/bdkprivate-win32.h: Corresponding changes as in the
	X11 backend.

	* bdk/win32/bdkcc-win32.c
	* bdk/win32/bdkcolor-win32.c
	* bdk/win32/bdkfont-win32.c
	* bdk/win32/bdkinput-win32.c
	* bdk/win32/bdkmain-win32.c
	* bdk/win32/bdkproperty-win32.c: Silence gcc -Wall.

2000-10-24  Havoc Pennington  <hp@redhat.com>

	* btk/btktextview.c (btk_text_view_scroll_to_mark_adjusted): make
	it a static function

	* btk/btktextbtree.c (btk_text_btree_tag): Gee, maybe we should
	redraw text when a tag is applied to it.

	* btk/btktexttag.c (btk_text_tag_affects_size)
	(btk_text_tag_affects_nonsize_appearance): private functions to
	see if a tag requires various kinds of redraw/layout to be queued
	up.

	* btk/btktexttag.h (struct _BtkTextTag): Remove relief crackrock

	* btk/testtext.c (fill_example_buffer): Put the cursor 
	at the start of the buffer, so search works by default

	* btk/btktextiter.c (lines_match): init match_start always

	* btk/btktextbuffer.c (btk_text_buffer_get_iter_at_line_index): New
	function, get iter at a line + a byte index

	* btk/btktextiter.c (btk_text_iter_set_line_index): New function,
	to set byte position within a line
	(btk_text_iter_check): remove leftover G_BREAKPOINT thing

2000-10-23  Havoc Pennington  <hp@redhat.com>

        * btk/testtext.c: Re-enable the "find" dialog

	* btk/testbtk.c: Add test for bdk_drawable_get_image
	
	* bdk/bdkwindow.c (bdk_window_begin_paint_rebunnyion): Fix bug where
	the arguments to bdk_draw_drawable were in the wrong order
	(bdk_window_paint_init_bg): This function was ignoring the
	init_rebunnyion, instead of clipping to it, so the entire backing
	pixmap was cleared on every begin_paint()
	(bdk_window_begin_paint_rebunnyion): Hmm, the same list-walking bug
	was in here again, the loop kept using the same BtkWindowPaint
	over and over.
	(bdk_window_begin_paint_rebunnyion): Fix a bug where we had two
	x_offset instead of x_offset and y_offset

	* bdk/bdkdraw.c (bdk_drawable_get_image): get composite drawable
	before we get the image.
	(bdk_draw_drawable): get the composite before we draw the drawable.
	(bdk_drawable_real_get_composite_drawable): default
	get_composite_drawable implementation that returns the drawable 
	itself

	* bdk/bdkdrawable.h (struct _BdkDrawableClass ): Add
	get_composite_drawable virtual function

	* bdk/bdkwindow.c (bdk_window_begin_paint_rebunnyion): Fix a cheesy
	list-walking bug

	* bdk/x11/bdkdrawable-x11.c (bdk_x11_draw_drawable): Add a hack to
	make this work if the source drawable is a BdkDrawableImplX11
	instead of a public drawable type. This is really broken; the
	problem is that BdkDrawable needs a virtual method get_xid(), but
	of course that doesn't work in practice. Enter RTTI.

	Also, improve mismatched depth message.

	* bdk/bdkpixmap.c (bdk_pixmap_get_image): Implement get_image for
	BdkPixmap

	* bdk/x11/bdkdrawable-x11.c (bdk_drawable_impl_x11_class_init):
	install _bdk_x11_get_image as our implementation of get_image
	
	* bdk/x11/bdkimage-x11.c (bdk_image_get): Rename to
	_bdk_x11_get_image and export for use in bdkdrawable-x11.c

	* bdk/bdkimage.c (bdk_image_get): Make this just a wrapper around
	bdk_drawable_get_image

	* bdk/bdkdraw.c (bdk_drawable_get_image): call virtual get_image

	* bdk/bdkdrawable.h (struct _BdkDrawableClass ): Virtualize
	get_image

	* btk/btktreestore.c (btk_tree_store_get_node): remove weird
	trailing semicolon after for loop

Mon Oct 23 12:07:57 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.c (btk_widget_set_style_internal): Fix problem
	where font_desc for widget's context lagged widget's font_desc by
	one step.

2000-10-22  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkgc-win32.c
	* bdk/win32/bdkimage-win32.c: Remove gcc -Wall warnings.

	* btk/makefile.mingw.in
	* btk/btk.def: Updates.

	* btk/testbtk.c: sleep() is called _sleep in MS's C
	library.

	* btk/btkimcontextsimple.c: Include <stdlib.h> for bsearch().

	* btk/makefile.msc: Remove

	* btk/makefile.msc.in: New file, like makefile.mingw.in.

	* btk/Makefile.am: Add it.

	* configure.in: Generate it.

	* btk/btktextbuffer.c (btk_text_buffer_create_child_anchor)
	* btk/btktextbtree.c (btk_text_line_char_to_byte): Return
	something even if not implemented, to satisfy picky MSVC.

	Patches by Hans Breuer:
	
	* bdk/win32/bdkdrawable-win32.c (bdk_win32_draw_glyphs): Call
	SetBkMode() and SetTextAlign() before calling
	bango_win32_render().

	* bdk/win32/bdkgc-win32.c (bdk_win32_gc_values_to_win32values):
	Set hcliprgn to NULL after destroying it.
	(bdk_gc_set_clip_rectangle): Delete hcliprgn and set to NULL.

	* bdk/win32/bdkgeometry-win32.c
	(_bdk_windowing_window_queue_antiexpose): More effective
	implementation.

	* bdk/win32/bdkpixmap-win32.c (bdk_pixmap_new): Use drawable's
	depth as default, not the visual's.

	* bdk/win32/bdkwindow-win32.c (bdk_window_set_title): Guard
	against empty title.

	* bdk/win32/bdkprivate-win32.h: Define a helper macro,
	IMAGE_PRIVATE_DATA.

	* bdk/win32/bdkimage-win32.c: Use it.

2000-10-22  Robert Brady  <robert@suse.co.uk>

	* configure.in: Check for bind_textdomain_codeset

	* btk/btkmain.c (btk_init_check): If bind_textdomain_codeset 
	present, make use of it.

	Add a translatable string "default:LTR" which, if translated
	to "default:RTL", will cause the default direction to be
	Right-to-Left.

	* btk/btkrange.h, btk/btkrange.c: Take into account the widget 
	direction if marked as flippable.

	* btk/btkhscale.c: Mark widget as flippable.
	
2000-10-04  Havoc Pennington  <hp@redhat.com>

	* btk/testbtk.c (create_buttons): create some stock buttons
	with the default accel group
	(create_image): test some new BtkImage features
	(make_message_dialog): test BtkMessageDialog
	(create_modal_window): fix someone's bizzarro indentation

        * btk/btkwindow.h, btk/btkwindow.c: Implement 
	BTK_WIN_POS_CENTER_ON_PARENT. 
	Add "destroy with parent" setting, which means the window goes
	away with its transient parent.
	(btk_window_get_default_accel_group): get the default accel group
	for the window.
	(btk_window_set_destroy_with_parent): set/unset destroy with
	parent flag
	(btk_window_read_rcfiles): invalidate icon set caches
	after reloading rcfiles	

	* btk/btkenums.h (BtkWindowPosition): add
	BTK_WIN_POS_CENTER_ON_PARENT, which centers a dialog 
	on its parent window when the dialog is mapped for the first time.

        * btk/btkmessagedialog.h, btk/btkmessagedialog.c: Add 
	a simple message dialog class
	
	* btk/btkdialog.c (btk_dialog_init): Connect delete event 
	handler to emit response signal, and maybe later it would
	honor a hide_on_delete flag - though that isn't there yet.
	Set border width on the vbox to 2, so we get some padding.	
	Use a button box for the action area.
	(btk_dialog_key_press): synthesize a delete event if Esc
	is pressed and the BtkWidget key press handler didn't 
	handle the escape key.
	(btk_dialog_new_with_buttons): new function creates a dialog
	with some default buttons in it.
	(btk_dialog_add_action_widget): add an activatable widget
	as a button in the dialog - you can also add a non-activatable
	widget by accessing the action area directly.
	(btk_dialog_add_button): add a simple button - stock ID or 
	label - to the action area
	(btk_dialog_response): emit response signal
	(btk_dialog_run): block waiting for the dialog, return 
	the response. Override normal delete_event behavior, so that 
	delete_event does nothing inside btk_dialog_run().
	* btk/btkdialog.h, btk/btkdialog.c: Add "response" signal
	emitted when an action widget is clicked or the dialog gets
	delete_event

	* btk/btk.h: add btkmessagedialog.h

	* btk/Makefile.am: add btkmessagedialog.[hc]

2000-10-18  Havoc Pennington  <hp@redhat.com>

	* btk/btktextiter.c (btk_text_iter_forward_to_newline): Fix a bug 
	where any number of empty lines would get skipped

	* btk/btktextiter.h: Remove padding from BtkTextIter; live on the
	edge.

	* btk/btktextiter.c (btk_text_iter_make_surreal): enhance the
	warning about invalid iterators (explain more thoroughly)
	(btk_text_iter_in_rebunnyion): rename btk_text_iter_in_range

	* btk/btktextview.c (FOCUS_EDGE_WIDTH): Make focus rectangle less
	big

	* demos/*.c: Add error handling

	* btk/btktextbuffer.c: don't modify const iterators

	* btk/bdk-pixbuf-loader.c: Add full error handling here

	* btk/btkimage.c (btk_image_set_from_file): ignore errors
	on file load

	* btk/btkiconfactory.c: Update to reflect addition of error
	handling to bdk-pixbuf loaders

Wed Oct 18 11:14:05 2000  Owen Taylor  <otaylor@redhat.com>	

	* configure.in demos/Makefile.am demos/testbtk/*: Start of work to
	move to new modularized testbtk.

2000-10-17  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c: Draw the arrows correctly.

	* btk/btktreemodel.c: Added user docs.

	* btk/btk.h: remove btktreedatalist.h.

	* btk/btktreestore.c (btk_tree_store_get_type): Get the correct
	parent when generating my type.

	* btk/btkmarshal.list: Added four more marshallers: INT:NONE,
	POINTER:NONE, POINTER:POINTER, and POINTER:POINTER,INT.

2000-10-16  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreemodel.h (struct _BtkTreeModelIface): Move
	BtkTreeModel from object to interface.

2000-10-16  Havoc Pennington  <hp@redhat.com>

	* btk/btktreeviewcolumn.c: #include btklabel.h, fixing 
	compilation

2000-10-16  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeselection.c: Add API documentation to all public
	functions.

	* btk/btktreeviewcolumn.c: Added API documentation to all public
	functions.

2000-10-15  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreeview.c (btk_tree_view_insert_column): New function
	proposed by Guy Harris <gharris@flashcom.net>.  Also, added API
	docs to all public functions.

	* btk/btktreeview.c, btk/btktreeview.h, btk/btktreestore.h,
	btk/btktreestore.c, btk/btkliststore.h, btk/btkliststore.c,
	btk/btkmodelsimple.c, btk/btkmodelsimple.h, btk/btktreedatalist.c,
	btk/btktreemodel.h, btk/btktreeselection.c,
	btk/btktreeselection.h: Fix BtkTreeNode *node ->BtkTreeNode node
	issue.

2000-10-14  Robert Brady  <robert@suse.co.uk>

	* configure.in: Added "fa" (Persian) to ALL_LINGUAS.

2000-10-12  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktreedatalist.[ch] (btk_tree_data_list_value_to_node): Added
	values other then G_TYPE_STRING.
	* btk/btktreeselection.c: Minor commenting updates.
	* btk/btktreeview.c: Format updates.

2000-10-09  Tor Lillqvist  <tml@iki.fi>

	* README.win32: Update.

	* bdk/win32/bdkgeometry-win32.c (bdk_window_clip_changed): Add two
	lines that had been deleted by mistake (?).

	* bdk/win32/bdkcursor-win32.c (bdk_cursor_new_from_pixmap): Handle
	also the case fg==white and bg==black (but still not randomly
	coloured cursors). Thanks to Wolfgang Sourdeau.

	* bdk/win32/*.c: Silence gcc -Wall.

	* btk/btk.def: Add missing entry points.

	Fixes by Hans Breuer:

	* bdk/makefile.msc
	* bdk/win32/makefile.msc: Update.

	* bdk/testbdk.c: If compiling with debugging (with _DEBUG defined,
	some MSVC thing, presumably), cause breakpoint on failures. Add
	BDK_NOR case. Call g_log_set_always_fatal.

	* bdk/win32/bdkwin32id.c (bdk_win32_handle_table_insert): Handle
	should be pased by reference.
	
	* bdk/win32/bdkprivate-win32.h: Correct declaration accordingly.
	
	* bdk/win32/*.c: Correct calls to bdk_win32_handle_table_insert.

	* bdk/win32/bdkevents-win32.c
	* bdk/win32/bdkwindow-win32.c: Handle WM_CREATE.

	* bdk/win32/bdkgc-win32.c: Fix mixups of drawable and
	implementation object.

	* bdk/win32/bdkimage-win32.c (bdk_image_get): Handle drawables,
	not just windows.
	
	* bdk/win32/bdkpixmap-win32.c (bdk_pixmap_impl_win32_finalize):
	Use the wrapper object.
	
2000-10-06  Havoc Pennington  <hp@redhat.com>

	* Makefile.am (SRC_SUBDIRS): contrib subdir

	* bdk/bdkpixbuf.h: Move BdkPixbufAlphaMode to bdk-pixbuf library,
	so it can be used in Xlib version

	* demos/testpixbuf.c (update_timeout): error checking from 1.0
	tree

	* btk/bdk-pixbuf-loader.c (bdk_pixbuf_loader_get_pixbuf): Sync
	change from 1.0 tree that returns first frame of animation
	if the loaded file is an animation.

        * contrib: add new directory to hold stuff that comes with BTK+
	but isn't really part of BTK+ (for now, bdk-pixbuf-xlib)
	
	* configure.in: add contrib/*

2000-10-05  Havoc Pennington  <hp@redhat.com>

        * demos/testpixbuf-save.c: add pixbuf save test

	* demos/Makefile.am: add testpixbuf-save.c

2000-10-05  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktree.h (BTK_TREE_SELECTION): Replaced with
	BTK_TREE_SELECTION_OLD to prevent conflict with btktreeselection.c
	* btk/testbtk.c: s/BTK_TREE_SELECTION/BTK_TREE_SELECTION_OLD/
	* btk/btktreeselection.[ch]: Replaced
	"node_selected"/"node_unselected" signal with "selection_changed"
	signal.

2000-10-04  Jonathan Blandford  <jrb@redhat.com>

	* btk/btk{tree,cell}?*.[ch]: Checked in initial draft of the new
	tree widget.

2000-10-04  Jonathan Blandford  <jrb@redhat.com>

	* bdk/bdkwindow.c (bdk_window_draw_arc): Fix obvious bug in circle
	drawing.

Wed Oct  4 15:52:15 2000 Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkselection-x11.c (_bdk_selection_window_destroyed):
	Move list pointer forwards before removing item from
	list. (Crash reported by Salmaso Raffaele)

	* bdk/bdkwindow.h: Remove spurious trailing ,

	* bdk/Makefile.am (LDFLAGS): You can't do interlibrary
	dependencies on uninstalled libraries, sorry folks.

2000-10-04  Havoc Pennington  <hp@redhat.com>

	* btk/btkstock.h, btk/btkstock.c, btk/btkiconfactory.h,
	btk/btkiconfactory.c: Fix copyrights	

	* demos/testpixbuf.c: add inline pixbuf test
	
Mon Sep 25 15:05:17 2000  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkwindow.h bdk/x11/bdkwindow-x11.c (bdk_window_iconify):
	Add bdk_window_iconify.

	* bdk/bdkwindow.h bdk/x11/bdkwindow-x11.c
	(bdk_window_set_geometry_hints): Add win_gravity
	to geometry structure.

	* bdk/x11/bdkevents-x11.c (bdk_wm_protocols_filter):
	Implement _NET_WM_PING.

	* bdk/x11/bdkmain-x11.c (_bdk_windowing_init_check):
	Set _NET_WM_PID on the client leader.

	* bdk/x11/bdkwindow-x11.c (bdk_window_set_icon_name):
	Handle UTF-8 better.

	* bdk/x11/bdkwindow-x11.c (bdk_window_set_title): Handle
	UTF-8 better, set _NET_WM_NAME as well. Only set
	icon name if it hasn't previously been explicitely 
	set.

2000-10-03  Havoc Pennington  <hp@redhat.com>

	* btk/testtextbuffer.c: clean up trailing whitespace,
	add extensive tests for tag toggle iteration.
	
	* btk/btktextiter.c (MAX_LINEAR_SCAN): decrease linear scan 
	distance

	* btk/btktextbtree.c (btk_text_line_next_could_contain_tag):
	optimize case where the tag root is on level 1
	(btk_text_line_previous_could_contain_tag): attempt to implement
	(btk_text_line_next_could_contain_tag): Abstract out node_compare
	functionality

	* btk/btktextiter.c (btk_text_iter_backward_to_tag_toggle):
	Implement this, though not very efficiently.

	* btk/btktextiterprivate.h: reformat

	* btk/btktextiter.c (btk_text_iter_get_char): return 0 on the end
	iterator

	* btk/btktextbuffer.c (btk_text_buffer_delete_interactive): Fix
	this to properly revalidate the iterators.

	* btk/btktextview.c (btk_text_view_delete): fix control-K to work
	properly at the end of the line (and therefore on empty lines)

	* btk/btktextbtree.c (btk_text_btree_get_selection_bounds): Gee,
	maybe we should return a value...

2000-10-03  Tor Lillqvist  <tml@iki.fi>

	* config.h.win32: Guard definition of alloca(). bunnylib.h now handles
	that.

	* bdk/bdk.def
	* btk/btk.def: Add new entry points.

	Changes just to make BTK+ build without errors on Win32. No hope
	of it working in its current state, though...:
	
	* bdk/win32/bdkselection-win32.c: Remove gcc -Wall warnings.  Add
	some functions from the X11 backend, just to make BTK+ build.

	* bdk/makefile.mingw.in
	* btk/makefile.mingw.in: Use correct bdk_pixbuf version
	number. Add new object files.

	* btk/btkclipboard.c: Include bdkwin32.h on Win32. Use
	GetMessageTime to get timestamp (where on X11 uses
	bdk_x11_get_server_time()).

2000-10-02  Havoc Pennington  <hp@pobox.com>

	* btk/btktextview.c: text_window_* weren't static and should have
	been.
	Start work on child widgets; not yet complete, syncing to 
	office computer.

	* btk/btktextchild.h: change this to contain a public interface,
	starting work on child interfaces.
	* btk/btktextchildprivate.h: move private interfaces here

	* btk/Makefile.am: update to reflect btktextchildprivate.h

	* btk/btktextview.h, btk/btktextview.c, btk/btktextbuffer.h,
	btk/btktextbuffer.c, btk/btktextiter.h, btk/btk/textiter.c, 
	btk/btktextmark.c: copyright notices

	* btk/btktextmarkprivate.h: reformat, and put _ in front of
	internal functions	

	* btk/btktextchild.c (_pixbuf_segment_new): put _ in front of
	internal function

	* btk/btktextlayout.c (btk_text_layout_get_line_display):
	Reformatting	

2000-09-30  Havoc Pennington  <hp@pobox.com>

	* btk/btktextbtree.c (btk_text_btree_get_selection_bounds): Handle
	NULL start/end pointers

	* btk/btktextbuffer.c: Write some docs
	(btk_text_buffer_get_selection_bounds): Allow start/end to be
	NULL, so you can just check whether there's a selection.	

	* btk/btktextbtree.c (btk_text_btree_remove_mark): No need to 
	cleanup_line or segments_changed ourselves, it gets done 
	in unlink_segment

	* btk/btktextmark.h:
	s/btk_text_mark_deleted/btk_text_mark_get_deleted/
	
	* btk/btktextsegment.h: Clean up some indentation and naming mess

	* btk/btktextmark.c: delete some more old Tk cruft

	* btk/btktextbuffer.c (btk_text_buffer_delete_mark): add ref to
	mark before removing it, so we can emit MARK_DELETED with a valid
	pointer.
	(btk_text_buffer_mark_set): hold ref across signal emission

	* btk/btktextbtree.c (btk_text_btree_remove_mark): improve
	whining about attempts to delete special marks

	* btk/btktextbuffer.c (_btk_text_buffer_spew): Prepend with
	underscore, since it's internal.

	* btk/btktextbuffer.h: Remove find_string prototype, this is 
	now implemented in terms of iterators in btktextiter.h

	* btk/btktextbuffer.c (btk_text_buffer_set_text): 
	New function, destructively sets contents of buffer. Also 
	a convenient way to clear the buffer by setting text to ""

	* btk/btktextiter.c (btk_text_iter_make_surreal): reformat
	multiline string literal

	* btk/testtext.c (text_changed_callback): Redraw line numbers if
	text changes.

	* btk/btktextiter.c (forward_char): Return FALSE if new location 
	is not dereferenceable
	(btk_text_iter_forward_lines): fix return value

2000-09-29  Havoc Pennington  <hp@redhat.com>

	* btk/btktexttag.c (btk_text_tag_set_priority): fix indentation

        * btk/btktextview.c: Implement drag thresholding; change functions 
	that set border window size to have nicer name
	(btk_text_view_mark_set_handler):  Fix this to have the 
	right signature.

	* btk/testtextbuffer.c (fill_buffer): Update with pixbuf changes

	* btk/testtext.c: Update with API changes, put line numbers on 
	both sides.
	
	* btk/btktextiter.c (btk_text_iter_get_pixbuf): Replace get_pixmap
	with this

	* btk/btktextchild.h, btk/btktextchild.c: replace all pixmap with
	pixbuf; delete a big block of #if 0 Tk code

	* btk/btktextbuffer.c (btk_text_buffer_insert_pixbuf): Replace 
	insert_pixmap with insert_pixbuf

2000-09-29  Martin Baulig  <baulig@suse.de>

	* bdk-pixbuf.pc.in: Renamed to gdb-pixbuf-2.0.pc.in to avoid
	confusion with the BdkPixbuf of the BUNNY 1.x platform.

2000-09-29  Havoc Pennington  <hp@pobox.com>

	* btk/btktextview.c: Implement the side windows.

	* btk/testtext.c: Implement simple line numbering in the 
	left side window; seems to make scrolling sloooow. Oops.
	Also, cursor blink is for some reason causing redraws
	of the line numbers. Should investigate...

2000-09-28  Havoc Pennington  <hp@redhat.com>

	* btk/btktextview.c: Set up infrastructure to deal with lots of 
	scrolling child windows, and draw focus rectangle properly.
	
	(btk_text_view_buffer_to_window_coords):
	Coordinate transformation to deal with all these freaking windows
	and offsets
	(btk_text_view_window_to_buffer_coords): transform the other way

	* btk/testtext.c (create_buffer): Update to match Bango API change

	* btk/btktexttagtable.c (btk_text_tag_table_foreach): Go over the
	anonymous tags
	(foreach_unref): don't emit remove signal from finalize, just
	set tag's parent to NULL

2000-09-26  Havoc Pennington  <hp@redhat.com>

        * btk/btkiconfactory.c (btk_icon_set_clear): remove
	Fix some warnings	

2000-09-26  Havoc Pennington  <hp@redhat.com>

	* btk/Makefile.am (btk_private_h_sources): Move more text widget
	headers	into the private header list

	* Makefile.am (pkgconfig_DATA): install pkg-config files

	* configure.in: add pkg-config files

	* bdk-2.0.pc.in, bdk-pixbuf.pc.in, btk+-2.0.pc.in: pkg-config files

	* btk/btkwindow.c (btk_window_read_rcfiles): Invalidate
	outstanding icon caches on theme change.

	* btk/btkiconfactory.h, btk/btkiconfactory.c: New icon system. Three 
	important types:

	(BtkIconSource): Specification for creating a pixbuf 
	appropriate for a direction/state/size triplet from 
	a source pixbuf or filename

	(BtkIconSet): List of BtkIconSource objects that are used to
	create the "same" icon (e.g. an OK button icon), and cache for
	rendered icons

	(BtkIconFactory): Hash from stock ID to BtkIconSet; used to look
	up the icon set for a given stock ID.  BTK maintains a stack of
	BtkIconFactory to search, and applications or libraries can add
	additional icon factories on top of the stack
	
        * btk/btkrc.h, btk/btkrc.c: When loading an RcStyle, parse 
	the set of BtkIconSource specified for a given stock ID into 
	a BtkIconSet, and put the BtkIconSet into a BtkIconFactory for the 
	RcStyle, under the specified stock ID.

	* btk/btkstyle.h, btk/btkstyle.c: Add a virtual function
	render_icon used to derive a BdkPixbuf from a BtkIconSource.
	This allows people to theme how prelight, insensitive, etc. are
	done.

	(btk_style_lookup_icon_set): Look up a stock ID in the list of
	icon factories for a style, and return the resulting 
	icon set if any.

	(btk_style_render_icon): Render an icon using the render_icon 
	method in the BtkStyleClass.

	* btk/btkwidget.h, btk/btkwidget.c (btk_widget_render_icon): 
	Use the style for a given widget to look up a stock ID, get the
	icon set, and render an icon using the render_icon method 
	of the style

	* btk/btkstock.h, btk/btkstock.c: Header with the BtkStockItem type
	(contains information about a stock item), the built-in stock item
	IDs, and functions to add/lookup stock items.

	* btk/stock-icons/*: Stock icons that come with BTK

	* btk/btkbutton.h, btk/btkbutton.c (btk_button_new_stock): Returns
	a button based on a BtkStockItem
	(btk_button_new_accel): Takes a uline string and accel group, and
	installs the accelerator.

	* btk/btkimage.h, btk/btkimage.c: Make this into a generic
	image-display widget.

2000-09-25  Havoc Pennington  <hp@redhat.com>

	* btk/btktexttypes.c: Remove Latin1 conversion stuff

	* btk/btktextbtree.c (btk_text_btree_node_remove_data): 
	Fix a bug when removing node data, we didn't properly 
	re-splice the linked list after removing the data.

	* btk/btktextview.c (btk_text_view_key_press_event): Pass through 
	BDK_Tab as literal tab, Ctrl-Tab to tab to focus widget

	* btk/btktextbuffer.c (selection_received): fix g_convert usage

	* btk/btktextlayout.c (set_para_values): Set tab array 
	for the layout from the BtkTextTag.

	* btk/btktexttypes.h: delete tab and search cruft, 
	remove g_convert() in favor of GLib version

	* btk/btktexttypes.c: remove tab implementation from here,
	move to Bango

	* btk/btktexttag.h, btk/btktexttag.c: Implement 
	tab stuff using new BangoTabArray from Bango

	* btk/btktexttag.c (btk_text_attributes_fill_from_tags): Remove
	unused border_width stuff

Thu Sep 14 12:21:12 2000  Owen Taylor  <otaylor@redhat.com>

        * btk/btktexttypes.[ch]: Remove g_convert (moved to
	bunnylib) and now useless utf_to_latin1() latin1_to_utf()

	* btk/btktextview.[ch]: Change ::move_insert and
	::delete_text action signals to ::move and ::delete;
	create the signals with the right enumeration type,
	not BTK_TYPE_ENUM so that bindings work. Add C-d, M-d,
	C-v bindings, change Home, End to move to beginning/end
	of line, Add C-Home C-End to move to beginning/end
	of buffer. Change ::cut_text to ::cut_clipboard, etc;
	combine ::scroll_text into ::move; use new BtkSelectionData
	functions to simplify DND text handling.
	
	* btk/btkenums.h btk/btktextview.h: Move movement,
	deletion enumerations here, rename enumeration values to 
	be consistently plural.

	* btk/btktextbuffer.c: Use new clipboard interfaces
	for cut/copy/paste and primary selection.

	* btk/btktextbuffer.[ch]: Remove excess time and
	'interactive' arguments from cut/copy/paste;
	rename cut to cut_clipboard, etc; remove
	btk_text_buffer_get_clipboard_contents().

	* btk/btktextlayout.[ch]: Add 
	btk_text_layout_move_iter_to_line_end() to move	the iter to 
	line ends.

	* btk/btkselection.[ch] (btk_selection_data_set/get_text):
	Functions to set or get a UTF-8 string on the selection
	data.

	* btk/btkclipboard.[ch]: New, simplified selection handling
	interfaces.

	* btk/btkinvisible.c (btk_invisible_new): Realize newly
	created widgets - one of these is useless if we don't.

	* btk/btkselection.[ch] (btk_selection_clear_targets): Export
	a public function clear all targets registered for the
	widget.

	* btk/btkselection.c (btk_selection_owner_set) docs/Changes-2.0.txt:
	Never call btk_widget_realize() - that was just asking
	for bizarre side-effects.

	* btk/btkselection.c (btk_selection_owner_set): Call
	bdk_selection_owner_set even if the widget is the
	same so that we reliably update the timestamp on
	the server.

	* bdk/x11/bdkevents-x11.c bdk/x11/bdkx.h: Add a 
	bdk_x11_get_server_time() function.
	
	* bdk/x11/bdkevents-x11.c bdk/x11/bdkprivate-x11.h
	bdk/x11/bdkselection-x11.c bdk/x11/bdkwindow-x11.h:
	Add some tricky filtering on serial numbers for
	selection clear events to fix up long-standard
	race condition FIXME's in btkselection.c.

	* bdk/bdkproperty.h bdk/x11/bdkselection-x11.h: Add
	routines to convert from utf8 to compound text or
	STRING and from a text property to UTF-8.

	* btk/btkmain.[ch] (btk_get_current_event_time): Add 
	a convenience function bdk_get_current_event_time().

	* btk/btkselection.c (btk_selection_data_copy/free): Copy
	and free selection_data->data properly

Sat Sep  9 10:23:53 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkthemes.c: Remove some unecessary includes.

2000-09-08  Jonathan Blandford  <jrb@redhat.com>

	* btk/btktextdisplay.c
	* btk/btktextlayout.c
	* btk/btktexttag.c
	* btk/btktexttag.h
	* btk/testtext.c: Change the overstrike property to strikethrough,
	to closer match bango.

Fri Sep  8 14:28:00 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btktextview.c: Fix up visibility so that focus,
	cursor_visible and blink interact properly.  Reenable cursor blink
	which had been roughly disabled. Make blink and focus
	properly per-view.

	* btk/btktextlayout.[ch] (btk_text_layout_set_cursor_visible):
	Add a flag for whether to display insertion cursor and
	a function to set the flag.

	* btk/btktextlayout.c (btk_text_layout_get_line_yrange): Change
	get_line_y() to get_line_yrange(), to be a bit more generally
	useful.

Thu Sep 07 20:54:33 2000  George Lebl <jirka@5z.com>

	* btk/btkmenu.c:  in btk_menu_set_submenu_navigation_rebunnyion
	  do stop_navigating_submenu, to clear last timeout properly.
	  Also in btk_menu_motion_notify move ignore_enter above
	  the conditional to make it always happen as suggested by Owen

2000-09-07  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/makefile.mingw.in: Use -Wall. Add bdkbango-win32.o

	* bdk/win32/bdkwin32.h: Add more definitions missing from the free
	w32api headers.

	* bdk/win32/bdkprivate-win32.h: Add a couple of missing
	declarations.

	* bdk/win32/bdkdrawable-win32.c: Remove gcc -Wall warnings.
	(bdk_win32_get_colormap): A line had been deleted by mistake.

	* bdk/win32/bdkevents-win32.c: Remove lint (gcc -Wall) here, too.
	(bdk_event_translate): Handle more virtual keycodes to be able to
	generate BDK events for Control-comma, Control-period, etc.

	* btk/btk.def: Add some missing entry points.

Thu Sep  7 11:47:02 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btktextbuffer.c btk/btkimcontext.c btk/btkwidget.c:
	Doc comment fixing. (Mostly non-matching parameter names.)

	* btk/btkcalendar.c btk/btklist.c btk/btknotebook.c: Modify
	comments a little to avoid looking like a doc comment.

	* btk/btkspinbutton.h (BTK_INPUT_ERROR): Change INPUT_ERROR to
	BTK_INPUT_ERROR. (Should the mechanism for erros in spin button
	conversions be changed to GError?)

	* btk/btkcolorsel.c (BTK_CUSTOM_PALETTE_WIDTH/HEIGHT): 
	Move private #defines into .c file.

	* btk/btktexttag.c (btk_text_tag_class_init): Alphabetize
	order of argument addition, remove duplicates.

	* btk/btkaspectframe.h (struct _BtkAspectFrameClass):
	parent class is FrameClass, not BinClass.

	* btk/btk.h: Add btkinvisible, which was missing.
	(It's occasionalyl useful for client apps, if seldom.)

	* bdk/bdktypes.h: Remove obsolete BDK_CORE_POINTER
	#define.

Wed Sep  6 09:53:15 2000  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkwindow-x11.c (bdk_window_new): Use X-space
	coordinates when creating window, instead of BDK-space
	coordinates. (Avoid BadValue on too large windows.)

2000-09-05  Sebastian Wilhelmi  <wilhelmi@ira.uka.de>

	* configure.in (use_mmx_asm): Remove conftest* after use along the
	lines of AC_TRY_COMPILE.	
	
	* btk/btkrc.c (btk_rc_parse_file): Use g_path_get_dirname instead
	of g_dirname, which is deprecated.
	(btk_rc_parse_any): Removed calls to
	g_scanner_{freeze,thaw}_symbol_table, which are deprecated.

	* btk/btkbindings.c (binding_entry_new, binding_entry_destroy):
	Removed calls to g_hash_table_{freeze,thaw}, as they are
	deprecated now.

	* btk/testtext.c (buffer_pretty_name): Use g_path_get_basename
	instead of g_basename.
	
2000-09-04 Elliot Lee <sopwith@redhat.com>
	
	* bdk/bdkpixbuf.h: Put text after #endif inside a comment to avoid
	ANSI warning.

Sun Sep 03 00:47:08 2000  George Lebl <jirka@5z.com>

	* btk/btkwidget.h:  Add some documenting comments about 
	  BTK_CAN_DEFAULT, BTK_HAS_DEFAULT and BTK_RECEIVES_DEFAULT
	  just as owen said on irc.

	* btk/btkwindow.c (btk_window_set_default):  Don't blindly
	  set HAS_DEFAULT.  Only set it if there isn't another window
	  holding it (a focus window which RECEIVES_DEFAULT) and only unset
	  it if the widget is not the focused window with RECEIVES_DEFAULT.
	  This fixes weird double default bugs in dialogs which has things
	  call btk_window_set_default at times.

Fri Sep  1 22:39:07 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmenu.[ch] TODO.xml: Apply patch from
	Nils Barth and David Santiago to improve submenu
	navigation. The patch does this by creating a triangular
	rebunnyion from the point where the pointer leaves the
	menu to the submenu.  While the pointer is in
	that rebunnyion and a timeout has not expired, events 
	that would cause the active submenu to change are
	ignored.

Fri Sep  1 15:34:46 2000  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkwindow-x11.c (bdk_window_move): Fix bug where
	moving a toplevel window immediately after sizing it would
	result in it being sized back to the old size since 
	impl->width, impl->height aren't updated until we hear
	back from the server. There is still a (longstanding) bug
	here that bdk_window_get_size() will give the wrong size
	until we do hear back.

2000-08-31  Havoc Pennington  <hp@redhat.com>

	* btk/btktextiter.h, btk/btktextiter.c, btk/btktextlayout.h, 
	btk/btktextlayout.c, btk/btktexttag.h, btk/btktexttag.c, 
	btk/btktexttagprivate.h, btk/btktextview.c:
	Rename BtkTextStyleValues to BtkTextAttributes

2000-08-31  Havoc Pennington  <hp@pobox.com>

	* btk/btktextbtree.c (BtkTextBTree): cache end line, 
	for rapid testing whether an iterator is the end iterator
	(btk_text_btree_new): init end line cache
	(btk_text_line_is_last): use fast cached line to 
	see if we're the last line.
	(get_last_line): use cached line here too, should 
	speed up some random unrelated code.
	
2000-08-30  Havoc Pennington  <hp@pobox.com>

	* btk/btkmarshal.list: Add marshallers for changed BtkTextBuffer
	signals.

	* btk/btktextbuffer.h: Add "interactive" arg to insert_text and
	delete_text signals. This allows the signals to be used for
	implementing undo.

	* btk/btktextbuffer.c: Change signal handler signatures; 
	provide "interactive" argument when emitting insert_text or
	delete_text signal.
	
2000-08-30  Havoc Pennington  <hp@pobox.com>

	* btk/btktextbuffer.c: Docs

Fri Aug 25 12:16:15 2000  Owen Taylor  <otaylor@redhat.com>

        * bdk/x11/bdkimage-x11.c: remove BDK_IMAGE_SHARED_PIXMAP
	from switch statements, since Tor removed the enumeration
	value.
	
	* bdk/x11/bdkimage-x11.c (bdk_image_get): 
	s/BDK_IS_WINDOW/BDK_IS_DRAWABLE/.

2000-08-29 Elliot Lee <sopwith@redhat.com>
	* */*.h: Use B_GNUC_CONST.

2000-08-27  Havoc Pennington  <hp@pobox.com>

	* btk/btktextiter.c, btk/btktextiter.h: wrote lots of API docs,
	minor indentation fixes, inserted some FIXME about stuff I
	realized was broken while documenting it.
	(btk_text_iter_get_pixmap): allow out params to be NULL, following
	BTK convention	

Tue Aug 22 12:33:24 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/testbtk.c (create_styles): Fix double free of
	font desc.

Mon Aug 21 22:39:18 2000  Owen Taylor  <otaylor@redhat.com>

        * btk/btkwidget.[ch]: Add btk_widget_modify_{fg,bg,text,base,font}.
	
	* btk/testbtk.c (create_styles): Add a test for modifying
	the style through btk_widget_modify_*.

	* btk/btkwidget.c (btk_widget_get_modifier_style): Add
	a function to get the current modifier style.

	* btk/btkwidget.c (btk_widget_modify_style): Make a copy
	of the passed in BtkRcStyle instead of ref'ing it.

	* btk/btkrc.[ch]: Add btk_rc_style_copy().

2000-08-20  Tor Lillqvist  <tml@iki.fi>

	* bdk/bdkimage.h
	* bdk/win32/bdkimage-win32.c: No need any longer on Win32 for the
	shared memory image+pixmap BdkImage type, or
	bdk_image_bitmap_new(). They were used in the bdk_imlib port, but
	I am dropping that.

	* btk/btkmain.h: On Win32, use a #define to map btk_init() to
	actually call btk_init_abi_check(), passing also
	sizeof(BtkWindow). Ditto for btk_init_check(). 

	* btk/btk.def
	* btk/btkmain.c: (btk_init_abi_check, btk_init_check_abi_check):
	New functions, used to check that the BTK+-using code has been
	compiled using the correct compiler and switches. In particular,
	with gcc one has to use the -fnative-struct switch as BTK+ is
	compiled with that.

Fri Aug 18 17:27:46 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkclist.c (btk_clist_merge): Don't leave dangling
	->prev fields when merging lists. (Found simultaneously
	by Pawel Salek and Jakub Jelinek)

2000-08-12  Tor Lillqvist  <tml@iki.fi>

	* bdk/bdk.def
	* btk/btk.def: Add missing entries.

	* bdk/win32/bdkfont-win32.c (bdk_font_load_internal): Use
	OUT_TT_ONLY_PRECIS, try to get a TrueType font.

	* bdk/win32/bdkinput-win32.c (bdk_device_get_state): New
	function. Dummy implementation at this point.

	* btk/makefile.mingw.in: Fix typo. Add testtext and testtextbuffer
	rules. Undefine BTK_COMPILATION when compiling the test programs.
	
	* btk/btkdebug.h: Mark btk_debug_flags for export/import.

2000-08-11  Tor Lillqvist  <tml@iki.fi>

	* btk/btkfilesel.c: Add more calls to g_filename_{to,from}_utf8()
	to convert back and forth from UTF-8 and the "system" (or "current
	locale") charset when necessary. Indentation/spacing cleanup.

2000-08-10  Havoc Pennington  <hp@redhat.com>

	* Makefile.am (snapshot): Change the format of the snapshot
	version to match bunnylib

	* bdk/win32/Makefile.am (EXTRA_DIST): remove bdkinputprivate.h
	from EXTRA_DIST since it doesn't seem to exist

2000-08-10  Tor Lillqvist  <tml@iki.fi>

	* btk/btkfilesel.c (open_new_dir): Use the "system codepage"
	version of the directory name (not the UTF-8 one) when building
	the path name to stat().

2000-08-03  Elliot Lee  <sopwith@redhat.com>

	* bdk/bdkbango.c (bdk_draw_layout_line): Don't shape runs with a
	BANGO_ATTR_SHAPE set.

Thu Aug  3 09:17:06 2000  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkrectangle.c (bdk_rectangle_intersect): Applied patch from
	Peter Osterlund to simplify the code while keeping the
	functionality the same.

Wed Aug  2 14:57:38 2000  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkwindow.c (bdk_window_process_updates_internal): Move
	is_viewable() test further inside the function, since removing the 
	window from the redraw list without clearing ->update_area
	was also very broken.

2000-08-02  Tor Lillqvist  <tml@iki.fi>

	* configure.in: Check for <unistd.h>.

2000-08-01  Martin Baulig  <baulig@suse.de>

	* btk/btkmain.c (btk_init_check): Use g_message() and not g_warning()
	to display the message that this is a development version of BTK+.

Mon Jul 31 18:37:36 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkentry.c (entry_adjust_scroll): Fix problem where computation
	was depending on widget->allocation instead of the width of text_area,
	which was incorrect for subclasses like BtkSpinButton.

	* bdk/bdkbango.c (bdk_draw_layout): Fix a couple of typos
	with width == 1 tests that should be width == -1.

Mon Jul 31 16:45:48 2000  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkwindow.c (bdk_window_process_updates_internal): Replace broken, 
	(broken, Elliot, every single window blank on X) custom code with call
	to bdk_window_is_viewable() which a) prevents code duplicate and
	b) works. 

2000-07-31  Elliot Lee  <sopwith@redhat.com>

	* btk/btkcolorsel.c: We really do need to include bdkfb.h in order
	to get the BDK_PARENT_ROOT() macro to work.
	* btk/btkmarshal.list: Add NONE:STRING,POINTER
	* bdk/bdkwindow.c: Don't send expose events, or invalidate pieces
	of, windows that aren't shown.
	* bdk/linux-fb: Redraw-when-menu-hidden solved, plus a bunch of
	pointer grab stuff.

Mon Jul 31 13:53:16 BST 2000  Tony Gale <gale@btk.org>

        * docs/btkfaq.sgml docs/btk-faq.sgml:
	  s/btk_main_iteration/g_main_iteration/

	  Did this already in change:
		Mon Nov 15 17:17:51 GMT 1999 Tony Gale  <gale@btk.org>
	  don't know how it got reverted.

2000-07-31  Stanislav Brabec  <utx@penguin.cz>

	* bdk/bdk.c: #ifdef G_ENABLE_DEBUG around bdk_arg_debug_cb and
	bdk_arg_no_debug_cb to fix compilation problem with --disable-debug.

	* bdk/Makefile.am: Link bdk against actually compiled bdk_pixbuf-1.3,
	not bdk_pixbuf.

2000-07-30  Pablo Saratxaga <pablo@mandrakesoft.com>

	* configure.in,po/{sp,sr}.po: Added Serbian files

2000-07-30  Tor Lillqvist  <tml@iki.fi>

	* bdk/Makefile.am: Add makefile.mingw.in to EXTRA_DIST.

	* bdk/win32/bdkevents-win32.c (bdk_events_init, bdk_events_queue):
	Remove the g_pipe_readable_msg stuff. Not needed with new GLib
	BUNNYIOChannel implementation.

	* bdk/win32/bdkinput.c
	* bdk/win32/bdkbango-win32.c: Update license name here, too.

	* bdk/win32/bdkwin32id.c (bdk_win32_handle_table_lookup): Fix
	definition to match prototype.

	* btk/makefile.mingw.in: Add libiconv CFLAGS and LIBS.

2000-07-27  Elliot Lee  <sopwith@redhat.com>

	* btk/bdk-pixbuf-loader.[ch]: Add bdk_pixbuf_loader_new_with_type
	function, to allow handling image formats that cannot be detected
	by looking at content alone.

Thu Jul 27 13:13:21 BST 2000  Tony Gale <gale@btk.org>

	* docs/tutorial/*.gif *.jpg *.eps
	  Update these to the same look-n-feel.
	  Why does including images in DocBook suck so badly?

Thu Jul 27 05:06:29 2000  Tim Janik  <timj@btk.org>

        * btk/btktable.c: applied patch from Phil Thompson
        <phil@river-bank.demon.co.uk> that enables space settings for
        the last row/columns as well.

Wed Jul 26 12:59:31 2000  Tim Janik  <timj@btk.org>

        * *.[hc]: applied patch from Andreas Persenius <ndap@swipnet.se> that
        updates the license headers to the GNU Lesser General Public License,
        as well as updating the copyright year to 2000.

2000-07-26  Robert Brady  <rwb197@zepler.org>

	* configure.in: Cause GETTEXT_PACKAGE to be consistent in config.h
	  and po/Makefile, was installing and looking for them under btk20
	  and btk2 respectively.

2000-07-25  Havoc Pennington  <hp@redhat.com>

	* btk/testtext.c: Comment out some stuff that depends on the rest
	of my patches.

2000-07-25  Havoc Pennington  <hp@redhat.com>

	* btk/btkmarshal.list: Add NONE:POINTER,POINTER,INT for the text
	buffer

2000-07-25  Havoc Pennington  <hp@redhat.com>

	* btk/testtext.c, btk/testtextbuffer.c: update to reflect text
	widget changes.

	* btk/btktextview.h: To be consistent with usage of "line"
	throughout the API to mean "newline-terminated thingy", change
	MOVEMENT_LINE to be MOVEMENT_WRAPPED_LINE, and MOVEMENT_PARAGRAPH
	to MOVEMENT_LINE.

	(BtkTextView): Add flags for default editability, and whether to
	show the cursor. Add functions to get/set that. Add 

	(btk_text_view_get_iter_location): new function

	* btk/btktexttypes.h: Move BtkTextLine typedef from here to
	btktextlayout.h
	(g_convert): Add g_convert temporarily, will go in bunnylib in a bit
	
	* btk/btktexttagtable.h: include btktexttag.h, and define
	BtkTextTagTableForeach instead of brokenly using GHFunc.
	Change btk_text_tag_table_foreach() so it doesn't use GHFunc.

	* btk/btktexttagprivate.h: Remove BtkTextStyleValues from here,
	moved to public header.

	* btk/btktexttag.h: Rename the "elide" attribute of tags to
	"invisible", since "elide" was a bad name.
	(btk_text_tag_get_priority): Added

	(BtkTextStyleValues): put this in public header, along with
	functions to use it.

	* btk/btktextmarkprivate.h: Include more headers, since we no
	longer include btktextbtree.h.

	* btk/btktextmark.h: Add btk_text_mark_ref, btk_text_mark_unref,
	btk_text_mark_deleted

	* btk/btktextlayout.h: Don't include the "really private" headers,
	only buffer/iter. Forward declare BtkTextLIne and BtkTextLineData
	to make this possible. Now we only need to install
	btktextlayout.h, not btktextbtree.h and btktext*private.h.
	(However the Makefile.am isn't changed yet because of the
	logistics of merging btk-hp-patches piecemeal)

	* btk/btktextiterprivate.h: include btree header, so it compiles;
	rename btk_text_iter_get_line to btk_text_iter_get_text_line since
	btk_text_iter_get_line is now used in the public API for a
	different purpose.

	* btk/btktextiter.h: Clean up function names to be more
	consistent. Always call char offset "offset" and byte index
	"index". A "line" is always a line number. 

	(btk_text_iter_is_last): new function, more efficient than 
	the existing way to check
	(btk_text_iter_is_first): new function, also more efficient

	(btk_text_iter_up_lines, btk_text_iter_down_lines): Remove these

	(btk_text_iter_next_char, btk_text_iter_prev_char): Renamed from 
	btk_text_iter_forward_char, etc.

	(btk_text_iter_forward_to_tag_toggle): Renamed from
	forward_find_tag_toggle, since this isn't a linear search

	(BtkTextCharPredicate): rename from BtkTextViewCharPredicate

	(btk_text_iter_forward_search, btk_text_iter_backward_search): 
	New functions, search for a buffer substring.

	* btk/btktextbuffer.h: Add fields to store whether a paste is
	interactive and default editable (since we need to store that info
	until we receive the selection data).

	Remove all the _at_char and at_line etc. versions of functions;
	only have iterator versions.

	Add _interactive() versions of functions, that consider the
	editability of text. (FIXME add interactive flag to the 
	insert/delete signals per Darin's suggestion)

	(btk_text_buffer_get_tag_table): new function, demand-creates the
	tag table if necessary

	Remove declaration of btk_text_buffer_get_iter_from_string

	(_btk_text_buffer_get_btree): private/internal function, added.
	

	* btk/btktextbtree.h: Remove forward decl of BtkTextLineData.
	(btk_text_line_is_last): new function

2000-07-25  Havoc Pennington  <hp@redhat.com>

	* btk/btkprogressbar.h: Implement new sane, 5-function API for
	using BtkProgressBar. See Changes-2.0.txt for details.

	* btk/btkprogressbar.c: Add object arguments "fraction" and
	"pulse_step" which are the equivalent of
	btk_progress_bar_set_pulse_step and btk_progress_bar_set_fraction.
	Implement new API.
	
	* btk/btkprogress.h (struct _BtkProgress): Add a field
	(use_text_format) to mark whether text set on the progress bar is
	a format string. Deprecate entire BtkProgress interface.

	* btk/btkprogress.c (btk_progress_init): init use_text_format to TRUE
	(btk_progress_build_string): make this a no-op if use_text_format
	is FALSE

	* docs/Changes-2.0.txt: Describe progress bar changes.

2000-07-25  Tor Lillqvist  <tml@iki.fi>

	* Makefile.am: Include the build directory.

	* configure.in: Generate build/Makefile, build/win32/Makefile,
	bdk/, bdk/win32/, and btk/makefile.mingw.

	* config.h.win32: Add USE_BMODULE and USE_MMX for bdk-pixbuf.
	Add GETTEXT_PACKAGE.
	
	* bdk/bdk.def
	* btk/btk.def: Updates.

	* bdk/bdkfont.h
	* bdk/bdkpixmap.h: Remove temporary Win32-only functions, we don't
	need them any longer.

	* bdk/bdkinput.h: Mark bdk_core_pointer for export/import.

	* bdk/makefile.mingw.in: Define BDK_COMPILATION. Link with
	BANGOWIN32_LIBS and bdk_pixbuf.

	* bdk/win32: Compiles, but no doubt doesn't work at all.

	* bdk/win32/makefile.mingw.in: Define BDK_COMPILATION. 

	* bdk/win32/bdkinput.c: New file, temporarily.
	
	* bdk/win32/bdkinput-win32.h: New file

	* bdk/win32/bdkinputprivate.h: Remove.

	* bdk/win32/bdkbango-win32.c: New file.

	* btk/makefile.mingw.in: New file

	* btk/makefile.cygwin: Removed
	
	* btk/Makefile.am: Update accordingly.

	* btk/btkrc.[ch] (btk_win32_get_installation_directory): Renamed and
	made externally visible.

	* btk/btkmain.c: Use it.
	
	* btk/btktextdisplay.c: No need to include bangox.h, bango.h
	is enough.

	* btk/btktypeutils.c: Mark bunnylib_debug_objects for import.

2000-07-24 Elliot Lee <sopwith@redhat.com>
	* bdk/bdkprivate.h: Remove bdk_*_lookup() defines, since they are defined by the
	individual backends already.
	* bdk/bdkrebunnyion-generic.h, bdk/bdktypes.h: Put bdkrebunnyionbox & bdksegment back together
	again. Yes, there really is a good reason for this, if you are using the bdkrebunnyion
	internals, and if you're not, why do you care?
	* bdk/bdkwindow.c: Fix inverted condition
	* bdk/linux-fb: Compiles (for me - it will not work elsewhere most likely).
	* btk/btkcolorsel.c, btk/btkwindow.c: Add include for linux-fb
	* btk/btkrange.c: Redraw trough when moving.
	* btk/btktypeutils.c: Fix warning by adding const cast.
	* modules/linux-fb/basic.c: Fix unknown glyph retrieval.

2000-07-23  Tor Lillqvist  <tml@iki.fi>

	* configure.in: Check for mkstemp and sigsetjmp. Output
	bdk-pixbuf/makefile.mingw and bdk-pixbuf/pixops/makefile.mingw.

	More work on BDK for Win32. Still in an intermediate state.

	* bdk/makefile.cygwin
	* bdk/win32/makefile.cygwin: Removed.
	
	* bdk/makefile.mingw.in
	* bdk/win32/makefile.mingw.in: New files.

	* bdk/Makefile.am
	* bdk/win32/Makefile.am: Generate and distribute them.

	* bdk/win32/bdkwindow-win32.h
	* bdk/win32/bdkdrawable-win32.h
	* bdk/win32/bdkpixmap-win32.h: New files.

	* bdk/win32/bdkcolor-win32.c
	* bdk/win32/bdkcursor-win32.c
	* bdk/win32/bdkdrawable-win32.c
	* bdk/win32/bdkgc-win32.c
	* bdk/win32/bdkimage-win32.c
	* bdk/win32/bdkprivate-win32.h
	* bdk/win32/bdkwin32.h: Update data structures. Cosmetics:
	Rename fields and variables called xcursor, xid, etc (these names
	were leftovers from the X11 backend) to hcursor, hwnd, hbitmap etc.

Sat Jul 22 17:41:26 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkentry.[ch]: Fix some problems with vertical
	alignment.

	* btk/btkentry.c (btk_entry_find_position): Fix 
	char/byte confusion.

Sat Jul 22 11:16:05 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btktextview.c (changed_handler): Fix bug where
	redraw wasn't being done properly when height of
	dirty rebunnyion changed.

	* demos/Makefile.am: Remove various references to
	-lbmodule

Fri Jul 21 15:28:13 2000  Owen Taylor  <otaylor@redhat.com>

        * btk/btktextlayout.[ch], btk/btktextdisplay.c: Use new
	BangoAttrShape to reserve space for pixmaps, add 
	GSList *pixmaps to BtkTextLineDisplay, draw the pixmaps
	in the display functions.
	
	* btk/testbtk.c (create_layout): Set some more bexotic
	scrolled window options

	* btk/btkscrolledwindow.[ch] (btk_scrolled_window_set_shadow_type):
	Add function to set the shadow type of a window, to allow
	putting a shadow around widgets such as BtkLayout or BunnyCanvas
	which don't draw their own frame.

Fri Jul 21 16:34:42 BST 2000  Tony Gale <gale@btk.org>

	* docs/tutorial/package-db-tutorial.sh: New file for
	  packaging DocBook format tutorial

Fri Jul 21 14:23:51 BST 2000  Tony Gale <gale@btk.org>

	* docs/tutorial/btk-tut.sgml: Minor updates

	* docs/tutorial/*.jpg *.eps: Screenshots for tutorial

2000-07-19  Tor Lillqvist  <tml@iki.fi>

	* btk/btksignal.c: Fix C++ comment.

	* btk/btkimmulticontext.c
	* btk/btktextbtree.c: Remove gccisms: Don't use __FUNCTION__,
	don't return value from void functions.

	* btk/btk.def: Add btk_rc_style_unref.

2000-07-19  Sebastian Wilhelmi  <wilhelmi@ira.uka.de>

	* bdk-pixbuf/bdk-pixbuf.h, btk/btkhsv.h, btk/btktextbtree.h,
	btk/btktextbuffer.h, btk/btktextchild.h, btk/btktextdisplay.h,
	btk/btktextiter.h, btk/btktextiterprivate.h, btk/btktextlayout.h,
	btk/btktextmarkprivate.h, btk/btktextsegment.h, btk/btktexttag.h,
	btk/btktexttagtable.h, btk/btktexttypes.h, btk/btktextview.h,
	btk/btktypeutils.h: Include files outside of the extern "C"
	block. Makes some C++ compiler happy. Reported by Denis Vakatov
	<vakatov@peony.nlm.nih.gov>.

Wed Jul 19 14:07:57 BST 2000  Tony Gale <gale@btk.org>

	* docs/tutorial/btk-tut.sgml: Yet more clean ups.
	  Completes first pass. Hurrah!

Tue Jul 18 17:17:55 BST 2000  Tony Gale <gale@btk.org>

	* docs/tutorial/btk-tut.sgml: More clean ups.

Mon Jul 17 18:52:38 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkentry.c (btk_entry_draw_text): Restore code to
	paint the background of the text area which was accidentally
	removed at some point.

	* btk/btkrc.[ch] btk/btkstyle.[ch] btk/btkthemes.[ch]: 
	  
	 - Move	most of the functionality from the theme vtable
	   into BtkRcStyleClass and BtkStyleClass. The moved
	   vtable functions were changed a bit in the move to
	   work better in their new home.

	 - Get rid of the engine and engine_data fields from
	   BtkRcStyle and BtkStyle; instead the theme
	   engine derives theme-specific subclasses of BtkRcStyle
	   and BtkStyle

	 - Add extra dlsym() found entry point to themes,
	   theme_create_rc_style().

	* btk/btkstyle.c: Copy xthickness, ythickness fields
	in btk_style_real_copy.

 	* btk/themes.[ch]: add a function btk_theme_engine_register_type()
	to register a type associated with an engine. (The engine
	won't be unloaded as there is an instance of the type.)


Mon Jul 17 18:19:06 BST 2000  Tony Gale <gale@btk.org>

	* docs/tutorial/btk-tut.sgml: Clean ups.

Mon Jul 17 13:59:29 BST 2000  Tony Gale <gale@btk.org>

	* docs/tutorial/btk-tut.sgml: Initial DocBook version. Lots
	  of cleaning up to do.

2000-07-15  Tor Lillqvist  <tml@iki.fi>

	* bdk/testbdk.c: New file, quick hack to test backends for
	pixel-by-pixel correctness of the most simple graphic operations.

Fri Jul 14 20:30:25 2000  Owen Taylor  <otaylor@redhat.com>

        * Really release 1.3.1
	
	* btk-config-2.0.in btk-2.0.m4: Fix up to correspond to new
	include structure.

Fri Jul 14 18:40:39 2000  Owen Taylor  <otaylor@redhat.com>

	* Released 1.3.1

Fri Jul 14 16:21:26 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btktextlayout.c: use FALSE for size_only most
	of the time when calling btk_text_layout_get_line_display()
	to avoid causing double reshapes when a redraw follows
	immediately after.

Tue Jul 11 11:13:40 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkrange.c (btk_range_default_[hv]slider_update): Invalidate
	appropriate rebunnyion and bdk_window_process_updates() so trough
	updating doesn't lag behind the window being scrolled.

        * bdk/bdkgc.c: Make parent_class pointer static.
	 
Sun Jul  9 21:31:23 2000  Owen Taylor  <otaylor@redhat.com>

        * bdk/bdk-pixbuf.c btk/bdk-pixbuf-loader.c btk/btktextview.c:
	include <string.h>.
	 
	* bdk/bdkpixbuf-render.c (bdk_pixbuf_render_to_drawable): Fix
	cut-and-paste error in computing memory offset for 4 channels.

Fri Jul 14 14:05:02 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkrc.c (btk_rc_parse_pixmap_path_string): Remove
	btk_rc_append_default_pixmap_path(), since it wasn't
	adding an interesting path and we don't have a meaningful
	default for this value.

Fri Jul 14 12:22:49 2000  Owen Taylor  <otaylor@redhat.com>

	* configure.in Makefile.am btk-config.m4 btk.m4: Move
	btk-config to btk-config-2.0 move btk_.m4 to
	btk-2.0.m4

	* Makefile.am btk/Makefile.am bdk-pixbuf/Makefile.am
	bdk/Makefile.am demos/Makefile.am: Change 
	library names to libbtk-1.3.la, etc, so that we
	can distinguish btk-1.2 and btk-2.0 on the linkline.

	* Makefile.am btk/Makefile.am bdk-pixbuf/Makefile.am
	bdk/Makefile.am bdk/x11/Makfile.am
	Move include files into /usr/include/btk-2.0, 
	/usr/lib/btk-2.0/include/
	 
	* autogen.sh acconfig.h configure.in btk/btkmain.c
	btk/btkintl.h: Change package for gettext from 
	btk+ to btk20. Put hack in autogen.sh to modify
	po/Makefile.in.in after gettextize to make this
	possible.

	* btk+.spec: Some updates, not tested.

	* bdk-pixbuf/Makefile.am: Move loaders into
	$(libdir)/btk-2.0/$(BTK_VERSION)/loaders.

	* btk/Makefile.am btk/btkrc.c: Move RC file locations
	$(sysconfdir)/btk-2.0 ~/.btkrc-2.0; theme subdir
	to THEMENAME/btk-2.0/. Move engine directory  to
	$(libdir)/btk-2.0/$(BTK_VERSION)/engines.
	
2000-07-12  Tor Lillqvist  <tml@iki.fi>

	Win32 changes, still doesn't build though.

	* bdk/makefile.cygwin
	* bdk/win32/makefile.cygwin
	* btk/makefile.cygwin: Updates.

	* bdk/win32/bdkgc-win32.c (_bdk_win32_gc_new): Use the same
	default values for fg and bg pixel as X11 does (0 and 1), not
	black and white. Use PS_ENDCAP_FLAT and PS_JOIN_MITER by default.
	Use 0 for pen width by default (treated as 1 anyway later, but for
	apps that might check the value in the BdkGC).
	(bdk_win32_hdc_get, bdk_win32_hdc_release): New functions, public
	interface to bdk_gc_predraw and _postdraw.

	* bdk/win32/bdkwin32.h
	* bdk/bdk.def: Add bdk_win32_hdc_{get,release}.

	* bdk/win32/bdkcolor-win32.c (bdk_colormap_alloc1): Remove
	extraneous semicolon.

	* bdk/win32/bdkdrawable-win32.c: Check also for pen_width == 0.

	* bdk/win32/bdkimage-win32.c (bdk_image_new): Use the visual's depth,
	not the Win32 bitspixel value.

	* bdk/win32/bdkcc-win32.c:
	* bdk/win32/bdkcolor-win32.c 
	* bdk/win32/bdkprivate-win32.h
	* bdk/win32/bdkwin32.h: Changes to make compilable, with new
	BDK object structure.

Tue Jul 11 20:59:35 2000  Tim Janik  <timj@btk.org>

	* docs/tutorial/btk_tut_12.es.sgml (name): 
	* docs/tutorial/btk_tut_it.sgml (name): 
	* docs/tutorial/btk_tut_fr.sgml (name): 
	* docs/tutorial/btk_tut.sgml (name): scratched notion of completely
	outdated email adress: s/timj@psynet.net/timj@btk.org/.

Tue Jul 11 13:10:57 BST 2000  Tony Gale <gale@btk.org>

	* docs/faq/btk-faq.sgml: Cleanup indenting and various
	  small changes.

Tue Jul 11 08:04:58 2000  Tim Janik  <timj@btk.org>

        * btk/btktree.c (btk_real_tree_select_child): eek, i've never seen
        a bug here, never been here and never fixed anything ;(
        (don't segfault if tree->root_tree is NULL, which happens prior
        to widget realization, but puke instead).

Tue Jul 11 06:38:42 2000  Tim Janik  <timj@btk.org>

	* btk/btkrc.h: add xthickness and ythickness to BtkRcStyle and
	add the necessary tokens.

	* btk/btkrc.c (btk_rc_style_init): properly initiality the rc style.
	(btk_rc_style_to_style): copy thicknesses.
	(btk_rc_init_style): apply thicknesses.
	(btk_rc_parse_style): parse xthickness and ythickness.

	* bdk/x11/bdkdnd-x11.c: silence compiler in switch() statements.

	* bdk/x11/bdkwindow-x11.c (bdk_window_foreign_new): 
	(bdk_window_new): 
	(_bdk_windowing_window_init): 
	* bdk/x11/bdkpixmap-x11.c (bdk_pixmap_foreign_new): 
	(bdk_pixmap_create_from_data): 
	(bdk_bitmap_create_from_data): 
	(bdk_pixmap_new): 
	* bdk/x11/bdkimage-x11.c (bdk_image_get): 
	(bdk_image_new): 
	* bdk/x11/bdkgc-x11.c (_bdk_x11_gc_new): 
	* bdk/x11/bdkdnd-x11.c (bdk_drag_context_new): 
	* bdk/x11/bdkcolor-x11.c (bdkx_colormap_get):
	(bdk_colormap_get_system): 
	(bdk_colormap_new): 
	* bdk/bdkwindow.c (bdk_window_init): 
	* btk/btkstyle.c (btk_style_new):
	* btk/bdk-pixbuf-loader.c (bdk_pixbuf_loader_frame_done):
	* bdk/bdkpixmap.c (bdk_pixmap_init): 
	* btk/btkrc.c (btk_rc_style_new):
	use g_object_new() instead of g_type_create_instance() which
	is a private function for fundamental type implementations.

Thu Jul  6 16:12:14 2000  Owen Taylor  <otaylor@redhat.com>

	* configure.in: Add check for db2html

Thu Jul  6 14:53:05 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btktypeutils.c (btk_type_init): Add a temporary 
	hack to set bunnylib_debug_objects based on btk_debug_flags.

Thu Jul  6 14:12:13 2000  Owen Taylor  <otaylor@redhat.com>

	* INSTALL.in: Update the Prerequisites section.

	* Makefile.am demos/Makefile.am docs/Makefile.am
	docs/tutorial/Makefile.am bdk/x11/Makefile.am
	bdk/linux-fb/Makefile.am: Dist fixes

Thu Jul  6 12:26:03 2000  Owen Taylor  <otaylor@redhat.com>

	* NEWS: 10,000 foot view of 1.3.1 changes.

Thu Jul  6 11:54:03 2000  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdk.h bdk/bdktypes.h bdk/linux-fb/bdkmain-fb.c
	bdk/nanox/bdkmain-nanox.c bdk/win32/bdkevents-win32.c
	bdk/win32/bdkinput-win32.c bdk/win32/bdkwin32.h
	bdk/x11/bdkmain-x11.c: 

	Patch from George Lebl to add a BdkGrabStatus enumeration to use
	as a return value of bdk_*_grab(). Previously, we just
	returned the X11 values directly.

Thu Jul  6 11:27:44 2000  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/Makefile.am: Patch from George Lebl to 
	install all the headers in the right place.

Tue Jul  4 13:13:01 BST 2000  Tony Gale <gale@btk.org>

	* docs/faq/btk-faq.sgml: Add remaining sections. Completes
	  initial conversion to DocBook.

2000-07-04  Tor Lillqvist  <tml@iki.fi>

	* README.win32: Improve a bit.

	* bdk/win32/bdkevents-win32.c (bdk_event_translate): Handle also
	WM_SYSCHAR, and other changes to get handling of Alt+nnn or
	Alt+0nnn on the numpad (used to enter characters by numeric code
	from current DOS or ANSI codepage) working correctly, as in other
	Windows apps.

	* bdk/win32/bdkcursor-win32.c (bdk_cursor_new_from_pixmap): Use
	same argument validity tests as in X11 version.
	(_bdk_cursor_destroy): Use DestroyCursor, not DestroyIcon.

	* bdk/win32/bdkwin32.h: Add also WM_MOUSEWHEEL and CopyCursor
	definitions in case missing from headers.

	* bdk/win32/bdkwindow-win32.c (bdk_win32_window_destroy): Also
	destroy the window-specific cursor.
	(RegisterBdkClass): Use the global bdk_ProgInstance instead of
	calling GetModuleHandle(NULL).
	(bdk_window_set_cursor): Reworked to always copy the passed cursor
	with CopyCursor before setting it as the window-specific
	cursor. It is OK for the caller to destroy the BdkCursor (and thus
	also its Windows cursor) after calling this function. Destroy any
	previous window-specific cursor.

Mon Jul  3 17:54:49 2000  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkfont-x11.c (bdk_font_charset_for_locale): 
	font charset is iso8859-1, not iso-8859-1.

Mon Jul  3 17:08:14 2000  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkfont-x11.c (bdk_font_charset_for_locale):
	Use g_get_charset() instead of g_get_codeset().

	* btk/btkframe.[ch] btkframe.h btk/btktextmark.h: 
	Comment out some strdup'ing functions to keep timj
	happy until we finish fighting this out.

Mon Jul  3 14:24:16 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.c (btk_widget_draw): Ignore calls with
	<= width or height.

	* btk/btktable.c (btk_table_attach): Fix missed merge
	from 1.2 for parent/child states.

	* bdk/bdkgc.c (bdk_gc_set_rgb_fg/bg_color): Fix a couple
	of typos.

	* bdk/bdkevents.[ch]: Remove press/xtilt/ytilt fields of
	event structures, replace with a generic axes field. Replace 
	deviceid/sourec with BdkDevice *device.

	* bdk/bdkevents.[ch] (bdk_event_get_axis): Add function
	to extract particular axis use value from event. (Also
	can be used for normal X/Y.)

	* bdk/bdkinput.h bdk/x11/bdkinput*: Major revision;
	allow for arbitrary number of axes, namespace everything
	as bdk_device_*. Replace guint32 deviceid with BdkDevice *
	everywhere.

	* bdk/x11/{bdkmain-x11.c,bdkevent-x11.c,bdkinput*}: 
	Get rid of the bdk_input_vtable setup if favor of simply
	defining the functions in bdkinput-none/gxi/xfree.c in
	a similar fashion to the way that the port structure is 
	done.

	* btk/btkdnd.c: Fix fields of synthesized button press event
	for new event structures. 

	* btk/btkinputdialog.c btk/testinput.c: Revise to match
	new device interfaces.

Sun Jul  2 18:19:50 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.[ch] (btk_widget_create_bango_layout): Add a 'text' argument to
	set the initial text.

	* btk/btkaccellabel.c btk/btkcalendar.c btk/btkclist.c
	btk/btkentry.c btk/btkhruler.c btk/btkhscale.c btk/btklabel.c
	btk/btkprogressbar.c btk/btkscale.c btk/btkvruler.c
	btk/btkvscale.c: Adapt to new argument of create_bango_layout().

	* btk/btkclist.c (_btk_clist_create_cell_layout): Use new
	bango_layout_set_font_description to simplify.

Sun Jul  2 17:43:41 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkclist.c (_btk_clist_create_cell_layout): Use new
	bango_layout_set_font_description to simplify.

Sun Jul  2 17:06:40 2000  Owen Taylor  <otaylor@redhat.com>

        * btk/btkcalendar.c btk/btkclist.c btk/btkctree.c btk/btkhscale.c
	btk/btkprogressbar.c btk/btkscale.c btk/btkvscale.c btk/btkaccellabel.c: Use
	bango_layout_get_pixel_extents() to remove a large number of '/ BANGO_SCALE'.

	* btk/btk[hv]ruler.c btk/btklabel.c: replace some / BANGO_SCALE with
	BANGO_PIXELS() macro.

Sun Jul  2 15:24:41 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.[ch] (btk_widget_get_bango_context): Add new function
	that returns a BangoContext owned by the widget and updated to
	match future changes in the widget. Also, make 
	btk_widget_create_bango_layout() use this context. If we ever
	add a ::changed signal to BangoContext, this will make things
	much more convenient. 

	* btk/btkentry.c btk/btklabel.c: Call bango_layout_context_changed()
	in the appropriate places instead of destroying the layouts and
	creating new ones.

	* btk/btkfontsel.[ch] btk/btkclist.c: Use btk_widget_get_bango_context()
	in a few strategic places.

Sun Jul  2 14:37:58 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkoptionmenu.c (btk_option_menu_size_request): Call 
	btk_widget_size_request() on reparented child, if one. Otherwise,
	queue_resize() on the child never results in it getting size-requested
	at all.

	* btk/testbtk.c (build_option_menu): Remove silly radio-menu-items
	in option menus, so that (with luck) people won't copy it into
	their apps in the future.

	* btk/btkoptionmenu.c: Connect ::size_request on the menu
	to btk_option_menu_calc_size. This isn't perfect, but should fix
	a lot of problems with changing the size of the menu's menu
	items after adding it to the option menu.

	* btk/btktexttag.c: Include btkmain.h for btk_get_default_language().

	* btk/btkwidget.[ch]: Add a ::direction_changed that triggers when
	the text direction for a widget changes.

	* btk/btk{entry.c,label.[ch],textview.[ch]} btk/testbtk.c: Use
	::direction_changed to get rid of various hacks.

Sun Jul  2 13:19:12 2000  Owen Taylor  <otaylor@redhat.com>

	* docs/Changes-2.0.txt: Move Changes-1.4.txt to the appropriate
	name.

Sun Jul  2 13:06:26 2000  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkpixmap-x11.[ch] Changes-1.4.txt: Add a is_foreign
	flag to the structure. Do not call XFreePixmap on pixmaps created
	by bdk_pixmap_foreign_new().

Sun Jul  2 12:45:50 2000  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkrgb.[ch]: Add bdk_rgb_find_color() to get a pixel
	value using BdkRGB functionality given BdkColormap and BdkColor.
	(name not final, waiting for inspiration.)
	
	* bdk/bdkgc.[ch] (bdk_gc_set_rgb_fg/bg_color): New functions to
	set the foreground/background of a GC using the GC's colormap
	and BdkRGB. (name not final, waiting for inspiration.)

	* bdk/bdkcompat.h bdk/bdkrgb.c (bdk_rgb_get_colormap): Rename from 
	bdk_rgb_get_cmap(), put #define in bdkcompat.h.

	* btk/btkwidget.[ch] btkcompat.h: Make visuals for
	btk_widget_get_visual(), btk_widget_get_default_visual, etc,
	purely a function of the corresponding colormap. Make
	btk_widget_set_visual(), etc, noop macros in btkcompat.h.

	* bdk/bdkpixmap.c bdk/x11/bdkpixmap-c11.c: Rewrite
	bdk_pixbuf_*create_from_xpm_* in terms of
	bdk_pixbuf_new_from_xpm_data(), move into platform independent
	code.

	* bdk/bdkpixbuf-render.c (bdk_pixbuf_render_to_drawable): Take
	advantage of the new draw_rgb_32_image_dithalign.

	* bdk/bdkrgb.c (bdk_draw_rgb_32_image_dithalign): Added.

	* btk/btkgc.c (btk_gc_new): Set the appropriate colormap
	on each created GC.

	* bdk/bdkgc.[ch]: Add bdk_gc_get/set_colormap.

	* bdk/bdkgc.[ch]: Add a colormap field to the BdkGC structure
	which we initialize from the drawable when the GC is created,
	if the drawable has a colormap.

	* bdk/x11/bdkgc-x11.c: include string.h for memset.

	* bdk/x11/bdkinput-x11.c: include string.h for strlen, etc.

	* btk/btklayout.[ch]: Remove unsed configure serial member.

Sat Jul  1 16:28:32 2000  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkevents-x11.c (bdk_event_translate): When
	actually returning expose events, make sure to set
	the count field properly.

	* bdk/x11/bdkgc-x11.c (bdk_x11_gc_values_to_xvalues): Fix
	accidentally reintroced bug which always cleared
	the graphics_exposures value. 

Wed Jun 28 18:03:09 BST 2000  Tony Gale <gale@btk.org>

	* docs/faq/btk-faq.sgml: Change DocBook layout slightly

Wed Jun 28 17:49:05 BST 2000  Tony Gale <gale@btk.org>

	* docs/faq/btk-faq.sgml: Finish Section 6. Add Section 7.

Wed Jun 28 13:31:55 BST 2000  Tony Gale <gale@btk.org>

	* docs/faq/btk-faq.sgml: Start of Section 6.

Mon Jun 26 19:37:04 2000  Owen Taylor  <otaylor@redhat.com>

        * configure.in: Put 1.3.1 in warning message, not 1.3.0.
	
        (Fixes problem with drawing childless frames. Pointed out
	by and a first patch from Anders)
	
	* btk/btkframe.c (btk_frame_compute_child_allocation): Always
	compute a child_allocation, even if we don't have a child.

	* btk/btkaspectframe.c (btk_aspect_frame_compute_child_allocation):
	Always chain to the parent's impl, even if we don't have a child.

Mon Jun 26 18:53:31 2000  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkrgb.c: If possible, create only a single shm segment and
	use multiple parts of it instead of creating a bunch of separate
	segments, since the maximum number of segments per system is not
	large. (This might be worth backporting to BTK+-1.2.x if we make a
	new release )

	* bdk/bdkrgb.c: Localize a bunch of variables into the BdkRgbInfo
	structure in preparation for per-colormap BdkRGB.

	* bdk/x11/bdkimage-x11.c (bdk_image_new): Don't set bdk_use_xshm
	to False when we get EINVAL from shmget so that the caller of
	bdk_image_new can retry with a smaller segment size.

Mon Jun 26 13:01:16 BST 2000  Tony Gale <gale@btk.org>

	* docs/faq/btk-faq.sgml: Add Sections 4 & 5.

Fri Jun 23 17:54:23 2000  Tim Janik  <timj@btk.org>

	* configure.in: make the current version number 1.3.1 (binary age 0,
	interface age 0).
	
	* btkfeatures.h, btkfeatures.h.in: dejavue, get rid of these *again*,
	btkcompat.h is all we want.

	* btk/btktypeutils.[hc]: define most of the primitive types in terms of
	GLib primitive types. fixed g_type_register_fundamental() argument
	ordering.

	* btk-config.in (lib_btk): add -lbdk_pixbuf so third party code
	compiles.

	* bdk-pixbuf-loader.[hc]: get rid of unistd.h include.
	object code cleanup, comment trigraph fixes, etc...

2000-06-23  Havoc Pennington  <hp@redhat.com>

	* btk/btktextview.c (btk_text_view_set_buffer): Use anonymous mark 
	instead of making up a bogus name for first_para_mark

	* btk/btkstatusbar.h, btk/btkstatusbar.c: Allow 
	0 as a context ID

Thu Jun 22 17:43:51 BST 2000  Tony Gale <gale@btk.org>

	* docs/faq/btk-faq.sgml: Change filename. Add Section 3.

2000-06-21  Havoc Pennington  <hp@pobox.com>

	* bdk/bdkwindow.c (_bdk_window_destroy_hierarchy): Fix bug where
	we didn't check window->bg_pixmap != BDK_NO_BG.

	* btk/bdk-pixbuf-loader.c: Change to reflect GObject-ification of
	bdk-pixbuf

Thu Jun 22 14:02:19 BST 2000  Tony Gale <gale@btk.org>

	* docs/faq/btk-faq.sgm: Move file to here.
	  TODO: Update Makfile.am 

Thu Jun 22 13:41:09 BST 2000  Tony Gale <gale@btk.org>

	* docs/btk-faq.sgm: Add Section 2

Thu Jun 22 08:43:45 BST 2000  Tony Gale <gale@btk.org>

	* docs/btk-faq.sgm: New file. Start of DocBook
	  version of the FAQ.

Wed Jun 21 23:04:17 2000  Owen Taylor  <otaylor@redhat.com>

	* configure.in (BDK_PIXBUF_MAJOR): Define version
	numbers for BDK_PIXBUF_*, as they get substituted
	into a header file. Need to consider versioning
	for bdk-pixbuf more carefully later.

2000-06-21  Raja R Harinath  <harinath@cs.umn.edu>

	Work with srcdir != builddir.	
	* demos/testanimation.c: Don't include "bdk-pixbuf.h".  Use
	<btk/bdk-pixbuf-loader.h>, not "btk-pixbuf/bdk-pixbuf-loader.h".
	* demos/testpixbuf.c: Likewise.
	* demos/testpixbuf-scale.c: Don't include "bdk-pixbuf.h".
	* demos/testpixbuf-drawable.c: Don't include "bdk-pixbuf.h".  Use
	<bdk/x11/bdkx.h>.
	* demos/pixbuf-demo.c: Use <btk/btk.h> not "btk.h".  Don't include
	"bdk-pixbuf.h".
	* demos/Makefile.am (INCLUDES): Remove unneeded directories.

Wed Jun 21 19:45:02 2000  Owen Taylor  <otaylor@redhat.com>

	* TODO.xml: Change 1.4 version numbers to 2.0.

Wed Jun 21 19:29:08 2000  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkpixbuf-render.c bdk/bdkpixbuf-drawable.c: Indentation
	fixups to BTK+ standard.

Wed Jun 21 16:38:13 2000  Owen Taylor  <otaylor@redhat.com>

	* bdk-pixbuf/* docs/reference/bdk-pixbuf/*: Welcome aboard,
	bdk-pixbuf.

	* btk/bdk-pixbuf-loader.c (bdk_pixbuf_loader_class_init):
	fixups for GObject.

	* bdk/Makefile.am bdk/bdkpixbuf-render.[ch] bdk/bdkpixbuf.[ch]: Bits of 
	bdk-pixbuf with BDK dependencies moved into BDK.
	
	* btk/Makefile.am btk/bdk-pixbuf-loader.[ch]: Temporarily
	move bdk-pixbuf-loader here until GObject has signals.

	* demos/: New directory of demos. Move demos from
	bdk-pixbuf here.

	* demos/pixbuf-init.c: Small bit of code to check for
	loaders in ../bdk-pixbuf/.libs/bdk-pixbuf, and if found,
	set BDK_PIXBUF_MODULEDIR appropriately.

	* bdk/bdkcompat.h: Remove BDK_DRAWABLE_PIXMAP compat
	define which no longer makes sense.

2000-06-21  Havoc Pennington  <hp@redhat.com>

	* btk/btkwidget.c (btk_widget_create_bango_context): Use
	btk_get_default_language

	* btk/btkmain.h, btk/btkmain.c (btk_get_default_language): 
	new function to get the default language

	* btk/btktexttagprivate.h, btk/btktexttag.c, btktextview.c: 
	s/btk_text_view_style_values/btk_text_style_values/

	* btk/btktexttag.c, btk/btktexttag.h, btk/btktexttagprivate.h:
	Add a "language" field to tags.

	(btk_text_tag_set_arg): Fix bug in setting
	"bg_full_height_set" tag.

2000-06-21  Havoc Pennington  <hp@redhat.com>

	* btk/btktextiter.h: Use gunichar instead of gint when appropriate
	in the interfaces

	* btk/btktexttypes.c: Remove UTF functions, use bunnylib 
	stuff instead when possible.

	* btk/btktexttypes.h: Delete some unused constants

	* btktextbtree.c, btktextiter.c, btktextsegment.c, btktextview.c,
	testtextbuffer.c: use bunnylib instead of custom unicode routines

Wed Jun 21 12:50:58 2000  Owen Taylor  <otaylor@redhat.com>

	* docs/es/: Removed mistakenly added generated sgml

	* docs/{bdk.texi,btk.texi,bdk.sgml} macros.texi texinfo.tex:
	Remove outdated info files.

	* docs/btk_tut* docs/package_tutorial.sh docs/tutorial:
	Moved tutorial files into subdir

	* docs/btkfaq.sgml docs/faq/btkfaq.sgml: Move FAQ into
	subdir.

	* docs/man/btk_button.pod: Remove. (contents will be
	integrated into btk-reference button page.)

	* configure.in docs/Makefile.am docs/tutorial/Makefile.am
	docs/faq/Makefile.am: Adjust for new organization

2000-06-21 Christopher Blizzard  <blizzard@redhat.com>

        * bdk/x11/Makefile.am (install-data-local): use $(mkinstalldirs)
        not $(MKINSTALLDIRS)

Wed Jun 21 12:24:28 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/testbtk.c (create_text): Finish the job Elliot started
	of removing font setting test for text widget. (Since text widget
	and BdkFont are not deprecated, and cause portability problems.)

Wed Jun 21 11:41:43 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkentry.c btk/btkimcontextsimple.c btk/btklabel.c
	btk/btktexttypes.c btk/testtext.c modules/linux-fb/basic.c:
	Remove use of libunicode in favor of new GLib functions.

	* btk/btkcolorsel.c: Remove conditional includes for FB, win32,
	nano-x, framebuffer. The X11 include is just a hack until we get
	the necessary functions in bdkcolor.h, so there is no reason to
	add other includes of platforms.

	* btk/btkwindow.c (btk_window_compute_default_size): Revert 
	window bigger than the screen change.

        * btk/testbtk.c: Revert some random changes from Elliot
	that had no particular point and were causing testbtkrc
	not to function correctly.
	
	* bdk/bdkrebunnyion-generic.h: Revert change from Elliot. Just
	because BdkSegment and BdkRebunnyionBox have the same fields,
	it doesn't mean that 'typedef BdkSegment BdkRebunnyionBox'
	results in clearer code.

	* bdk/x11/bdkinput-x11.c (bdk_input_common_select_events,
	bdk_input_translate_coordinates): Fix missed BdkObjectification

2000-06-18  Elliot Lee  <sopwith@redhat.com>

	* bdk/Makefile.am, bdk/*/Makefile.am: Fix conditionality to work the "right" way.
	* btk/btk{plug,socket}.h: Missed commits from previous.

2000-06-20  Havoc Pennington  <hp@redhat.com>

	* modules/linux-fb/Makefile.am: Make this compile
	without framebuffer enabled

	* bdk/linux-fb/Makefile.am: Add conditional to not build
	framebuffer unless specified in configure

	* bdk/bdkdraw.c (bdk_draw_drawable): Fix bug where I was getting
	the size of the target instead of source if -1 was passed for
	width/height

	* bdk/x11/bdkgeometry-x11.c (bdk_window_compute_position): Fix 
	width/height confusion.

2000-06-19  Havoc Pennington  <hp@redhat.com>

	* bdk/x11/bdkx.h (BDK_WINDOW_XWINDOW): change this to be
	BDK_DRAWABLE_XID. In the future, we probably want to make it
	faster with G_DISABLE_CHECKS turned on.

2000-06-14  Havoc Pennington  <hp@redhat.com>

        * bdk/Makefile.am: add bdkpixmap.c

	* bdk/bdk.c: s/bdk_window_init/_bdk_windowing_window_init/
	s/bdk_image_init/_bdk_windowing_image_init

	* bdk/bdkcolor.c: make ref/unref compat wrappers for GObject
	ref/unref

	* bdk/bdkcolor.h: make BdkColormap a GObject subclass

	* bdk/bdkcompat.h: remove BdkWindowType compat, since
	BdkWindowType is now non-deprecated; 
	change bdk_window_get_type() compat to be
	bdk_window_get_window_type().

	* bdk/bdkdnd.h: make BdkDragContext a GObject.

	* bdk/bdkdraw.c, bdk/bdkdraw.h: Convert BdkDrawable to a pure
	virtual GObject. Make all functions call into the vtable.
	Move bdk_image_put() guts in here. Remove BdkDrawableType
	and bdk_drawable_get_type(), these are now BdkWindow-specific.
	draw_image, get_depth, get_size, set_colormap, get_colormap,
	get_visual added to the vtable.
	
	* bdk/bdkgc.h, bdk/bdkgc.c: Convert BdkGC to a pure virtual 
	GObject. Virtualize everything. 
	(bdk_gc_new_with_values): remove check for destroyed window,
	because now BdkWindow::create_gc will check this.
	(bdk_gc_set_values): New function to set GC values, this 
	was already implemented but wasn't in the header

	* bdk/bdkimage.h, bdk/bdkimage.c: Convert BdkImage to a GObject.

	* bdk/bdkinternals.h: Remove _bdk_window_alloc(), remove
	_bdk_window_draw_image(), remove _bdk_windowing_window_class,
	remove _bdk_window_class; add _bdk_window_impl_get_type() and
	_bdk_pixmap_impl_get_type(). Rename bdk_window_init to
	_bdk_windowing_window_init, rename bdk_image_init to
	_bdk_windowing_image_init.
	
	* bdk/bdkbango.c: Reflect GObject-ification of BangoContext.
	(bdk_draw_layout): Remove check for destroyed window, 
	because all the drawable methods already check it.
	
	* bdk/bdkpixmap.h, bdk/bdkpixmap.c: Convert BdkPixmap to GObject.
	Add bdkpixmap.c which contains implementation of BdkDrawable
	virtual table (by chaining to a platform-specific implementation
	object).
	
	* bdk/bdkprivate.h: Remove BDK_IS_WINDOW, BDK_IS_PIXMAP, 
	BDK_DRAWABLE_DESTROYED. Add BDK_WINDOW_DESTROYED. Replace
	BDK_DRAWABLE_TYPE with BDK_WINDOW_TYPE. Remove BdkDrawablePrivate,
	BdkWindowPrivate, BdkImageClass, BdkImagePrivate, BdkGCPrivate,
	BdkColormapPrivate. 

	* bdk/bdktypes.h: #include <bunnylib-object.h>

	* bdk/bdkwindow.h, bdk/bdkwindow.c: Convert BdkWindow to GObject.
	Move most functionality to platform-specific implementation
	object. BdkWindow itself now handles the backing store, then
	chains to the platform-specific implementation.
	(bdk_window_get_window_type): return BdkWindowType of the window.
	(bdk_window_peek_children): New routine, returns the children of 
	a BdkWindow
	(bdk_window_get_children): Was in X11-specific code and did 
	XQueryTree. Changed to simply return a copy of window->children; 
	so it can go in cross-platform code.
	
	* bdk/x11/Makefile.am: fix broken MKINSTALLDIRS path

	* bdk/x11/bdkcolor-x11.c: implement X-specific parts of 
	BdkColormap; just changed to use the new private data instead
	of casting to BdkColormapPrivate.

	* bdk/x11/bdkcursor-x11.c: added a couple typechecks to 
	bdk_cursor_new().

	* bdk/x11/bdkdnd-x11.c: Change the way we access private fields 
	(private data member in the GObject). 
	(xdnd_manager_source_filter): Function had broken 
	error handling, fix it (use bdk_error_trap_push).

	* bdk/x11/bdkdrawable-x11.c: This file now implements
	a base class for BdkWindowImplX11/BdkPixmapImplX11. This 
	base class is purely for the convenience of the X port,
	and not part of the interface to cross-platform BDK.

	* bdk/x11/bdkevents-x11.c: Reflect various renamings.
	
	* bdk/x11/bdkgc-x11.c: Implement a subclass of BdkGC that's
	specific to X, and returned by the create_gc virtual method
	of BdkDrawableImplX11. 
	(bdk_x11_gc_set_dashes): Change this to take an array of gint8
	rather than gchar, this was also changed in the BdkGC vtable.
	(bdk_x11_gc_values_to_xvalues): If BdkGCValues is NULL, or the
	mask is 0, return immediately, instead of checking every flag.
	This is faster, and keeps us from segfaulting if values is NULL
	and the mask contains some nonzero flags.

	* bdk/x11/bdkgeometry-x11.c: deal with all the rearranging of
	BdkWindow.

	* bdk/x11/bdkglobals-x11.c: change type of grab window, since 
	BdkWindowPrivate is gone.

	* bdk/x11/bdkim-x11.c: rename things that got renamed.

	* bdk/x11/bdkimage-x11.c: implement in terms of GObject, and 
	remove the image_put stuff that got transferred to BdkDrawable.
	
	* bdk/x11/bdkinput.c: renamings

	* bdk/x11/bdkmain-x11.c: #include <bango/bangox.h>

	* bdk/x11/bdkpixmap-x11.c: GObject conversion

	* bdk/x11/bdkprivate-x11.h: indentation fixes

	* bdk/x11/bdkproperty-x11.c: renamings

	* bdk/x11/bdkselection-x11.c: renamings

	* bdk/x11/bdkwindow-x11.c: Restructuring and renaming; this now 
	implements the platform-specific "impl" object.
	Moved bdk_window_get_children to bdk/bdkwindow.c

	* bdk/x11/bdkx.h: Remove all the private structs and private datas
	that no longer exist. Add declaration of BdkGCX11 object here.
	Fix all the macros to still work. 

	* btk/btk-boxed.defs: Remove BtkStyle, BdkColormap, BdkWindow,
	BdkDragContext from the boxed types since they are now GObjects.

	* btk/btkstyle.h, btk/btkstyle.c: Converted BtkStyle to a GObject,
	moved xthickness/ythickness into the instance. BtkStyleClass
	functions are now in the standard vtable for BtkStyle, so you have
	to create a GObject subclass to write a theme engine.
	(btk_style_copy): fixed a leaked BangoFontDescription
	(btk_style_init): renamed btk_style_realize, so btk_style_init
	can be the standard GObject function.
	
	* Throughout BTK:
	s/style->klass->[xy]thickness/style->[xy]thickness
	s/bango_layout_unref/g_object_unref/

	* btk/btkrc.h, btk/btkrc.c: Converted BtkRcStyle to a GObject.
	
	* btk/btksocket.c: Use bdk_window_get_user_data() instead of 
	accessing BDK internals.

	* btk/btkwidget.c: Use bdk_window_peek_children() instead of 
	accessing BDK internals.

2000-06-18  Elliot Lee  <sopwith@redhat.com>

	* btk/btkwindow.c: Don't allow creation of a window bigger than the screen.

	* btk/btkrange.c: Fix the mega-jumpy-with-lagged-events scrollbar
 	problem by calculating event position relative to the trough
 	rather than the slider.
	* btk/btkdnd.c, btk/btkcolorsel.c: Include FB headers if appropriate.

	* bdk/bdkgc.h: Add BDK_NOR.

	* configure.in, Makefile.am: Add modules top level dir
	* configure.in: Only use bangox library if building x11 target.
	* bdk/bdkdnd.h: Add BDK_DRAG_PROTO_LOCAL enum for future intra-app use.

Fri Jun 16 22:24:22 2000  Christopher Blizzard  <blizzard@redhat.com>

	* btk/btkcolorsel.c: Change private class member to be named
	private_data throughout the file.

	* btk/btkcolorsel.h (struct _BtkColorSelection): Change private to
	private_data to avoid clashing with keyword.

Fri Jun 16 22:24:22 2000  Christopher Blizzard  <blizzard@redhat.com>

	* bdk/bdkdnd.h: Add comment to remove warning.

Sun Jun 18 15:35:35 2000  Pablo Saratxaga <pablo@mandrakesoft.com>

	* btk/btkrc.cp1251,btk/Makefile.am: the cp1251 is also used by
	Byelorussian language; changed the Makefile and file names 
	to reflect that.

Mon Jun 12 16:58:40 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwindow.c (btk_window_unmap): Call bdk_window_withdraw
	rather than bdk_window_hide; this makes things work
	correctly if the window is programmatically hidden while
	iconified.

Sun Jun 11 12:46:19 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkdnd.c (btk_drag_set_default_icon): Fix
	cut and paste typo where wrong pixmap was being
	unref'ed. (Pointed out by a friend of KUSANO Takayuki.)

Sun Jun 11 10:22:36 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkselection.c (btk_selection_bytes_per_item):
	Add helper function to compute format / bytes 
	relationship. Use in a couple places to fix up
	errors which assume 8 * format.

	* btk/btkselection.c (btk_selection_request): Use 32
	rather than 8 * sizeof (BdkAtom), to work correctly
	on Alpha.

Thu Jun  8 21:54:51 2000 Christopher Blizzard  <blizzard@redhat.com>

	* btk/Makefile.am (DEPS): deps include libbtk-x11.la, not
	libbtk.la
	(LDADDS): include libbtk-x11.la and libbdk-x11.la, not the non-x11
	versions

	* btk/btklabel.c (btk_label_get_text): Make sure that the error
	checking macros return NULL since the function has a return value.

Wed Jun  7 15:44:42 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/Makefile.am (LDFLAGS): Add missing backslash that was keeping
	BTK+ from building at all.

	* bdk/Makefile.am (bdk_c_sources): Fix up some indentation issues.

Mon Jun  5 19:32:53 CEST 2000 Paolo Molaro <lupus@linuxcare.com>

	* configure.in, btk-config.in, bdk/Makefile.am, bdk/*/Makefile.am,
	btk/Makefile.am: make it possible to configure btk for different
	targets on the same platform. The library name is now 
	libbtk-$target-$version.so. btk-config accepts a --target x11|nanox|linux-fb
	flag. Only the x11 target compiles right now.
	* bdk/bdkrebunnyion-generic.h, bdk/bdkrebunnyion-generic.c, bdk/bdkpoly-generic.h,
	bdk/bdkpolyreg-generic.c: move generic rebunnyion code in the main BDK dir.
	* bdk/nanox/bdk*generic*: delete generic rebunnyion code.
	* bdk/linux-fb/bdk*generic*: delete generic rebunnyion code.
	* README.nanox: update information.
	
Tue Jun  6 10:53:59 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btktoolbar.c (btk_toolbar_prepend_widget): Fix to
	prepend not append. (Pointed out by Brett Hall.)

Tue Jun  6 01:59:57 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkentry.c (btk_entry_finalize): Unref the entry's layout.

Mon Jun  5 16:00:09 2000  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdk.c (bdk_init_check): Add call to g_type_init() - we'll
	need this later, and this makes sure that the atexit for
	bunnylib gets called after that for BDK, so atexits are
	properly ordered for object leak checking.

	* bdk/bdk.c (bdk_exit_func): Call bdk_windowing_exit().

	* bdk/x11/bdkmain-x11.c (bdk_windowing_exit): Call 
	bango_x_shutdown_display()

	* btk/simple.c (main): Close window on destroy.

Mon Jun  5 11:50:02 2000  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkgc-x11.c (bdk_x11_gc_values_to_xvalues): We need
	to treat initial creation different from setting with 
	regards to the graphics-exposures parameter, so add a parameter
	indicating whether this is initial or not.

Mon Jun  5 13:29:31 2000  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkevents-x11.c: Hack bdk_event_get_graphics_expose()
	to sort of work by adding an extra return_exposes arg
	to bdk_event_translate() - it might be better to simply
	deprecate the function altogether and force people to rewrite
	without it. bdk_window_scroll() handles most of it, and where
	bdk_window_scroll() doesn't work, simply redrawing more does.

	* btk/btkwidget.c (btk_widget_set_default_direction): Fix up
	assertion.

	* btk-config.in: Include BANGO_CFLAGS/LIBS.

	* bdk/x11/bdkevents-x11.c (bdk_event_translate): Remove a 
	bunch of pretty much useless /* Print debugging info */ comments 
	which had drifted away from the code they were commenting.

2000-06-02  Havoc Pennington  <hp@pobox.com>

        * btk/testtextbuffer.c: Test program to make sure BtkTextBuffer
	is in working order.
	
	* btk/testtext.c: Change to reflect anonymous mark API

	* btk/btktextview.c: Convert from mark names to BtkTextMark*.

	* btk/btktexttag.h (struct _BtkTextTag): remove the affects_size
	field, which was unused.

	* btk/btktextmarkprivate.h (BTK_IS_TEXT_MARK): add this macro,
	saves some typing.

	* btk/btktextbuffer.c: Switch from mark names to BtkTextMark*	

	* btk/btktextbtree.c (btk_text_btree_new): set the not_deleteable
	flag on the insertion point and selection bound

	Throughout, use BtkTextMark instead of BtkTextLineSegment, and 
	make mark-manipulation functions take a BtkTextMark* instead of a
	mark name.
	
	* btk/btktextmarkprivate.h: Add a "not_deleteable" flag to 
	BtkTextMarkBody; will be used to detect attempts to delete
	the permanent marks (insert and selection bound)

	* btk/Makefile.am (noinst_PROGRAMS): add testtextbuffer	

Fri Jun  2 12:56:01 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.c (btk_widget_init): Initialize DOUBLE_BUFFERED
	flag to on.

	* btk/btkwidget.c (btk_widget_draw) btk/btkmain.c (btk_main_do_event): 
	Honor DOUBLE_BUFFRED_FLAG

	* btk/btkwidget.c (btk_widget_set_double_buffered): Add a
	function to set the DOUBLE_BUFFERED flag.

	* btk/btkwidget.h: Add BTK_DOUBLE_BUFFERED flag to indicate whether
	or not exposes done on the widget should be double-buffered.

	* btk/btkenums.h (BtkTextDirection): Reverse order of enumerations
	to be what would be expected. (Fixes problem with a
	g_return_if_fail() validating a TextDirection enumeration)

Thu Jun  1 23:05:13 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.c: Remove all references to 
	offscreen flag which was no longer used.

	* btk/btkprivate.h (enum): Remove unused flags and compress.

	* btk/btkframe.c (btk_frame_set_label_widget): Check
	for non-null label_widget->parent.

	* btk/btkentry.c: Get rid of code to deal with BangoAttribute 
	which no longer was used.

	* bdk/bdkbango.c (bdk_bango_context_get_info): make static.

	* bdk/bdkbango.c (bdk_draw_layout[_line]): Add checks
	for null arguments.

	* bdk/x11/bdkgeometry-x11.c (bdk_window_scroll): add
	check for destroyed windows.

Thu Jun  1 13:48:45 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkimmulticontext.c: Add a finalize method and unref
	the slave context there.

	* btk/btkinvisible.[ch]: Make reference counting behavior
	identical to BtkWindow.

Thu Jun  1 01:54:11 2000  Owen Taylor  <otaylor@redhat.com>

	* Makefile.am bdk/bdkbango.c: Copy the layout render function from
	bangox to here, so we can write them independent of rendering
	system, using BDK primitives.

	* bdk/bdkdrawable.h bdk/bdkdraw.c bdk/bdkwindow.c
	bdk/x11/bdkdrawable-x11.c: Remove draw_layout() from the vtable,
	since we have a rendering-system independent implementation in
	terms of draw_glyphs().
	
	* bdk/bdkbango.c bdkdrawable.h (bdk_draw_layout_line): New
	function to render a single line.

	* bdk/x11/bdkbango.c: Move the guts of this file mostly
	into ../bdkbango.c, which simplifies things, since we
	don't have to deal with raw X gc's.

Fri May 19 04:28:16 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btktextlayout.[ch]: Add get_log_attrs() function to
	get the logical attributes for a given BtkTextLine.

Tue May 30 16:05:39 2000  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkfont-x11.c (bdk_font_charset_for_locale): Track
	g_locale_get_codeset() to g_get_codeset() change.

Tue May 30 15:03:19 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/testcalendar.c (calendar_font_selection_ok): Use font
	descriptions.

	* btk/btkentry.c (btk_entry_draw_text): Center text within
	the entry.

	* btk/btkfontsel.c (btk_font_selection_dialog_init): Start of
	redoing (vastly simplifying) for Bango. Still needs quite
	a bit of work. (Size selection is currently poor. List of 
	predefined sizes is not a good idea, since all of these
	sizes won't necessarily be distinct.)

Tue May 30 13:50:19 2000  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkfont-x11.c (bdk_font_charset_for_locale): Handle
	CODESET results for LANG=C.

Mon May 29 15:49:10 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkrc.[ch]: Add a 'font_name' declaration to RC
	which takes a stringized bango font description;
	ignore the older 'font' and 'fontset' declarations.

	* btk/btkstyle.c btk/btkrc.c: Fill in the style->font
	field with a BdkFont derived via bdk_font_from_description(),
	for compatibility. (Should we just remove it entirely?
	Probably too much compatibility breakage, but people
	should be migrating to the new Bango stuff as quickly
	as possible.)

Mon May 29 15:47:41 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkentry.c btk/btkclist.c: s/bango_font_unref/g_object_unref/.

Mon May 29 15:44:46 2000  Owen Taylor  <otaylor@redhat.com>

        * btk/btkcalender.c: Roughly bango-ized. Really needs 
	redoing; there are some bugs in size allocation right
	now, the semi-existant distinction between header / day
	fonts was removed, but, with Bango, could actually
	be made functional in a nice way.
	
	* btk/testcalender: Move calender from examples into this
	directory as a test program. (We really need to restrcture
	testbtk into a whole directory full of tests for every
	widget or functionality group, separated into multiple .c
	files.)

Mon May 29 15:19:56 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/testbtk.c (file_exists): Fix stupid typo that
	was keeping RC file from being loaded.

	* btk/testbtkrc btk/testbtkrc2: Test new bango-ized
	RC file font code.

Mon May 29 14:31:27 2000  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkfont.h bdk/x11/bdkfont-x11.c (bdk_font_from_description):
	Add function to load a BdkFont from a BangoFontDescription.

2000-05-29  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkevents-win32.c (bdk_WindowProc): The local "event"
	variable should be of type BdkEventPrivate.

Fri May 26 17:16:40 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/frame.[ch] btkaspectframe.c: Make frame widgets able
	to have any widget for the label, use a BtkLabel widget
	to display the text. (Based partially on a patch from
	Anders Carlson.)

	(Quite a bit of code reorganization - strip 90% of the
	guts out of btkaspectframe and add a single virtual
	func to BtkFrameClass - compute_child_allocation.)

Fri May 26 12:00:02 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkctree.c btk/btkclist.[ch]: Bangoized.
	(Removed clist->row_center_offset field because caching
	it wasn't saving time or code, added private function
	_btk_clist_create_cell_layout()).

Wed May 24 15:59:37 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkaccellabel.c: Bangoized.

	* btk/[hv]ruler.c: Bangoized

Mon May 22 19:23:59 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkfilesel.c (btk_file_selection_init):
	Use btk_clist_set_column_auto_resize() to remove need
	need for manual column width computations.

Mon May 22 18:50:26 2000  Owen Taylor  <otaylor@redhat.com>

        * btk/btktooltips.[ch]: Replace custom drawing with a BtkLabel, 
	ensuring Bango correctness, and considerably simplifying the
	code.
	
	* btk/btklabel.c btk[hv]scale.c: 1000 => BANGO_SCALE.

	* btk/btklabel.c (btk_label_size_request): Fixed incorrect
	getting of numbers of lines.

	* btk/btklabel.c (btk_label_size_request): Set the requisition
	to the actual requested width of the lable, not to the wrap
	width we set.

	* btk/btktextchild.h: Remove extraneous include of btk/btk.h.

	* btk/btktextbtree.c btk/btktextbuffer.c btk/btktextlayout.c
	  btk/btktextview.c btk/btktextview.[ch]: Fix up includes.

	* btk/btktextview.c: Fix structure inheritance.

	* btk/btkprogressbar.c: Bangoize.

Mon May 22 15:47:30 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btktextview.c (btk_text_view_get_first_para_iter): Encapsulate
	in a function.

	* btk/btktextlayout.c (find_display_line_above): Fixed
	bug with computing line tops.

	* btk/btktextview.c (changed_handler): Fix < , <= confusion.

Thu May 18 18:53:31 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btktextdisplay.c (btk_text_layout_draw): Fix up the x_offset
	and y_offset coordinates to do what we need now. (The offset between
	buffer and layout coordinates has been reintroduced, but is a 
	bit different than before.)

	* btk/btktextview.[ch]: No longer inherit from BtkLayout; instead
	handle the adjustments ourselves, and scroll as necessary using
	the new bdk_window_scroll().
	
	The advantage of this is that when we are incrementally revalidating,
	we are essentially rearranging things around the visible portion
	of the screen. With the old setup, the visible portion of the
	screen was moved around in the layout, so scrolling and redrawing
	to track that caused jumping of the display. Since we now
	control the scrolling ourselves, we can suppress this and
	only redraw when things actually change.

Thu May 18 18:47:25 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btktextbtree.c (redisplay_mark): We need to invalidate
	the rebunnyion not just redisplay it after-all, since we store the
	cursors in the LineDisplay. (Ugly interactions here between
	BtkLayout and BtkTextBTree here.)
	
	* btk/btktextbtree.c (redisplay_rebunnyion): Fixed reversed comparison.

Thu May 18 18:43:21 2000  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkwindow.h bdk/x11/bdkgeometry-x11.c (bdk_window_scroll): 
	Added function to scroll contents of a window while keeping the
	window constant. Works by XCopyArea or guffaw-scrolling depending
	on the details of how the window is set up. (guffaw-scrolling
	still needs to be filled in.)

Wed May 17 22:36:53 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btktextiter.c btk/btkmain.c: Add a debug key for the text widget,
	move the debugging that was tied to a global variable
	to that.

	* btk/btkmarshal.list: Add NONE:INT,INT,INT

	* btk/btktextbtree.[ch] btk/btktextlayout.c: Keep a separate
	validated flag, in line data instead of setting height/width to
	-1. This allows us to perform operations with partially invalid
	buffer (using the old size for invalid lines) and thus to do
	incremental vaidation. Keep height/width aggregates up to date
	when deleting text and rebalancing the tree.

	* btk/btktextbtree.[ch]: Add functions validate a line
	(btk_text_btree_validate_line), and to validate up
	to a number of pixels (btk_text_btree_validate).

	* btk/btktextlayout.[ch]: Add an ::invalidated signal
	that indicates that something is changed and a revalidation
	pass is needed. Change ::need_repaint to ::changed, and
	make it take old and new yranges instead of a rectangle.

	* btk/btktextbtree.[ch] btk/btktextlayout.[ch]: Move
	the line_data_destroy() function from 
	btk_text_btree_add_view() to a virtual function in 
	BtkTextLayout

	* btk/btktextbtree.[ch]: Remove btk_text_btree_get_damage_range(),
	since we are handling partial repaints in a different fashion
	now.

	* btk/btktextbtree.[ch]: Only repaint the changed portion
	of the selection instead of queueing a repaint on the
	entire widget.

	* btk/btktextbuffer.[ch] btk/btktextbtree.[ch]: Move
	get_selection_bounds() down to btree, make the function
	in buffer a wrapper around the btree function.

	* btk/btktextlayout.[ch]: Add functions to check if the
	layout is valid and to recompute either a range of pixels
	aroudn a line or a certain total number of pixels.

	* btk/btktextlayout.[ch]: Cache a single line display;
	now that we only redraw the needed portions, the hit rate
	for this cache is quite high.
	
	* btk/btktextview.[ch]: Keep track of the first paragraph
	on the screen so that when re-laying-out the buffer, we can
	keep the same place. This requires connecting to ::value_changed
	on the adjustments

	* btk/btktextview.[ch]: Add idle functions to revalidate
	the buffer after we receive an ::invalidated signal.
	
Wed May 17 22:10:47 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btklayout.c (btk_layout_size_allocate): Set upper
	to max of allocation and layout size, not just to the
	layout size.

	* btk/btk[hv]scrollbar.c (btk_[hv]scrollbar_calc_slider_size): 
	Invalidate window so it gets redrawn properly.

	* bdk/bdkwindow.c (bdk_window_invalidate_rect): Allow rect == NULL
	to mean the entire window.

	* bdk/bdkevents.h: Move definition for BDK_PRIORITY_REDRAW
	into public header.

Mon May 15 14:51:31 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btktextmark.c (btk_text_mark_get_name): Add function
	to get the name of a mark.

	* btk/btktextlayout.c (btk_text_layout_get_line_at_y): Add a function
	to find the paragraph from a y position.

Thu May 11 12:57:20 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btktextbtree.c (btk_text_btree_node_invalidate_upward): Valid
	nodes have width/height >= 0, not > 0.

Tue May  9 21:29:06 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btktextlayout.[ch] btk/btktextdisplay.c (btk_text_layout_get_line_display):
	Add a size_only flag, so when we only need the size, we don't create
	useless appearance attributes.

	* btk/btktextview.c (btk_text_view_ensure_layout): Remove
	duplicate setting of font description.

	* btk/btkscale.c: Use BANGO_SCALE instead of 1000 

Wed Apr 26 01:53:23 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/Makefile.am (EXTRA_DIST): Add OLD_STAMP into 
	EXTRA_DIST. It does not work well when the file that
	everything depends on is not in the tarball.

Wed Apr 26 00:56:14 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/testbtk.c: Some hacks and fixes so that it basically
	works when not sitting in the BTK+ build tree.

2000-05-03  Havoc Pennington  <hp@redhat.com>

	* btk/btktextbtree.c (btk_text_line_next_could_contain_tag):
	Properly determine the ordering of the tag root and the current
	line within the tree. Previous algorithm only worked if the tag
	root's immediate parent was the common root of both the current
	line and the tag root.

Wed Apr 26 00:43:00 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btktextlayout.c (set_para_values): Fix some bugs in
	alignment.

	* btk/btktextview.c (btk_text_view_ensure_layout): Track
	the widget text directional dynamically.

	* btk/btktextview.[ch]: Added functions to get and set default
	wrap mode.

Tue Apr 25 23:47:38 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btktextlayout.c (btk_text_layout_get_iter_location): Fix bug
	in cursor location computation.

Tue Apr 25 23:22:59 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btklayout.c (btk_layout_set_size): Clamp hadjustment/
	vadjusment values properly when layout gets smaller.

	* btk/btktextview.c (need_repaint_handler): Areas being
	passed in are far completely inaccurate, and sometimes
	too small, so, for now, just queue a redraw on the
	whole visible rebunnyion.

2000-04-25  Havoc Pennington  <hp@redhat.com>

	* btk/btktextbtree.c (summary_destroy): new function to 
	destroy tag summary nodes
	(btk_text_line_next_could_contain_tag): this function was 
	totally broken if the line passed in wasn't below the tag
	root. Fix it.
	(btk_text_btree_first_could_contain_tag): In the tag == NULL 
	"wildcard" case, we have to do a linear scan. Blah.
	(btk_text_btree_last_could_contain_tag): In tag == NULL case,
	we have to do the linear scan
	(tag_removed_cb): When a tag is removed from the tag table, 
	remove the BtkTextTagInfo node from the btree.
	(btk_text_btree_spew): Implement the spew function, for 
	our debugging pleasure.

Tue Apr 25 19:40:18 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btktextlayout.c (btk_text_layout_set_buffer): Fix
	a problem with referring to the wrong buffer.

	* btk/btkentry.c: Fix focus-in/focus-out confusion.

	* btk/btkrc.c btk/btkstyle.c: Moving setting default
	font description to btk_style_new() - otherwise things
	don't work without a .btkrc file.

	* btk/btktextbuffer.c (btk_text_buffer_new): Sink the
	tags table if we create it ourself, too.

	* bdk/bdktypes.h (enum): Move BDK_RELEASE_MASK, since
	it was conflicting with XKB modifiers.

	* btk/btktextview.[ch]: Add simple support for 
	BtkIMContext.

Mon Apr 24 19:34:18 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkentry.c (btk_entry_move_cursor_visually): Fix problem
	with deletion from last commit.

Mon Apr 24 19:29:40 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.c (btk_widget_create_bango_context): Set the language
	in the context from the current locale.
	
	* btk/btkentry.c (btk_entry_size_request): Use language from the
	context, not hardcoded value.

	* btk/btkentry.c (btk_entry_move_cursor): Make character movement visual,
	not logical.

Sun Apr 23 23:39:18 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkentry.c btk/btktextdisplay.c: Don't handle selections as
	attributes - that doesn't handle partial-glyph selection
	properly. Instead use new bango_layout_line_get_x_ranges()
	functionality to draw the selection.

	* btk/btkentry.c: Simplify code since bango_layout_line_index_to_x()
	now properly handles out-of-range coordinates.

	* btk/btktextbuffer.c: Emit "mark_set" when the cursor is moved.

	* btk/btktextiter.h btk/btktextiterprivate.h: Make btk_text_iter_get_line_byte()
	public.

	* btk/btktextlayout.[ch]: Properly set the direction in the BangoContext
	for paragraphs opposite to the base direction of the widget.

	* btk/btktextlayout.[ch] btk/btktextdisplay.c: Fixes for alignment.

	* btk/btktextlayout.c: Don't split segments on marks, since that
	causes Arabic words to reshape as you cursor through.

	* btk/btktextlayout.[ch] btk/btktextview.[ch]: Implement virtual
	cursor position when moving vertically with the arrow keys and
	scrolling with page-up/page-down. (Arrow keys save only the X,
	scrolling saves both X and Y.)

	This means you can line-up / line-down or page-up / page-down
	without losing your place, and also that moving vertically
	with the cursor keys keeps the same X position, not the same
	character count:

	* btk/btktextlayout.[ch] btk/btktextview.[ch]: Make vertical
	arrow keys move by display lines, not paragraphs.

Tue Apr 18 14:16:50 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btklayout.c: Make sure that the bin window is at least
	as big as the allocation. (Should we also make sure that the
	bin window is big enough to completely cover widget->window?)

	* btk/btktextview.c (btk_text_view_get_visible_rect): Add
	function to get the onscreen rectangle.

	* bdk/x11/bdkwindow-x11.c (bdk_window_get_pointer): Correctly account
	for offsets in window coordinates.

Sun Apr 16 16:13:27 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkentry.c (btk_entry_get_cursor_locations): Fix index/offset
	confusion.

	* btk/btktextview.c (btk_text_view_ensure_layout): Set the default direction
	from the widget direction.

	* btk/btktexttag.c btk/btktexttagprivate.h (btk_text_tag_set_arg): 
	Add a "direction" attribute.

	* btk/btktextview.c: global s/tkxt/text_view/.

	* btk/testtext.c: Added long block of text in Arabic, to test out
	the direction attributes. (Some problems with the shaping system
	for arabic become obvious - like the fact the cursor splits words
	into unjoined pieces.)

Fri Apr 14 12:54:34 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btktextdisplay.c (render_layout): Add overstrike handling.

	* btk/btktextlayout.c: Fix up alignment.

	* btk/testtext.c: Add some tests for centering, wrapping.

Fri Apr 14 09:26:22 2000  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkdrawable.h bdk/bdkdraw.c bdk/bdkwindow.c bdk/x11/bdkdrawable-x11.c:
	Add a draw_glyphs() operation to the drawable vtable and bdk_draw_glyphs().
	If we wrote BTK+-specific layout-render function this could just replace
	the draw_layout() operation in the vtable.

	* btk/btkentry.c: Move guts of btk_entry_get_cursor_locations to 
	bango_layout_get_cursor_pos() and use that function.

	* btk/btktextchild.[ch]: add btk_ onto pixmap_segment_new(), since it
	is a non-static symbol.

	* btk/btktextbtree.[ch]: Replace btk_text_btree_find_line_data_by_y()
	with btk_text_btree_find_line_by_y()

	* btk/btktextdisplay.c: Rewrote for Bango - uses a custom layout
	renderer that handles BtkTextAppearance attributes.

	* btk/btktexttag.[ch] btk/btktexttagprivate.h: 

	  - Move the values in the style that don't affect geometry into a
	    BtkTextAppearance structure.
	  - Change underline to take a BangoUnderline and "font" a string
	    representation of a font description
	  - Add a "font_desc" attribute which takes a FontDescription structure.

	* btk/btktextlayout.[ch]:

	  - Get rid of the display-line list per each line. Instead, we
	    generate, on demand, a BtkTextLineDisplay structure which]
	    contains a BangoLayout * and other necesary information
	    (offsets, cursor locations) for displaying a paragraph.
	  - Get rid of the code to wrap lines, create display chunks,
	    etc. Instead, we just go through a paragraph and convert
	    it into the necessary inputs to a BangoLayout.
	  - Implement a new attribute type, BtkTextAttrAppearance. This
	    holds a BtkTextAppearance, and is used to pass colors, 
	    stipple, etc, through from the layout to the display without
	    having to use lots and lots of individual attributes.
	  - Reimplement btk_layout_get_iter_at_pixel() btk_layout_get_iter_pos()
	    in terms of BangoLayout functions.
	
	* btk/btktextview.c: 
	 
	  - Handle passing the necessary BangoContext to the layout
	  - Some fixups in painting to deal with the automatic backing store
	    and offsetting of BTK+-1.4
	  - Add a style_set handler so that the default style reacts
	    properly to theme changes.
	
	* btk/btktext?*.[ch]: Random code-style fixes.

	* btk/testtext.c: Substitute in languages that Bango handles now for Thai

Mon Apr 10 10:33:45 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btktext?*.[ch]: Check in Havoc's port of the Tk text widget,
	in original form preparatory to Bango-ization and bdkimcontext-ization.

Thu Apr  6 19:25:39 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkimcontext.c: Move default implementations to real_* vfuncs,
	so that we can derive from btkimcontext in language bindings properly.

Thu Apr  6 16:02:52 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkimcontextsimple.[ch]: Use bdk_keyval_to_unicode to bdk_unicode_to_keyval.
	Add a compose table including (almost) all the compose combinations
	from X. This is 6k of static, shared data as opposed to 50k or so of dynamic
	data in the XIM implementation.

	* bdk/bdk.h bdk/bdkkeyuni.c bdk/win32/bdkevents-win32.c (bdk_keyval_to_unicode, bdk_unicode_to_keyval):
	Moved functions to convert keyvalues from and to unicode here from
	the win32 port and made them public.

Wed Apr  5 16:37:29 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkeditable.c (btk_editable_insert_text): Allow new_text_length == -1.

Wed Apr  5 16:27:45 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkimcontext.[ch]: Base class for new input context system

	* btk/btkimmulticontext.[ch]: Proxy input context that allows
	the real input context implementation to be loaded from modules
	and switched on the fly.

	* btk/btkcontextsimple.[ch]: Simple implementation of an input
	context that just does direct keysymbol => unicode translation.

	* btk/btkentry.[ch]: Start switching editing over to using
	BtkInputContext. (No handling of preedit yet.)

Wed Apr  5 15:48:41 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btktypeutils.h (BTK_CHECK_GET_CLASS): Fix problem with one too
	many substitutions. (klass should not be subsituted.)

Wed Apr  5 00:18:14 2000  Owen Taylor  <otaylor@redhat.com>

	* configure.in: Add checks for Bango

	* configure.in docs/Makefile.am: Add test for sgml2html
	and allow 'make dist' without building html, but print out
	warnings in that case. (For making snapshots)

	* bdk/Makefile.am bdk/x11/Makefile.am btk/Makefile.am:
	Add Bango libraries and C flags

	* bdk/bdkdraw.c bdk/bdkdrawable.h bdkwindow.c bdk/x11/bdkdrawable-x11.c:
	Add function (bdk_draw_layout) to draw a bango layout.

	* bdk/bdkbango.h bdk/x11/bdkbango-x11.c: New file with functions
	for getting Bango contexts for BDK.

	* btk/btkeditable.c: Get rid of dead code btk_editable_parent_set()

	* btk/btkentry.[ch]: Complete rewrite to use Bango, add bidirectional
	editing.

	* btk/btkentry.c: Hack in simple Hebrew input with direct
	keysym => unicode translations. More languages can be added
	here, but real input-method support is needed.

	* docs/Changes-1.4.txt: Added note about entry behavior.
	
	* btk/btkenums.h btk/btkwidget.[ch] testbtk.c btkprivate.h: Add functions
	to set the reading direction for a widget and the global direction.
	Add test which allows toggling the global direction. Two private
	flags are used to store the direction. (BTK_DIRECTION_SET + BTK_DIRECTION_LTR)

	* btk/btkcheckbutton.c btk/btkframe.c btk/btkhbbox.c btk/btkhbox.c
	  btk/btkradiobutton.c btk/btkspinbutton.c btk/btktable.c 

	* btk/btk[hv]scale.c btk/btkscale.[ch]: Draw numbers using Bango

	* btk/btklabel.[ch]: Moved to Bango and considerably rewritten. Line breaking,
	underlining now handled by Bango.

	* btk/btkstyle.[ch] btk/btkrc.[ch]: Add a BangoFontDescription
	to RCStyle and Style. (Having both this and the old font name and BdkFont 
	is temporary.)

	* btk/btkwidget.[ch] (btk_widget_create_bango_{context,layout}): Added 
	convenience functions for creating contexts and layouts for widgets.

	* btk/testbtk.c: Enhance label tests with multilingual labels.

2000-05-29  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkclist.c (btk_clist_column_titles_active): let you set the
	titles to be active, even if they aren't visible.
	(btk_clist_column_titles_passive):  Ditto.

2000-05-21  Nils Barth  <nils_barth@post.harvard.edu>

	* btkmenu.c:
	* btkmenu.h:
	* btktypeutils.h: Spelling/grammar fixes in comments.

Tue May 23 12:25:07 CEST 2000 lupus <lupus@debian.org>

	* bdk/nanox/*.h: add missing header files.

Fri May 19 11:52:59 2000  Tim Janik  <timj@btk.org>

	* btk/btkdrawingarea.c (btk_drawing_area_send_configure): set
	send_event to TRUE.
	(btk_drawing_area_size): queue a resize.

Sun Mar 26 03:21:28 2000  Tim Janik  <timj@btk.org>

        * btk/btksignal.c (btk_signal_handlers_destroy): when unref-ing
        the handlers, also invalidate them. bug nailed down by Karl Nelson
        <kenelson@ece.ucdavis.edu>.

Fri May 19 06:49:23 2000  Tim Janik  <timj@btk.org>

	* btk/btkfontsel.c (btk_font_selection_get_font_name): handle
	"(nil)" foundries, patch from Grigorios Magklis.

	* btk/btkfontsel.c (btk_font_selection_load_font): don't crash
	on non-available fonts, based on a patch by Grigorios Magklis
	<maglis@cs.rochester.edu>.

2000-05-18  Elliot Lee  <sopwith@redhat.com>

	* bdk/x11/bdkrebunnyion-generic.c: If a rebunnyion does not have any
 	rectangles, or if the specified rectangle is not in the rebunnyion, then return BDK_OVERLAP_RECTANGLE_OUT
	instead of BDK_OVERLAP_RECTANGLE_IN.

2000-05-17  Jonathan Blandford  <jrb@redhat.com>

	* btk/btklayout.c (btk_layout_map): Remove references to
	OFFSCREEN, as it is no longer necessary.

Wed May 17 10:52:12 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkcolorsel.c: Patch from David Santiago
	<mrcooger@cyberverse.com> to change things so that the 
	indicator of the active palette entry is done independently,
	not via the focus, since it should always be visible.

2000-05-17  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkevents-win32.c (bdk_event_translate): Plug same
	refcount leaks as in the X11 backend.

	* bdk/win32/bdkgc-win32.c (bdk_win32_gc_set_values): Logging
	cosmetics.

	* bdk/win32/bdkwindow-win32.c: Similar changes as in X11
	backend. Add _bdk_windowing_window_destroy().

	* btk/btkcolorsel.c: Include correct backend-specific header.
	Don't use XColor unless on X11. (No BDK_VISUAL_STATIC_COLOR
	either, but these probably do exist on nanox?)
	
	* btk/btkhsv.c: Use G_PI (fresh from <bunnylib.h>) instead of M_PI
	which isn't necessarily defined by <math.h>.

	* btk/btkobject.c (btk_object_init): Don't go up the class
	ancestry past BtkObject.

	* btk/btktypeutils.h: Mark BTK_TYPE_IDENTIFIER for export/import
	from DLL on Win32.

	* btk/btk.def: Update corresponding to recent changes.

	* btk/makefile.{cygwin,msc}: Updates.

Fri May 12 18:46:51 2000  Owen Taylor  <otaylor@redhat.com>

	* docs/Changes-1.4.txt: A bit of editing.

	* bdk/bdkwindow.c (_bdk_window_clear_update_area) 
	* bdk/x11/bdkwindow-x11.c (bdk_window_hide): Add a function
	to clear the update area for the window, and clear it
	when hiding a window.

	* bdk/bdkwindow.c (bdk_window_begin_paint_rebunnyion): Ignore
	if window destroyed.

	* bdk/bdkwindow.c (bdk_window_end_paint): Likewise.

	* bdk/bdkwindow.c bdk/x11/bdkwindow-x11.c bdk/bdkinternals.h: Move 
	bdk_window_destroy() to the generic code, since there was a lot of 
	window-system-independent logic it in. Add a function:
	
	 _bdk_window_destroy() 

	to the internal API to destroy a window without unreferencing it.
	Add a function:

	 _bdk_windowing_window_destroy()

	That does the windowing-system-dependent part of destroying 
	the window.

Fri May 12 11:07:41 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/testbtk.c: Fix various memory leaks of pixmaps.

Fri May 12 11:06:10 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.c docs/Changes-1.4.txt (btk_widget_shape_combine_mask): 
	Make btk_widget_shape_combine_mask() keep a reference count on
	the pixmap since it keeps it around.

Fri May 12 10:53:29 2000  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkwindow.c (bdk_window_process_updates_internal): Fix refcount
	leak.

	* bdk/x11/bdkevents-x11.c (bdk_event_translate): Fix refcount
	leak with event filters.

Thu May 11 14:29:44 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkdnd.c (btk_drag_dest_set_internal): Remove the
	signal handlers with the right data arguments. (Fixes
	some warnings when a widget was repeatedly set as a drag
	destination.)

	* bdk/x11/bdkdnd-x11.c (bdk_window_register_dnd): Set data on the
	window so we can avoid avoid setting the DND properties on the
	toplevel window repeatedly.

2000-05-13  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkwin32.h: Define more message types missing from
	mingw headers.

	* bdk/win32/bdkevents-win32.c (bdk_event_translate): On WM_DESTROY
	call bdk_window_destroy_notify(). It was never called. This
	probably meant that the BdkWindow was never freed. Thanks Owen for
	noticing (!).

	* bdk/win32/bdkwindow-win32.c (bdk_window_internal_destroy): Mark
	window as destroyed before calling DestroyWindow(). DestroyWindow()
	causes a call to the window procedure (bdk_WindowProc), which
	calls bdk_event_translate(), which calls
	bdk_window_destroy_notify(), which gets confused unless the window
	is set as destroyed.

	* bdk/win32/bdkcolor-win32.c (bdk_win32_color_to_string): Rename
	this function to indicate it's win32 only. Put inside #ifdef
	G_ENABLE_DEBUG.

	* bdk/win32/bdkevents-win32.c (bdk_win32_message_name): New
	debugging function. (bdk_event_translate:) Add a default branch
	that uses the above function to print debug messages with all
	Windows messages symbolically.

	* bdk/win32/bdkprivate-win32.h: Declare it, and
	bdk_win32_color_to_string, but only if G_ENABLE_DEBUG.

Fri May 12 20:07:32 2000  Tim Janik  <timj@btk.org>

	* btk/btkcolorseldialog.c: don't include btk/btkintl.h in a
	public header file.

Fri May 12 17:13:32 2000  Tim Janik  <timj@btk.org>

	* docs/Changes-1.4.txt: documented necessary changes for 1.4 transition.

	* btk/btktext.c: made the adjustments no-construct args, simply
	provide default adjustments.
	(btk_text_destroy): release adjustments.

	* btk/btkprogressbar.c (btk_progress_bar_class_init): made the
	adjustment argument non-construct.

	* btk/btkprogress.c (btk_progress_destroy): release adjustment here,
	instead of in finalize.
	(btk_progress_get_text_from_value): 
	(btk_progress_get_current_text): 
	(btk_progress_set_value): 
	(btk_progress_get_percentage_from_value): 
	(btk_progress_get_current_percentage): 
	(btk_progress_set_percentage): 
	(btk_progress_configure): ensure an adjustment is present.

Thu May 11 01:24:08 2000  Tim Janik  <timj@btk.org>

	* btk/btkcolorsel.[hc]:
	* btk/btkcolorseldialog.[hc]:
	* btk/btkhsv.[hc]: major code cleanups, destroy handlers need to chain
	their parent implementation, use bit fields for boolean values, don't
	create unused widgets, usage of bunnylib types, braces go on their own
	lines, function argument alignment, #include directives etc. etc. etc..

	* btk/Makefile.am (btk_public_h_sources): install btkhsv.h.

Wed May 10 23:29:52 2000  Tim Janik  <timj@btk.org>

	* btk/btktoolbar.c (btk_toolbar_destroy): don't unref a NULL tooltips.

	* btk/btkfilesel.c (btk_file_selection_destroy): don't free a cmpl_state
	of NULL.

	* btk/btkcombo.c (btk_combo_item_destroy): don't keep references
	to freed data.
	(btk_combo_destroy): don't keep a pointer to a destroyed window.

	* btk/btkmenu.c (btk_menu_init): reset the menu's toplevel pointer
	to NULL when the toplevel is getting destroyed.
	(btk_menu_set_tearoff_state): same here for the tearoff_window.
	(btk_menu_destroy): 
	(btk_menu_init): store the information of whether we have to
	readd the initial child ref_count during destruction in a new
	BtkMenu field needs_destruction_ref_count.

	* btk/btkviewport.c: SHAME! ok this one is tricky, so i note it
	here, those reading: learn from my mistake! ;)
	in order for set_?adjustment to support a default adjustemnt if
	invoked with an adjustment pointer of NULL, the code read (pseudo):
	if (v->adjustment) unref (v->adjustment);
	if (!adjustment) adjustment = adjustment_new ();
	if (v->adjustment != adjustment) v->adjustment = ref (adjustment);
	now imagine the first unref to actually free the old adjustment and
	adjustment_new() creating a new adjustment from the very same memory
	portion. here, the latter comparision will unintendedly fail, and
	all hell breaks loose.
	(btk_viewport_set_hadjustment):
	(btk_viewport_set_vadjustment): reset viewport->?adjustment to NULL
	after unreferencing it.

	* btk/btkcontainer.[hc]: removed toplevel registration
	functions: btk_container_register_toplevel(),
	btk_container_unregister_toplevel() and
	btk_container_get_toplevels() which had wrong semantics
	anyways: it didn't reference and copy the list.

	* btk/btkwindow.c: we take over the container toplevel registration
	bussiness now. windows are registered across multiple destructions,
	untill they are finalized. the initial implicit reference count
	users are holding on windows is removed with the first destruction
	though.
	(btk_window_init): ref & sink and set has_user_ref_count, got
	rid of btk_container_register_toplevel() call. add window to
	toplevel_list.
	(btk_window_destroy): unref the window if has_user_ref_count
	is still set, got rid of call to
	btk_container_unregister_toplevel().
	(btk_window_finalize): remove window from toplevel list.
	(btk_window_list_toplevels): new function to return a newly
	created list with referenced toplevels.
	(btk_window_read_rcfiles): use btk_window_list_toplevels().

	* btk/btkhscale.c (btk_hscale_class_init): made the BtkRange
	adjustment a non-construct arg.
	* btk/btkvscale.c (btk_vscale_class_init): likewise.
	* btk/btkhscrollbar.c (btk_vscrollbar_class_init): likewise.
	* btk/btkvscrollbar.c (btk_vscrollbar_class_init): likewise.

	* btk/btkrange.c: added some realized checks.
	(btk_range_destroy): get rid of the h/v adjustments in the
	destroy handler instead of finalize. remove timer.
	(btk_range_get_adjustment): demand create adjustment.

	* btk/btkviewport.c: made h/v adjustment non-construct args.
	we simply create them on demand now and get rid of them in
	the destroy handler.
	(btk_viewport_destroy): get rid of the h/v adjustments in the
	destroy handler instead of finalize.
	(btk_viewport_get_hadjustment): 
	(btk_viewport_get_vadjustment): 
	(btk_viewport_size_allocate): demand create h/v adjustment
	if required.

	* btk/btkwidget.c (btk_widget_finalize): duplicate part of the
	btk_widget_real_destroy () functionality.
	(btk_widget_real_destroy): reinitialize with a new style, instead
	of setting widget->style to NULL.

Fri May  5 13:02:09 2000  Tim Janik  <timj@btk.org>

	* btk/btkcalendar.c:
	* btk/btkbutton.c: ported _get_type() implementation over to
	GType, either to preserve memchunks allocation facilities,
	or because Btk+ 1.0 BtkTypeInfo was still being used.

	* btk/btkobject.[hc]: derive from GObject. ported various functions
	over. prepare for ::destroy to be emitted multiple times.
	removed reference tracer magic. chain into GObjectClass.shutdown()
	to emit ::destroy signal.

	* btk/btksignal.c: removed assumptions about BTK_TYPE_OBJECT being
	fundamental.

	* btk/btkmain.c: removed btk_object_post_arg_parsing_init()
	cludge.

	* btk/btksocket.c:
	* btk/btkplug.c:
	* btk/btklayout.c:
	* btk/btklabel.c:
	* btk/btkargcollector.c:
	* btk/btkarg.c: various fixups to work with BTK_TYPE_OBJECT
	not being a fundamental anymore, and to work with the new
	type system (nuked fundamental type varargs clutter).

	* btk/*.c: install finalize handlers in the GObjectClass
	part of the class structure.
	changed direct BTK_OBJECT()->klass accesses to
	BTK_*_GET_CLASS().
	changed direct object_class->type accesses to BTK_CLASS_TYPE().

	* btktypeutils.[hc]: use the reserved fundamental ids provided by
	GType. made most of the BTK_*() type macros and Btk* typedefs
	simple wrappers around macros and types provided by GType.
	most notably, a significant portion of the old API vanished:
	BTK_TYPE_MAKE(),
	BTK_TYPE_SEQNO(),
	BTK_TYPE_FLAT_FIRST, BTK_TYPE_FLAT_LAST,
	BTK_TYPE_STRUCTURED_FIRST, BTK_TYPE_STRUCTURED_LAST,
	BTK_TYPE_ARGS,
	BTK_TYPE_CALLBACK,
	BTK_TYPE_C_CALLBACK,
	BTK_TYPE_FOREIGN,
	BtkTypeQuery,
	btk_type_query(),
	btk_type_set_varargs_type(),
	btk_type_get_varargs_type(),
	btk_type_check_object_cast(),
	btk_type_check_class_cast(),
	btk_type_describe_tree(),
	btk_type_describe_heritage(),
	btk_type_free(),
	btk_type_children_types(),
	btk_type_set_chunk_alloc(),
	btk_type_register_enum(),
	btk_type_register_flags(),
	btk_type_parent_class().
	replacements, where available are described in ../docs/Changes-1.4.txt.
	implemented compatibility functions for the remaining API.

	* configure.in: depend on bunnylib 1.3.1, use bobject module.

Thu May 11 12:39:50 2000  Owen Taylor  <otaylor@redhat.com>

	* TODO.xml: Various updates to current status.

Wed May 10 20:25:04 2000  Owen Taylor  <otaylor@redhat.com>

	* btk.m4: Print out version when test succeeds.

Wed May 10 16:38:17 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/Makefile.am docs/Changes-1.4.txt btk/btkcolorsel.[ch]
	btk/btkhsv.[ch]: Color selection dialog rewrite.
	
	(Original triangle color selector from Simon Budig
	<Simon.Budig@unix-ag.org>, Cleaned up and rewritten for BTK+ by
	from Jonathan, Havoc, and Federico. Merge into BTK+ done by David
	Santiago <mrcooger@cyberverse.com>)

	* btk/btkcolorseldialog.[ch]: Split color selection dialog
	out into a separate widget.

	* btk/testbtk.c: Add some checkbuttons for toggling palette
	and opacity controls.

Wed May 10 16:08:09 2000  Owen Taylor  <otaylor@redhat.com>

	* configure.in (BTK_LIBS_EXTRA): Remove references to bobject that 
	snuck in prematurely.

2000-05-07  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkevents-win32.c (bdk_event_translate): Fix typo. I
	had deleted a ! operator by mistake, which caused
	BDK_SELECTION_CLEAR events never to be generated, which caused
	only the first copy to the clipboard from an btkeditable to
	actually cause a copy to the Windows clipboard.

2000-05-06  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkdnd-win32.c: Enable shortcut resolution for gcc
	compilation, too. Current mingw gcc distributions include the
	necessary headers. Also the necessary IIDs are now in mingw
	headers/libraries, and own definitions unnecessary.

	More hacking on OLE2 DND, still doesn't work though, and thus
	ifdeffed out.

	* bdk/win32/bdkwindow-win32.c: Remove bdk_window_clear() from
	here, too.

Sat,  6 May 2000 13:31:34 +0200 Paolo Molaro <lupus@linuxcare.com>

	* bdk/nanox/*: nano-X port work in progress.
	* bdk/simple.c: simple test for Bdk.
	* README.nanox: notes about the port: read this first!
	* btk/btk{dnd,plug,selection,window}.c: minimal changes to make btk compile
	with nano-X.

Fri May  5 11:18:47 2000  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkwindow.c bdk/x11/bdkwindow-x11.c (bdk_window_clear): Move
	bdk_window_clear() into common code, implement in terms of
	bdk_window_clear_area(). (Fixes bug where bdk_window_clear() was
	not redirected to the backing rectangle.

Wed Apr 26 01:53:23 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/Makefile.am (EXTRA_DIST): Add OLD_STAMP into 
	EXTRA_DIST. It does not work well when the file that
	everything depends on is not in the tarball.

Tue Apr 25 22:20:41 2000  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkwindow.c (bdk_window_process_updates_internal): Fix error
	with recursion where process_updates() is called from
	an expose handler. (BtkTextView is highly broken in
	doing this, but it should work, so it is a nice test
	case.)

Sun Apr 23 23:39:18 2000  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkwindow.c (bdk_window_process_updates_internal): Gracefully
	handle the case where updates are queued during processing of
	updates.

Tue Apr 18 14:16:50 2000  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkwindow-x11.c (bdk_window_foreign_new): We already assume
	window is on bdk_display - use that instead of segfaulting.

Thu May  4 02:04:46 2000  Tim Janik  <timj@btk.org>

        * configure.in (STRIP_DUMMY): some Make 3.79 $(strip ) versions are
        broken and require an empty arg, give it to them.

Fri Apr 28 19:34:32 2000  Tim Janik  <timj@btk.org>

	* btk/btklabel.h: indentation fixes.

2000-05-02  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkdrawable-win32.c (bdk_win32_draw_arc): Don't try to
	draw too narrow or too low arcs, they seem to fail, at least with
	some display drivers.

	* bdk/bdk.c (bdk_init_check): Use G_DIR_SEPARATOR.

	Large changes to the Win32 backend, partially made necessary by
	the changes to the backend-independent internal
	structures. Attempts to implement similar backing store stuff as
	on X11. The current (CVS) version of the Win32 backend is *not* as
	stable as it was before the no-flicker branch was merged. A
	zipfile with that version is available from
	http://www.gimp.org/win32/. That should be use by "production"
	code until this CVS version is usable. (But note, the Win32
	backend has never been claimed to be "production quality".)

	* README.win32: Add the above comment about versions.

	* bdk/bdkwindow.c: Don't use backing store for now on Win32.

	* bdk/bdk.def: Update.

	* bdk/bdkfont.h: Declare temporary Win32-only functions. Will
	presumably be replaced by some more better mechanism as 1.4 gets
	closer to release shape.

	* bdk/makefile.{cygwin,msc}: Update.

	* bdk/win32/*.c: Correct inclusions of the backend-specific and
	internal headers. Change code according to changes in these. Use
	bdk_drawable_*, not bdk_window_* where necessary.

	* bdk/win32/bdkdnd-win32.c: Use MISC selector for BDK_NOTE, not
	our old DND.

	* bdk/win32/bdkdrawable-win32.c (bdk_win32_draw_text): Don't try
	to interpret single characters as UTF-8. Thanks to Hans Breuer.
	Use correct function name in warning messages.

	* bdk/win32/bdkevents-win32.c: Use correct parameter lists for the
	GSourceFuncs bdk_event_prepare and bdk_event_check.
	(bdk_event_get_graphics_expose): Do implement, use
	PeekMessage. Thanks to Hans Breuer.
	(event_mask_string): Debugging function to print an BdkEventMask.
	(bdk_pointer_grab): Use it.

	* bdk/win32/bdkfont-win32.c: The Unicode subrange that the
	(old) book I used claimed was Hangul actually is CJK Unified
	Ideographs Extension A. Also, Hangul Syllables were missing.
	Improve logging.

	* bdk/win32/bdkgc-win32.c: Largish changes.

	* bdk/win32/bdkim-win32.c (bdk_set_locale): Use
	g_win32_getlocale() from GLib, and not setlocale() to get current
	locale name.

	* bdk/win32/bdkprivate-win32.h
	* bdk/win32/bdkwin32.h: Move stuff from bdkprivate-win32.h to
	bdkwin32.h, similarily as in the X11 backend.

	* bdk/win32/bdkwindow-win32.c (bdk_propagate_shapes): Bugfix,
	assignment was used instead of equals in if test. Thanks to Hans
	Breuer.

	* bdk/win32/bdkgeometry-win32.c: New file, just a quick hack of
	the X11 version.

	* bdk/win32/makefile.{cygwin,msc}
	* btk/makefile.{cygwin,msc}: Updates. Better kludge to get the
	path to the Win32 headers that works also with the mingw compiler.

	* btk/btkstyle.c: Include <string.h>.

2000-04-26  Havoc Pennington  <hp@redhat.com>

	* btk/btklabel.c (btk_label_get_text): Add this function,
	replacing the broken btk_label_get ()

2000-04-15  Havoc Pennington  <hp@pobox.com>

	* bdk/bdkdnd.h: clean up enum format, remove extra comma, 
	this keeps scanner scripts from getting confused.

	* bdk/bdkdraw.c (bdk_drawable_get_data): This should return the
	data, rather than void

2000-04-15  Tor Lillqvist  <tml@iki.fi>

	* btk/btkclist.c (btk_clist_motion)
	* btk/btklist.c (btk_list_motion_notify): If we get a motion event
	with is_hint FALSE, get x and y from the event. They used to be
	used uninitialised. The Win32 backend never sends motion events
	marked as hints. This for instance fixes the annoying file and
	font selector behaviour in the Win32 version.

2000-04-14  Tor Lillqvist  <tml@iki.fi>

	* btk/btksignal.c: (Win32:) Export the btk_private_signals and
	btk_private_n_signals variables, they are used by some software,
	sigh.

	* btk/btkrc.c (get_btk_sysconf_directory): (Win32:) Fetch the
	installation directory from the Registry, where the installer
	should have put it.

Fri Apr  7 17:19:27 2000  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/Makefile.am: Fix problem with installation directory for
	bdkx.h

	* btk/btkmenuitem.c btk/btkmenushell.c: Patch from David Santiago
	<mrcooger@cyberverse.com> so that when selecting menus with the
	mouse, the first item will not be selected, but when selecting
	with an accelerator, or navigating left-right on a menubar with
	the menus popped up, the first item will be selected.

2000-04-05  Dan Damian  <dand@dnttm.ro>

	* configure.in: Added "ro" to ALL_LINGUAS.

Wed Apr  5 00:08:36 2000  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkgc-x11.c (_bdk_x11_gc_new): Fix screwy
	indentation.

	* Makefile.am (EXTRA_DIST): Fix typo.

	* bdk[/x11]/Makefile.am (INCLUDES): Add $(top_builddir)/bdk
	to catch bdkconfig.h

	* btk/btkitemfactory.c: Added FIXME.

2000-03-30  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkpaned.c (btk_paned_get_position): oops.
	s/return_if_fail/return_val_if_fail/g and add a return value.

Mon Mar 27 20:56:14 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.c (btk_widget_queue_clear_area): Fix up 
	merge slipup.

	* bdk/bdkinput.h: Fix missing line from merge.

Mon Mar 27 20:39:49 2000  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkcolor.c cursor.c bdkdraw.c bdkfont.c: Include bdkinternals.h
	instead of bdkprivate.h.

Sun Mar 12 15:19:24 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkinputdialog.h (struct _BtkInputDialogClass): Fix
	parent class to correctly be BtkDialogClass.

Thu Feb 24 23:58:21 2000  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkgeometry-x11.c: Don't worry about clipping of
	toplevel windows and their immediate children by their parents,
	since the size of toplevel windows is out of our immediate
	control and we don't get any real benefit from trying to track
	this size for clipping.

	* bdk/bdkprivate.h (struct _BdkWindowPrivate) bdk/x11/bdkwindow-x11.c : Add a flag
	for input_only windows.

	* bdk/bdkwindow.c bdk/x11/bdkgeometry-x11.c: Use the above flag
	to fix some hacks and make sure that we don't try to set the
	background of input only windows.

Thu Feb 24 18:11:46 2000  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkinternals.h bdk/bdkprivate.h bdk/Makefile.am: Add a header file for
	the _really_ internal stuff, and leave bdkprivate.h for the fake private
	stuff that we've traditionally exposed.

	* bdk/**.c: Use bdkinternals.h where appropriate.

	* bdk/x11/bdkx.h bdk/x11/bdkprivate-x11.h bdk/x11/*.c: Make bdkx.h
	not include bdkprivate-x11.h, move all stuff of conceivable public
	interest into bdkx.h; keep all really private stuff in
	uninstalled header bdkprivate-x11.h.

	* bdk/bdkdraw.c bdk/bdkwindow.c bdk/bdkinternals: Redirect all calls to
	image->image_put on windows through a new function _bdk_window_draw_image()
	to allow us to do backing store for images. (Sort of ugly)

	* bdk/bdkgc.c bdk/bdkprivate.h: Cache the ts and clip origins for graphics
	contexts locally so that we can offset them properly when drawing 
	onto backing pixmaps.

	* bdk/bdkinput.h: Reindented

	* bdk/bdkprivate.h bdk/x11/bdkwindow-x11.c: Store the background
	pixmap or color for the window, so we can properly initialize
	our double-buffer pixmaps, and also so that we temporarily set
	a background of None while scrolling.

	* bdk/bdkrebunnyion.h: Revise rebunnyion boolean operators to have an
	interface that is actually convenient - switch from creating new
	rebunnyions	on every op, to "methods" that modify existing rebunnyions
	(A = A OP B). 3 argument forms which allow dest == src, would also
	be possible, but the current interfaces seem to map nicely
	onto what needs to be done. (There is quite a lot of rebunnyion
	code in BDK now.)

	* bdk/bdkrebunnyion.h: Add constructor from rectangle and a copy
	operator.

	* bdk/x11/{bdkrebunnyion-generic.[ch],bdkpolyreg-generic.c,
	bdkpoly-generic.h: Copy rebunnyion code from Xlib, switch it over
	to 32 bit coordinates, modify it to be mostly BTK+ style
	and to have interfaces that match bdkrebunnyion.h.

	* bdk/bdkwindow.c bdk/bdkprivate.h: Add facility for
	double-buffered	drawing. bdk_window_begin_paint_{rect,rebunnyion}()
	create a backing pixmap and redirect all drawing to
	that backing pixmap until a matching bdk_window_end_paint().

	* bdk/bdkwindow.[ch] bdk/bdkinternals.h bdk/x11/bdkdrawable-x11.c:
	Create a special drawable class for BtkWindow's that 
	redirects the drawing to the backing pixmap as necessary
	and then calls the real operations in _bdk_windowing_window_class.

	* bdk/bdkprivate.h bdk/bdkwindow.[ch] bdk/x11/bdkevents-x11.c:
	Store invalid rebunnyion for each window. Generate expose events for invalid
	rebunnyion in an idle. This replaces both the expose compression
	and the redrawing queuing in BTK+. It is both more efficient and
	simpler than either one individually and far more so then the
	combination.

	* bdk/x11/bdkgeometry.c bdk/x11/bdkwindow.c bdk/x11/bdkprivate-x11.h:
	Emulate 32 bit coordinates for windows with 16 bit coordinates
	by offsetting drawing, guffaw scrolling techniques and
	mapping/unmapping child windows as necessary.

	* bdk/bdkwindow.[ch] bdk/x11/bdkgeometry.c: Add anti-exposes,
	where, when invalid rebunnyions are processed, the rebunnyion is stored,
	and if expose events come in that are detectably duplicate
	the processed exposes (by comparison of event serial numbers),
	the stored rebunnyion is subtracted out of those exposes.

	* bdk/x11/bdkgeometry.c: Temporarily unset backing pixmaps of
	rebunnyions newly exposed when scrolling or resizing windows.
	This, combined with forcing processesing of queued invalidated
	rebunnyions, gives nice flicker-free scrolling.

	* btk/btklayout.c btk/btkviewport.c: Force processing of
	invalidated rebunnyions after every scroll.

	* btk/btklayout.c: Vastly simplify using the new 32 bit coordinate
	emulation in BDK. Its, for all practical purposes just a
	BtkViewport/BtkFixed hybrid now.

	* bdk/bdkdrawable-x11.c: Convert from BDK (32 bit) to X11
	(16-bit) structures as necessary instead of just casting.

	* bdk/x11/bdkgc-x11.c bdk/x11/bdkx.h: Replace XSetRebunnyion with code
	in terms of the structures from bdkrebunnyion-generic.c, using appropriate
	offsets from BDK to X11 coordinates. Cache clip mask and
	origin and ts origin locally and only flush to the server
	when drawing, to avoid constantly setting and resetting these
	values when offsetting GC's for scrolling and backing pixmaps.

	* bdk/x11/bdkinput-x11.c: Fix leak of axes structures.

	* btk/btkcontainer.c: Call process_all_updates at end
	of resizing to reduce flicker. (Avoids having redraw
	lag arbitrarily behind resize under some circumstances)

	* btk/btkentry.c: Remove old backing store code, and simply take
	advantage of the new backing store capabilities of BDK.

	* btk/btkmain.c: Simple implementation of widget backing
	store - simply push a paint while handling each expose.
	(Should really be configurable widget for widget.)
	
	* btk/btkwidget.c: Remove all the old complicated redraw
	code, and simply invalidate the BDK windows from
	bdk_window_queue_clear(), etc. (Sigh, so much carefully
	debugged complexity ... gone to the winds.)

	Remove all the code for suppressing expose events while
	resizes are pending; this isn't needed since the invalid
	areas won't be processed until after the resizes are
	processed, since they are in a lower priority idle.

Thu Feb 24 15:37:41 2000  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkrectangle.c (bdk_rectangle_intersect): Set width
	and height of dest rectangle for non-intersecting rectangles.

Sun Feb 20 16:47:31 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.h: Make BtkAllocation just a typedef
	for BdkRectangle.

Sun Feb 20 11:27:00 2000  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdk{events,image,private,types,window}.h
	 bdk/x11/bdkinputprivate.h: Change all coordinates
	 from int16 to int. Also, Change width and height from
	 unsigned to signed to avoid all the stupid C 
	 signedness bugs.

Sat Feb 19 12:01:53 2000  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkdrawable-x11.c (bdk_x11_draw_drawable):
	Use bdk_drawable_get_depth instead of bdk_drawable_get_visual.
	Add some more detailed checking.

	* bdk/bdkdraw.c bdk/bdkdrawable.h (bdk_drawable_get_depth):
	New function to retrieve the depth of a drawable.

	* bdk/bdkprivate.h (struct _BdkDrawablePrivate): Add a depth
	field, reorder fields to save memory. 

Mon Dec 13 14:06:03 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btkentry.c (btk_entry_draw_cursor_on_drawable): Draw a small portion
	of the background image instead of scaling the background down to
	a line.

	* btk/btk[hv]scrollbar.c (btk_hscrollbar_size_allocate): Removed mysterious
	which temporarily set slider to wrong size.

	* btk/btkaspectframe.c btkbin.c: Remove unecessary calls to
	queue_clear().

Wed Nov 17 18:36:05 1999  Owen Taylor  <otaylor@redhat.com>

2000-03-23  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkpaned.c (btk_paned_get_position): add getter.

2000-03-17  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkevents-win32.c: Remove the #ifndef
	USE_DISPATCHMESSAGE sections, we do want to use DispatchMessage.

	* bdk/win32/bdkfont-win32.c
	* bdk/win32/bdkproperty-win32.c
	* bdk/win32/bdkselection-win32.c
	* bdk/win32/bdkwindow-win32.c: Add const to some arguments that are
	now declared such.

Wed Mar 15 02:59:38 PST 2000 Manish Singh <yosh@gimp.org>

	* btk/btkvpaned.c: removed stray gutter_size reference, a 1.2 relic

Mon Mar 13 18:37:55 2000  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkdnd.c: Fix a bunch of cases where XGetWindowProperty()
	is called without trapping X errors.

Fri Feb 25 10:48:53 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkrc.*: Fix problem where stray '"' characters found their
	way into the fontset lists.

Tue Feb 22 08:52:52 2000  Tim Janik  <timj@btk.org>

	* btk/btkthemes.h: add extern "C" scope.

Mon Feb 21 20:16:42 2000  Lars Hamann  <lars@btk.org>

	* btk/btkclist.c: applied  patch from Guy Harris <guy@netapp.com>
	to make appends to the list constant. (btk-guy-990901-0.patch)

Mon Feb 14 22:50:10 2000  Tim Janik  <timj@btk.org>

	* btk/btktypeutils.c (btk_type_init): use g_str_hash() and g_str_equal()
	for the typename hash table.

Mon Feb 14 15:01:23 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkpaned.c (btk_paned_compute_position): Add some sanity checks
	to make sure we never divide by zero. 
	(Problem pointed out by Michal Jaegermann <michal@ellpspace.math.ualberta.ca>)

Mon Feb 14 12:29:38 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkfontsel.c: Apply patch from
	SHIRASAKI Yasuhiro <yasuhiro@awa.tohoku.ac.jp> to make font selector work a little
	better with 2-byte fonts. (Load a fontset instead of a font for two byte fonts.)

	Also, some cleanups in atom handling.

Sun Feb 13 08:02:21 2000  Tim Janik  <timj@btk.org>

	* btk/btksocket.c (btk_socket_class_init): parent class is BtkContainer,
	not BtkWidget.

Fri Feb 11 02:19:32 2000  Tim Janik  <timj@btk.org>

	* btk/btkhpaned.c (btk_hpaned_size_allocate): 
	* btk/btkvpaned.c (btk_vpaned_size_allocate): 
	* btk/btkpaned.c (btk_paned_compute_position): had to squeeze some
	more guint wrap-around bugs before going to bed.

Thu Feb 10 16:16:35 2000  Tim Janik  <timj@btk.org>

	* btk/btkspinbutton.c (btk_spin_button_size_allocate): guard against
	guint wrap arounds in allocation.width.

	* btk/btktable.c (btk_table_size_allocate_pass1): repeat shrinking
	process untill we fit the allocation given.

Tue Feb  8 09:38:29 2000  Tim Janik  <timj@btk.org>

	* btk/btkwidget.c:
	(btk_widget_unrealize): guard widget access with ref/unref
	around signal emission.
	(btk_widget_hide): same here, but also check its destroyed
	state before queueing a resize.

Tue Feb  8 03:05:55 2000  Tim Janik  <timj@btk.org>

	* btk/btkstyle.c (btk_style_new): use btk_default_prelight_bg instead
	of btk_default_insensitive_bg as insensitive base color.

	* btk/btktext.c (btk_text_style_set): set the background color according
	to the widget's state.
	(btk_text_realize): same here.
	(btk_text_state_changed): same here.
	(draw_bg_rect): compare background color against base[] from
	BTK_WIDGET_STATE (text) not BTK_STATE_NORMAL.

Mon Feb  7 04:01:55 2000  Tim Janik  <timj@btk.org>

	* btk/btkmain.c (btk_main_do_event): ignore delete events when
	grabs are active, unless a delete event is send to the toplevel
	of the currently grab holding widget.

Sun Feb  6 10:13:15 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkctree.c (btk_ctree_drag_data_received): Remove
	debugging g_print's.

Fri Feb  4 15:54:54 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkscrolledwindow.c (btk_scrolled_window_size_request): Don't
	ever make the scrolled-window requisition ever depend on the 
	visibility state of the scrollbars for the AUTOMATIC policy. 
	This breaks the	BTK+ requisition model, and causes loops.

Fri Feb  4 15:09:12 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkstyle.c (btk_style_new): Set the charset explicitely for
	the default font to avoid problems with XFree86-4.0 where the
	default charset is iso10646-1, not iso8859-1.

Thu Feb  3 14:58:48 PST 2000 Manish Singh <yosh@gimp.org>

	* acinclude.m4
	* config.guess
	* config.sub
	* ltconfig
	* ltmain.sh: upgrade to libtool 1.3.4 (bugfix only release)

	* btk/Makefile.am: minor cosmetic consistency tweak

Thu Feb  3 14:46:01 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmenushell.c (btk_menu_shell_button_release): Set
	the activate_time to 0, so that we handle a quick
	press/release press/release properly and don't suppress
	the second release. (Red Hat bug #7545)

Wed Feb  2 22:25:17 2000  Tim Janik  <timj@btk.org>

	* btk/btkctree.c (row_delete):
	(btk_ctree_node_set_row_data_full): fixed very evil reentrancy
	bugs with destruction notifier, *always* update internal
	structures *before* calling user code.

Sun Jan 30 20:10:52 2000  Lars Hamann  <lars@btk.org>

	A few more fixes for bug #5487, #2051, #2677.
	* btk/btkclist.c : 
	(btk_clist_button_press):  Reset clist->anchor to -1 if event->type is
 	not BDK_BUTTON_PRESS.
	(resync_selection): resync only if selection_mode is
	BTK_SELECTION_EXTENDED
	* btk/btkctree.c (resync_selection): same here

Sun Jan 30 12:29:20 2000  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdk.h btk/btkmenu.h: Removed duplicate prototypes for
	bdk_drag_get_selection() and btk_menu_detach().

	[ From Jeroen Ruigrok/Asmodai ]

Sat Jan 29 10:11:56 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btknotebook.c (btk_notebook_size_request): 
	page->tab_label can be NULL.

2000-01-25  Havoc Pennington  <hp@pobox.com>
	
	* bdk/bdkwindow.c (bdk_window_set_back_pixmap): parent_relative
	arg is boolean

	* bdk/bdkselection.c (bdk_selection_owner_set): return boolean

	* bdk/bdkrectangle.c (bdk_rectangle_intersect): return boolean

	* bdk/bdkproperty.c (bdk_property_get): return boolean

	* bdk/bdkinput.c (bdk_input_set_mode): return boolean

	* bdk/bdkim.c (bdk_im_ready): return boolean

	* bdk/bdkgc.c (bdk_gc_set_exposures): gboolean arg

	* bdk/bdkfont.c (bdk_font_equal): return gboolean (mild
	bunnylib clash, should fix bunnylib)

	* bdk/bdkevents.c (bdk_set_show_events): take gboolean arg
	(bdk_get_show_events): return gboolean, and canonicalize 
	to TRUE/FALSE

	* bdk/bdkcolor.c (bdk_colormap_new): gboolean flag whether the
	colormap is private
	(bdk_colors_alloc): gboolean whether to be contiguous
	(bdk_color_equal): return gboolean since we are a predicate
	and not a qsort() (this looks semi-wrong due to bunnylib breakage,
	IMO bunnylib should be fixed)
	
	* bdk/bdk.c (bdk_set_use_xshm): take gboolean arg
	(bdk_get_use_xshm): return gboolean
	(bdk_pointer_is_grabbed): return gboolean

	* bdk/bdk.h: Change prototypes to match all the above changes,
	and re-run ebtk-format-protos as required.

Fri Jan 28 12:28:17 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkctree.c (resync_selection): 
	* btk/btkclist.c (resync_selection):

	Return immediately if clist->drag_pos < 0. This is a workaround
	for the corrupt state that the clist gets into when a
	BDK_2BUTTON_PRESS occurs. See note in btk_clist_button_press().

	Bug #5487, #2051, #2677; fix suggested by David Helder and T. Alexander Popiel.
	
	* btk/btknotebook.c (btk_notebook_size_request): Fix uninitialized
	variable from recent commit.

Thu Jan 27 15:22:09 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkdnd.c (btk_drag_begin): Fix stupid typo in last commit.

Thu Jan 27 18:00:55 2000  Tim Janik  <timj@btk.org>

	* btk/Makefile.am: prefix all autogenerated source that get build in
	$(srcdir) with $(srcdir)/, so make doesn't assume they got generted
	in builddir. since we subsequently cd into srcdir for autogeneration,
	the paths have to be stripped from the target file names, thusly we
	use $(@F) as target names now.
	put a comment about configure.in's --disable-rebuilds option,
	which can be used for non-writable source directories, for development
	setups though, srcdir has to be *writable*.

hu Jan 27 00:15:03 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkdnd.c (btk_drag_begin btk_drag_get_event_actions):
	  Finish the job of allowing event to be NULL.
	  (Fixes bug #4283, reported by Chris Blizzard)

	* btk/btkentry.c (entry_adjust_scroll): When calculating
	  things so that the cursor appears on screen, properly
	  take into account INNER_BORDER.
	  (Fixes bug #4754, reported by Antonio Campos)

Wed Jan 26 23:12:28 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btknotebook.c (btk_notebook_map): Don't
	  show the tab_label unless it itself is visible.

	  btk/btknotebook.c (btk_notebook_size_request):
	  Do a better job of making sure that the visibility
	  of the tab label corresponds to whether it should
	  be mapped or not.

Wed Jan 26 21:17:03 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkoptionmenu.c (btk_option_menu_position):
	  Use the requisition, not the allocation, since the
	  allocation has not necessarily been computed yet.
	  (Pointed out by Eugene Osintsev)

Wed Jan 26 19:44:25 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkstyle.c (btk_style_new): Dont' set
	  style/base[BTK_STATE_INSENSITIVE] both to
	  btk_default_insensitive_bg!
	  (Bug #2187, reported by Jonathan Blandford)

	* btk/btkaccelgroup.c (btk_accelerator_valid):
	  Add Alt_L, Alt_R to list of invalid accelerators.
	  (Bug #3736, reported by Vlad Harchev)

Wed Jan 26 19:01:56 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkfilesel.c (open_ref_dir): Fix several
	bugs which occured after an attempt to open 
	invalid home directory left cmpl_state->reference_dir == NULL.

	 - completion on files in home directory didn't work
	 - completion on an empty string caused  segfault

	 (Bug #3678, reported by Steve Ratcliffe)

	* btk/btkscale.c (btk_scale_get_value_width): Fix
	cut and paste error that was causing scales to
	be incorrectly positioned.
	(Bug #2956,
	 patch from Steve Ratcliffe <steve@parabola.demon.co.uk>)

2000-01-27  Shirasaki Yasuhiro  <yasuhiro@bunny.gr.jp>

	* acinclude.m4 (AM_BTK_WITH_NLS): Add -lintl to libs
	when checking for dcgettext, if we've found we needed
	it for dgettext.
+
Wed Jan 26 18:06:07 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.c (btk_widget_queue_clear_area): Ignore
	queue_clear on NO_WINDOW widgets during a reparent,
	since at that point the window and widget heirarchies
	are out of sync. This stops crashing in some cases
	(the scrolled window reparent test, for instance), and
	_probably_ won't cause drawing errors.

	* btk/testbtk.c: Make the reparenting-a-scrolled-window
	test do what it was supposed to do and be robust against
	window closings, etc. (Bug #2443)

Wed Jan 26 16:56:54 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkentry.c: Fix return values on mouse events.
	(Bug #2686, Sky <seb_sky@yahoo.com>)

	* btk/genmarshal.pl: Fix up handling of FOREIGN.
	(pointed out by George Lebl)

 	* bdk/bdkcolor.c (bdk_color_copy): Made const-safe.
	(From Ettore Perazzoli  <ettore@helixcode.com>)
 
Mon Jan 24 10:44:48 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkcalendar.c (btk_calendar_main_button): Handle
	clicks between rows or outside calender area correctly.
	(Patch from Damon Chaplin)

	* btk/btkclist.c (btk_clist_set_row_data_full): 
	* btk/btkctree.c (btk_ctree_node_set_row_data_full): 
	  Call destroy function when overwriting existing data. 
	  (Pointed out by Damon Chaplin)

Tue Jan 25 09:55:41 2000  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdk.c: Remove useless #include of <X11/Xmu/WinUtil.h>,
	  which was causing problems on various systems with Xmu.
	  This hasn't been needed for a very long time.
	  (Fixes #1185 3167)

Sun Jan 23 22:27:36 2000  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdki18n.h: Include <ctype.h> when defining
	  bdk_isw* in terms of is* as a fallback.
	  (Bug #4106 - Dan Winship <danw@MIT.EDU>)

Sun Jan 23 22:12:36 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkviewport.c (btk_viewport_size_allocate): Don't
	  realize the widget when it is size allocated!
	  (old, old bug)

	* btk/btkviewport.c (btk_viewport_adjustment_value_changed):
	  Removed unused call to bdk_window_get_size() that
	  showed up when the above was fixed.

Sat Jan 22 15:44:30 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.c (btk_widget_reparent): Correctly
	  fix up widget->window when the widget is a
	  NO_WINDOW container widget.

Sat Jan 22 12:40:48 2000  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkpixmap.c (bdk_pixmap_seek_string): Rewrite
	  to account for the fact that feof() does _not_ 
	  return TRUE on errors, and thus avoid infinite loops
	  when trying to use bdk_pixmap_create_from_xpm()
	  on unreadable values.

Fri Jan 21 18:32:43 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkaspectframe.h (struct _BtkAspectFrame): s/gint/gboolean/.

Fri Jan 21 16:24:08 2000  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkgc.c (bdk_gc_set_dashes): Change from
	  bdk_gc_set_dashes to take gint8 instead of gchar to
	  make it clearer that it is _not_ a NULL terminated string.

	* bdk/bdk.h bdk/bdkfont.c bdk/bdkgc.c bdk/bdkselection.c
	  bdk/bdkwindow.c btk/btkprogress.[ch] btk/btkthemes.[ch]
	  btk/btktreeitem.[ch] btk/btkwidget.[ch]: Constify string
	  arguments.

Thu Dec 30 04:51:05 1999  Tim Janik  <timj@btk.org>

	* btk/btkvscale.c (btk_vscale_pos_background): 
	* btk/btkhscale.c (btk_hscale_pos_background): when calculating the
	background size relative to our allocation, guard against small
	allocations, we may have not yet been size allocated.

Thu Dec  2 10:59:14 1999  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkdnd.c (xdnd_check_dest): Allow version >= 3,
	not just version == 3. We implement all 3 + most of 4 - 
	(we don't support matching text/plain;charset=iso-8859-1
	to a dest that expects text/plain). We'll still advertise
	3 to be safe, but any client implementing version >= 3
	must interoperate with 3.
	
Tue Mar 14 11:53:31 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btktooltips.[ch] (struct _BtkTooltips): Remove foreground,
	background and gc members, add a warning in btk_tooltips_set_color()
	indicating that this function is deprecated.

Thu Mar  9 22:10:56 GMT 2000  Tony Gale <gale@btk.org>

	* docs/btkfaq.sgml: FAQ Update:
	  - Minor cleanups (Emmanuel, me)
	  - New questions:
		I need to add a new signal to a BTK+ widget. Any idea? (timj)
		How can I retrieve the text from a BtkMenuItem? (timj)
		How do I validate/limit/filter the input to a BtkEntry? (me)
		Memory does not seem to be released when I free the list
			nodes I've allocated (timj)

2000-03-07  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkmain-win32.c: Internal BDK error reporting changes:
	(bdk_win32_gdi_failed) New function for reporting errors from GDI,
	for which it is no use to call GetLastError onWin9x.
	(bdk_other_api_failed) New function, for general error
	reporting without calling GetLastError.
	(bdk_win32_api_failed) OTOH, this function always calls
	GetLastError. (bdk_win32_last_error_string) Remove this function,
	GLib has the equivalent now.

	* bdk/win32/bdkprivate-win32.h: Declare the above, and macros to
	call them with function name, file name and line number in the
	arguments.

	* bdk/win32/*.c: Use the new macros for reporting errors from GDI
	functions.
	
	* btk/btk.def: Add some missing entry points.

	* btk/btkcompat.h.in: Define btk_paned_gutter_size and
	btk_paned_set_gutter_size, which don't exist any longer, as void.
	
	Fixes by Hans Breuer:

	* bdk/makefile.msc: Update for debugging.

	* bdk/win32/bdkgc-win32.c (bdk_win32_gc_set_dashes): Fake
	implementation, just use the PS_DASH, PS_DOT, PS_DASHDOT or
	PS_DASHDOTDOT or PS_DASH styles depending on the number of entries
	in the dash_list.

	* bdk/win32/bdkwin32.h (BDK_FONT_XFONT): New macro, similar as in
	the x11 backend.

	* bdk/win32/bdkprivate-win32.h (IS_WIN_NT): New macro.

	* btk/testbtk.c: Include config.h, guard inclusion of unistd.h.

2000-03-04  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkprivate-win32.h (struct _BdkWindowWin32Data): Store
	just pixel value of background colour.

	* bdk/win32/bdkgc-win32.c (bdk_colormap_color): New function
	containing code snippet previously duplicated in a couple of
	places.
	
	* bdk/win32/bdkdrawable-win32.c (bdk_win32_draw_points): Use
	bdk_colormap_color.

	* bdk/win32/bdkevents-win32.c (bdk_event_translate): Generate
	BDK_SCROLL events for WM_MOUSEWHEEL messages. Don't generate
	events for autorepeated Shift, Control and Alt keys. Use
	bdk_colormap_color.

	* bdk/win32/bdkwindow-win32.c (bdk_window_set_cursor): If the
	pointer is inside the window the cursor of which we are setting,
	call SetCursor immediately.

	* bdk/win32/makefile.cygwin
	* btk/makefile.cygwin: If we don't have the build number stamp
	file, use zero.

	* btk/btkcompat.h.in: Define btk_paned_gutter_size and
	btk_paned_set_gutter_size as empty.

	* btk/btk.def: Remove btk_paned_set_gutter_size.
	
Tue Feb 29 13:10:00 GMT 2000  Tony Gale <gale@btk.org>

	* bdk/bdkwindow.h bdk/x11/gxid.c btk/btkclist.c btk/btkclist.h
	  btk/btkctree.c btk/btkmenu.h btk/btkwidget.c btk/testbtk.c
	  docs/styles.txt docs/refcounting.txt docs/btkfaq.sgml
	  docs/btk_tut.sgml docs/btk.texi TODO:

	  Spelling/grammar fixes from Martin Buchholz <martin@xemacs.org>

Sat Feb 26 11:46:25 GMT 2000  Tony Gale <gale@btk.org>

        * btk/btkcalendar.c: Implement num_marked_dates,
          and don't emit mutiple day_selected signals on
          month_prev.

2000-02-25  Jonathan Blandford  <jrb@redhat.com>

	* docs/make-todo (lineno): let title and logo be configurable so
	that BUNNY can use this script too.

	* TODO.xml: added logourl and a title

Fri Feb 25 11:12:00 2000  Owen Taylor  <otaylor@redhat.com>

	* TODO.xml: Added some UI items, and an explanatory
	comment at the top of the file.

Thu Feb 24 09:07:28 2000  Tim Janik  <timj@btk.org>

	* TODO.xml: some updates, added abunch of new entries.
	a note for those fiddeling with this file, when done
	with it, invoke:
	$ ./docs/make-todo TODO.xml >/dev/null
	and correct output errors before comitting changes.

Wed Feb 23 22:59:50 2000  Owen Taylor  <otaylor@redhat.com>

	* TODO.xml: Added XML-structured TODO file.
	* docs/make-todo: python script to turn TODO.xml into
	  pretty XML output. 

2000-02-23  Jonathan Blandford  <jrb@redhat.com>

	* btk/btkstyle.c (btk_default_draw_handle): add a 'paned' mode to
	the function to let it draw the seven dots, instead of the old,
	much maligned, method.
	(draw_dot): New function to draw a dot.

	* btk/btkhpaned.c (btk_hpaned_size_allocate): changed allocation
	to draw the handle inside the border width as opposed to outside.
	Use paint function instead of bdk_draw_point.

	* btk/btkvpaned.c (btk_vpaned_size_allocate): changed allocation
	to draw the handle inside the border width as opposed to outside.
	Use paint function instead of bdk_draw_point.

	* btk/btkfilesel.c (btk_file_selection_update_history_menu):
	Change indenting to be more BTK like.

Wed Feb 23 10:54:14 GMT 2000  Tony Gale <gale@btk.org>

        * docs/btk_tut.sgml: New section on BtkCalendar
        * examples/calendar: Update example code

Tue Feb 22 13:54:12 GMT 2000  Tony Gale <gale@btk.org>

	* docs/btkfaq.sgml: FAQ Update

2000-02-19  Anders Carlsson  <andersca@gnu.org>

	* btk/btkrange.c (btk_range_scroll_event): Return TRUE
	to prevent the scroll event to be propagated upwards.

Fri Feb 18 14:37:29 2000  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkwindow-x11.c (bdk_event_mask_table): Remove
	OwnerGrabButtonMask from button entries for
	BDK_BUTTON_PRESS / BDK_BUTTON_RELEASE.

	* btk/btklayout.c (btk_layout_realize): Always add BDK_SCROLL
	to the event mask (which will result in button/press release
	being added to the event mask on Unix) so scrolling works
	for layouts in scroll windows.

	* bdk/bdkevents.h (enum): Fix up BDK_ALL_EVENTS_MASK.

	Patch from Anders Carlsson  <andersca@gnu.org> to add
	a scroll event.

 	* btk/testbtk.c (scroll_test_scroll): Added an example of mouse wheel
 	scrolling to the "Test Scrolling" part of testbtk.
 
 	* btk/btkwidget.h (struct _BtkWidgetClass): Added scroll_event signal.
 
 	* btk/btkwidget.c: Added "scroll_event" BTK+ signal and matched
 	it against BDK_SCROLL.
 
 	* btk/btkrange.c (btk_range_scroll_event): Updated to use the new
 	way of mouse wheel scrolling.
 
 	* btk/btkscrolledwindow.c (btk_scrolled_window_scroll_event): Likewise.
 
 	* btk/btkspinbutton.c (btk_spin_button_scroll): Likewise.
 
 	* btk/btkmain.c: Removed previous mouse wheel hack.
 
 	* bdk/x11/bdkwindow-x11.c (bdk_event_mask_table): Added entry in
 	bdk_event_mask_table.
 
 	* bdk/x11/bdkevents-x11.c (bdk_event_translate): Added 
 	BdkEventScroll handler.
 
 	* bdk/bdkevents.h: Added BdkEventScroll structure.
 
Thu Feb 17 17:10:12 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/gt{h,k,}vpaned.[ch]: Add patch from Jonathan Blandford
	and Anders Carlsson to change the Paned widgets so that they
	can be dragged from anywhere along the length. Also change
	the way that this is drawn to make this apparent.

	* btk/btkoptionmenu.c (btk_option_menu_get_history): Apply patch
	from George Lebl to check that option_menu->menu is present
	before getting history.

2000-02-14  Tor Lillqvist  <tml@iki.fi>

	* bdk/bdkdraw.c (bdk_draw_segments): Move the test for no segments
	before the assertion for non-NULL segment list.

	* bdk/win32/bdkgc-win32.c: (bdk_win32_gc_values_to_win32values):
	Seems that pattern brushes *must* be 8x8 pixels! At least on my
	machine, but it might be display driver dependent. Sigh, so make
	sure the stipple is that size. Does Windows suck or what?

	* bdk/win32/bdkdrawable-win32.c: Improve error handling in a few
	places.

2000-02-13  Havoc Pennington  <hp@pobox.com>

	* bdk/x11/bdkcursor-x11.c (bdk_cursor_new_from_pixmap): init
	refcount to 1
	(bdk_cursor_new): init refcount to 1

	* bdk/win32/bdkcursor-win32.c (bdk_cursor_new): init refcount to 1

2000-02-13  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkgc-win32.c (bdk_gc_predraw): Add an extra parameter
	so that we don't have to do unnecessary settings to the HDC.

	* bdk/win32/bdkdrawable-win32.c
	* bdk/win32/bdkimage-win32.c: Corresponding changes to the calls of
	bdk_gc_predraw.

	* bdk/win32/bdkdrawable-win32.c: Special-casing for BdkGCs where
	the fill style is BDK_OPAQUE_STIPPLED. In those cases we construct
	GDI paths, call WidenPath to get the outline of the stroken path,
	and then fill the outline (with the brush that was built from the
	stipple).

	* bdk/win32/bdkgc-win32.c: Factor out common code from
	_bdk_win32_gc_new and bdk_win32_gc_set_values into
	bdk_win32_gc_values_to_win32values. Use correct colour for
	SetBkColor() (Until now the code actually used a random colour in
	the call to SetBkColor()... but that didn't show up as not many
	GDI APIs use the background colour. Pattern (opaque stippled)
	brushes do.)

	* bdk/win32/bdkmain-win32.c (bdk_win32_last_error_string,
	bdk_win32_api_failed): New functions for error logging.

	* bdk/win32/bdkprivate-win32.h: Declare them, and define a macro
	WIN32_API_FAILED to call them, passing function or file name and
	line number.

	* bdk/win32/*.c: Use the WIN32_API_FAILED macro.

	* bdk/win32/bdkprivate-win32.h: Store just the pixel values from
	BdkColor for foreground and background in BdkGCWin32Data.

	* bdk/makefile.cygwin: Link in the resource object separately.

	* bdk/win32/rc/bdk.rc
	* btk/btk.rc (New file)
	* bdk/win32/makefile.cygwin
	* btk/makefile.cygwin: Update build number in DLLs automatically,
	as in GLib.

Sun Feb 13 08:54:45 2000  Tim Janik  <timj@btk.org>

	* bdk/bdkcursor.h (struct _BdkCursor): s/refcount/ref_count/.
	* bdk/x11/bdkcursor-x11.c (bdk_cursor_new_from_pixmap): 
	* bdk/x11/bdkcursor-x11.c (_bdk_cursor_destroy): 
	* bdk/bdkcursor.c (bdk_cursor_ref): insert assertments for the
	parameters given and cursor->ref_count. coding style fixups.

	* btk/btksocket.c (btk_socket_class_init): parent class is BtkContainer,
	not BtkWidget.
	
	* btk/*.h: applied patch from Mathieu Lacage <lacage@email.enst.fr> to
	fix up widget macros and add _GET_CLASS() variant.
	
	* btk/*.c: some BtkType fixups.

2000-02-09  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkproperty-win32.c
	* bdk/x11/bdkproperty-x11.c: The assertions for BDK_IS_WINDOW
	were reversed.

2000-02-04  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkfont-win32.c (logfont_to_xlfd): Use
	g_filename_to_utf8 to convert the font names Windows gives us from
	whatever is the default codepage to UTF-8.
	(bdk_font_load_internal) Use g_filename_from_utf8 for conversion
	in the other direction.

	* bdk/win32/bdkgc-win32.c (bdk_win32_gc_set_values): Fix cut&paste
	error in debugging output.

2000-02-02  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkwindow-win32.c (bdk_window_clear): Pass zero width
	and height parameters to bdk_window_clear_area(). Not minus one.

Wed Feb  2 11:58:05 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkdnd.c (btk_drag_selection_received): Add some sanity
	checks if the widget passed to btk_drag_get_data() was not the
	dest widget.

2000-02-01  Tor Lillqvist  <tml@iki.fi>

	* btk/btkfilesel.c: Use the g_filename_to_utf8 and
	g_filename_from_utf8 functions (which were added a moment ago to
	GLib). Some cleanups: Use gbooleans. Use GStrings instead of fixed
	size buffers.

	btk_file_selection_get_filename returns the filename in the C
	runtime encoding. It calls g_filename_from_utf8, but copies the
	returned string to a static buffer, which is returned. I think
	this is better than returning the result from g_filename_from_utf8
	directly, which would mean all apps that use it would have to free
	the return value. Or should this function care about this issue at
	all? Maybe a new function with clearly defined semantics.

	* btk/btkfilesel.h: Add comment about
	btk_file_selection_get_filename returning the filename in the C
	runtime's encoding.

	* README.win32
	* bdk/bdk.def
	* bdk/makefile.{cygwin,msc}
	* btk/btk.def: Updates.

	* bdk/bdkcursor-win32.c: Initialise refcount.

2000-01-31  Yuan-Chung Cheng <platin@linux.org.tw>

        * configure.in: Added "zh_CN.GB2312" to ALL_LINGUAS.

2000-01-30  Havoc Pennington  <hp@pobox.com>

	* btk/testbtk.c (set_cursor): use bdk_cursor_unref instead of
	destroy

	* bdk/bdkimage.c (bdk_image_ref): image wasn't being returned

	* bdk/bdkprivate.h: declare _bdk_cursor_destroy which is then 
	implemented in platform-specific code

	* bdk/Makefile.am (bdk_c_sources): add bdkcursor.c

	* bdk/x11/bdkcursor-x11.c (bdk_cursor_destroy): rename with an
	underscore in front

	* bdk/win32/bdkcursor-win32.c (bdk_cursor_destroy):
	put an underscore in front

	* bdk/bdkcursor.c: new file, implements
	bdk_cursor_ref/bdk_cursor_unref

	* bdk/bdkcursor.h: Refcount BdkCursor

	* bdk/bdkcompat.h (bdk_cursor_destroy): compat

2000-01-29  Tor Lillqvist  <tml@iki.fi>

	* bdk/bdkwindow.h
	* bdk/bdkpixmap.h: Remove prototypes for renamed functions.

Tue Jan 25 11:43:21 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkinvisible.h (struct _BtkInvisible[Class]): Fix
	structures to properly inherit from BtkWidget not BtkBin.

Sun Jan 23 20:28:24 2000  Owen Taylor  <otaylor@redhat.com>

	* btk+.spec.in: Added lib/btk+/include/* to %files
	(bug #5178 - Peter Wainright)
	
	* btk/Makefile.am (btk_public_h_sources): Add btkcompat.h
	so that it will be installed.
	(bug #4889 - "david d `zoo' zuhn" <zoo@mnnr.org>)

Fri Jan 21 16:29:28 2000  Owen Taylor  <otaylor@redhat.com>

	* btk/btkstyle.[ch] docs/Changes-1.4.txt: Make the @detail argument
	for the BtkStyleClass vtable const.

	* btk/btkitemfactory.[ch] docs/Changes-1.4.txt: Make BtkPrintFunc
	take a const string argument like BtkTranslateFunc. This will
	require changes in use code.

2000-01-19  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkwindow-win32.c (bdk_window_clear_area): The correct
	semantics (to mimic the X11 backend, which just calls XClearArea)
	is to check for zero width (and height), and in that case use the
	window's width minus x (height minus y). This fixes for instance
	some redraw problems with btkclist, which were easily noticeable
	in the btk file selection widget.

	(bdk_window_new): Don't set WS_EX_TOPMOST for dialog
	windows.

2000-01-13  Tor Lillqvist  <tml@iki.fi>

	* configure.in
	* bdk/Makefile.am
	* bdk/x11/Makefile.am
	* bdk/win32/Makefile.am: Small fixes, thanks to Peter Wainwright
	(bug #5177).
	* bdk/win32/bdkcc-win32.c: Reintroduce, to be thrown
	out later.

2000-01-09  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkevents-win32.c (bdk_event_translate): Ignore
	WM_MOVE for iconified or invisible windows. This fixes various
	problems when minimising windows. Thanks to Bernd Herd.

2000-01-05  Tor Lillqvist  <tml@iki.fi>

	* bdk/bdkdraw.c (bdk_draw_lines): Fix copy&paste error: Call the
	backend's draw_lines method, not draw_points.

2000-01-02  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkevents-win32.c: Clean up some more leftovers from
	before Owen's reorganisation: Don't have queued_events and
	queued_tail statics in this file, but use bdk_queued_events and
	bdk_queued_tail. This makes exposure event compression work again.

	(bdk_WindowProc): Comment out a posting of bdk_ping_msg, doesn't
	seem to be needed?

1999-12-30  Tor Lillqvist  <tml@iki.fi>

	* bdk/bdk.c: If we don't HAVE_XCONVERTCASE we must #include
	bdkkeysyms.h to get the BDK_* keysym constants that are needed by
	bdk_keyval_convert_case(). Otherwise, bdk_keyval_convert_case()
	doesn't do anything.

	* bdk/bdk.def: Add bdk_xid_table_insert.

	* bdk/win32/bdkprivate-win32.h
	* bdk/win32/bdkevents-win32.c
	* bdk/win32/bdkinput-win32.c
	
	* bdk/win32/bdkwindow-win32.c: Remove the superfluous
	extension_events field in the BdkWindowWin32Data struct. Use only
	the extension_events field in BdkWindowPrivate. Previously one was
	set, and the other one tested, which broke tablet
	functionality. Thanks to Keishi Suenaga for pointing this out.

1999-12-18  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkfont-win32.c (bdk_text_size, bdk_text_extents):
	When handling a single character (text length == 1), don't handle
	it as if it was UTF-8.

1999-12-11  Tor Lillqvist  <tml@iki.fi>

	* Makefile.am: Distribute README.win32.
	
	* bdk/Makefile.am
	* bdk/win32/Makefile.am: Distribute Win32 files.

	* bdk/makefile.msc: New file.

	* bdk/bdk.c (bdk_arg_context_parse): Fix gccism (no statement
	after label).

	* bdk/bdkprivate.h: Must mark also bdk_error_warnings and
	bdk_error_code as BDKVAR, as they are referred outside BDK.

	* bdk/win32/makefile.msc: Update.

	* bdk/win32/bdkfont-win32.c (check_unicode_subranges): More
	tweaks. Check only if at least one of those Unicode subrange bits
	we care for is set. If no code page bits are set, guess (wildly)
	based on the charset.

	* bdk/win32/bdkinput-win32.c: Remove debugging leftover.

	* bdk/win32/bdkwindow-win32.c (bdk_window_new): Assure title is
	non-NULL.

	* btk/btkdnd.c
	* btk/btklayout.c
	* btk/btkplug.c
	* btk/btkselection.c
	* btk/btksocket.c
	* btk/btkwindow.c: Include x11/bdkx.h *or* win32/bdkwin32.c as
	appropriate. There must be a cleaner way to handle this?

	* btk/btkrc.c: Must include windows.h on Win32.

	* btk/testbtk.c: No need to include bdkx.h.

	* btk/makefile.cygwin: Correct invokation of genmarshal.pl.

1999-12-07  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkfont-win32.c: Fix string measurement code. For now,
	the rbearing is set to the same as the width, but this should be
	fixed.

1999-12-06  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkfont-win32.c (check_unicode_subranges): New
	function. If Windows doesn't tell us what Unicode subranges a font
	covers, guesstimate based on the codepages it covers. This will
	hopefully help those Windows versions or fonts that don't give us
	any useful Unicode subrange information with GetTextCharsetInfo.
	Call this function in bdk_font_load_internal.

	* bdk/win32/{bdkdnd,bdkimage,bdkpixmap,bdkprivate}-win32.c: Misc
	minor changes.

Fri Dec  3 14:09:50 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btkoptionmenu.[ch] (btk_option_menu_get_history):
	New function, long needed.

Wed Dec  1 22:35:43 1999  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkproperty.h x11/bdkproperty.c: Change 
	only_if_exists argument of bdk_atom_intern to
	bool.

1999-11-25  Tor Lillqvist  <tml@iki.fi>

	* bdk/bdkgc.c (bdk_gc_set_ts_origin, bdk_gc_set_clip_origin): 
	Fix two copy&paste errors.

	* bdk/makefile.cygwin: Also rebuild DLL when the static archive in
	win32 has changed.

	* bdk/win32/bdkprivate-win32.h: Don't need CPINFO in the
	BdkWin32SingleFont struct.

	* bdk/win32/bdkfont-win32.c: Some more debugging: Print Unicode
	subranges of loaded fonts. Clear font signature first, in case
	GetTextCharsetInfo fails. Pretend SYMBOL_CHARSET fonts have
	ASCII+Basic Latin (i.e. 0x40--0xFF) as they are single-byte.

	* bdk/win32/bdkgc-win32.c: Improved logging. (bdk_gc_postdraw):
	Unoffset clip rebunnyion.

1999-11-23  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkevents-win32.c (bdk_event_translate): set
	event->any.window before calling filter functions.

Fri Nov 19 10:34:41 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btkgamma.h: Adapt cast macros to standard.

[ Merges from 1.2 ]

Tue Nov 16 10:15:54 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btkitemfactory.c (btk_item_factory_parse_path):
	If translation does not include a '/', use entire
	translation instead of crashing.

Sun Oct 31 22:21:11 1999  Tim Janik  <timj@btk.org>

	* docs/btk_tut.sgml:
	s/btk_accel_group_attach/btk_window_add_accel_group/.

Sat Oct 30 09:09:09 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btkselection.c (btk_target_list_remove): Use
	g_list_remove_link, not g_list_remove.

	[ From Geert Bevin <gbevin@thunderstorms.org> ]
	
Sun Oct 24 07:41:40 1999  Tim Janik  <timj@btk.org>

	* btk/btkclist.c (real_undo_selection): commented out g_print()
	statement upon unselection (how the heck did that slip in?).

Sat Oct 23 03:03:08 1999  Tim Janik  <timj@btk.org>

	* btk/btktext.c (btk_text_freeze): 
	(btk_text_thaw): undraw/draw cursor here to avoid unnecessary scrolling
	in frozen state (and aparently crashes). patch provided by Anders
	Melchiorsen <and@kampsax.dtu.dk>.

Sat Oct 23 02:53:20 1999  Tim Janik  <timj@btk.org>

	* fix insensitive default/focus widget activation,
	reported by Matt Goodall <mgg@isotek.co.uk>.

	* btk/btkwindow.c (btk_window_key_press_event): 
	(btk_window_activate_default):
	(btk_window_activate_focus):
	return handled=FALSE for actiavtion of insensitive default
	widgets. return handled=TRUE for activation of insensitive
	focus widgets. don't activate in either case.

Tue Oct 19 09:55:08 1999  Owen Taylor  <otaylor@redhat.com>

	* btk-config.in (lib_btk): Switch order of @x_cflags@
	and $bunnylib_cflags to match library order and in the
	theory that an old version of GLib is more likely to
	be in the include directory for X then vice-versa.
	(Bug #2776)

Tue Oct 19 09:46:49 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btkrc.c (btk_rc_init): Always use LC_CTYPE 
	to determine the locale for fontsets, not LC_MESSAGES;
	the user may want English messages with a handling
	for non-English languages. (LC_CTYPE=ru_RU LC_MESSAGES=fr_FR
	will still be broken) (Bug #2891)

Tue Oct 19 20:36:42 1999  Changwoo Ryu  <cwryu@adam.kaist.ac.kr>

	* btk/btkrc.ko: Fixed the wrong number of "*"'s.

Tue Oct 19 12:15:13 1999  Changwoo Ryu  <cwryu@adam.kaist.ac.kr>

	* btk/btkrc.ko: Changed the Korean default fontset.

Fri Oct  8 02:32:47 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btklayout.c (btk_layout_adjustment_changed): Fix bug
	where when scrolling to the left or top double exposes
	were done, causing major slowdowns.

Thu Oct  7 18:31:55 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btkrc.c (btk_rc_init): Always normalize codeset
	names to lowercase and alphanumeric, before looking
	them up.

	* btk/Makefile.am: Install codeset variant btkrc files
	with normalized names.

Thu Oct  7 22:52:42 1999  Tim Janik  <timj@btk.org>

	* btk/btkitemfactory.c (btk_item_factory_popup_with_data): even
	popup menus when the menu is already visible, but its parent
	is still hidden, (happens after tornoff window got hidden).

Thu Oct  7 11:09:55 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/Makefile.am (install-data-local): Fix
	a typo where btkrc.vi_VN.tcvn5712 wasn't getting
	deleted, causing error messages on install.

Thu Oct  7 11:03:06 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btk[hv]paned.c (btk_{h,v}paned_draw): Redraw
	the handle as well, since we now sometimes ignore
	exposes on the handle while resizing.

Wed Oct  6 18:02:31 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btkrc.c (btk_rc_append_default_pixmap_path): Fix stupid
	extra g_free introduced in one of the last one or two 
	commits.

Wed Oct  6 16:38:36 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/Makefile.am btk/btkrc*: Make naming of btkrc files
	consistent, put each style that a btkrc.* file creates
	in a unique namespace, remove old files before installing.

Wed Oct  6 14:31:16 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btkrc.c (btk_rc_init): Avoid leaking memory when
	btk_rc_init is called multiple times. (Yes, people who
	do that have bugs in their code.)

Tue Oct  5 11:36:57 PDT 1999 Manish Singh <yosh@gimp.org>

	* btk/Makefile.am: listing btkrc in btkconf_DATA seems to barf.
	Remove it since it's generated by the Makefile anyway

Tue Oct  5 02:43:41 1999  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkinputcommon.h (bdk_input_device_new): Free
	device->info.axes for core pointer.

Thu Sep 30 13:55:25 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/testbtk.c (destroy_idle_test): Rename idle to 
	idle_id, to deal with obsolete, broken C libraries.

Mon Sep 27 02:50:15 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btkvscale.c (btk_vscale_draw): Don't add in
	allocation->x/y twice!

	* btk/btkhscale.c: Make usage of btk_hscale_pos_trough()
	consistent with btk_vscale_pos_trough().

Sun Sep 26 19:44:34 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btkcontainer.c (btk_container_queue_resize): We may
	be queueing a resize on a toplevel container between
	the time we show it and when we map it. So, we need
	to test BTK_WIDGET_VISIBLE() for toplevels, and only
	use BTK_WIDGET_DRAWABLE() for child windows.

Thu Sep 23 16:41:03 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/Makefile.am (LDADDS): Add BDK_WLIBS to LDADDS 
	(fixes bug #2144)

Fri Sep 24 00:51:45 1999  Tim Janik  <timj@btk.org>

	* btk/btkcontainer.c (btk_container_queue_resize): check for
	container DRAWABLE (instead of VISIBLE), so we don't queue
	resizes on non-toplevel containers.

Sun Sep 19 18:13:31 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btkselection.[ch]: Make the data argument
	const guchar *.

Sat Sep 18 21:27:40 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwindow.c: Try to behave sensibly if 
	the focus widget is the window itself. (Should
	we allow this at all?)

Fri Sep 17 09:57:15 1999  Tim Janik  <timj@btk.org>

	* btk/btkwidget.c (btk_widget_set_sensitive): 
	* btk/btknotebook.c (btk_notebook_set_scrollable): 
	* btk/btknotebook.c (btk_notebook_set_show_border): 
	* btk/btkclist.c (btk_notebook_set_show_border): make gboolean args
	in prototypes and implementations consistent (Tomas Ogren).

	* btk/btklayout.c (btk_layout_remove): unset BTK_IS_OFFSCREEN flag
	before the widget is unparented (reported by damon).

	* btk/btkdnd.c: make the cursor and icon data _unsigned_ char,
	since we provide unsigned data anyways.

Thu Sep 16 21:32:01 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btktooltips.c (btk_tooltips_set_tip): Delay
	the call to btk_tooltips_layout_text() until later.

	* btk/btktooltips.c (btk_tooltips_draw_tips):
	Call btk_widget_ensure_style() before using the style.

Wed Sep 15 02:52:19 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.c (btk_widget_event): Added workaround
	for old widgets that don't propagate draws to all
	children. (Namely bunny-dock for bunny-libs <= 1.0.16)

Tue Sep 14 19:22:19 1999  Tim Janik  <timj@btk.org>

	* btk/btkwidget.c (btk_widget_queue_resize): don't queue the parent
	for a redraw but just the widget that requested the resize.

Tue Sep 14 18:29:47 1999  Tim Janik  <timj@btk.org>

	* btk/btkcontainer.c: added new widget level method
	btk_container_set_reallocate_redraws() and a BtkContainer flag
	reallocate_redraws : 1 to reflect the setting, exported this through
	the argument system as a boolean ::reallocate_redraws.

	* btk/btkwidget.c (btk_widget_size_allocate): when queueing redraws
	on the widget because the allocation changes, do so as well for
	widget->parent if the parent has reallocate_redraws set to TRUE.
	with that containers requesting reallocation redraws get automatically
	redrawn if their children changed allocation (this unfortunately
	affects also other children that didn't change allocation, but we
	cannot work around that before 1.3).

Tue Sep 14 18:23:01 1999  Tim Janik  <timj@btk.org>

	* btk/btkwidget.c (btk_widget_idle_draw): only emit ::draw if width
	_and_ height are >0 (not _or_).

	* btk/btktable.c (btk_table_remove): use btk_widget_queue_resize()
	instead of btk_container_queue_resize(), which is a core btk internal
	function (must have been on crack when i queued that).

	* btk/btkprivate.h: added new private flag BTK_FULLDRAW_PENDING, so
	we can check more reliably if we want to discard expose events.
	* btk/btkwidget.c: added setting/unsetting of the BTK_FULLDRAW_PENDING
	flag.
	
	* btk/btkwidget.c (btk_widget_event): don't discard synthesized exposes,
	we simply trust these events. for deciding whether to discard exposes,
	check BTK_FULLDRAW_PENDING instead of RESIZE_PENDING.
	
Mon Sep 13 15:01:21 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.c (btk_widget_queue_clear_area): Ignore
	queues of areas that are completely off screen.

	* btk/btkwidget.c (btk_widget_idle_draw): Fix broken
	logic for handleboxes.

	* btk/btkwidget.c (btk_widget_queue_draw_data): Add santity
	check on width/height.

Mon Sep 13 02:22:47 1999  Tim Janik  <timj@btk.org>

	* btk/Makefile.am: backed out Raja's recent VPATH build "improvements",
	we are fine with using $@ the way we do (if we actually encounter
	brokeness with $@ in VPATH builds because of additional path prefixes,
	we need to use $(@F) actually).

Mon Sep 13 01:34:53 1999  Tim Janik  <timj@btk.org>

	* btk/btksignal.c: renamed two variables, hopefully didn't introduce
	short lived bugs, that would allow language bindings to do surgeries
	to our guts.

Fri Sep 10 15:22:50 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwindow.c (btk_window_size_allocate): Fix typo
	where comparison was being done against an uninitialized
	value causing intermittant results depending on
	compiler flags. Also make it clearer that we aren't
	ever initializing the child as 0x0 (though this will
	be caught in btk_widget_size_allocate())

Fri Sep 10 10:06:56 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwindow.c (btk_window_set_transient_for): Move
	btk_window_unset_transient_for() call after we do checks
	involving the old transient parent.
	[ From Lance Capser <lmc@cyberhighway.net> ]

1999-09-07  Raja R Harinath  <harinath@cs.umn.edu>

	* btk/Makefile.am (btk.defs): Go back to using `touch' to create
	an empty file.

Mon Sep  6 00:11:56 1999  Lars Hamann  <lars@btk.org>

	* btk/btkctree.c (btk_ctree_is_ancestor): return FALSE if node has
	no children. (Reported by: Chris Rogers <gandalf@pobox.com>)

1999-09-03  Raja R Harinath  <harinath@cs.umn.edu>

	* btk/Makefile.am (gen_sources): Improve VPATH builds.
	`$@' is valid only in the build dir, not after we've done 
	`cd $srcdir'.  Also use `test -f' instead of less portable
	`test -e'.

Fri Sep  3 15:59:56 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btktext.c (correct_cache_insert): Rewrite
	 for simplicity, and hopefully correctness.
	 (Fixes bug #1322, which was a segfault when
	  on some insertions with the properties around
	  the insertion set up just wrong.)

	* btk/btktext.c (btk_text_adjustment): When we receive
	 a "changed" signal, clamp the new value to the adjustment
	 bounds to avoid segfaulting if someone tries to change
	 the adjustment to a bogus value. (Bug #1795)

Thu Sep  2 16:33:59 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmain.c: Ignore unexpected destroy notifies
	for children, for toplevel windows handle them
	like delete_event.

	* btk/btkplug.c: Add an unrealize handler so that
	we unref plug->socket_window when we are done
	with it.

Fri Sep  3 14:52:54 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btktext.c (clear_area): Fix stupid signedness
	 problem that was causing background to sometimes
	 be misaligned.

Fri Sep  3 12:26:33 1999  Owen Taylor  <otaylor@redhat.com>

	[ Fixes pointed out by Ettore Perazzoli <ettore@comm2000.it> ]
	
	* btk/btkmenu.c (btk_menu_position): Make
	 sure we never position menus with negative x, y,
	 since btk_widget_set_uposition() can't handle that.

	* btk/btkmenuitem.c (btk_menu_item_position_menu):
	 Modify the positioning code a bit so that we always
	 put the top-left corner onscreen. (This is for
	 UI reasons, btk_menu_position() now takes care of
	 btk_widet_set_uposition() brokeness.)

Fri Sep  3 03:06:30 1999  Tim Janik  <timj@btk.org>

	* btk/Makefile.am: fixed up things for -jx, x > 1.

Sun Sep  5 08:48:51 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.c (btk_widget_modify_style): Ref the
	  RC style that is passed in. The lack of the ref
	  before was a bug. If people worked around this
	  bug, this will introduce a slight memory leak
	  in their code. The code should typically look like:

	    rc_style = btk_rc_style_new ();
	    [...]
	    btk_widget_modify_style (widget, rc_style);
	    btk_rc_style_unref (rc_style);

	* btk/btkwidget.c (btk_widget_modify_style): Reset
	  the style if it was already set.

	* btk/btkwidget.c (btk_widget_set_name): Only set the
	  style if it was set before.

Thu Sep  2 19:02:37 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/testbtk.c (main): Add a check to see if we
	  are being run from the correct directory and
	  to quit nicely if we are not.

	* btk/btkrc.c (btk_rc_slist_remove_all): Make function
	  static.

Thu Sep  2 23:00:03 1999  Tim Janik  <timj@btk.org>

	* btk/btkenums.h (BtkWindowPosition): added BTK_WIN_POS_CENTER_ALWAYS.

	* btk/btkwindow.c:
	queue resizes unconditionally (btk_widget_queue_resize will figure
	what to do if the window is not realized).
	(btk_window_move_resize): only recenter the window
	for BTK_WIN_POS_CENTER_ALWAYS.
	(btk_window_compute_reposition): handle BTK_WIN_POS_CENTER_ALWAYS in
	the same way as BTK_WIN_POS_CENTER.

Thu Sep  2 22:39:27 1999  Tim Janik  <timj@btk.org>

	* btk/btkwindow.c (btk_window_reposition): check for the last position
	with (!(info->last_flags & BDK_HINT_POS)) instead of
	(!info->last_flags & BDK_HINT_POS).

	* btk/btkwindow.c (btk_window_move_resize): constrain new_width and
	new_height unconditionally, because we use these values even if
	!default_size_changed && !hints_changed.
	comented the (default_size_changed || hints_changed) case with
	respect to resize rejects from the window manager.

	* btk/btkwindow.c (btk_window_move_resize): save info->last values
	in the zvt condition hack, since this includes the window hints, set
	the hints after the handling_resize case.

	* btk/btkwindow.c (btk_window_show): constrain the default size that a
	window is initially shown with to the geometry.

Thu Sep  2 07:38:56 1999  Tim Janik  <timj@btk.org>

	* btk/btkwindow.c (btk_window_move_resize):
	s/size_changed/default_size_changed/g so i know what's
	really going on (frying brain on smaller flame now).

Thu Sep  2 05:47:47 1999  Tim Janik  <timj@btk.org>

	* btk/btkwindow.c (btk_window_move_resize): queue a new resize if
	we have size_changed upon handling_resize. this is a gross
	workaround for the broken zvt widget and should be removed in
	1.3 again (search for FIXME).
	Owen provided an accurate comment for this:

        /* We could be here for two reasons
         *  1) We coincidentally got a resize while handling
         *     another resize.
         *  2) Our computation of size_changed was completely
         *     screwed up, probably because one of our children
         *     is broken. It's probably a zvt widget.
         *
         * For 1), we could just go ahead and ask for the
         * new size right now, but doing that for 2)
         * might well be fighting the user (and can even
         * trigger a loop). Since we really don't want to
         * do that, we requeue a resize in hopes that
         * by the time it gets handled, the child has seen
         * the light and is willing to go along with the
         * new size. (this happens for the zvt widget, since
         * the size_allocate() above will have stored the
         * requisition corresponding to the new size in the
         * zvt widget)
         *
         * This doesn't buy us anything for 1), but it shouldn't
         * hurt us too badly, since it is what would have
         * happened if we had gotten the configure event before
         * the new size had been set.
         */

Wed Sep  1 20:46:11 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btkrc.c: deal properly with the fact that RC
	  style lists may include rc styles more than once.

	* btk/btkrc.c (btk_rc_append_pixmap_path): Removed
	  unused static function.

	* btk/btkrc.c (btk_rc_find_pixmap_in_path): Keep a
	  stack of directories of RC files currently being
	  parsed and implicitely add them to pixmap path.
	  
	  This fixes a bug where the directory would get
	  appended then overwritten by pixmap_path declarations.

	  (bug #1462, from Peter Wainright <prw@wainpr.demon.co.uk>)

	* btk/btkthemes.c (btk_theme_engine_unref): Call
	  theme's exit function. (Patch from Peter Wainwright,
	  bug #1454)

	* btk/btkradiomenuitem.c (btk_radio_menu_item_destroy):
	  Add a destroy() handler to take care of removing
	  group for menu item. (Fixes bug #1197)

	* btk/btkwidget.c (btk_widget_size_request): Fixed thinko
	  in warning message.

Wed Sep  1 21:27:42 1999  Tim Janik  <timj@btk.org>

	* btk/btkwindow.c (btk_window_move_resize): don't require a server
	roundtrip to figure window's width and height, since we know that
	anyways from widget->allocation.

Wed Sep  1 12:37:44 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwindow.c (btk_window_move_resize): Compute
	  the hints after we request the new size.

Wed Sep  1 10:38:37 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwindow.c (btk_window_compute_hints): Removed
	  BTK_WIDGET_REALIZED() assertion - we can compute the
	  hints before we are realized.

	* btk/btkwindow.c (btk_window_move_resize): Reorder
	  hint changing so that we have a value of hints_changed
	  when we decide whether to constrain the window size.

	* btk/btkwindow.c (btk_window_move_resize): Spelling fix.

	* btk/btkwindow.c (btk_window_constrain_size): cleanups,
	change back to G_MAXINT.

Wed Sep  1 06:54:59 1999  Tim Janik  <timj@btk.org>

	* btk/btkwindow.c (btk_window_get_geometry_info): zero initialize
	new BtkWindowGeometryInfo, so fields like BdkGeometry geometry
	contain uncluttered values.
	(btk_window_compute_hints): simply assert that window is realized
	and that geometry_info is valid, since we rely on this anyways.
	(btk_window_constrain_size): major cleanups to the code.
	if (flags & BDK_HINT_BASE_SIZE) use geometry's base width and height
	for the base size, instead of the minimums. use 32767 as max width
	and height (like in btkwindow.c) instead of G_MAXINT.

Wed Sep  1 04:41:25 1999  Tim Janik  <timj@btk.org>

	* cleaned up the BtkContainer.need_resize flag handling mess, we
	only need to force resize requests when we were prematurely
	realized, or our widget tree was modified when we were temporarily
	hidden. handling these cases directly upon showing the window (i.e.
	while the BdkWindow is still unmapped) avoids the need to wait for
	a configure event response and therefore makes the GUI more snappier
	and avoids blank windows during the roundtrip.

	* btk/btkwidget.c:
	(btk_widget_hide): 
	(btk_widget_show): don't queue resizes on toplevels, they know how
	to deal with matters.

	* btk/btkcontainer.c (btk_container_queue_resize): set the ->need_resize
	flag directly for not visible resize containers and spare us unecessary
	signal emissions.

	* btk/btkwindow.c:
	(btk_window_realize): if we need to enforce premature size allocation,
	queue a container resize so we are correctly resized later on.
	(btk_window_init):
	(btk_window_size_request):
	don't freak around with the ->need_resize flag,
	btk_container_queue_resize() will care about that.
	(btk_window_show):
	handle initial resizing issues here, we can handle matters better in
	this place, especially since we know that our BdkWindow is still
	unmapped.
	(btk_window_move_resize):
	don't care about ->need_resize at all.
	handle size changes properly that occoured while we waited for a
	configure event.

Tue Aug 31 15:58:46 1999  Owen Taylor  <otaylor@redhat.com>

        * btk/btkwidget.c (btk_widget_set_uposition):
        * btk/btkwindow.[hc] (btk_window_reposition):
        Move the hint setting code from btk_widget_set_uposition
        to here; set the hints so that we respect any previously
        set geometry hints.

        * btk/btkwindow.c (btk_window_compute_reposition): Don't
        change the window hints here or move the window here,
        let that happen in btk_window_move_resize().

Tue Aug 31 06:58:52 1999  Tim Janik  <timj@btk.org>

	* btk/btkwidget.c (btk_widget_event): when discarding exposes due
	to already queued resizes (and therefore redraws) on a widget, check
	its anchestry as well.

	* btk/btkcontainer.c:
	(btk_container_queue_resize): clear resize widgets for resize
	containers before aborting prematurely. this is especially important
	for toplevels which may need imemdiate processing or their resize
	handler to be queued.
	(btk_container_dequeue_resize_handler): added new internal function for
	btkwindow.c.

	* btk/btkwindow.c (btk_window_move_resize): if we are resizing due to a
	configure event, take possible changes in window position into account
	as well.
	if we request a new window size, queue up a resize handler that will
	last until the configure event response arrives.
	combined the ->need_resize case (initial show) with the general size
	(hints) changed case and added even more comments.
	if !auto_shrink, only revert to the old allocation if the new size
	is smaller than the current allocation.

Tue Aug 31 11:55:20 1999  Owen Taylor  <otaylor@redhat.com>

        * btk/btkwindow.c (btk_window_set_arg, btk_window_set_policy,
                           btk_window_set_geometry_hints
                           btk_window_set_default_size):
        When hints are set, queue a resize so that the hints will
        be eventually reset on the toplevel.

        * btk/btkwindow.c (btk_window_show): Use
        btk_window_compute_default_size(). Clear the need_resize flag
        on the initail map so that we don't unnecessarily trigger the
        resize code.

        * btk/btkwindow.c (btk_window_move_resize): Split apart
        into separate functions. Compare the hints we are setting
        with what we set last time so that we can accurately
        tell when we need to reset the hints.

        * btk/btkwindow.c (btk_window_compute_default_size): New
        function to figure out the size from requisition
        and default_size.

        * btk/btkwindow.c (btk_window_constrain_size): Function
        from fvwm to constrain a size to the geometry hints.

        * btk/btkwindow.c (btk_window_compare_hints): New function
        to compare two sets of geometry hints.

        * btk/btkwindow.c (btk_window_compute_hints): Renamed
        from btk_window_set_hints(), just compute the hints,
        don't set them.

        * btk/btkwindow.c (btk_window_compute_reposition): Move
        code from btk_window_move_resize() to separate function,
        rationalize a bit.

Tue Aug 31 13:05:03 1999  Owen Taylor  <otaylor@redhat.com>

	* btkrc.h: Move the ref_count member out of the BtkRcStyle
	structure into a new private structure.

	* btkrc.c: Split BtkRcStyle into public/private.
	In the private part, add a list of pointers to the
	RcStyle lists this RcStyle participates in.

	* btkrc.c: When a RcStyle is free, remove all
	lists referencing it from the 
	realized_style_ht hash, and free those lists.
	
	* btk/btkrc.c (btk_rc_clear_styles): Don't call
	btk_rc_init(), since that adds the default styles
	to the list of parsed RC files again.

	* btk/btkrc.c: Use btk_rc_style_find() consistently.
	
Thu Aug 26 14:14:42 1999  Tim Janik  <timj@btk.org>

	* btk/btkwidget.c (btk_widget_size_allocate): reactivated the sanity
	checks that ensure that a widget's allocation is at least 1 in width
	and height. (BUNNY note: this doesn't affect old panel code anymore,
	because BtkSocket will request width and height of at least 1 since
	Fri Jul 23).

	* btk/btkwindow.c (btk_window_realize): if the widget hasn't been
	allocated yet (happens if the user realizes the window prematurely),
	size request and allocate it.
	(btk_window_size_allocate): guard against guint underflows.

Wed Aug 25 19:01:36 1999  Lars Hamann  <lars@btk.org>

	* btk/Makefile.am (btk_built_sources): reordered stamp-btk.defs
 	in btk_built_sources, so btk.defs gets built prior to all other
 	sources.

Mon Aug 23 19:11:17 1999  Tim Janik  <timj@btk.org>

	* btk/Makefile.am:
	invoke indent on btkmarshal.*. 
	rewrote source generation rules, use COPYING as oldest source tag for
	a piggyback rule to generate all sources from (don't touch it ;).
	major cleanups, strip spaces on build rules for GNU Make.

	* btk/genmarshal.pl: don't operate on hardcoded filenames but take
	source and target files from commandline arguments. don't invoke indent.

Sat Aug 21 14:07:36 1999  Lars Hamann  <lars@btk.org>

	* btk/btknotebook.c (btk_notebook_real_switch_page): queue_resize
	notebook after switch to avoid drawing problems.
	(Bug#856 Reported by: Theodore Roth <troth@netmagic.net>)
	
	(btk_notebook_pages_allocate): don't map not visible tab_labels, 
	show them instead. 
	(Bug#1805 Reported by: Dave Cole <dave@dccs.com.au>)

Sat Aug 21 14:07:36 1999  Lars Hamann  <lars@btk.org>

	* btk/btknotebook.c (btk_notebook_real_switch_page): queue_resize
	notebook after switch to avoid drawing problems.
	(Bug#856 Reported by: Theodore Roth <troth@netmagic.net>)
	
	(btk_notebook_pages_allocate): don't map not visible tab_labels, 
	show them instead. 
	(Bug#1805 Reported by: Dave Cole <dave@dccs.com.au>)

Wed Aug 18 09:20:10 1999  Tim Janik  <timj@btk.org>

	* btk/btkwindow.c:
	we use window->need_resize from configure_event now, to indicate that
	the btkwindow should keep its allocation (e.g. because the user resized
	the window through window manager handles). resize_count is now reliably
	used to figure whether we got the allocation we requested from the
	window manager.
	configure events get queued as resizes now, the real stuff (size
	computation and allocation) now only goes on in btk_window_move_resize().
	BtkWindow's requisition now contains its *real* requisition (like all
	other widgets), *not* taking usize into account.
	geometry_info->last_{width|height} is now updated from set_hints() only
	so it always contains the last hints we set for the window manager.
	made some event handlers return TRUE instead of FALSE.
	the overall code should be much more straight forward now, and the
	significant code portions are accompanied by comments now.
	(btk_window_set_hints):
	removed requisition argument and made it
	fetch the requisition through btk_widget_get_child_requisition.
	we also don't move the bdkwindow here anymore, btk_window_move_resize()
	does that now.
	(btk_window_show):
	ensure that the widget is realized before calling 
	btk_container_check_resize() (and thus btk_window_move_resize()), also
	ensure that we got properly size requested and allocated before
	realization.
	(btk_window_configure_event):
	ignore plain window moves, or reallocate the widget tree through the
	resize queue otherwise.
	(btk_window_move_resize):
	mostly rewrote this function to figure window manager hints more
	reliably, coalesce window moves and resizes to reduce configure events
	and do actuall size allocations.

Tue Aug 17 07:43:04 1999  Tim Janik  <timj@btk.org>

	* btk/btkwidget.c (btk_widget_event): discard expose events for widgets
	that have a resize pending, because a redraw is already queued for them.

	* btk/btkcontainer.c: removed ugly connect_to ::size_allocate signal
	hack to clear resize_widgets.

	* btk/btkwidget.c (btk_widget_size_allocate): call clear_resize_widgets
	for resize containers prior to size allocation. (this is also a bit
	ugly, but avoids side effects for stopped emissions and is thus more
	reliable).
	(btk_widget_unparent): removed disconnect call for clear_resize_widgets.

	* btk/btktooltips.c (btk_tooltips_paint_window): renamed this
	function from btk_tooltips_expose, as we connect to ::expose_event
	*and* ::draw now.

1999-08-18  Federico Mena Quintero  <federico@redhat.com>

	* btk/btkselection.c (btk_target_list_ref): Added missing sanity
	checks.
	(btk_target_list_unref): Likewise.

	* btk/btkthemes.c (btk_theme_engine_unref): Likewise.

Tue Aug 17 15:47:07 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btkcolorsel.c (btk_color_selection_draw_value_bar):
	guard against division by zero. (Fixes bug #1339)

Tue Aug 17 10:56:49 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btkentry.c (btk_move_{forward,backward}_word): 
	Prevent the trivial leak of information of allowing
	word motion when the entry is not visible.

Tue Aug 17 10:28:52 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btkfilesel.c (btk_file_selection_fileop_error): Propagate
	modality to error dialog as well as confirmation dialogs.
	(Bug #1803, reported by Rosanna Wing Sze Yuen)

Wed Aug 11 01:04:57 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btktreeitem.c (btk_tree_item_draw_lines): Honor
	tree->view_lines.
	(btk-guy-990611-3.patch: Guy Harris <guy@netapp.com>)

	* btk/Makefile.am (install-data-local): Solaris apparently
	has various troubles with ln -f; use rm first instead.
	(btk-guy-990611-2.patch: Guy Harris <guy@netapp.com>)

1999-07-30  Raja R Harinath  <harinath@cs.umn.edu>

	* btk/Makefile.am (stamp-m): Don't `mv' from builddir to srcdir,
	use `cp' followed by `rm' (the `rm' was already there).

July 30, 1999 Elliot Lee <sopwith@redhat.com>
	
	* configure.in: Fix autoconf warnings about cross compilation by
	trying to provide sane defaults for AC_TRY_RUN.
	* btk/Makefile.am: If we refer to btkmarshal.[ch] in $(srcdir),
	put them into $(srcdir) when generated. Also add a dependency of
	btksignal.h on btkmarshal.h for -j builds. 
	* btk/btk(dnd,style,gamma).c: Minor warning fixes.

Wed Jul 28 09:29:19 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmain.c (btk_main_iteration_do): Added missing
	BDK_THREADS_{LEAVE,ENTER} pair.
	(From Paul Fisher <pnfisher@redhat.com>)

Fri Jul 23 01:00:15 1999  Tim Janik  <timj@btk.org>

	* btk/btksocket.c (btk_socket_size_request): asure that the requested
	width and height are always >0 (owen).

Fri Jul 23 00:00:47 1999  Tim Janik  <timj@btk.org>

	* btk/btkwidget.c (btk_widget_size_allocate): backed out my recent
	change that assured that a widget's allocated with and height are
	always >1, since this breaks *buggy* panel code. unfortunately this
	back-breaks the gimp's color selector.

	* btk/btkdrawingarea.c (btk_drawing_area_size_allocate): asure that our
	allocation is always >0 in width and height, before sending the
	configure event; this is a *gross* hack to get the gimp back to work.
	
	* marked both cases with TODO-1.3

Wed Jul 21 15:47:39 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btktext.c: Don't display wrap indicators when
	text is not editable and word wrap is on.

Wed Jul 21 08:21:40 1999  Tim Janik  <timj@btk.org>

	* btk/btkitemfactory.c (btk_item_factory_create_item): special case
	option menus here as they are not derived from menu shell, assure that
	the option menu has a menu we can add items to.

Tue Jul 20 23:29:48 1999  Tim Janik  <timj@btk.org>

	* btk/btknotebook.c (btk_notebook_page_allocate): convert allocation->
	width/height to (gint) before calculations and check against < 0 to
	avoid guint wraparounds.

Sun Jul 18 00:35:49 1999  Tim Janik  <timj@btk.org>

	* btk/btkwidget.c (btk_widget_size_allocate): ensure that the allocated
	width and height is never zero. sanity check both dimensions against
	32767 and issue a warning if the allocation is greater than that.

Wed Jul  7 15:03:30 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmain.c (btk_events_pending): Unlock around call
	to g_main_pending() as well.

Wed Jul  7 14:59:01 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmain.c (btk_main_iteration): Unlock around
	call to g_main_iteration() - since that will regrab
	BTK+ lock to process events.

Thu Jul  1 15:01:55 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwindow.c
	- Regularize with the rest of BTK+ by making widget->requisition
	  not reflect the set_usize()
	- Always recompute geometry hints, then check if they
	  changed before sending them to the X server. The
	  previous checks for changes would fail in a number
	  of circumstances. 

Thu Jul  1 11:55:59 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btkstyle.c: Include <stdlib.h> for strcmp().

Wed Jun 30 19:26:36 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btkdnd.c:
	- Code cleanups
	- Instantaneously update on modifier key presses
	- Allow cancellation of the drag with Escape.

Tue Jun 29 17:04:09 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/testbtk.c (create_handle_box): Set the policy
	to auto_shrink - otherwise the appearance is rather
	strange when flipping between horizontal and vertical.

Mon Jun 28 09:29:52 1999  Tim Janik  <timj@btk.org>

	* btk/btkwindow.c: add ::default_width and ::default_height arguments.
	(btk_window_set_default_size): don't change a value if it's < 0.
	queue a resize.

Sun Jun 27 11:00:33 1999  Tim Janik  <timj@btk.org>

	* btk/btktext.c (btk_text_insert): don't segfault on NULL inserts.

Mon Jun 28 12:08:25 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btkfilesel.c (cmpl_completion_fullname): Don't
	add an extra "/" when concating "/" + filename.
	(From Matt Grossman <mattg@oz.net>)

Mon Jun 28 10:57:12 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btkctree.c (draw_cell_pixmap): Reset clip mask
	for fg_gc if we set it for drawing pixmap.

Tue Jun 15 12:45:12 1999  Owen Taylor  <otaylor@redhat.com>

        Fixes from Peter Wainwright <prw@wainpr.demon.co.uk>
	
	* btk/btkrc.c (btk_rc_parse_engine): If rc_style->engine is
	already set, call old engine's destroy function and
	unref the old engine.

Thu Jun 10 17:59:38 1999  Tim Janik  <timj@btk.org>

	* btk/btkdrawingarea.c (btk_drawing_area_size): queue a resize.

Wed Jun  9 15:13:16 1999  Tim Janik  <timj@btk.org>

	* btk/btkaccelgroup.h: mark certain functions as internal.

Wed Jun  9 13:48:28 1999  Tim Janik  <timj@btk.org>

        * btk/btkpreview.c (btk_preview_set_expand): queue a resize if the
        expand behaviour changed.

        * btk/btklabel.c (btk_label_set_pattern):
        (btk_label_set_justify):
        (btk_label_set_line_wrap):
        don't bother invoking queue_clear, the reallocation does
        that for us, always free_words so the upcoming resize will
        relayout the label's contents.

Wed Jun  9 12:50:48 1999  Tim Janik  <timj@btk.org>

        * applied argument implementation patches from Elena Devdariani
        <elena@cogent.ca>.

        * btk/btktoolbar.c: ::orientation, ::toolbar_style, ::space_size,
        ::space_style, ::relief
        * btk/btkruler.c: ::lower, ::upper, ::position, ::max_size
        * btk/btkpreview.c: ::expand
        * btk/btkpaned.c: ::handle_size, ::gutter_size
        * btk/btknotebook.c: ::homogeneous
        * btk/btklabel.c: ::wrap
        * btk/btklist.c: ::selection_mode
        * btk/btkhandlebox.c: ::handle_position, ::snap_edge
        * btk/btkcurve.c: ::curve_type, ::min_x, ::max_x, ::min_y, ::max_y
        * btk/btkcolorsel.c: ::update_policy, ::use_opacity
        * btk/btkclist.c: ::sort_type
        * btk/btkcheckmenuitem.c: ::active, ::show_toggle
        * btk/btkaspectframe.c: ::xalign, ::yalign, ::ratio, ::obey_child

Tue Jun  1 23:38:38 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btkstyle.c: Removed ill-thought-out part of last
	comment.

Tue Jun  1 23:30:09 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btkstyle.c (btk_style_attach): Get the reference
	counting right when we have to attach a new style
	for a different visual. (Chi-Deok Hwang <cdhwang@sr.hei.co.kr>)

	* btk/btkstyle.c: Documented the refcounting
	peculularities of btk_style_attach.

1999-06-01  Tim Janik  <timj@dhcpd7.redhat.com>

	* btk/btkwindow.c (btk_window_new): added return if fail for invalid
	window types.

	* examples/packer/pack.c (main): use BTK_WINDOW_TOPLEVEL instead
	of BTK_TOPLEVEL for creating the window.

1999-06-01  Tim Janik  <timj@dhcpd7.redhat.com>

	* btk/btkmain.c (btk_init_check): don't segfault when --btk-module is
	the last argument (reported by Per Winkvist).
	
Tue May 25 13:13:12 1999  Owen Taylor  <otaylor@redhat.com>

        Fixes for invisible XOR lines (Frank Loemker
	<floemker@TechFak.Uni-Bielefeld.DE>)
	
	* btk/btkclist.c (btk_clist_realize): Always use
	a non-zero pixel for BDK_XOR.

	* btk/btkvpaned.c btk/btkhpaned.c: 
	Use BDK_INVERT instead of BDK_XOR.

Wed May 12 21:56:40 1999  Lars Hamann  <lars@btk.org>

	* btk/btkclist.c (adjust_adjustments): signal emit value_changed
	signals if h/voffsets differ from adjustment values.
	Reportet by Jerome Bolliet <bolliet@in2p3.fr>

Mon May 10 04:20:41 1999  Tim Janik  <timj@btk.org>

	* btk/btkmenushell.c (btk_menu_shell_activate_item): propagate
	::selection-done emissions up to the topmost menu shell.

Fri May  7 10:15:14 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btknotebook.c (btk_notebook_set_scrollable): Unset
	the user data on the window before destroying it.

	* btk/btknotebook.c (btk_notebook_unrealize): Add an
	unrealize handler to take care of destroying 
	notebook->panel properly. 
	(Bug #1198 - Morten Welinder <terra@diku.dk>)

	* btk/btktext.c (expand_scratch_buffer): Fix reversal
	of g_new and g_realloc to stop memory leak. (Actually,
	we could just use g_realloc(), but I'm not 100% sure
	that is portable).
	(Bug #1196 - Morten Welinder <terra@diku.dk>)

Wed Apr 21 00:42:08 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btkplug.h: Removed stray BtkPlugButton declaration.

	* bdk/bdkfont.c (bdk_text_measure): Fix the return value
        for fontsets.

	* btk/btkbutton.c (btkbutton_expose): Fix warning
	with bin/button confusion.

Thu May  6 04:53:26 1999  Tim Janik  <timj@btk.org>

	* btk/testbtk.c: in the ItemFactory test, link radio items together,
	and show how preselection of radio items is done.

Sun May  2 13:31:14 1999  Tim Janik  <timj@btk.org>

	* btk/btktreeitem.c (btk_tree_item_set_subtree): 
	* btk/btktree.c (btk_tree_add) (btk_tree_insert):
	* btk/btktoolbar.c (btk_toolbar_insert_element): 
	* btk/btkpaned.c (btk_paned_pack2) (btk_paned_pack1):
	* btk/btkscrolledwindow.c (btk_scrolled_window_add): 
	* btk/btktable.c (btk_table_attach): 
	* btk/btklist.c (btk_list_insert_items): 
	* btk/btkmenushell.c (btk_menu_shell_insert): 
	* btk/btknotebook.c (btk_notebook_insert_page_menu): 
	* btk/btkpacker.c (btk_packer_add_defaults) (btk_packer_add): 
	* btk/btkbin.c (btk_bin_add): 
	* btk/btkbox.c (btk_box_pack_start) (btk_box_pack_end): 
	* btk/btkfixed.c (btk_fixed_put): 
	* btk/btklayout.c (btk_layout_put):
	general fixups to container_add logic. always realize child if
	child->parent is realized, only map the child and queue a resize
	if child and child->parent are both visible.

Fri Apr 30 09:02:28 1999  Tim Janik  <timj@btk.org>

	* btk/btkwidget.c (btk_widget_real_unrealize): use btk_container_forall
	instead of btk_container_foreach to walk and unrealize children, so
	composite children get also unrealized.
	(btk_widget_real_show): don't call btk_widget_map() if we don't need to.
	(btk_widget_map): assert that the widget is visible (basic constrain).
	(btk_widget_real_map): assert that the widget is realized (basic
	constrain).

Fri Apr 29 00:53:20 1999  Tim Janik  <timj@btk.org>

	* btk/btkbindings.c (btk_pattern_spec_init): plugged a memory leak.

Tue May  4 09:32:08 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/Makefile.am btk/btkrc.iso-8859-2: Add a btkrc
	file for iso-8859-2 locales.

	* configure.in (ALL_LINGUAS): ALL_LINGUAS update.

Tue Apr 27 16:38:32 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/Makefile.am: Fix typo of static_sources for static_SOURCES.
	 (Pointed out by andy@rz.uni-karlsruhe.de and others).
	 Remove some suspicious and useless lines. 

Tue May  4 08:44:08 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btkclist.c (btk_clist_draw, draw_rows): Use 
	width,height = 0, 0 to mean - here to edge of window,
	instead of -1, -1, since the former is all we support.

Tue May  4 08:34:43 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btkmain.c (btk_main): Correctly free list nodes
	when removing from quit_functions list.

Tue Apr 27 14:17:16 1999  Tim Janik  <timj@btk.org>

	* btk/btkpacker.c (btk_packer_size_request): remove unused variable.

Tue Apr 27 18:23:35 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btkentry.c (btk_entry_draw_cursor_on_drawable): 
	 When redrawing characters on non-visible entry, use appropriate
	 '*' character. (Bug #1130 - Jean-Marc Jacquet <jm@littleigloo.org>)

Tue Apr 27 01:31:40 1999  Lars Hamann  <lars@btk.org>

	* btk/btkclist.c (drag_dest_cell): compute destination cell
	from drag coordinates.
	(btk_clist_drag_data_received) (btk_clist_drag_motion):
 	use drag_dest_cell.

	* btk/btktree (drag_dest_cell)
	(btk_ctree_drag_data_received) (btk_ctree_drag_motion): likewise.
	(Bug #1129)

Wed Apr 21 21:26:11 1999  Tim Janik  <timj@btk.org>

	* btk/btkitemfactory.c (btk_item_factory_init): properly initialize
	translate_* fields.
	(btk_item_factory_finalize): invoke translate_notify independant from
	translate_data.
	(btk_item_factory_set_translate_func): likewise.
	(btk_item_factory_destroy): only remove ifactory pointer from those
	widgets that belong to us (stupid me).

Mon Apr 19 12:05:31 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btkrc.c (btk_rc_style_init): Fixed leak of
	rc_style list when lookup succeeeds.

Thu Apr 15 01:11:24 1999  Lars Hamann  <lars@btk.org>

	* btk/btkctree.c (resync_selection): 
	* btk/btkclist.c (resync_selection): fixed undo_selection bug.
	* btk/btkclist.c (btk_clist_button_release): fixed resync_selection
 	bug.

Fri Apr  9 19:22:19 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btkcolorsel.c btk/btkdnd.c btk/btkmenuitem.c:
	Add some missing BDK_THREADS_ENTER()/LEAVE around
	timeouts. (Patches from Sebastian Wilhelmi <wilhelmi@ira.uka.de>)

Thu Apr  8 20:10:33 1999  Tim Janik  <timj@btk.org>

	* btk/btkentry.c (btk_entry_key_press): use btk_widget_activate()
	rather than emit_by_name.

	* btk/btkeditable.c (btk_editable_insert_text): keep a reference
	on the widget across multiple signal emissions.
	(btk_editable_delete_text): same here.
	(btk_editable_class_init): set widget_class->activate_signal after
	editable_signals[ACTIVATE] has been created.

Wed Apr  7 22:59:47 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btkpaned.c (btk_paned_set_position): Don't clamp
	position here prematurely -- we might not have the
	right ->min_position and ->max_position yet.

Tue Apr  6 16:38:51 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btkselection.c bdk/bdkselection.c: (btk_selection_request):
	Add error traps so if the other end of the connection
	dies, we survive.

	* btk/btkselection.c (btk_selection_notify): Clean
	up properly when selection property retrieval fails.
	
	* btk/btkselection.c (btk_selection_request): Correctly
	reject SelectionRequest notifies where the handler
	returns no data.

Tue Apr  6 12:24:21 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btkdnd.c (btk_drag_dest_leave): Only unhighlight
	when we've previously highlighted.

	* btk/btkdnd.c (btk_drag_dest_handle_event): Don't
	emit two "drag_leave" signals for Motif drops.

	* btk/btkdnd.c (btk_drag_source_handle_event): Send
	back the correct status messages when dropping from
	Motif onto a proxy window that is rejecting the
	drop.

Sat Mar 27 23:32:13 1999  Tim Janik  <timj@btk.org>

	* btk/btkarg.[hc]: added functions from GLE, btk_arg_reset() to free
	the value and reset type to BTK_TYPE_INVALID, and btk_arg_values_equal()
	to compare two argument values. added btk_arg_to_valueloc() to set a
	variable from an arg through its location (pointer).

	* btk/btkobject.[hc]: implemented btk_object_get() in terms of
	btk_object_arg_get() and btk_arg_to_valueloc(), floats are collected
	as gfloat*, uchars are collected as guchar*, ints are collected as
	gint*, etc...

Mon Mar 29 17:45:47 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btkaccelgroup.c btk/btkbtkbindings.c:
	Include <string.h> instead of <strings.h>.

	* btk/btkstyle.c: Fix double include of btkthemes.h
	(actually, a lot more duplicate includes occur if
	 you trace through the sequence of #include's)
	btk-jbb-990320-0: John Bley, jbb6@acpub.duke.edu
	
Mon Mar 29 17:02:58 1999  Owen Taylor  <otaylor@redhat.com>

        Patches from Akira Higuchi <a-higuti@math.sci.hokudai.ac.jp>
	btk-a-higuti-990322-[0-3]

	* configure.in: Fix confusion between BTK_LOCALE_[C]FLAGS
	that was causing -DX_LOCALE not	to work.

	* btk/btkrc.c (btk_rc_init):
	X_LOCALE will never have LC_MESSAGES defined

Thu Mar 25 12:38:31 1999  Tim Janik  <timj@btk.org>

	* btk/btkrc.c (btk_rc_append_default_module_path): get $HOME from
	g_get_home_dir() (btk-pmc-990123-0.patch.gz).

	* btk/btkwindow.c (btk_window_key_press_event): feature keypad up/down/
	left/right as well (btk-michael-980726-0.patch.gz).

	* btk/btklabel.[hc]: bunch of miscellaneous cleanups, such as s/0/NULL/
	for pointer values, use gchar instead of char. fixed uline allocation
	leaks, changed the allocation pattern so we use G_ALLOC_AND_FREE mem
	chunks instead of G_ALLOC_ONLY.
	(btk_label_size_request): always alter requisition as passed and leave
	widget->requisition alone.
	(btk_label_set_text): allow NULL strings.
	(btk_label_new): likewise.

Wed Mar 24 09:24:03 1999  Tim Janik  <timj@btk.org>

	* btk/btkdrawingarea.[hc]: type/macro fixups.

Mon Mar 22 05:51:34 1999  Tim Janik  <timj@btk.org>

	* btk/btkbin.c (btk_bin_draw): only redraw children that are visible
	*and* mapped (i.e. drawable).
	(btk_bin_expose): only send exposes to drawable children.

	* btk/btkbox.c (btk_box_draw): only redraw children that are drawable.
	(btk_box_expose): only send exposes to drawable children.

	* btk/btkhscale.c (btk_hscale_draw): 
	* btk/btkvscale.c (btk_vscale_draw):
	hm, this is an ugly one. we first compute the size of our trough area
	here (window relative) and then check intersection with the draw_area
	which is parent relative because we're a NO_WINDOW widget, so we need
	to offset the trough area by allocation.x and allocation.y before the
	check. (this must not be done for the background area though, since
	that's already computed parent relative).

Mon Mar 22 00:41:39 1999  Lars Hamann  <lars@btk.org>

	* btk/btkclist.c (btk_clist_unrealize): unmap clist if neccessary,
	unrealize title buttons.

Fri Mar 19 00:00:22 1999  Lars Hamann  <lars@btk.org>

	* btk/btkclist.c (btk_clist_column_title_passive)
	(btk_clist_column_title_active): 
	only connect/disconnect to BtkWidgetClass::event to block mouse events.

	* btk/btkclist.c (vertical_timeout) (horizontal_timeout): 
	zero initialize event, removed superfluous bdk_window_get_pointer call

	* btk/btklist.c (btk_list_vertical_timeout)
	(btk_list_horizontal_timeout): removed superfluous
 	bdk_window_get_pointer call

Wed Mar 17 09:00:00 1999  Tim Janik  <timj@btk.org>

	* plugging problems reported by "Bruce Mitchener, Jr."
	<bruce@puremagic.com> due to a purify session.

	* btk/btkstyle.c:
	(btk_style_ref): 
	(btk_style_unref): assert ref_count to be > 0.

	* btk/btkclist.c (btk_clist_set_cell_style): { 0 } initilaize
	the requisition.
	(btk_clist_set_shift): likewise.

	* btk/btklayout.c: introduce btk_layout_finalize() to unref the
	adjustments.

	* btk/btklist.c (btk_list_horizontal_timeout): zero initialize the
	event before sending it and set send_event to TRUE (which needs to
	be done for *all* synthesized events).
	(btk_list_vertical_timeout): likewise.

	* btk/btktipsquery.c (btk_tips_query_destroy): plug small memory
	leaks.

	* btk/btkdrawingarea.c (btk_drawing_area_send_configure): set send_event
	to TRUE when synthesizing events.

[ *** end of merges from 1.2 *** ]	
	
1999-11-21  Tor Lillqvist  <tml@iki.fi>

	* bdk/bdkconfig.h: Remove, as this is a file generated by configure
	(or copied from bdkconfig.h.win32 on Win32, sigh).

	* bdk/bdkprivate.h: Mark bdk_parent_root for export from DLL.

	* bdk/bdk.c (bdk_keyval_convert_case): Fix typo.

	* bdk/bdkgc.c (bdk_gc_alloc): Remove duplicated line.

	* bdk/bdkconfig.h.win32: New file.

	* bdk/win32/makefile.cygwin: Build just a static archive here.

	* bdk/makefile.cygwin: New file. Get the win32-specific stuff
	for the DLL from the static archive built above.

	* bdk/bdk.def: Moved here from the win32 subdirectory.

	* bdk/win32/*: Adapt for the changed private struct organisation.

	* btk/makefile.{cygwin,msc}: Get bdk library from ../bdk now.

Sun Nov 21 16:44:35 1999  Stefan Jeske  <stefan@btk.org>

        * btk/btkspinbutton.c (btk_spin_button_button_press): Added support 
        for wheel mice (buttons 4 and 5).

1999-11-18  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkgc-win32.c (bdk_gc_predraw): Also for truecolor
	drawables use just the pixel field in the foreground and
	background BdkColor of the BdkGC.

	bdk_gc_set_{fore,back}ground() are called in the GIMP with
	BdkColors containing uninitialized (red,green,blue) fields, and
	just the pixel field filled in, and furthermore in the
	visual-dependent format as returned by bdk_rgb_xpixel_from_rgb().
	It thus turns out that we really don't need to have the full
	BdkColor for fg and bg in BdkGCWin32Data after all. Will change
	it later to have just the pixel values.

Mon Nov 15 17:17:51 GMT 1999 Tony Gale  <gale@btk.org>

	* docs/btkfaq.sgml: s/btk_main_iteration/g_main_iteration/

Sat Nov 13 22:30:29 GMT 1999 Tony Gale  <gale@btk.org>

	* docs/btkfaq.sgml: threads example from Erik Mouw.
	New question on BtkLabel background colors.

	* docs/btk_tut.sgml:
	  - Correct the example code callback
	    function definitions.
	  - Update the btkdial example code, from Frans van Schaik.
	  - Update setselection.c to current API.

        * examples/Makefile examples/*/*.c: Update to code
        listed in tutorial.

1999-11-10  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkfont-win32.c: Fix a couple of bugs. The Unicode
	subrange table (from the "Developing International Software for
	WIndows 95 and Windows NT" book) was missing the Hangul syllable
	block... Get the loaded font's charset correctly.

	(Note that this, and the other *-win32.c files, still really are
	the old ones, the win32 subdirectory is not ready for compilation
	yet after the reorg.)

Wed Nov 10 17:26:49 GMT 1999 Tony Gale  <gale@btk.org>

	* btk/btkclist.c: Fix off-by-one bug in parameter
	check.

Wed Nov 10 12:12:03 1999  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkinput-{x11,xfree}.c: Call XFreeDeviceState()
	on results of XQueryDeviceState().

Mon Nov  8 16:40:43 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.c: Substitute bdkx.h => bdkprivate.h since
	we need to accesss only ->children. We need an accessor
	for the children.

	* btk/btkhandlebox.c btk/testbtk.c: Substitute G
	DK_ROOT_PARENT() => NULL, in call to btk_window_get_pointer()
	to get rid of bdkx.h include.
	
	* btk/btkctree.c: Get rid of #include <bdk/bdkx.h>
	and random references to 'None'.

	* btk/btkclist.c btk/btkeditable.c btk/btkpreview.c
	Get rid of unused #include <bdk/bdkx.h>

	* btk/btkrc.c btk/btkmain.c: Get rid of #include <bdk/bdkx.h>
	bdkx.h is _X_ specific stuff. BDK_WINDOWING comes from
	bdkconfig.h.

1999-11-08  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkdraw.c
	* bdk/win32/bdkfont.c
	* bdk/win32/bdkgc.c: Various minor cleanups and bugfixes
	following yesterday's changes. (Unrelated to Owen's reorg.)

Mon Nov  8 16:18:25 1999  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkinput-gxi.c: Add missing include,
	  fix BdkWindowPrivate => BdkDrawablePrivate.

	* bdk/x11/bdkinputprivate.h: include <X11/Xlib.h>.

	* bdk/x11/Makefile.am (xinput_sources): Add missing
	backslash to fix building with --with-xinput=none

Mon Nov  8 14:47:04 1999  Owen Taylor  <otaylor@redhat.com>

	Move all X specific code into the x11/ directory.
	Aside from shuffling things around, did the following:

       * bdk/bdkprivate.h bdk/bdk.h bdk/x11/bdkmain-x11.h: Add
	 bdk_arg_context_* - a simple argument parsing system
	 in the style of popt.

       * bdk/bdkdrawable.[ch] bdk/bdkprivate.h bdk/bdkwindow.[ch]
	 bdk/x11/bdkprivate-x11.h:
	 Remove X specific stuff from BdkDrawable and BdkWindowPrivate - 
	 add ->klass and ->klass_data fields. The klass_data
	 field points to an auxilliary structure that is
	 windowing system dependent.

       * bdk/bdkfont.c: Make most of the measurement functions
	 simply wrappers around bdk_text_extents().

       * bdk/bdkfont.c bdk/bdkprivate.h bdk/x11/bdkfont-x11.c: Add a 
	 _bdk_font_strlen() function that hides the weird
	 behavior in btk+-1.[02] where a string is interpreted
	 differently for 8-bit and 16-bit fonts.

       * bdk/bdkevents.c: Add a new function bdk_event_button_generate()
	 to store common code for synthesizing double/triple
	 press events.
	
       * bdk/bdkgc.[ch]: Virtualize in the same way as bdkdrawable.h.
	 Make all the function that modify an existing GC
	 simply wrappers around bdk_gc_set_values().
	 
       * bdk/bdkcc.[ch]: Moved into x11/ directory in preparation
	 for throwing out later.

       * bdk/bdkfont.c bdk/bdkimage.c bdk/bdkcolor.c: Change BdkFontPrivate,
	 BdkImagePrivate and BdkColormapPrivate to have a
	 windowing system dependent part (BdkFontPrivateX etc.)
	 that "derives" from the system-independent part.

       * configure.in bdk/x11/Makefile.in bdk/x11/bdkinput*.c:
	 Got rid of the included-source-files for XInput in
	 favor of automake conditionals. (Which didn't exist
	 when XInput support was originally added.)

       * bdk/bdkrgb.c: Remove the visual id from the debugging
	 statements since that is X11 specific; print out
	 type/depth info instead.
	 

Wed Nov  3 18:14:49 1999  Owen Taylor  <otaylor@redhat.com>

	* bdk/x11/bdkfont-x11.c (bdk_font_load): Ref fonts when
	loading duplicates of hashed fonts.

	* bdk/bdk.c (bdk_keysym_convert_case): rename
	bdk_XConvertCase to bdk_keysym_convert_case, allow
	results to be NULL in the BTK+ style.

	* bdk/bdkcompat.h: Started compatibility header
	for renames.

1999-11-07  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkprivate.h: New font private structures, related to
	fontsets.

	* bdk/win32/bdkfont.c: New functions bdk_font_list_new() and
	bdk_font_list_free(). On X11, will just be wrappers to
	XListFonts() and XFreeFontNames(). On Win32, the code previously
	in btkfontsel.c is now here.

	New function bdk_font_xlfd_create(). On X11 will get the FONT
	property of the font (for BDK_FONT_FONTs), or call
	XBaseFontNameListOfFontSet (for BDK_FONT_FONTSETs), on Win32
	builds a XLFD style name from the font information in the LOGFONT
	struct(s).

	New function bdk_font_xlfd_free(), which correspondingly frees the
	string returned by bdk_font_xlfd_create().

	Implement fontsets on Win32. Add a function that iterates over a
	wide char string and calls a callback function for each substring
	of wide chars from the same Unicode subrange (and thus probably
	available in the same real font).

	Improve the XLFD emulation a bit.

	* bdk/win32/bdkim.c (bdk_nmbstowchar_ts): Small bugfix.

	* bdk/win32/bdkevents.c: Workaround for suspected bug on Win2k
	Beta3, WM_IME_CHAR messages don't seem to contain the composed
	multi-byte char as with the Active IMM on Win9x. Oh well, handle
	WM_IME_COMPOSITION with GCS_RESULTSTR instead, use
	ImmGetCompositionStringW() to get the composed Unicode chars.

	* bdk/win32/bdkgc.c
	* bdk/win32/bdkdraw.c: Changes needed because of the font private
	struct changes.

	* bdk/win32/bdk.def: Add the new functions.

1999-11-04  Tor Lillqvist  <tml@iki.fi>

	* config.h.win32: Don't define HAVE_DIMM_H if MSC, as you have to
	get the Platform SDK to get <dimm.h>.

	* bdk/win32/bdkevents.c: More event handling fixes and
	simplification. Never generate motion events with is_hint true. We
	used to do that on bogus grounds earlier. Windows sends
	WM_MOUSEMOVE messages on button events even if the mouse hasn't
	moved, ignore these.

	* bdk/win32/bdkfont.c: Load all fonts as (pretended) fontsets.

	* bdk/win32/bdkglobals.c
	* bdk/win32/bdkprivate.h: Define a typedef for the pointer to
	the TrackMouseEvent function, and use it.

	* bdk/win32/bdkwindow.c: Terminate widechar string with a zero
	char before calling WideCharToMultiByte in order to get a string
	for the window title.

	* bdk/win32/bdkdnd.c: Some more random hacking, ifdeffed out.

	* bdk/win32/bdk.def: Remove obsolete functions.

	* bdk/win32/makefile.{cygwin,msc}: Remove bdkcompat.{o,obj}. Add
	/nodefaultlib and /defaultlib switches.

	* btk/btkrc.c: s/gwin_getlocale/g_win32_getlocale/.

1999-10-31  Tor Lillqvist  <tml@iki.fi>

	* bdk/bdkkeysyms.h: Add new keysyms from X11R6.4 (including
	EuroSign).

	* bdk/bdktypes.h: Add note about wchar_t not necessarily being the
	same type as BdkWChar, especially on Win32.

	* bdk/win32/*.c: Change bdk_root_parent to be a pointer.

	* bdk/win32/*.c: Assume all strings are UTF-8. Convert to Unicode
	before passing to Windows GDI for drawing etc. Convert to the
	system default codepage before passing to Windows as window
	titles.

	* bdk/win32/bdkprivate.h: Add more fields to BdkWindowPrivate to
	support changing input locale on the fly.

	* bdk/win32/bdkevent.c: Support input language (keyboard locale)
	on-the-fly changes. Convert incoming characters from the current
	codepage to Unicode (and then to a UTF-8 multi-byte string) based
	on the current input language. Use keysym<->Unicode mapping tables
	and functions borrowed from xterm sources.

	Support IMEs (Input Method Editors) for CJK languages. On non-CJK
	editions of Win9x, use the ActiveX-based Active IMM (Input Method
	Manager) if available. IMEs and the Active IMM are available under
	the disguise of Chinese, Korean and Japanese support for IE and
	Outlook Express from "Windows Update" for Win98. On Win2k, the CJK
	support is present in all editions (as long as you install it).

	Call DispatchMessage from bdk_events_queue() (and thus
	bdk_WindowProc()), instead of duplicating the code in
	bdk_WindowProc().

	Reworked the grab handling and propagation code, factored out
	duplicated code snippets into separate functions. Other cleanups,
	too.

	* bdk/win32/surrogate-dimm.h: Provide just the bits we need from
	the <dimm.h> header describing the Active IMM.

	* bdk/win32/bdkfont.c: Pretend to support fontsets, but so far
	just do the same as for "single" fonts.

	* bdk/win32/bdk.c: Call CoInitialize() (COM initialisation) from
	bdk_init_check, and CoUninitialize() from bdk_exit_func. Handle
	the new keysyms from bdkkeysyms.h.

	* btk/btkfontsel.c (Win32): Load the font for the preview as a
	fontset, so that btkentry uses wide characters.

	* btk/btkrc.c (Win32): Get the locale with gwin_getlocale(). Call
	GTk+'s system directory "btk+", not "btk".

Sat Oct 30 13:17:18 BST 1999 Tony Gale <gale@btk.org>

	* docs/btkfaq.sgml: FAQ update

1999-10-21  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkprivate.h: Add more font private data.

	* bdk/win32/bdkfont.c
	* bdk/win32/bdkdraw.c: Revamped handling of multi-byte charset
	fonts and strings. Now works much better. You still have to
	have a correct font selected, though. No fontset emulation yet.

1999-10-19  Tor Lillqvist  <tml@iki.fi>

	* btk/maketypes.awk: Use G_OS_WIN32.

	* btk/btk.def: Add some missing entry points. Also some non-public
	ones, but PyBTK porter claims to need them.

	* btk/makefile.{cygwin,msc}: Drop some unneeded headers from the
	built-in type generation.

1999-10-14  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkdraw.c (bdk_draw_text_wc): Don't use TextOutW for
	BDK_FONT_FONT fonts (which is all we have for now, we don't
	emulate fontsets). The X11 version uses plain XDrawString in that
	case, too. The string passed to bdk_draw_text_wc seems to be in
	fact (at least, when used by btkentry and btktext) either in a
	single-byte charset, or a DBCS. Not Unicode.

	This fixes the problem in btkfontsel, where even if you had
	selected a font with a non-Latin1 charset (windows-greek, for
	instance), the preview still used Latin-1 glyphs.

	* bdk/win32/bdkfont.c (bdk_text_width_wc): Similar change. Don't
	use GetTextExtentPoint32W, use GetTextExtentPoint32A.
	(bdk_font_load): Recognize the demibold etc weights, even if we
	don't have the corresponding constants in the headers.
	(bdk_font_hash_insert): Use same hash mechanism as in the X11
	version. Should save font resources a bit, when we don't have
	multiple HFONTs for the same font.

	* bdk/win32/bdkprivate.h: Add the names field as in the X11
	version.

1999-10-11  ERDI Gergo  <cactus@cactus.rulez.org>

	* bdk/bdk.c (bdk_beep): Modified the XBell call to use the default
	X values

1999-10-09  ERDI Gergo  <cactus@cactus.rulez.org>

	* btk/btktoolbar.h, btk/btktoolbar.c: Added horizontal icon/text
	layout support (as mentioned on
	http://www.jcinteractive.com/bunny-ui/software/widgets/)

Wed Oct  6 12:46:17 PDT 1999 Manish Singh <yosh@gimp.org>

	* btk/fnmatch.c
	* btk/btkfilesel.c: s/G_HAVE_CYGWIN/G_WITH_CYGWIN/

1999-10-05  Jesus Bravo Alvarez  <jba@pobox.com>

	* configure.in (ALL_LINGUAS): Added Galician (gl)

1999-10-05  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/*.[ch]: Corresponding changes as in X11 backend.

	* bdk/win32/bdkcompat.c: New file, actually provide an
	implementation for the deprecated functions. (Just temporarily.)

	* btk/btkfilesel.c: Fix an #ifdef syntax botch.

	* btk/makefile.{cygwin,msc}: Update bdk_headers.

	* bdk/win32/bdk.def btk/btk.def: Updates.

1999-10-05  Kjartan Maraas  <kmaraas@online.no>

	* configure.in: Added "uk" to ALL_LINGUAS.
	
Mon Oct  4 11:57:11 PDT 1999 Manish Singh <yosh@gimp.org>

	* configure.in: correct checking for BeOS check

	* bdk/bdktypes.h
	* btk/fnmatch.c
	* btk/btkfilesel.c
	* btk/btkitemfactory.c
	* btk/btkmain.[ch]
	* btk/btkrc.c: use G_OS_WIN32 and G_HAVE_CYGWIN #defines

Mon Oct  4 16:16:53 1999  Pablo Saratxaga <pablo@mandrakesoft.com>

	* btk/btkrc.{bg,iso88591[345]}: add btkrc files for some new charset
	encodings: iso-8859-13 (for Lithuanian), iso-8859-14 (used by celtic
	languages), iso-8859-15 (used in Estonia) and microsoft-cp1251 (used
	by Bulgarian). 

Sun Oct  3 18:13:44 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.c (btk_reset_shapes_recurse): 
	Fix a reference to window_private->destroyed.	

	* btk/btkplug.c (btk_plug_realize): Fix up a direct
	(ugly) setting of an internal BdkWindow member to use
	a _slightly_ cleaner macro.

	* bdk/bdkprivate.h: Split BdkWindowPrivate into
	BdkDrawablePrivate and BdkWindowPrivate.
	Add extra macros for accessing BDK_DRAWABLE_ components.

	* *.[ch]: Massive adjustments for the above, use the
	new macros in a lot of places.

Sun Oct  3 15:16:24 1999  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdktypes.h: Make BdkDrawable the base type,
	not BdkWindow.

Sun Oct  3 15:08:44 1999  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkdraw.c (bdk_drawable_get_data): Added new function.

Sun Oct  3 14:26:15 1999  Owen Taylor  <otaylor@redhat.com>

	* bdk/gxid* bdk/x11/gxid*: Move files into x11 subdirectory.

Sun Oct  3 14:16:23 1999  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkdrawable.h: Include bdk/bdkdrawable.h with
	bdk/ prefix. (Pointed out by chak@is.tsukuba.ac.jp)

	* configure.in bdk/Makefile.am x11/: create x-specific subdirectory.

	* docs/btk-config.1: Now autogenerated.
	* docs/Changes-1.4.txt: started
	
1999-10-03  Tor Lillqvist  <tml@iki.fi>

	* bdk/bdkimage.h bdk/bdkpixmap.h: Change BDK_WINDOWING_WIN32 usage
	to #ifdef also here.

	* bdk/win32/*.h bdk/win32/*.c: Make corresponding changes as those
	Owen did to the X11 backend.

	* bdk/win32/bdkdraw.c (bdk_draw_pixmap): Fix it again, don't use
	ScrollWindowEx when blitting inside a window, it can't be correct
	in the general case.

	* bdk/win32/bdkevents.c: Don't handle WM_SIZING, handling
	WM_GETMINMAXINFO is easier.

	* bdk/win32/bdkimage.c (bdk_image_new): Create new image with
	depth equal to the bitspixel value, not the visual's depth.

	* bdk/win32/bdkvisual.c (bdk_visual_init): Set the visual's depth
	to 24 even if the bitspixel value is 32.

	* bdk/bdkrgb.c (bdk_rgb_select_conv): After the above change, no
	need to check for depth==32 when bpp==32, depth will always be 24.

Fri Oct  1 18:03:36 1999  Owen Taylor  <otaylor@redhat.com>

        * docs/Changes-1.4.txt: Started
	
	* btk/Makefile.am (bdk_headers): Include all the new headers.

        * bdk/*.h bdk/*.c: Split bdk.h into lots of itty-bitty little pieces.
	
	* bdk/bdkprivate.h bdk/bdkcc.c: Moved BdkColorContext private
	into C file.
	
	* bdkinput.h bdkinputprivate.h - renamed the internal bdkinput
	header to bdkinputprivate.h.

	* bdk/bdk.h bdk/bdk.c: Removed bdk_time* functions which have been
	unused since before 1.2.

1999-09-30  Tor Lillqvist  <tml@iki.fi>

	* btk/btkfontsel.c (btk_font_selection_get_xlfd_field): On Win32,
	expand possible hex escapes in the font family (put there by
	logfont_to_xlfd if the font name isn't a legal XLFD font family,
	mainly if it contains slashes). (btk_font_selection_create_xlfd):
	On Win32, add hex escapes here, too.

Wed Sep 29 19:55:35 1999  Owen Taylor  <otaylor@redhat.com>

	* */*.[ch]: Changed from #if BDK_WINDOWING == BDK_WINDOWING_X11
	to #ifdef BDK_WINDOWING_X11.

[ Merges from btk-1-2 ]

Wed Sep  8 07:13:29 1999  Tim Janik  <timj@btk.org>

	* configure.in: fixed "GNU Make" check to pass with new make version
	3.77.95.

Fri Sep  3 16:04:41 1999  Tim Janik  <timj@btk.org>

	* btk-config.in (--version): don't echo @BTK_VERSION@, but
	@BTK_MAJOR_VERSION@.@BTK_MINOR_VERSION@.@BTK_MICRO_VERSION@, so the
	AM_PATH_BTK() macros don't get confused by the -pre1.

Thu Sep  2 19:02:37 1999  Owen Taylor  <otaylor@redhat.com>

	* configure.in (REBUILD): Change check for perl5
	  to check explicitely for v >= 5.002. (5.001
	  does not work with our scripts.)

Wed Aug 25 15:45:46 1999  Tim Janik  <timj@btk.org>

	* configure.in: evaluate $PERL for the perl version check. added
	--disable-rebuilds to give the user an option to completely disable
	any source autogeneration rules.

Mon Aug 23 23:16:14 1999  Tim Janik  <timj@btk.org>

	* configure.in: evaluate $ac_make when checking for GNU Make.

Mon Aug 23 19:11:17 1999  Tim Janik  <timj@btk.org>

	* docs/Makefile.am: added generation.txt.

	* Makefile.am: require automake 1.4, build README from README.in and
	INSTALL from INSTALL.in in dist-hook.
	
	* README.in:
	* INSTALL.in: new files to autogenerate README and INSTALL from.

	* configure.in: figure whether we have GNU Make

	* docs/generation.txt: minor additions/corrections.

Wed Aug 11 13:38:26 BST 1999 Tony Gale  <gale@btk.org>

	* docs/btkfaq.sgml: FAQ Update

July 30, 1999 Elliot Lee <sopwith@redhat.com>
	
	* configure.in: Fix autoconf warnings about cross compilation by
	trying to provide sane defaults for AC_TRY_RUN.

Fri Jul 16 22:20:21 PDT 1999 Manish Singh <yosh@gimp.org>

	* ltconfig
	* ltmain.sh: upgrade to libtool 1.3.3

Thu Jul  8 11:30:18 1999  Owen Taylor  <otaylor@redhat.com>

	* INSTALL: Indicate that the --with-bunnylib= configure
	time flag is unsupported.

Mon Jul  5 20:36:03 1999  Owen Taylor  <otaylor@redhat.com>

	* docs/generation.txt: Added a file that gives
	documenation about the autogeneration process for
	various autogenerated files.
	
Tue Jun 29 15:59:25 1999  Owen Taylor  <otaylor@redhat.com>

	* configure.in (LIBS): Look for libbmodule in the
	right location.

Thu Jun 17 13:57:31 1999  Owen Taylor  <otaylor@redhat.com>

	* docs/btk_tut.sgml: Removed references to
	code examples in my directory on btk.org as
	they should all be in the tutorial now.

	* docs/btk_tut.sgml: Added sources for dial-test
	and scribble-xinput programs that were previously
	missing.

Fri Jun  4 00:08:59 1999  Owen Taylor  <otaylor@redhat.com>

	* TODO: Added entry about menu keyboard navigation, removed
	some finished items.

Mon May 31 00:11:24 1999  Owen Taylor  <otaylor@redhat.com>

	* acinclude.m4: Standardize on func_dgettext
	not func_gettext, so that the checks for dgettext
	actually are paid attention to.

Wed May  5 10:47:54 1999  Owen Taylor  <otaylor@redhat.com>

	* configure.in (LIBS): Add $INTLLIBS into $LIBS
	directly, rather than repeating the checks for
	gettext.

	* INSTALL: Added information about gettext and
	NLS support.

	* acinclude.m4 (LIBM): Check for dgettext, not
	just gettext. This should hopefully fix things wrt
	systems with old versions of GNU gettext installed.

Tue Jun 29 15:59:25 1999  Owen Taylor  <otaylor@redhat.com>

	* configure.in (LIBS): Look for libbmodule in the
	right location.

Thu Apr  1 16:58:10 PST 1999 Manish Singh <yosh@gimp.org>

	* autogen.sh: add --enable-maintainer-mode

	* configure.in: set ACLOCAL="$ACLOCAL $ACLOCAL_FLAGS"

Wed Mar 24 23:03:49 CST 1999 Shawn T. Amundson <amundson@btk.org>

	* docs/btk-config.1.in:
	  docs/Makefile.am:
	  configure.in: btk-config is now generated.

	* docs/btk-config.1: Removed, now generated.

Thu Sep 23 17:59:59 1999  Tim Janik  <timj@btk.org>

        * bdk/bdkevents.c (bdk_event_translate): grr, even if Bdk doesn't
        handle CreateNotify itself, still put out a debuging message for
        --bdk-debug=events. made the ReparentNotify debugging message more
        verbose.
        wrap xcoords translation for ConfigureEvents into an error trap,
        a destroy event may already be pending, and in that case, the
        actuall coordinate values are not at all critical.

Sat Sep 18 22:24:15 1999  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkcc.c: Stop leaking the color_hash all over
	the place. Simplify and improve the logic.

Fri Sep 17 09:57:15 1999  Tim Janik  <timj@btk.org>

	* bdk/bdk.h, bdk/bdkcolor.c: make return types (gint or gboolean)
	for prototypes and function implementations consistent (reported
	by Tomas Ogren).

Tue Sep 14 18:23:01 1999  Tim Janik  <timj@btk.org>

	* bdk/bdkevents.c (bdk_event_translate): tell if expose events have
	send_event set in debugging output.
	(bdk_compress_exposures): default initialize the event so we don't
	operate on bogus values (namely send_event).

Thu Sep  2 16:33:59 1999  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkwindow.c: When we receive an unexpected
	destroy notify on one of our windows, don't just
	warn about it, also mark our windows as destroyed.

Sun Sep  5 08:10:53 1999  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkfont.c (bdk_font_hash_insert): Add
	  name => font and name => fontset hashes. The 
	  name => fontset hash is a _big_ win since we
	  weren't previously caching fontsets at all and loading
	  fontsets is expensive. The name => font hash
	  is less of a win, but it does save us from doing
	  repeated XQueryFont calls on the same font.

	* bdk/bdkprivate.h (struct _BdkFontPrivate): Add a names
	  list so we can remove font/fontset from hash.

Thu Sep  2 19:02:37 1999  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkproperty.c (bdk_atom_intern): Remove useless
	  and slightly confusing test. [ XInternAtom (,,TRUE)
	  will never return None ].

Sat Sep  4 08:39:26 1999  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkwindow.c (bdk_window_set_geometry_hints)
	  bdk/bdkwindow.c (bdk_window_set_hints):

	Don't omit setting the properties if flags == 0 -
	there may be an existing set of properties there
	already. (Very old bug. Would it be better to
	delete the property instead?)

	* bdk/bdkselection.c (bdk_selection_property_get): Fix 
	  spelling error in comment.

Wed Sep  1 14:05:30 1999  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkimage.c (bdk_image_new): Use bdk_error_trap_push()
	  to avoid stomping over bdk_error_warnings.

	* bdk/bdkimage.c (bdk_image_new): compute image->bpp
	  as (bits_per_pixel + 7) / 8. This gives the same
	  result as before for multiples of 8, but actually
	  a "reasonable" value for 1bit or 4bit displays.

Mon Aug 23 19:11:17 1999  Tim Janik  <timj@btk.org>

	* bdk/Makefile.am: minor cleanups, strip spaces on build rules for
	GNU Make.

Tue Aug 17 07:43:04 1999  Tim Janik  <timj@btk.org>

	* bdk/bdkevents.c (bdk_event_translate): give a debugging note when
	discarding configure events.

1999-08-18  Federico Mena Quintero  <federico@redhat.com>

	* bdk/bdkpixmap.c (bdk_pixmap_unref): g_return_if_fail() the
	refcount is greater than zero.

	* bdk/bdkwindow.c (bdk_window_unref): Likewise.

	* bdk/bdkfont.c (bdk_font_unref): Likewise.

	* bdk/bdkgc.c (bdk_gc_unref): Likewise.

	* bdk/bdkdnd.c (bdk_drag_context_unref): Likewise.

Wed Aug 11 01:04:57 1999  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkproperty.c (bdk_property_get): Fix assumption
	that format 32 => sizeof(item) == 4. It really is
	sizeof(long).

Tue Jun 29 23:02:42 1999  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdk.c (bdk_x_error / bdk_x_io_error): Don't
	core dump at all on X IO errors, only core dump
	if --enable-debug for X errors.

Thu Jun 24 17:06:23 1999  Tim Janik  <timj@btk.org>

	* bdk/bdkevents.c (bdk_event_translate): removed old ""Got event for
	unknown window:" message. disabled ConfigureNotify discarding code,
	because it led to events being processed out of order.

Thu Jun 24 12:22:02 1999  Tim Janik  <timj@btk.org>

	* bdk/bdkglobals.c: preinitialize bdk_error_code to 0.

	* bdk/bdkevents.c (bdk_event_send_client_message_to_all_recurse): since
	we export this function, supress error warnings and don't reset the
	error code in the first half of this function.

	* bdk/bdk.c (bdk_x_error): set bdk_error_code to the actuall X error
	code (instead of just -1) so bdk_error_trap_pop() reveals something
	actually informative about the error that happened.

	* bdk/*.c:
	don't rely on bdk_error_code being -1 if an error occoured, but just
	bdk_error_code != 0.

Thu Jun 24 11:50:07 1999  Tim Janik  <timj@btk.org>

	* bdk/bdkevents.c (bdk_event_apply_filters): advance the filter list
	pointer *before* invoking the filter function, so we at least don't
	crash if a filter is removed that is currently executed. window filters
	*really* need to be made truely reentrant at some point.

Mon Jun 14 11:10:15 1999  Tim Janik  <timj@btk.org>

	* bdk/bdkevents.c (bdk_event_translate): print the atom name in the
	PropertyNotify debug messages.

Wed May  5 22:51:06 1999  Owen Taylor  <otaylor@redhat.com>
	
        Patch from Sung-Hyun Nam <namsh@lgic.co.kr>
	
	* bdk/bdkim.c: Fix cut-and-paste errors for 
	x/y and PreeditAttributes/StatusAttributes.

Wed May  5 22:24:21 1999  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkwindow.c (bdk_window_set_geometry_hints): Change
	G_MAXINT to 2^16 to alleviate overflow problems in
	various window managers.

Wed Apr 21 00:42:08 1999  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkfont.c (bdk_text_measure): Fix the return value
        for fontsets.

Wed May  5 12:42:01 1999  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkwindow.c (bdk_window_set_geometry_hints):
	Initialize size_hints.x and size_hints.y because kwm
	brokenly pays attention to them.
	(Bug #1181 -  Lars Heete <hel@admin.de>)

Wed May  5 11:38:56 1999  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkrgb.c (bdk_rgb_choose_visual): Free the 
	return value of bdk_list_visuals(). 
	(Bug #1193 - Morten Welinder <terra@diku.dk>)

Tue May  4 11:12:56 PDT 1999 Manish Singh <yosh@gimp.org>

	* bdk/bdkim.c (bdk_im_real_open): cast the return value of
	XSetIMValues to (void *) when comparing to NULL, to workaround
	the problem of some compilers barfing since older X headers don't
	have the prototype for it.

Mon Apr 19 10:11:12 1999  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkcolor.c (bdk_colormap_new): Fix memory leak
	for pseudocolor where colormap->colors was double
	allocated.

	* bdk/bdkcolor.c (bdk_colormap_alloc1): Store the
	color value in the hash table with the pixel filled
	in so when we do later hash table lookups, the color
	value is correct.
	
Sun May  2 15:29:45 PDT 1999 Manish Singh <yosh@gimp.org>

	* bdk/bdkdraw.c (bdk_draw_lines): check private->destroyed before
	making the call

Tue Apr 27 11:17:35 1999  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkdnd.c (xdnd_set_{targets,actions}): Fix leak
	pointed out by Morten Welinder <terra@diku.dk>.

Wed Apr 21 14:20:22 1999  George Lebl  <jirka@5z.com>

	* bdk/bdkwindow.c: (bdk_window_remove_filter) correctly remove the
	  default filter from the list

Wed Apr 21 14:20:22 1999  George Lebl  <jirka@5z.com>

	* bdk/bdkwindow.c: (bdk_window_remove_filter) correctly remove the
	  default filter from the list

Fri Apr 16 20:41:43 PDT 1999 Manish Singh <yosh@gimp.org>

	* bdk/bdk.c: #include "bdkkeysyms.h" for bdk_XConvertCase #defines

	* btk/btkfontsel.c (btk_font_selection_create_xlfd): use
	g_strdup_printf instead of calcing the length separately

Tue Apr 13 02:49:33 1999  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkwindow.c: removed some silly #ifdef HAVE_CONFIG
	that we don't do in many other places. (Fixing duplicate 
	#include of config.h)

	* bdk/bdkevents.c: include bdkinput.h _after_ config.h.
	Otherwise, #ifndef XINPUT_NONE check in the latter
	doesn't work. (Bug #546)

Sun Apr 11 14:38:03 1999  Tim Janik  <timj@btk.org>

	* bdk/bdkpixmap.c (_bdk_pixmap_create_from_xpm): check for color
	"None" case insensitive.

Tue Apr  6 16:38:51 1999  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkselection.c: 
	Add error traps so if the other end of the connection
	dies, we survive.

Tue Apr  6 12:24:21 1999  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkdnd.c (bdk_drag_motion): Separate out the
	dest_xid field into two fields - one for the window
	to send in messages, one to indicate the last looked
	up window for caching purposes. This is needed, so
	that Leave messages get the correct window.

Mon Apr  5 13:21:30 1999  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkevents.c (bdk_event_check, bdk_event_prepare):
	Fix warning created by people mucking around
	with the gsource API.

	* bdk/bdkevents.c (bdk_io_invoke, bdk_input_add_full):
	Change mapping between BUNNYIOCondition and BdkInputCondition
	to match the way the Linux kernel does it. This should
	fix problems where closed pipes were no longer signalling
	BDK_INPUT_READ on systems with a native poll().

Mon Apr  5 17:11:57 1999  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkpixmap.c (_bdk_pixmap_create_from_xpm): Check 
	explicitly for the string "None" - it is in the XPM
	spec and some servers treat unknown colors in odd ways
	(like asking the user!)

Thu Apr  1 16:58:10 PST 1999 Manish Singh <yosh@gimp.org>

	* bdk/bdkevents.c: made "->" into a "." of previous change so
	it compiles

Thu Apr  1 18:41:25 1999  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkevents.c (bdk_compress_exposures): Set the
	window field of the event structure before calling
	user filters.

1999-03-31  Federico Mena Quintero  <federico@nuclecu.unam.mx>

	* bdk/bdk.c (bdk_init_check): Use False as the last argument to
	XInternAtom() here.  This is a particularly Old And Nasty(tm) bug.

Mon Mar 29 17:31:52 1999  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkim.c (bdk_mbstowcs): Free the value of the
	intermediate text property - prevents major memory
        leak when bdk_use_mb.
	btk-d3august-990311-0: Bj|rn Augustsson <d3august@dtek.chalmers.se>

Mon Mar 29 17:02:58 1999  Owen Taylor  <otaylor@redhat.com>

        Patches from Akira Higuchi <a-higuti@math.sci.hokudai.ac.jp>
	btk-a-higuti-990322-[0-3]

	* bdk/bdkfont.c (bdk_text_extents_wc): Make  work when
	sizeof(wchar_t) != sizeof (BdkWChar)

	* configure.in: Fix confusion between BTK_LOCALE_[C]FLAGS
	that was causing -DX_LOCALE not	to work.

	* btk/btkrc.c (btk_rc_init):
	X_LOCALE will never have LC_MESSAGES defined

	* bdk/bdk.c (bdk_init_check):
	Remove --xim-preedit and --xim-status from argv properly.

	* bdk/bdkim.c (bdk_ic_real_new): Add a bdk_flush() so
	that the client window is present on the X server
	before we pass it to the input method.

Tue Mar  9 10:46:49 1999  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkdnd.c (motif_find_drag_window): Fix bug where
	if --display is specified on the command line, than
	the drag window will not be created on that display.
	
Tue Mar  9 10:38:24 1999  Owen Taylor  <otaylor@redhat.com>

	* bdk/bdkproperty.c (bdk_atom_intern): Fixed bug where
	lookups with only_if_exists == TRUE were inserting
	bogus values into the atom cache.

Wed Mar 17 09:00:00 1999  Tim Janik  <timj@btk.org>

	* bdk/bdkselection.c (bdk_selection_property_get): first XFree(t),
	then reset it to NULL.

	* bdk/bdkcolor.c:
	(bdk_colors_free): 
	(bdk_colormap_free_colors): use colormap->colors[in_pixels[i]] as the
	key for g_hash_table_remove() in both functions, this prevents us
	from accessing possibly uninitialized portions of a BdkColor structure
	where we are only interested in its pixel value.

Tue Mar  9 01:01:28 1999  Tim Janik  <timj@btk.org>

	* bdk/bdkfont.c (bdk_font_load): first lookup the xfont ID in our
	font hash table, if we have a BdkFontPrivate entry for this font
	already, simply increment its reference count, provided by Olaf Dietsche
	<olaf.dietsche+list.btk@netcologne.de>.

1999-09-21  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdk.c (bdk_exit_func): Delete the bdk_DC when exiting,
	just to be sure.

	* bdk/win32/bdkvisual.c (bdk_visual_init): Remove a couple of
	unused variables, leftovers from the X11 version.

	* bdk/win32/rc/*.cur: Better cursors provided by Bernd Herd.

	* btk/btkfontsel.c (btk_font_selection_get_xlfd_field): Only
	downcase fields on X11.

Mon Sep 20 13:17:39 1999  Pablo Saratxaga <pablo@mandrakesoft.com>
        
        * configure.in,po/pt_BR.po: added Portuguese Brazilian file from
        Alex Sandro Queiroz e Silva <asandro@lcg.dc.ufc.br>

1999-09-17  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdk.def: Add bdk_threads_mutex.

	* btk/makefile.msc: Correct path to libintl.

	Thanks to Tomi Ollila and Bernd Herd: Fix some inconsistencies in
	use of gint vs. int, and gint vs. gboolean in headers and
	definitions. Use BtkType for the *_get_type functions. Note that
	these changes preserve binary compatibility.

	* bdk/bdk.c
	* bdk/win32/bdk.c
	* bdk/bdk.h: Fix inconsistencies: gint vs int.

	* btk/btkmain.c
	* btk/btkclist.c
	* btk/btkmenufactory.c
	* btk/btknotebook.c
	* btk/btkwidget.c: Fix inconsistencies, also gint
	vs. gboolean.

	* btk/btkcolorsel.[ch]
	* btk/btkcombo.[ch]
	* btk/btkdrawingarea.[ch]
	* btk/btkgamma.[ch]
	* btk/btkhandlebox.[ch]
	* btk/btkhpaned.[ch]
	* btk/btkhruler.[ch]
	* btk/btkplug.[ch]
	* btk/btkpreview.[ch]
	* btk/btkruler.[ch]
	* btk/btksocket.[ch]
	* btk/btkstatusbar.[ch]
	* btk/btktoolbar.[ch]
	* btk/btkvbbox.[ch]
	* btk/btkvpaned.[ch]
	* btk/btkvruler.[ch]: Always use type BtkType for the *_get_type
	functions.

	* btk/btkgamma.h: Fix bug, missing () in call of
	btk_gamma_curve_get_type() in BTK_GAMMA_CURVE_CLASS. 

1999-09-14  Tor Lillqvist  <tml@iki.fi>

	* bdk/bdkcolor.c (bdk_colormap_new)
	* bdk/win32/bdkcolor.c (bdk_colormap_new): Fix memory leak:
	colormap->colors was allocated twice.

	* bdk/win32/bdk.c: Remove some unused stuff.

	* bdk/win32/bdkcolor.c (bdk_colormap_sync): Initialize all of the
	colormap.

	* btk/btkfontsel.c (btk_font_selection_dialog_get_type)
	* btk/btklabel.h (btk_label_get_type)
	* btk/btktipsquery.c (btk_tips_query_get_type)
	* btk/btktypeutils.h (btk_type_name): : Use BtkType
	in a couple of places, not guint.

Fri Sep 10 21:31:00 CEST 1999 Pablo Saratxaga <pablo@mandrakesoft.com>

	* configure.in,po/et.po: added Estonian language file

Wed Sep  1 14:36:12 CEST 1999 Pablo Saratxaga <pablo@mandrakesoft.com>

	* configure.in,po/da.po: added Danish file

Sun Aug 29 13:38:59 BST 1999 Tony Gale <gale@btk.org>

	* docs/btkfaq.sgml: Minor FAQ Update

Sat Aug 28 14:34:37 BST 1999 Tony Gale <gale@btk.org>

	* docs/btkfaq.sgml: FAQ update

1999-08-27  Tor Lillqvist  <tml@iki.fi>

	Win32: Philippe Colantoni <colanton@aris.ss.uci.edu> suggests a
	way to get window contents continually refreshed while resizing. I
	didn't like the effects myself, so it's not on by default.

	* bdk/win32/bdkprivate.h: New flag variable
	bdk_event_func_from_window_proc, FALSE by default.

	* bdk/win32/bdk.c (bdk_init_check): Set above flag if the
	environment variable BDK_EVENT_FUNC_FROM_WINDOW_PROC is set, or we
	are passed --bdk-event-func-from-window-proc.

	* bdk/win32/bdkevents.c (bdk_WindowProc): If above flag is set,
	and we have am event_func, call it instead of enqueing the event.

1999-08-23  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkevents.c (bdk_event_translate): Fix from Simon
	Kelley: Set expose_count in BdkEventExposes correctly.

	* bdk/win32/bdkwindow.c: Remove dead code (#ifdef
	MULTIPLE_WINDOW_CLASSES).

	* bdk/win32/bdkdraw.c (bdk_draw_line): Workaround from Hans Breuer
	for bug in NT, apparently NT *does* draw the end pixel, too, in
	LineTo with a one-pixel pen, so we don't have to do it ourselves.

1999-08-21  Tor Lillqvist  <tml@iki.fi>

	Improvements by Hans Breuer: 

	* bdk/win32/bdkwindow.c (RegisterBdkClass): New function

	* bdk/win32/bdkwindow.c (bdk_window_new): Use it. Don't set the
	CS_?REDRAW flags as they cause lots of (late) redraws when "show
	window contents while dragging" is turned on. Allocate at least
	one unique class for every BdkWindowType. If support for single
	window-specific icons is ever needed (eg. Dialog specific), every
	such window should get its own class.

1999-08-19  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkgc.c (bdk_gc_new_with_values): Fix a cut&paste
	error that caused crashes.

1999-08-17  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkdraw.c (bdk_draw_pixmap): When blitting inside one
	window, use ScrollWindowEx, and call UpdateWindow. This prevents
	bugs when for instance part of the window was outside the
	display. Thanks to Philippe Colantoni for finding and fixing this.

1999-08-16  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkdraw.c (bdk_draw_arc): Fix start and end radial
	endpoint calculations which were totally wrong. (A little RTFMing
	helps a lot ;-)

	* btk/makefile.{cygwin,msc}: Use libintl extracted from bunnylibc
	from a separate directory, not from gettext, because of licensing
	issues (we want to use the LGPL version).

	* README.win32: Mention the intl from bunnylibc vs from gettext issue.

1999-08-13  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkevents.c (bdk_event_translate): Fix a couple of bugs
	in the key event handling: Now AltGr chars work again. Also,
	now Alt-digits are passed up as well as Control-digits.
	Pass keypad plus and minus as normal plus and minus.

Wed Aug 11 13:38:26 BST 1999 Tony Gale  <gale@btk.org>

        * docs/btkfaq.sgml: FAQ Update

1999-07-25  Tor Lillqvist  <tml@iki.fi>

	* README.win32
	* config.h.win32: Add HAVE_WINTAB. Undefine it if bulding without
 	the Wintab SDK.

	* bdk/win32/bdkinput.c: Hack some more. Still doesn't quite work
 	OK, but getting closer. Guard against bogus tilt data from Wacom
 	ArtPad II with the 3.40 driver. Add ifdefs for HAVE_WINTAB to
 	enable easier building without Wintab.

	* bdk/win32/bdkinput.h
	* bdk/win32/bdkevents.c	
	* bdk/win32/bdkwindow.c: Minor changes related related to above.
	
	* bdk/win32/bdkvisual.c: Simplify a lot, remove leftovers from X11
 	code. As we have just one visual on Win32, no sense to have it in a
 	table, and no need for the hash table.

	* bdk/win32/rc/cursor*.cur: Edit some of the cursors a bit to look
 	better on white background.

1999-07-21  Tor Lillqvist  <tml@iki.fi>

	* README.win32: Update gcc build instructions. Mention gettext is
 	GPL.

	* bdk/win32/bdkcursor.c (bdk_cursor_new_from_pixmap): Get correct
 	supported cursor size with GetSystemMetrics.

	* bdk/win32/bdkfont.c
	* btk/btkfontsel.c: Guard against some font weight and charset
 	symbols being undefined (in mingw32 headers).

	* bdk/win32/makefile.cygwin
	* btk/makefile.cygwin
	* btk/btkthemes.c: No longer need to have differently named
	gcc-built DLLs when using gcc-2.95 and -fnative-struct.

hu Jul 15 13:33:15 BST 1999 Tony Gale <gale@btk.org>

	* docs/btkfaq.sgml: Long awaited FAQ update.

1999-07-15  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkcursor.c (bdk_cursor_new_from_pixmap): Implement
 	it. Obscure bit manipulation needed.

	* bdk/win32/bdkevents.c: Logging.
	
	* btk/btkthemes.c (btk_theme_engine_get): (Win32) Use new DLL naming
	style (file name include compiler name) for theme engines.

1999-07-13  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkdraw.c (bdk_draw_pixmap): Less logging verbiage.

	* bdk/win32/bdkevents.c: Fix long-standing bug in key
 	events. The key.string wasn't zero-terminated, still we strdup'ed
 	it in bdk_event_copy(). Synthesize crossing events for button
 	events before possible propagation.

	* bdk/win32/bdkwindow.c: Log bdk_window_set_title.

	* bdk/win32/makefile.cygwin
	* btk/makefile.cygwin: Use new DLL naming style for the
 	GCC-compiled ones.

	* bdk/win32/makefile.msc
	* btk/makefile.msc: Cosmetics mostly.

	* btk/btk.def: Add missing entry points.

	* btk/btksocket.c: Add dummy btk_socket_get_type() for Win32.

1999-07-09  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkdraw.c (bdk_draw_arc): Don't draw anything if width
 	or height is zero. Don't print a warning if Pie or Arc fails, they
	always fail (?) for very narrow ellipses.

	* bdk/win32/bdkdraw.c (bdk_draw_pixmap): Call InvalidateRgn for
 	the part or the destination window corresponding to source area
 	outside of the source drawable's boundary.

	* bdk/win32/bdkdraw.c (bdk_draw_lines, bdk_draw_polygon): Don't do
 	anything if less than two points.

	* bdk/win32/bdkselection.c (bdk_selection_owner_get): Always
 	return NULL. Btk cut-and-paste inside a single program works
 	better this way. (It always gets the clipboard contents from
 	Windows, not from its own copy, which is cleared anyway. I can't
 	say I fully understand what happens... Emulating the X selection
 	and property stuff is a bit of a mess.)

	* bdk/win32/bdkevents.c
	* bdk/win32/bdkproperty.c: A bit more verbose logging.

	* bdk/win32/bdkrebunnyion.c: Fix some memory leaks (temporary rebunnyions
 	that never got deleted). Revamp bdk_rebunnyion_shrink.

	* bdk/win32/bdkrebunnyion.c: Fix memory leak, delete temporary rebunnyions
 	after use.

	* btk/btk.def: Add some missing entry points.

	* btk/btkrc.c: Strip trailing directory separator from pixmap path
 	component.

1999-07-04  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkevents.c (bdk_event_translate): Handle
 	Control-digits specially.

1999-07-03  Tor Lillqvist  <tml@iki.fi>

	* btk/makefile.{cygwin,msc}: New pthreads version. Use gettext.

1999-06-28  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkimage.c (bdk_image_get): bpl was set wrong for
 	bitmaps, should be multiple of 4. (Thanks to Hans Breuer for
 	finding this.)

1999-06-01  Jose H Mercado  <jmercado@mit.edu>

	* btk+.spec.in: Corrected some typos in files section.
	
1999-06-15  Tor Lillqvist  <tml@iki.fi>

	* README.win32: Mention using GNU gettext.
	* config.h.win32: Enable NLS stuff.
	* btk/makefile.msc: Use GNU gettext.
	* bdk/win32/bdkdnd.c: Minor header reorg.
	* bdk/win32/{bdkevents,bdkwindow}.c: No semantic changes, mainly
	cosmetics.
	* btk/btkrc.c (Win32): Make get_btk_sysconf_directory() public.
	* btk/btkmain.c (Win32): Use it in bindtextdomain() call.

Wed Jun  2 11:44:25 PDT 1999 Manish Singh <yosh@gimp.org>

	* acinclude.m4
        * config.guess
        * config.status
        * ltconfig
        * ltmain.sh: upgrade to libtool 1.3.2 (BeOS changes merged)

1999-05-30  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/bdkwindow.c: AdjustWindowRectEx2 renamed to
 	SafeAdjustWindowRectEx. Don't override all calls to
 	AdjustWindowRectEx by it, but use it only in two places: When
 	creating a new top-level window and when moving a top-level
 	window.

	Use screen coordinate rectangle, not client rectangle, in
 	bdk_window_move. Thus SafeAdjustWindowRectEx will do its job only
 	when we try to place a window so that the decoration (mainly,
 	title bar) isn't visible.

	These changes fix the bug that showed up for instance as the
 	GIMP's saved top-level windows moving right and down (by an amount
 	equal to the window decoration) for each session. This bug showed
 	up also in testbtk's "Saved Position".

	bdk_window_resize also redone a bit.

1999-05-25  Tor Lillqvist  <tml@iki.fi>

	* btk/testbtkrc: Add (commented out) Windows-style theme
	include line.

	* bdk/win32/bdk.def,btk/btk.def: Add some missing entry points.

1999-05-18  Tor Lillqvist  <tml@iki.fi>

	* bdk/win32/makefile.{cygwin,msc}: Copy our bdkprivate.h and
 	bdkx.h to a bdk subdirectory, so that applications can include
 	these with <bdk/*.h> without trouble.

	* bdk/win32/bdkimage.c (bdk_image_new_with_depth): Code simplified.
	(bdk_image_destroy): Plug resource leak, some BdkImages didn't
	have their bitmap destroyed.

	* bdk/win32/bdk.def: Add bdk_root_parent.

Wed May 12 03:00:56 CDT 1999 Shawn T. Amundson <amundson@btk.org>

	* configure.in
	  btk-config.in
	  ltconfig
	  ltmain.sh     
	  btk/Makefile.am: changes to compile nicely (with xlib) 
          on BeOS

Sat May  1 15:04:42 PDT 1999 Manish Singh <yosh@gimp.org>

	* acinclude.m4
	* config.guess
	* config.sub
	* ltconfig
	* ltmain.sh: upgrade to libtool 1.3

Fri Apr 30 13:38:16 1999  Lars Hamann  <lars@btk.org>

	* btk/btkclist.c:
	* btk/btkctree.c: merges from btk-1-2

1999-04-25  Tor Lillqvist  <tml@iki.fi>

	Support added for building using a GNU toolchain on Win32,
	gcc -mno-cygwin (egcs-1.1.2) on cygwin-b20.1.

	* bdk/win32/makefile.cygwin btk/makefile.cygwin: New files.
	* config.h.win32: Changes for gcc.
	* bdk/bdkrectangle.c: Include bdk.h as <bdk/bdk.h>.
	* bdk/bdkcolor.c: config.h.win32 already defines strcasecmp.
	* bdk/win32/bdkconfig.h: Only the MS compiler has wctype.h.
	* bdk/win32/bdkdnd.c: Protect (unused) OLE2 stuff better.
	Protect shl stuff unavaiilable with mingw32 headers.
	* bdk/win32/bdkevents.c: Fix typo.
	* bdk/win32/bdkglobals.c: Use BDKVAR here also for gcc.
	* bdk/win32/bdkim.c: Use OEM code page for multibyte chars. (?)
	* bdk/win32/bdkinput.c: Use __try __except only with the MS compiler.
	* bdk/win32/bdkprivate.h: Make up for some stuff missing from
	the mingw32 headers.
	* bdk/win32/makefile.msc: Use latest Wintab kit and bunnylib.
	* btk/btkfilesel.c: Include <bunnylib.h> early, to get stat->_stat
	definition on Win32. Test for NATIVE_WIN32, not _MSC_VER.
	* btk/btkfontsel.c: Protect CHARSET redefinition on Win32.
	Test for NATIVE_WIN32, not _MSC_VER.
	* btk/btkmain.c: No use warning about developer version on Win32,
	there aren't any non-developer versions anyhow.
	* btk/btkrc.c: Test for NATIVE_WIN32, not _MSC_VER.
	* btk/makefile.msc: Use pthread from another directory. Minor other
	changes. 

Wed Apr 21 14:20:22 1999  George Lebl  <jirka@5z.com>

        * bdk/bdkwindow.c: (bdk_window_remove_filter) correctly remove the
          default filter from the list

Mon Mar  8 12:52:53 1999  Owen Taylor  <otaylor@redhat.com>

	* btk/btkwidget.c (btk_widget_grab_default): Add a warning
	 when btk_widget_grab_default() is called for a widget that
	 is not within a BtkWindow.

Sat Apr 10 13:52:54 BST 1999  Tony Gale <gale@btk.org>

	* docs/btk_tut.sgml, examples/clist.c: use a
	  scrolled window in the clist example. Minor
	  tutorial fixes.

Fri Apr  2 09:19:20 BST 1999  Tony Gale <gale@btk.org>

	* docs/btk_tut.sgml: Style check from David King
	  <dking@youvegotmail.net>

1999-03-30  Pavel Machek  <pavel@artax.karlin.mff.cuni.cz>

	* btk/btkfontsel.c (btk_font_selection_get_fonts): Make code
	compile with unknown value of BDK_WINDOWING

1999-03-28  Raja R Harinath  <harinath@cs.umn.edu>

	* bdk/Makefile.am (bdkconfig.h): Make sure `bdkconfig.h' exists
	after the rule is fired.
	(install-exec-local): Install bdkconfig.h only if the contents are
	different from the currently installed bdkconfig.h.

1999-03-26  Raja R Harinath  <harinath@cs.umn.edu>

	* bdk/Makefile.am (configexecincludedir): Rename from 
	configincludedir so that bdkconfig.h will be installed 
	as part of `make install-exec'. 

Fri Mar 19 16:50:33 PST 1999 Manish Singh <yosh@gimp.org>

	* acinclude.m4
	* config.guess
	* config.sub
	* ltconfig
	* ltmain.sh: upgrade to libtool 1.2f

	* autogen.sh: libtool is not required to autogen btk+

	* acconfig.h: remove WITH_SYMBOL_UNDERSCORE (not explictly
	needed)

1999-03-18  Tor Lillqvist  <tml@iki.fi>

	* bdk/bdktypes.h: Merge in Win32 version: Define macro BDKVAR for
	declaring bdk variables exported/imported from the DLL. New image
	type enum, BDK_IMAGE_SHARED_PIXMAP, for bdk_imlib. New drag and
	drop protocol enums, BDK_DRAG_PROTO_WIN32_DROPFILES and
	BDK_DRAG_PROTO_OLE2.

	* bdk/bdk.h: Merge in Win32 version: Two new functions,
	bdk_pixmap_create_on_shared_image and bdk_image_bitmap_new. So far
	declared only for the Win32 version, but could be in the X11
	version as well. (Needed for a Xlib-less bdk_imlib.)
	bdk_color_hash should have only one parameter. Declare
	bdk_threads_mutex with BDKVAR.
	
	* bdk/bdkcolor.c (bdk_color_hash): A hash function should have
	just one parameter.

	* bdk/bdkimage.c (bdk_image_get): Initialize bpp correctly. Bytes
	per pixel, not bits.

	* bdk/bdkrgb.c: Mingle includes somewhat. (bdk_rgb_select_conv):
	Fetch bpp (which means bits-per-pixel here) from another place on
	Win32. Accept also depth==32 (which we might get on Win32) with
	bpp==32.

	* btk/{btkclist,btkctree,btkdnd,btkditable,btkfontsel,
	btkhandlebox,btklayout,btkmain,btkplug,btkpreview,btkrc,
	btkselection,btksocket,btkstyle,btkwidget,btkwindow}.c:
	Include gdx.h from "bdkx.h", not "bdk/bdkx.h", as bdkx.h will be
	in the backend-dependent directory, not in the common bdk
	directory.

	* btk/testbtk.c: Ditto. Also, don't use ../bdk path to bdk
	headers.

Wed Mar 17 05:06:49 1999  Tim Janik  <timj@btk.org>

	* btk/btkmain.c (btk_init_check): tell people that they don't really
	want to use the Btk+ devel version (which is true, and yes - even i am
	currently working with the 1.2.x branch). so everyone reading this, you
	probably want to issue
	cvs checkout -r bunnylib-1-2 bunnylib
	and
	cvs checkout -r btk-1-2 btk+
	as your next two comands.

Wed Mar 17 02:49:32 1999  Tim Janik  <timj@btk.org>

	* configure.in: build btkcompat.h from btkcompat.h.in instead of
	btkfeatures.h from btkfeatures.h.in, require GLib 1.3.0.

	* btk/btkcompat.h.in: combined btkcompat.h and btkfeatures.in in this
	file. strongly deprecated the BTK_HAVE_* macros, we provide
	BTK_CHECK_VERSION() for people that need to check for certain
	Btk+ versions.

	* btk/btkcompat.h: removed this from CVS.
	* btk/btkfeatures.h.in: removed this from CVS, btkfeatures.h was a bad
	idea right from the start, it just didn't seem like that back then.

Wed Mar 17 01:46:28 1999  Tim Janik  <timj@btk.org>

	* merges from btk-1-2:

Tue Mar 16 17:43:33 1999  Tim Janik  <timj@btk.org>

        * btk/btkitemfactory.c (btk_item_factory_parse_rc_string): ensure the
        item factory class has been created.
        (btk_item_factory_parse_rc): likewise.

        * btk/btkmenu.c:
        keep proper references for old_active_menu_item.
        (btk_menu_reparent): unset the usize of the new parent,
        so the menu can sanely be size requested and we don't get nasty screen
        artefacts upon next reparentation.
        (btk_menu_motion_notify): set send_event to TRUE if we synthesize an
        enter notify. only synthesize enter notifies if the pointer really is
        inside the event window.
        (btk_menu_popdown): use btk_menu_shell_deselect().
        (btk_menu_popup): move the background setting stuff into
        btk_menu_tearoff_bg_copy() so it can be called from other places as well.

        * btk/btkmenushell.c (btk_menu_shell_button_press): use
        btk_menu_shell_select_item() to select the new item.
        (btk_menu_shell_deselect): export this function, so btkmenu.c can
        do the right thing for deselection as well.

Sat Mar 15 20:10:33 1999  Tim Janik  <timj@btk.org>

        * btk/btkwidget.[hc]:
        (btk_widget_accelerators_locked): return whether a widget's accelerators
        are locked.

        * btk/btkmenu.c (btk_menu_key_press): don't remove or install new or
        existing accelerators if the widget's accelerators are locked.

Sat Mar 14 19:44:05 1999  Tim Janik  <timj@btk.org>

        * btk/btkitemfactory.[hc]: allow managing of foreign menu items.

        * btk/btkmenu.c: truely forward key press and key release events to
        the menu widget from the toplevel or tearoff window. we can't simply
        connect to that, we need to stop further processing of the events as
        well.

Sat Mar 13 13:14:17 1999  Tim Janik  <timj@btk.org>

        * btk/btkmenu.c:
        (btk_menu_key_press): pass event->keyval, event->state to
        btk_accelerator_valid, instead of event->keyval twice.
        refuse to install single letter accelerators for menus that use
        single letter shortcuts.

        * btk/btkitemfactory.c (btk_item_factory_create_item): use
        btk_menu_ensure_uline_accel_group().

        * btk/btkmenu.[hc]: added btk_menu_ensure_uline_accel_group()
        which will always return an uline accel group, made
        btk_menu_get_uline_accel_group() return NULL if the group isn't
        yet created.

Mon Mar 15 01:03:27 1999  Lars Hamann  <lars@btk.org>

        * btk/btkclist.h (struct _BtkCListColumn): added button_passive flag.

        * btk/btkclist.c (btk_clist_column_title_passive):
        Leave button sensitive, trap  button_press, button_release,
        motion_notify, enter_notify and leave_notify events instead.
        (btk_clist_column_title_active): disconnect event handler.
        (btk_clist_drag_data_get): fixed memory leak. Reported by
        Guillaume Laurent <glaurent@worldnet.fr>

Wed Mar 10 23:49:55 1999  Lars Hamann  <lars@btk.org>

        * btk/btklayout.c (btk_layout_adjustment_changed): fixed a few
        width/height mixups.

        * btk/btkctree.c (tree_delete): emit an tree_unselect_row signal
        if needed.

Wed Mar 10 00:11:32 1999  Tim Janik  <timj@btk.org>

        * btk/testbtk.c (create_item_factory): unref the item factory after
        window's destruction.

        * btk/btkmenushell.c (btk_menu_shell_activate_item): keep a reference
        count on the menu shell around the menu item's activation, since the
        signal emission may cause menu shell destruction.

        * btk/btkitemfactory.c:
        the previous code leaked one accel group per menu. we use
        btk_menu_get_uline_accel_group() now to fix that, and with that
        also create the underline accelerator group of the menus only if
        required (i.e. an underline accelerator has been specified).
        (btk_item_factory_construct):
        (btk_item_factory_create_item): removed code that would create an
        extra accel group for the menu (and leak references).
        (btk_item_factory_create_item): adapted the underline accelerator
        installation code to properly feature btk_menu_get_uline_accel_group().

        * btk/btkmenu.[hc]: added btk_menu_get_accel_group() to retrive
        menu->accel_group, this may return NULL if the accelerator group
        hasn't been set yet.
        added btk_menu_get_uline_accel_group() to retrive the underline
        accelerator group of the menu, this will be created on demand
        and proper care is taken about its reference count.

        * btk/btkitemfactory.h:
        * btk/btkitemfactory.c:
        dumped the approach of keeping a widgets by action list on the
        factory since the factory<->widget destroy negotiation didn't work
        and would be hard to get going at all. instead we keep a list of
        BtkItemFactoryItem items on the factory (BtkItemFactoryItems are
        persistant throughout a program's life time).
        also, i removed the static const gchar *key_* variables, and made
        them inline strings (they weren't actually used anyways).
        (btk_item_factory_add_item): update ifactory->items.
        (btk_item_factory_destroy): destroy ifactory->items (and remove
        the item factory pointer from the remaining ifactory widgets).
        (btk_item_factory_get_widget_by_action): walk the BtkItemFactoryItem
        list to find the widget.
        (btk_item_factory_get_item): new function that works around
        btk_item_factory_get_widget() limitations, this function will only
        return menu items, even for <Branch> entries.

Tue Mar  9 01:01:28 1999  Tim Janik  <timj@btk.org>

        * bdk/bdkfont.c (bdk_font_load): first lookup the xfont ID in our
        font hash table, if we have a BdkFontPrivate entry for this font
        already, simply increment its reference count, provided by Olaf Dietsche
        <olaf.dietsche+list.btk@netcologne.de>.

        * btk/btkstyle.c (btk_style_copy): plug a BdkFont reference leak, fix
        provided by Olaf Dietsche <olaf.dietsche+list.btk@netcologne.de>.

Sun Mar  7 06:13:29 1999  Tim Janik  <timj@btk.org>

        * btk/btkcontainer.c:
        (btk_container_add_with_args):
        (btk_container_addv):
        (btk_container_add): before adding a child to a conatiner, make sure
        it is (default) constructed, this is neccessary because under certain
        circumstances the child will get relized and mapped immediatedly, in
        which case it has to be constructed already.

Mon Mar  1 17:58:21 1999  Tim Janik  <timj@btk.org>

        * btk/btksignal.c (btk_signal_connect_by_type): count object_signal
        values > 1 as TRUE also.

1999-03-16  Tor Lillqvist  <tml@iki.fi>

	* README.win32: New file.
		
	* configure.in: Check for lstat.

	* config.h.win32: Add non-definition of HAVE_LSTAT, just for
	completeness.

	* btk/btkrc.c: If don't HAVE_LSTAT, use stat.

	* btk/btk.def: Removed CRs.

	* btk/makefile.msc: Correct include path to Win32 BDK version (in
	..\bdk\win32).

	* bdk/win32/makefile.msc: Correct upwards relative paths.
	
Mon Mar 15 03:38:34 1999  George Lebl  <jirka@5z.com>

	* btk/btkdnd.c: (btk_drag_highlight) swap the
	  btk_drag_highlight_expose and btk_drag_highlight_paint since
	  it was connecting a void function to expose_event and the int
	  returning function to the draw signal

1999-03-14  Jeff Garzik  <jgarzik@pobox.com>

	* configure.in:
	Use correct path to libbmodule.la when ref'ing uninstalled copy
	of bunnylib.  (Already in stable branch, Bug #417)

1999-03-15  Tor Lillqvist  <tml@iki.fi>

	Win32 merge and general portability stuff:
		
	* acconfig.h,configure.in: Check for <sys/time.h>.

	* bdk/win32: New directory (actually, been there for a while).
	
	* btk/fnmatch.c: Include <bunnylib.h> for G_DIR_SEPARATOR, WIN32 and
	NATIVE_WIN32, and use these. Always case fold on Win32. No
	backslashed escapes on native Win32.

	* btk/{btk.def,makefile.msc}: New files.

	* btk/Makefile.am: Add above new files.
	
	* btk/{btkaccelgroup,btkbindings}.c: Include <string.h>
 	instead of <strings.h>.

	* btk/{btkcalendar,btkitemfactory,btkpreview,btkrc}.c: Include
	config.h. Protect inclusion of <sys/param.h>, <sys/time.h>, and
	<unistd.h> appropriately.

	* btk/btkdnd.c: Merge in Win32 version (which doesn't do much).
	Use ABS() (from <bunnylib.h>) instead of abs().
	
	* btk/btkfilesel.c: Moved Win32-specific includes after inclusion
	of btk (and thus bunnylib) headers, so that WIN32 will be
	defined. With MS C, include <direct.h> for mkdir prototype.

	* btk/btkitemfactory.c (btk_item_factory_callback_marshal): Add
	some casts, needed by MS C.

	* btk/{btklayout,btkplug}.c: Merge in Win32 version (which isn't
	implemented).

	* btk/btkmain.c: Include bdk/bdkx.h for BDK_WINDOWING. Include
	<X11/Xlocale.h> only on X11 platform, otherwise <locale.h>.  Use
	G_SEARCHPATH_SEPARATOR_S and g_module_build_path.

	* btk/btkmain.h: Mark variables for export/import on Win32.
		
	* btk/btkrange.c (btk_range_motion_notify): Set mods also in case
	the event is not a hint, or its window is not the slider. Needed
	on Win32, at least.

	* btk/btkrc.c: Include config.h and bdk/bdkx.h. Use <locale.h>
	unless on X11. Skip \r chars, too. Use G_DIR_SEPARATOR and
	G_SEARCHPATH_SEPARATOR(_S). Use g_path_is_absolute. On Win32, use
	a subdirectory of the Windows directory as btk system
	configuration directory.

	* btk/btkselection.c: No chunks on Win32.

	* btk/btksocket.c: Not implemented on Win32.

	* btk/btkthemes.c (btk_theme_engine_get): Use g_module_build_path.

	* btk/makeenums.h: Include bdkprivate.h after bdk.h.

	* btk/maketypes.awk: Declare variables with a macro that expands to
	necessary export/import magic in the case of Win32.
		
	* btk/testrgb.c: Use dynamically allocated buffer. Use GTimers.

1999-03-13  Raja R Harinath  <harinath@cs.umn.edu>

	* configure.in (bdk_wc): Move widechar tests from `bunnylib' to here,
	since those were meant only for bdki18n.h.  
	* bdk/bdki18n.h: Include bdkconfig.h and use BDK_* instead of G_*
	for widechar tests.
	* btk/Makefile.am (INCLUDES): Add -I../bdk for bdkconfig.h.

1999-03-13  Tor Lillqvist  <tml@iki.fi>

	* configure.in acconfig.h: Check for dirent.h and pwd.h. Generate
	bdk/bdkconfig.h using similar mechanism as GLib's bunnylibconfig.h.

	* btk-config.in: Add @libdir/btk+/include (where bdkconfig.h is
	installed) to CFLAGS.

	* bdk/Makefile.am: Add rules for bdkconfig.h.

	* bdk/bdktypes.h: Include bdkconfig.h. Define macros for windowing
	APIs.

	* bdk/bdkfontsel.c: Don't include Xlib.h, it gets included via
	bdkx.h anyway when compiling for X11.
	(btk_font_selection_create_xlfd): Use g_strdup_printf. (In
	general): Merge in Win32 version.
	
	* btk/btkfilesel.c: Use g_get_current_dir(). Merge in Win32
	version: Use G_DIR_SEPARATOR, g_path_is_absolute, no tilde
	expansion (if we don't have HAVE_PWD_H), allow for drive
	letters. UNC paths (\\server\share\...) are not handled yet.  Also,
	included code from Craig Setera's port to Win32 (the one that uses
	X11, and the cygwin dll), even if it probably will be abandoned.

	* btk/btkfilesel.c: Don't append a * to the pattern to complete if
	the user entered one herself.  This way one can complete *.h and
	don't get matches on any .help files, for instance.
	
Tue Mar  9 01:01:28 1999  Tim Janik  <timj@btk.org>

        * bdk/bdkfont.c (bdk_font_load): first lookup the xfont ID in our
        font hash table, if we have a BdkFontPrivate entry for this font
        already, simply increment its reference count, provided by Olaf Dietsche
        <olaf.dietsche+list.btk@netcologne.de>.

        * btk/btkstyle.c (btk_style_copy): plug a BdkFont reference leak, fix
        provided by Olaf Dietsche <olaf.dietsche+list.btk@netcologne.de>.

1999-03-09  Federico Mena Quintero  <federico@nuclecu.unam.mx>

	* btk/btkstyle.c (btk_default_draw_handle): Significantly reduced
	the number of calls to bdk_draw_point() (and thus to X) by
	clipping the points by hand.

	* btk/btkhandlebox.c (draw_textured_frame): Actually make use of
	the clip parameter.
	(btk_handle_box_paint): Only paint the handle if the expose area
	intersects it.

Sun Mar  7 18:46:37 1999  ape@lrdpf.spacetec.no  (Asbjorn Pettersen)

	* btk/btkmain.c (add_dll_suffix): Add this function (OS/2 ver.)

Sun Mar  7 11:43:34 1999  ape@spacetec.no  (Asbjorn Pettersen)

	* btk/btkthemes.c (btk_theme_engine_get): Add OS/2 changes.
	Added function gen_8_3_dll_name(gchar *name, gchar *fullname).

Fri Mar  5 09:12:24 1999  ape@lrdpf.spacetec.no  (Asbjorn Pettersen)

	* btk/btkitemfactory.c (btk_item_factory_parse_rc): Open file in
	 textmode (O_TEXT) for OS/2 version.

Sun Feb 28 16:46:02 1999  Stefan Jeske  <stefan@btk.org>

	* btk/btkspinbutton.[c,h] btk/testbtk.c: Added two new signals to 
	BtkSpinButton, "input" and "output", to make the output more flexible.
 	The user has to provide a mapping between adjustment->value and the
 	output string (and vice versa, if the spin button is editable). 
	See testbtk for examples.

Sat Feb 27 01:18:47 1999  Tim Janik  <timj@btk.org>

	* ChangeLog: moved old ChangeLog to ChangeLog.pre-1-2, and started
	new one.
	
	* configure.in: set btk+ version to 1.3.0.

	* btk/btkfilesel.h, btk/btkfilesel.c: Derive from BtkDialog,
